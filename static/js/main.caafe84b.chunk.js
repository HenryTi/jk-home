(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,function(e,t,n){"use strict";n(47);var r=n(34),i=n(45),a=n(46),o=n(27),s=n(2),c=n.n(s),u=n(6),l=n(8),h=n(18),f=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},d=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(u.a)(this,e),this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=h.k.array([],{deep:t})}return Object(l.a)(e,[{key:"scrollToTop",value:function(){this.topDiv="$$"+Object(a.a)()}},{key:"scrollToBottom",value:function(){this.bottomDiv="$$"+Object(a.a)()}},{key:"reset",value:function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)}},{key:"append",value:function(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)}},{key:"first",value:function(e){return d(this,void 0,void 0,c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.reset(),this.beforeLoad=!1,this.param=e,t.next=5,this.more();case 5:case"end":return t.stop()}},t,this)}))}},{key:"more",value:function(){return d(this,void 0,void 0,c.a.mark(function e(){var t,n,r,i,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.allLoaded){e.next=2;break}return e.abrupt("return");case 2:if(!0!==this.loading){e.next=4;break}return e.abrupt("return");case 4:return this.loading=!0,r=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(r=this.firstSize+1),e.next=9,this.load(this.param,this.pageStart,r);case 9:if(i=e.sent,this.loading=!1,this.loaded=!0,a=i.length,!0===this.isFirst&&a>this.firstSize||!1===this.isFirst&&a>this.pageSize?(this.allLoaded=!1,--a,i.splice(a,1)):this.allLoaded=!0,0!==a){e.next=17;break}return this._items.clear(),e.abrupt("return");case 17:this.setPageStart(i[a-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,Object(o.a)(i)):(n=this._items).unshift.apply(n,Object(o.a)(i.reverse())),this.isFirst=!1;case 20:case"end":return e.stop()}},e,this)}))}},{key:"items",get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0}}]),e}();f([h.k],p.prototype,"loading",void 0),f([h.k],p.prototype,"beforeLoad",void 0),f([h.k],p.prototype,"loaded",void 0),f([h.k],p.prototype,"allLoaded",void 0),f([h.d],p.prototype,"items",null),f([h.k],p.prototype,"topDiv",void 0),f([h.k],p.prototype,"bottomDiv",void 0);var v=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},m=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(u.a)(this,e),this.arr=[],this.dict=new Map,this.maxCount=t}return Object(l.a)(e,[{key:"loadIds",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(null!==s){var c=this.dict.get(s);void 0===c&&(t.push(s),c={id:s},this.dict.set(s,c))}}}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}this.loadId(t)}},{key:"get",value:function(e){if(void 0===e||null===e)return null;var t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t}},{key:"setItem",value:function(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))}},{key:"loadId",value:function(e){return m(this,void 0,void 0,c.a.mark(function t(){var n,r,i,a,o,s,u,l,h,f,d,p,v,m,b=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loadIds(e);case 2:if(void 0!==(n=t.sent)){t.next=36;break}r=!0,i=!1,a=void 0,t.prev=7,o=e[Symbol.iterator]();case 9:if(r=(s=o.next()).done){t.next=20;break}if(null!==(u=s.value)){t.next=13;break}return t.abrupt("continue",17);case 13:return t.next=15,this._loadId(u);case 15:l=t.sent,this.setItem(u,l);case 17:r=!0,t.next=9;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(7),i=!0,a=t.t0;case 26:t.prev=26,t.prev=27,r||null==o.return||o.return();case 29:if(t.prev=29,!i){t.next=32;break}throw a;case 32:return t.finish(29);case 33:return t.finish(26);case 34:t.next=56;break;case 36:for(h=!0,f=!1,d=void 0,t.prev=39,p=function(){var e=m.value,t=n.find(function(t){return t.id===e});b.setItem(e,t)},v=e[Symbol.iterator]();!(h=(m=v.next()).done);h=!0)p();t.next=48;break;case 44:t.prev=44,t.t1=t.catch(39),f=!0,d=t.t1;case 48:t.prev=48,t.prev=49,h||null==v.return||v.return();case 51:if(t.prev=51,!f){t.next=54;break}throw d;case 54:return t.finish(51);case 55:return t.finish(48);case 56:case"end":return t.stop()}},t,this,[[7,22,26,34],[27,,29,33],[39,44,48,56],[49,,51,55]])}))}}]),e}();v([h.k],b.prototype,"dict",void 0),n.d(t,"q",function(){return r.k}),n.d(t,"o",function(){return r.j}),n.d(t,"n",function(){return r.h}),n.d(t,"k",function(){return r.c}),n.d(t,"j",function(){return r.b}),n.d(t,"a",function(){return r.a}),n.d(t,"e",function(){return i.d}),n.d(t,"p",function(){return i.j}),n.d(t,"f",function(){return i.e}),n.d(t,"b",function(){return i.a}),n.d(t,"m",function(){return i.i}),n.d(t,"l",function(){return i.h}),n.d(t,"c",function(){return i.b}),n.d(t,"r",function(){return i.k}),n.d(t,"d",function(){return i.c}),n.d(t,"h",function(){return i.f}),n.d(t,"i",function(){return i.g}),n.d(t,"g",function(){return p})},,,function(e,t,n){"use strict";var r,i=n(4),a=n(20),o=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=function(){function e(e){this.formView=e}return e.prototype.render=function(){return i.createElement("div",{className:"col-sm-10"},this.renderControl())},Object.defineProperty(e.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.clear=function(){},e.prototype.clearErrors=function(){},e.prototype.readValues=function(e){},e.prototype.setError=function(e,t){},e.prototype.setInitValues=function(e){},e.prototype.isOk=function(){return this.validate(),!this.hasError},e.prototype.validate=function(){},s([a.d],e.prototype,"hasError",null),s([a.d],e.prototype,"filled",null),e}(),u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.field=n,i.face=r,i.init(),i.setProps(),i}return o(t,e),t.prototype.ref=function(e){this.element=e},t.prototype.init=function(){var e;this.rules=[];var t=this.field.rules;void 0!==t&&(!0===Array.isArray(t)?(e=this.rules).push.apply(e,t):this.rules.push(t))},t.prototype.setProps=function(){return this.props={ref:this.ref.bind(this),name:this.field.name}},Object.defineProperty(t.prototype,"hasError",{get:function(){return void 0!==this.error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return void 0!==this.value&&this.value!==this.field.defaultValue},enumerable:!0,configurable:!0}),t.prototype.clearValue=function(){this.value=void 0},t.prototype.clear=function(){this.clearErrors(),this.clearValue()},t.prototype.clearErrors=function(){this.isOK=void 0,this.error=void 0},t.prototype.readValues=function(e){e[this.field.name]=this.value},t.prototype.setError=function(e,t){},t.prototype.setInitValues=function(e){},t.prototype.getValueFromElement=function(){return this.value},t.prototype.validate=function(){try{var e=this.getValueFromElement();if(this.rules.length>0){for(var t=void 0,n=0,r=this.rules;n<r.length;n++){var i=r[n];console.log("validate: %s",e);var a=i(e);if(console.log("validate: %s err: %s",e,a),!0===a)this.error=void 0,t=!0;else if(void 0!==a)return this.error=a,void(this.isOK=!1)}this.isOK=t}this.value=e}catch(o){this.error=o.message}},t.prototype.render=function(){var e;if(void 0!==this.face){var t=this.face.notes;void 0!==t&&(e=i.createElement("small",{className:"text-muted"},t))}return i.createElement("div",{className:"col-sm-10"},this.renderControl(),e)},s([a.k],t.prototype,"isOK",void 0),s([a.k],t.prototype,"error",void 0),s([a.k],t.prototype,"value",void 0),s([a.d],t.prototype,"hasError",null),s([a.d],t.prototype,"filled",null),t}(c),l=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(e){function t(t){var n=e.call(this,t)||this;return n.otherClick=n.otherClick.bind(n),n}return l(t,e),t.prototype.otherClick=function(){var e=this.formView.props.onOther;void 0!==e&&e(this.formView.readValues())},t.prototype.renderControl=function(){console.log("buttons.renderControl");var e=this.formView.nothing,t=this.formView.hasError,n=this.formView.props;console.log("buttons.renderControl nothing:%s hasError:%s",e,t);var r,a=n.submitButton,o=n.otherButton;n.onOther;return void 0!==o&&(r=i.createElement("button",{className:"btn btn-outline-info ml-auto",onClick:this.otherClick},o)),i.createElement("div",{className:"d-flex justify-content-start"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:e||t},a||"\u63d0\u4ea4"),r)},t}(c),f=n(30),d=n(14),p=n.n(d),v=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.init=function(){e.prototype.init.call(this),!0===this.field.required&&this.rules.push(function(e){return null!==e&&void 0!==e&&0!==e.trim().length||"\u5fc5\u987b\u586b\u5165\u8981\u6c42\u5185\u5bb9"})},t.prototype.getValueFromElement=function(){return this.parseValue(this.element.value)},t.prototype.setProps=function(){e.prototype.setProps.call(this),f.assign(this.props,{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)});var t=this.face;return void 0!==t&&f.assign(this.props,{placeholder:t.placeholder}),this.props},t.prototype.parseValue=function(e){return e},t.prototype.onBlur=function(){this.validate()},t.prototype.onChange=function(){console.log("onChange"),this.validate()},t.prototype.onFocus=function(){this.clearErrors()},t.prototype.className=function(){return d({"form-control":!0,"has-success":!0===this.isOK,"is-invalid":void 0!==this.error,"is-valid":void 0===this.error&&!0===this.isOK})},t.prototype.renderInput=function(){return i.createElement("input",m({className:this.className()},this.props))},t.prototype.ref=function(t){e.prototype.ref.call(this,t),t&&(t.value=void 0===this.value?"":this.value)},t.prototype.renderError=function(){return void 0===this.error?null:i.createElement("div",{className:"invalid-feedback"},this.error)},t.prototype.clearValue=function(){e.prototype.clearValue.call(this),this.element.value=""},t.prototype.setError=function(e,t){this.field.name===e&&(this.error=t)},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0!==t&&(this.value=t)},t.prototype.renderControl=function(){return i.createElement(i.Fragment,null,this.renderInput(),this.renderError())},t}(u),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return f.assign(t,{type:"text",maxLength:this.field.maxLength}),t},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length)return e},t}(b),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return f.assign(t,{type:"password",maxLength:this.field.maxLength}),t},t}(w),g=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.extraChars=[];var t=this.field,n=t.min,r=t.max;switch(void 0!==n?(this.rules.push(function(e){if(void 0!==e)return!(e<n)||"\u6700\u5c0f\u503c\u4e3a"+n}),n<0&&this.extraChars.push(45)):this.extraChars.push(45),void 0!==r&&this.rules.push(function(e){if(void 0!==e)return!(e>r)||"\u6700\u5927\u503c\u4e3a"+r}),this.field.type){case"dec":case"number":this.extraChars.push(46)}},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("\u65e0\u6548\u7684\u6570\u5b57");return t}},t.prototype.setProps=function(){e.prototype.setProps.call(this),f.assign(this.props,{type:"number",step:this.field.step,onKeyPress:this.onKeyPress.bind(this)})},t.prototype.onKeyPress=function(e){var t=e.charCode;if(!(8===t||0===t||13===t||t>=48&&t<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(t)>=0)switch(t){case 46:this.onKeyDot();break;case 45:this.onKeyNeg(),e.preventDefault()}else e.preventDefault()},t.prototype.onKeyDot=function(){var e=this.element.value;e.indexOf(".")>=0&&(this.element.value=e.replace(".",""))},t.prototype.onKeyNeg=function(){var e=this.element.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.element.value=e},t}(b),O=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.init=function(){e.prototype.init.call(this);var t=this.field,n=t.trueValue,r=t.falseValue;void 0===n&&(this.trueValue=1),void 0===r&&(this.falseValue=0)},t.prototype.setProps=function(){e.prototype.setProps.call(this),f.assign(this.props,{onChange:this.onChange.bind(this)})},t.prototype.clearValue=function(){this.element.checked=this.field.defaultValue===this.trueValue,this.value=this.getValueFromElement()},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0===t&&(t=this.field.defaultValue)},t.prototype.getValueFromElement=function(){return this.element.checked?this.trueValue:this.falseValue},t.prototype.onChange=function(){this.value=this.getValueFromElement()},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static"},i.createElement("label",{className:"form-control"},i.createElement("label",{className:"custom-control custom-checkbox mb-0"},i.createElement("input",{type:"checkbox",name:this.field.name,ref:this.props.ref,onChange:this.props.onChange,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},this.face.label))))},t}(u),E=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.prototype.renderControl=function(){var e=this;return i.createElement("div",{className:"form-control-static"},i.createElement("div",{className:"form-control"},this.face.list.map(function(t,n){var r;return"object"!==typeof t?r=t:(r=t.text,t.value),i.createElement("label",{key:n,className:"custom-control custom-radio w-25"},i.createElement("input",{type:"radio",name:e.field.name,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},r))})))},t}(u),N=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(){return(S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this),n=this.field.maxLength,r=this.face.rows;return f.assign(t,{maxLength:n,rows:r}),t},t.prototype.renderInput=function(){var e=this;return i.createElement("textarea",S({ref:function(t){e.el=t,void 0!==t&&(t.value="")},className:this.className()},this.props))},t}(b),F=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.ref=i.ref.bind(i),i}return F(t,e),t.prototype.getValueFromElement=function(){var e=this.element,t=(e.selectedIndex,e.selectedOptions[0].value);switch(this.field.type){case"number":t=Number(t);break;case"date":t=new Date(t);break;case"bool":"string"===typeof t&&(t="true"===t.toLowerCase())}return t},t.prototype.renderControl=function(){var e=this.face.list,t=[];return void 0===this.face.default&&t.push(i.createElement("option",{key:-1,value:void 0},"\u8bf7\u9009\u62e9")),t.push.apply(t,e.map(function(e,t){var n,r;return"object"!==typeof e?n=r=e:(n=e.text,r=e.value),i.createElement("option",{key:t,value:r},n)})),i.createElement("div",{className:"form-control-static"},i.createElement("select",{name:this.field.name,className:"form-control",ref:this.ref},t))},t}(u),A=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},i.createElement("div",{className:"alert alert-primary",role:"alert"},"don't know how to create control",i.createElement("br",null),"field: ",JSON.stringify(this.field)," must be object ",i.createElement("br",null),"face: ",JSON.stringify(this.face)," must be object ",i.createElement("br",null)))},t}(u),q=function(e){function t(t,n){var r=e.call(this,t)||this;return r.element=n,r}return A(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},this.element)},t}(c),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},D=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},U=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return D(t,void 0,void 0,function(){var e,t,n,r,i,a,o;return U(this,function(s){switch(s.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=s.sent())?(this.value=void 0,[2]):void 0===n?(this.value=r.id,[2]):(i=n(r),a=i.id,o=i.caption,this.value=a,this.caption=o,[2])}})})},t.onPicked=function(e){t.value=e.id},t}return T(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.controlContent=function(){var e=this.face,t=e.itemFromId,n=e.fromPicked,r=e.initCaption;if(void 0===this.value)return r||"\u8bf7\u9009\u62e9Id";if(void 0!==this.caption)return this.caption;if(void 0!==t&&void 0!==n){var i=t(this.value);if(i){var a=n(i);if(void 0!==a)return a.caption}}return String(this.value)},t.prototype.renderControl=function(){var e=this.face,t=e.tuid,n=e.input;return void 0===n?i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer",onClick:this.onClick},this.controlContent()):i.createElement("div",{className:"form-control-static "},i.createElement(n.component,{id:this.value,ui:t}))},I([a.k],t.prototype,"caption",void 0),t}(u),L=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},H=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},W=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.onIdChanged=i.onIdChanged.bind(i),i}return L(t,e),t.prototype.onIdChanged=function(e){this.value=e.id},t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.buildContent=function(){var e=this;return i.createElement(this.face.input.component,B({},this.face,{id:this.value,onFormValues:function(){return e.formView.readValues()},onIdChanged:this.onIdChanged}))},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static "},this.buildContent())},H([a.k],t.prototype,"caption",void 0),t}(u),K=n(28),Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},J=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},X=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return J(t,void 0,void 0,function(){var e,t,n,r,i,a,o;return X(this,function(s){switch(s.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=s.sent())?(this.value=void 0,[2]):(i=n(r),a=i.id,o=i.caption,this.value=a,this.caption=o,[2])}})})},t.view=Object(K.a)(function(){var e,n=t.face.content;return e=void 0===t.value||null===t.value?"\u8bf7\u9009\u62e9":i.createElement(n,{id:t.value}),i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer bg-light",onClick:t.onClick},e)}),t}return Q(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.renderControl=function(){return i.createElement(this.view,null)},z([a.k],t.prototype,"caption",void 0),t}(u),G=function(e,t){t.label;return void 0!==t.group?function(e,t,n){return new R(e,n,void 0)}(e,0,t):void 0!==t.field?function(e,t,n){var r=n.field,i=n.face;switch(typeof r){case"string":r={name:r,type:"string"};break;case"object":break;default:return new R(e,r,i)}var a=r.type||"string";if(void 0===i){if(void 0===(i=$[a]))return new R(e,r,i)}else if(void 0===i.type){var o=$[a];i.type=void 0===o?"string":o.type}return new(Y[i.type||a]||R)(e,r,i)}(e,0,t):new q(e,t.help)},Y={string:w,password:k,number:x,checkbox:j,radiobox:C,select:V,"pick-id":M,"pick-tuid":W,textarea:P,pick:Z},$={string:{type:"string"},number:{type:"number"},int:{type:"number"},dec:{type:"number"},bool:{type:"checkbox"}};var _=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(){function e(e,t){if(this.form=e,this.row=t,void 0===t.type){var n=t.createControl;void 0===n&&(n=e.createControl),void 0===n&&(n=G),this.control=n(e,t)}}return e.prototype.isOk=function(){return void 0===this.control||this.control.isOk()},e.prototype.contains=function(e){var t=this.row.field;if(void 0!==t)return e===t.name;var n=this.row.group;return void 0!==n&&void 0!==n.find(function(t){return t.field.name===e})},Object.defineProperty(e.prototype,"hasError",{get:function(){return this.control.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return this.control.filled},enumerable:!0,configurable:!0}),e.prototype.clear=function(){void 0!==this.control&&this.control.clear()},e.prototype.clearErrors=function(){void 0!==this.control&&this.control.clearErrors()},e.prototype.readValues=function(e){void 0!==this.control&&this.control.readValues(e)},e.prototype.setError=function(e,t){void 0!==this.control&&this.control.setError(e,t)},e.prototype.setInitValues=function(e){void 0!==this.control&&this.control.setInitValues(e)},e}(),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group"},this.row)},Object.defineProperty(t.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(ee),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.row.label),this.control.render())},t}(ee);function re(e,t){return new ne(e,t)}function ie(e,t){return new te(e,t)}var ae="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",oe=8;function se(){for(var e=ae.length,t="",n=0;n<oe;n++)t+=ae.charAt(Math.floor(Math.random()*e));return t}var ce=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},le=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},he=function(){function e(e){this.rows=[],this.uid=se(),this.props=e,this.buildRows(e),this.createControl=e.createControl,this.onSubmit=this.onSubmit.bind(this)}return Object.defineProperty(e.prototype,"hasError",{get:function(){var e=this.rows.map(function(e,t){return t+": "+e.hasError+"\n"});return console.log(e),this.rows.some(function(e){return e.hasError})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nothing",{get:function(){return this.rows.every(function(e){return!e.filled})},enumerable:!0,configurable:!0}),e.prototype.readValues=function(){for(var e={},t=0,n=this.rows;t<n.length;t++){n[t].readValues(e)}return e},e.prototype.clear=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clear()}},e.prototype.clearErrors=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clearErrors()}},e.prototype.setError=function(e,t){for(var n=0,r=this.rows;n<r.length;n++){r[n].setError(e,t)}},e.prototype.setInitValues=function(e){if(void 0!==e)for(var t=0,n=this.rows;t<n.length;t++){n[t].setInitValues(e)}},e.prototype.buildRows=function(e){var t=e.formRows,n=e.createRow;if(void 0!==t){for(var r=0,a=t;r<a.length;r++){var o=a[r];this.rows.push(this.buildRow(o,n))}!0!==this.props.readOnly&&(this.buttonsRow=this.buildRow({createControl:this.createButtons.bind(this)},void 0))}else this.rows.push(ie(this,i.createElement("div",{className:"text-warning"},"TonvaForm need formRows defined")))},e.prototype.buildRow=function(e,t){var n;return void 0!==e.type?n=ie:void 0===(n=e.createRow)&&void 0===(n=t)&&(n=re),n(this,e)},e.prototype.createButtons=function(e,t){return new h(e)},e.prototype.isOk=function(){for(var e=!0,t=0,n=this.rows;t<n.length;t++){n[t].isOk()||(e=!1)}return e},e.prototype.render=function(){var e=this;return i.createElement("form",{onSubmit:this.onSubmit},this.rows.map(function(t,n){return t.render(e.uid+n)}),this.buttons())},e.prototype.buttons=function(){if(void 0!==this.buttonsRow)return this.buttonsRow.render(this.uid+this.rows.length)},e.prototype.onSubmit=function(e){return ue(this,void 0,void 0,function(){var t;return le(this,function(n){switch(n.label){case 0:return e.preventDefault(),this.isOk()?(t=this.readValues(),[4,this.props.onSubmit(t)]):[2];case 1:return n.sent(),[2]}})})},ce([a.d],e.prototype,"hasError",null),ce([a.d],e.prototype,"nothing",null),e}(),fe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};var pe=function(e){function t(t){var n=e.call(this,t)||this;return n.formView=new he(n.props),n}return fe(t,e),t.prototype.componentWillMount=function(){this.formView.setInitValues(this.props.initValues)},t.prototype.debug=function(){},t.prototype.render=function(){var e=this.props,t=e.className,n=e.children;e.initValues;return i.createElement("div",{className:t},void 0===n?this.formView.render():i.createElement("form",{onSubmit:this.formView.onSubmit},n))},t=de([K.a],t)}(i.Component),ve=n(60),me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),be=(function(e){function t(t){var n=e.call(this,t)||this;return n.toggle=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={dropdownOpen:!1},n}me(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.actions,r=e.isRight;void 0===r&&(r=!0);var a=n.some(function(e){return void 0!==e.icon});return i.createElement(ve.d,{isOpen:this.state.dropdownOpen,toggle:this.toggle},i.createElement(ve.c,{caret:!0,size:"sm",className:"cursor-pointer"},i.createElement("i",{className:d("fa","fa-"+(t||"ellipsis-v"))})),i.createElement(ve.b,{right:r},n.map(function(e,t){var n,r=e.icon,o=e.caption,s=e.action;return void 0===r&&void 0===o?i.createElement("div",{className:"dropdown-divider"}):(!0===a&&(void 0!==r&&(r="fa-"+r),n=i.createElement(i.Fragment,null,i.createElement("i",{className:d("fa",r,"fa-fw"),"aria-hidden":!0}),"\xa0 ")),void 0===s?i.createElement("h6",{className:"dropdown-header"},n," ",o):i.createElement(ve.a,{key:t,onClick:s},n," ",o))})))}}(i.Component),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return be(t,e),t.prototype.render=function(){var e=this.props.date;if(!e)return null;var t="string"===typeof e?new Date(Date.parse(e)):e,n=new Date,r=n.getTime()-t.getTime(),i=n.getDate(),a=t.getDate(),o=t.getHours(),s=t.getMinutes(),c=t.getMonth()+1,u=o+(s<10?":0":":")+s;return r<-864e5?t.getFullYear()+"\u5e74"+c+"\u6708"+a+"\u65e5 "+u:r<864e5?a!==i?(r<0?"\u660e\u5929 ":"\u6628\u5929 ")+u:u:r<31536e6?c+"\u6708"+a+"\u65e5 ":t.getFullYear()+"\u5e74"+c+"\u6708"+a+"\u65e5"},t}(i.Component),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(){function e(){}return e.prototype.setValues=function(e){},e}(),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.render=function(e){return i.createElement("div",{key:"_b_"+e,className:""},i.createElement("div",{className:"col-sm-12"},i.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))},t}(ke),xe=function(e){function t(t){var n=e.call(this)||this;return n.param=t,n}return we(t,e),t.prototype.render=function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=d(t);return i.createElement("div",{key:"_g_"+e,className:n,style:{backgroundColor:"#f0f0f0"}})},t}(ke),Oe=function(e){function t(t,n){var r=e.call(this)||this;return r.gridProps=t,r.prop=n,r}return we(t,e),t.prototype.render=function(e){var t=this.prop,n=t.onClick,r=t.bk,a=d({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return i.createElement("div",{key:e,className:a,onClick:n},this.renderLabel(),this.renderProp())},t.prototype.renderLabel=function(){var e=this.prop.label;return void 0===e?null:i.createElement("label",{className:"col-sm-2 col-form-label"},e)},t.prototype.renderProp=function(){var e,t,n=this.prop,r=n.label,a=n.full;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var o=d(e,t,!0!==a?void 0===r?"col-sm-12":"col-sm-10":"w-100","d-flex");return i.createElement("div",{className:o},this.renderPropBody())},t.prototype.renderPropBody=function(){return i.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())},t.prototype.renderPropContent=function(){return this.content},t}(ke),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(Oe),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(Oe),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.setValues=function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}},t.prototype.renderPropBody=function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?i.createElement("div",null):i.createElement("div",{className:"w-100"},r.map(function(e,t){return i.createElement(i.Fragment,{key:t},0===t?null:i.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),i.createElement(n,e))}))},t}(Oe),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),t.prototype.renderPropBody=function(){return this.prop.component},t}(Oe),Se=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}we(t,e),t.prototype.render=function(e){return i.createElement("div",{className:"bg-white"},i.createElement("label",{className:"col-sm-2 col-form-label"},"AAABBBCCC"),i.createElement("div",{className:"col-sm-10"},i.createElement("div",{className:"form-control-plaintext"},"dsfasfa sdf asdf a")))}}(ke),function(){function e(e,t){this.gridProps=e,this.props=t,this.buildRows()}return e.prototype.buildRows=function(){this.rows=[];for(var e=!0,t=0,n=this.props;t<n.length;t++){var r=n[t];if("string"===typeof r)this.rows.push(new xe(r)),e=!0;else{e||this.rows.push(new ge);var i=void 0;switch(r.type){default:continue;case"string":i=new je(this.gridProps,r);break;case"number":i=new Ee(this.gridProps,r);break;case"list":i=new Ce(this.gridProps,r);break;case"component":i=new Ne(this.gridProps,r)}this.rows.push(i),e=!1}}},e.prototype.setValues=function(e){for(var t=0,n=this.rows;t<n.length;t++){n[t].setValues(e)}},e.prototype.render=function(){return this.rows.map(function(e,t){return e.render(String(t))})},e}()),Pe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pe(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.rows,r=e.values,a=new Se(this.props,n);a.setValues(r);var o=d("container-fluid",t);return i.createElement("div",{className:o},a.render())},t=Fe([K.a],t)}(i.Component),Ae=(n(118),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Re=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},qe=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ae(t,e),t.prototype.render=function(){var e,t=this.props,n=t.className,r=t.badge,a=t.size,o=t.color,s=t.badgeAlign,c=t.badgeVertical,u=t.children,l=d(n,"va-badge",a&&"va-badge-"+a,"va-badge-"+(o||"secondary"),s&&"va-badg-"+s,c&&"va-badg-"+c);return r&&(e=i.createElement("b",null,r)),i.createElement("div",{className:l},u,e)},t=Re([K.a],t)}(i.Component),n(120),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Te=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qe(t,e),t.prototype.render=function(){var e,t,n,r=this.props,a=r.className,o=r.left,s=r.children,c=r.right,u=r.onClick;return void 0!==o&&(e=i.createElement("header",null,o)),void 0!==c&&(t=i.createElement("footer",null,c)),void 0!==u&&(n="cursor-pointer"),i.createElement("div",{className:d("va-lmr",a,n),onClick:u},e,i.createElement("div",null,s),t)},t=Te([K.a],t)}(i.Component),De=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return De(t,e),t.prototype.render=function(){var e=this.props,t=e.name,n=e.className,r=e.size,a=e.spin,o=e.fixWidth,s=e.border,c=e.pull,u=e.pulse,l=e.rotate,h=e.flip,f=e.inverse,p=d(n,"fa",t&&"fa-"+t,r&&"fa-"+r,o&&"fa-fw",s&&"fa-border",c&&"fa-pull-"+c,a&&"fa-spin",u&&"fa-pulse",l&&"fa-rotate-"+l,h&&"fa-flip-"+h,f&&"fa-inverse");return i.createElement("i",{className:p})},t}(i.Component),Me=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}De(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.size,r=e.children,a=d("fa-stack",t,n&&"fa-"+n);return i.createElement("span",{className:a},r)}}(i.Component),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Me(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.iconClass,r=e.text,a=e.textClass;return i.createElement("div",{className:"py-2"},i.createElement(Ue,{className:n,name:t,fixWidth:!0}),i.createElement("span",{className:a},r))},t}(i.Component),Be=function(e){return i.createElement("small",{className:d("text-muted",e.className),style:e.style},e.children)},He=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),We={width:"4rem",height:"4rem"},Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return He(t,e),t.prototype.render=function(){var e,t=this.props,n=t.icon,r=t.main,a=t.discription,o=t.px,s=t.py;e="string"===typeof a?i.createElement("div",null,a):a;var c=n;"string"===typeof n&&(c=i.createElement("img",{className:"d-flex mr-3",src:n,alt:"img",style:We}));var u=d("media",void 0===o?"px-0":"px-"+o,void 0===s?"py-2":"py-"+s);return i.createElement("div",{className:u},c,i.createElement("div",{className:"media-body"},i.createElement("h5",{className:"mt-0"},r),e))},t}(i.Component),Qe=(n(122),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ze=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},Je=function(e){function t(t){var n=e.call(this,t)||this;return n.state={pressed:!1},n}return Qe(t,e),t.prototype.render=function(){var e,t,n,r,a,o,s=this.props,c=(s.date,s.main),u=s.vice,l=s.middle,h=s.midSize,f=s.icon,p=s.unread,v=s.right,m=s.onClick;if(void 0!==p){var b=void 0;(b="number"===typeof p?p:p.get())>0?n=i.createElement("b",null,b):b<0&&(n=i.createElement("b",{className:"dot"}))}switch(typeof f){case"object":e=i.createElement("header",null,f,n),t=!1;break;case"string":e=i.createElement("header",{className:"icon"},i.createElement("img",{src:f}),n),t=!0}if(void 0!==l)switch(typeof l){case"string":r=i.createElement("div",{style:{flex:h}},l);break;default:r=l}void 0!==v&&(a="string"===typeof v?i.createElement("footer",null,i.createElement("small",{className:"text-muted"},v)):i.createElement("footer",null,v)),void 0!==u&&(o=i.createElement("span",null,u));var y=d("va-row",{icon:t,pressed:this.state.pressed},{"va-action":void 0!==m});return i.createElement("li",{className:y,onClick:m},e,i.createElement("div",null,i.createElement("div",null,c),o),r,a)},t=ze([K.a],t)}(i.Component),Xe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=function(){return(Ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ge=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},Ye=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xe(t,e),t.prototype.render=function(){var e,t,n=this,r=this.props,a=r.header,o=r.items,s=r.beforeLoad,c=r.none,u=r.renderRow,l=r.className,h=r.footer,f=r.itemClick,p=r.converter,v=d(l,"va-list");return e=void 0===o?null===s?null:i.createElement("li",{className:"empty"},s||"..."):0===o.length?i.createElement("li",{className:"empty"},c||"[none]"):void 0!==u?o.map(function(e,t){return u(e,t,n.props.ex)}):o.map(function(e,t){var n,r=e.onClick;if(void 0===r&&void 0!==f&&(r=function(){return f(e)}),void 0!==p){if(void 0===(n=p(e)))return null}else n=Ze({},e);return void 0===n.key&&(n.key=n.main),i.createElement(Je,Ze({onClick:r},n))}),void 0!==a&&(t="string"===typeof a?i.createElement("div",{className:"va-list-header"},a):a),i.createElement("div",{className:v},t,i.createElement("ul",null,e),h)},t=Ge([K.a],t)}(i.Component),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),$e=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},_e=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},et=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e){n.key=e.target.value,void 0!==n.key&&(n.key=n.key.trim()),n.setState({disabled:!n.key})},n.ref=function(e){n.input=e,n.key=n.props.initKey||"",null!==e&&(e.value=n.key)},n.onSubmit=function(e){return $e(n,void 0,void 0,function(){return _e(this,function(t){switch(t.label){case 0:return e.preventDefault(),this.key?(this.input&&(this.input.disabled=!0),[4,this.props.onSearch(this.key)]):[2];case 1:return t.sent(),this.input&&(this.input.disabled=!1),[2]}})})},n.state={disabled:!1},n}return Ye(t,e),t.prototype.render=function(){var e,t,n=this.props,r=n.className,a=n.label,o=n.placeholder,s=n.buttonText,c=n.maxLength;switch(n.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return void 0!==a&&(t=i.createElement("label",{className:"input-group-addon"},a)),i.createElement("form",{className:r,onSubmit:this.onSubmit},i.createElement("div",{className:d("input-group",e)},t,i.createElement("input",{onChange:this.onChange,type:"text",name:"key",ref:this.ref,className:"form-control",placeholder:o,maxLength:c}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.state.disabled},i.createElement("i",{className:"fa fa-search"}),i.createElement("i",{className:"fa"}),s))))},t}(i.Component),tt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(){return(nt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},rt=(function(e){function t(t){var n=e.call(this,t)||this;return n.values={},n.stepViews=[],n.state={topView:void 0,stepViews:[]},n.onPrev=n.onPrev.bind(n),n.onNext=n.onNext.bind(n),n}tt(t,e),t.prototype.setStep=function(e){var t=this.props.steps[e];if(void 0!==t){var n,r;void 0!==this.topView&&this.stepViews.push(this.topView),this.stepViews.length>0&&(n=i.createElement(rt,{prefix:"undo",text:"\u4e0a\u4e00\u6b65"}),r=this.onPrev);var a=this.props,o=(a.header,a.footer,void 0===t.next?{prefix:"cloud-upload",text:this.props.submitButton||"\u63d0\u4ea4"}:{suffix:"arrow-right",text:"\u4e0b\u4e00\u6b65"}),s={formRows:t.formRows,submitButton:i.createElement(rt,nt({},o)),onSubmit:this.onNext,otherButton:n,onOther:r};this.stepViews.length;this.topView={stepName:e,step:t,props:s},this.setState({topView:this.topView,stepViews:this.stepViews})}},t.prototype.componentWillMount=function(){this.setStep(this.props.first)},t.prototype.onPrev=function(e){f.assign(this.values,e),this.topView=this.stepViews.pop(),this.setState({topView:this.topView,stepViews:this.stepViews})},t.prototype.onNext=function(e){f.assign(this.values,e);var t,n=this.topView.step.next;if(void 0===n)return this.props.onSubmit(this.values);t="string"===typeof n?n:n(this.values),this.setStep(t)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.header,r=e.footer,a=this.state,o=a.topView,s=a.stepViews,c=o.stepName,u=o.step,l=s.length+1;return i.createElement("div",{className:t},i.createElement("div",null,n&&n(u,l),i.createElement(pe,nt({key:c,initValues:this.values},o.props)),r&&r(u,l)))}}(i.Component),function(e){var t,n,r=e.prefix,a=(e.text,e.suffix);return void 0!==r&&(t=i.createElement("i",{className:d("fa","fa-"+r)})),void 0!==a&&(n=i.createElement("i",{className:d("fa","fa-"+a)})),i.createElement(i.Fragment,null,t," ",e.text," ",n)}),it=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},at=function(){function e(e){this.list=e}return Object.defineProperty(e.prototype,"isPaged",{get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loading",{get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItems",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.updateProps=function(e){},e.prototype.renderContent=function(e,t){var n=this.list.props.item.render;return void 0===n?i.createElement("div",{className:"px-3 py-2"},JSON.stringify(e)):n(e,t)},it([a.d],e.prototype,"loading",null),e}(),ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ot(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,a=n.key,o=n.onClick;return i.createElement("li",{key:void 0===a?t:a(e),className:d("va-row-clickable",r),onClick:function(){return o(e)}},this.renderContent(e,t))},t}(at),ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,a=n.key;n.render;if("string"===typeof e){var o=d("va-list-gap","px-3","pt-1");return i.createElement("li",{key:se(),className:o},e)}return i.createElement("li",{key:void 0===a?t:a(e),className:d(r)},this.renderContent(e,t))},t}(at),lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lt(t,e),t.prototype.buildItems=function(){console.log("buildItems in selectable.tsx");var e,t=this.list.props,n=t.items,r=t.selectedItems,i=t.compare;return void 0===n?this._items=void 0:null===n?this._items=null:(e=!0===Array.isArray(n)?n:n.items,this._selectedItems=r,this._items=void 0===r?e.map(function(e){return{selected:!1,item:e,labelId:se()}}):void 0===i?e.map(function(e){return{selected:void 0!==r.find(function(t){return t===e}),item:e,labelId:se()}}):e.map(function(e){return{selected:void 0!==r.find(function(t){return i(e,t)}),item:e,labelId:se()}}))},Object.defineProperty(t.prototype,"items",{get:function(){return this.buildItems(),this._items},enumerable:!0,configurable:!0}),t.prototype.updateProps=function(e){e.selectedItems!==this._selectedItems&&this.buildItems()},t.prototype.onSelect=function(e,t){e.selected=t;var n=this._items.some(function(e){return e.selected});this.list.props.item.onSelect(e.item,t,n)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._items.filter(function(e){return!0===e.selected}).map(function(e){return e.item})},enumerable:!0,configurable:!0}),t.prototype.render=function(e,t){var n=this,r=this.list.props.item,a=r.className,o=r.key,s=(r.render,r.onSelect,e.labelId),c=e.selected;return i.createElement("li",{key:void 0===o?t:o(e),className:d(a)},i.createElement("div",{className:"d-flex align-items-center px-3"},i.createElement("input",{ref:function(e){e&&(n.input=e,e.checked=c)},className:"",type:"checkbox",value:"",id:s,defaultChecked:c,onChange:function(t){n.onSelect(e,t.target.checked)}}),i.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:s},this.renderContent(e.item,t))))},ht([a.d],t.prototype,"items",null),t}(at),dt=(n(124),function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),pt=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},vt=function(e){function t(t){var n=e.call(this,t)||this;n._$scroll=function(e){console.log("############### items scroll to "+e)};var r=n.props.item,i=r.onClick,a=r.onSelect;return n.listBase=void 0!==a?new ft(n):void 0!==i?new st(n):new ut(n),n}return dt(t,e),t.prototype.componentWillUpdate=function(e,t,n){this.listBase.updateProps(e)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this.listBase.selectedItems},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.header,a=t.footer,o=t.before,s=t.loading,c=t.none;t.item,t.selectedItems;void 0===o&&(o="before"),void 0===s&&(s="loading"),void 0===c&&(c="none");var u,l=this.listBase,h=(l.isPaged,l.items);l.loading;function f(e,t){if(e)switch(typeof e){default:case"string":return i.createElement("li",{className:"va-list-"+t},e);case"function":return i.createElement("li",{className:"va-list-"+t},e());case"object":return i.createElement("li",null,e)}}return u=null===h?f(o,"before"):void 0===h?f(s,"loading"):0===h.length?f(c,"none"):h.map(function(t,n){return e.listBase.render(t,n)}),i.createElement("ul",{className:p()("va-list",n)},f(r,"header"),u,f(a,"footer"))},t=pt([K.a],t)}(i.Component);n.d(t,"a",function(){return ye}),n.d(t,"h",function(){return Ve}),n.d(t,"d",function(){return Ie}),n.d(t,"b",function(){return Ue}),n.d(t,"c",function(){return Le}),n.d(t,"g",function(){return Be}),n.d(t,"f",function(){return Ke}),n.d(t,"i",function(){return et}),n.d(t,"e",function(){return vt})},,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return C}),n.d(t,"a",function(){return P}),n.d(t,"c",function(){return R});var r,i=n(2),a=n.n(i),o=n(6),s=n(8),c=n(9),u=n(7),l=n(10),h=n(13),f=n(11),d=n(18),p=(n(63),n(47)),v=n(52),m=n(65),b=n(75),y=n(32),w=n(41),k=n(34),g=(n(72),n(81),n(100),n(102),n(38)),x=n(48),O=n(62),j=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},E=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},C=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0,N=(n(82),[]),S=1,P=function(t){function n(e){var t;return Object(o.a)(this,n),(t=Object(c.a)(this,Object(u.a)(n).call(this,e))).waitCount=0,t.isHistoryBack=!1,t.clearError=function(){t.setState({fetchError:void 0})},t.back=t.back.bind(Object(h.a)(Object(h.a)(t))),t.navBack=t.navBack.bind(Object(h.a)(Object(h.a)(t))),t.stack=[],t.state={stack:t.stack,wait:0,fetchError:void 0},t}return Object(l.a)(n,t),Object(s.a)(n,[{key:"componentWillMount",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.addEventListener("popstate",this.navBack);case 1:case"end":return e.stop()}},e,this)}))}},{key:"componentDidMount",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return R.set(this),e.next=3,R.start();case 3:case"end":return e.stop()}},e,this)}))}},{key:"startWait",value:function(){var t=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=e.setTimeout(function(){t.waitTimeHandler=void 0,t.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})}},{key:"endWait",value:function(){var e=this;setTimeout(function(){--e.waitCount,0===e.waitCount&&(void 0!==e.waitTimeHandler&&(clearTimeout(e.waitTimeHandler),e.waitTimeHandler=void 0),e.setState({wait:0}))},100)}},{key:"onError",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=e.error)||!0!==n.unauthorized){t.next=5;break}return t.next=4,R.showLogin();case 4:return t.abrupt("return");case 5:this.setState({fetchError:e});case 6:case"end":return t.stop()}},t,this)}))}},{key:"show",value:function(e,t){return this.clear(),this.push(e,t)}},{key:"push",value:function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=S++;return this.stack.push({key:n,view:e,ceased:!1,disposer:t}),this.refresh(),n}},{key:"replace",value:function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var i=S++;return this.stack.push({key:i,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh(),i}},{key:"ceaseTop",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){this.stack[t].ceased=!0}}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,i=0;i<e&&0!==t.length;i++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}}},{key:"popTo",value:function(e){throw new Error("to be designed")}},{key:"removeCeased",value:function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()}},{key:"popAndDispose",value:function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}}},{key:"dispose",value:function(e){void 0!==e&&(void 0===this.stack.find(function(t){return t.disposer===e})&&e())}},{key:"clear",value:function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose();this.refresh()}},{key:"regConfirmClose",value:function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)}},{key:"navBack",value:function(){R.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1}},{key:"back",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return E(this,void 0,void 0,a.a.mark(function t(){var n,r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.stack,0!==(r=n.length)){t.next=4;break}return t.abrupt("return");case 4:if(1!==r){t.next=7;break}return self!=window.top&&window.top.postMessage({type:"pop-app"},"*"),t.abrupt("return");case 7:if(i=n[r-1],!0!==e||!i.confirmClose){t.next=16;break}return t.next=11,i.confirmClose();case 11:if(t.t0=t.sent,!0!==t.t0){t.next=14;break}this.pop();case 14:t.next=17;break;case 16:this.pop();case 17:case"end":return t.stop()}},t,this)}))}},{key:"confirmBox",value:function(e){return window.confirm(e)}},{key:"render",value:function(){var e=this.state,t=e.wait,n=e.fetchError,r=this.state.stack,i=r.length-1,a=null,o=null;switch(t){case 1:a=f.createElement("li",{className:"va-wait va-wait1"});break;case 2:a=f.createElement("li",{className:"va-wait va-wait2"},f.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),f.createElement("span",{className:"sr-only"},"Loading..."))}return n&&(o=f.createElement(b.a,Object.assign({clearError:this.clearError},n))),f.createElement("ul",{className:"va"},r.map(function(e,t){var n=e.key,r=e.view;return f.createElement("li",{key:n,style:t<i?{visibility:"hidden"}:void 0},r)}),a,o)}},{key:"refresh",value:function(){this.setState({stack:this.stack})}},{key:"level",get:function(){return this.stack.length}}]),n}(f.Component);function F(e){return void 0===e?{url:void 0,ws:void 0}:{url:"http://"+e+"/",ws:"ws://"+e+"/tv/"}}function V(){return E(this,void 0,void 0,a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=F("101.200.46.56"),n=F(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||k.e),!0!==document.location.hash.includes("sheet_debug")){e.next=5;break}return e.abrupt("return",n);case 5:e.next=18;break;case 11:return e.sent,console.log("connected"),e.abrupt("return",n);case 16:e.prev=16,e.t0=e.catch(7);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this,[[7,16]])}))}var A=function(){function e(){Object(o.a)(this,e),this.local=new w.a,this.user=void 0;var t=x.b.lang,n=x.b.district;this.language=t,this.culture=n}return Object(s.a)(e,[{key:"set",value:function(e){this.nav=e}},{key:"registerReceiveHandler",value:function(e){if(void 0!==this.ws)return this.ws.onWsReceiveAny(e)}},{key:"unregisterReceiveHandler",value:function(e){void 0!==this.ws&&void 0!==e&&this.ws.endWsReceive(e)}},{key:"onReceive",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.ws){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.ws.receive(e);case 4:case"end":return t.stop()}},t,this)}))}},{key:"getUnitName",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("unit.json",{});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n.unit);case 10:return e.prev=10,e.t0=e.catch(0),this.local.unit.clear(),e.abrupt("return");case 14:case"end":return e.stop()}},e,this,[[0,10]])}))}},{key:"loadUnit",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.local.unit.get())){e.next=13;break}if(!0===w.b){e.next=4;break}return e.abrupt("return",n.id);case 4:return e.next=6,this.getUnitName();case 6:if(void 0!==(t=e.sent)){e.next=9;break}return e.abrupt("return");case 9:if(n.name!==t){e.next=11;break}return e.abrupt("return",n.id);case 11:e.next=18;break;case 13:return e.next=15,this.getUnitName();case 15:if(void 0!==(t=e.sent)){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,k.g.unitFromName(t);case 20:return void 0!==(r=e.sent)&&this.local.unit.set({id:r,name:t}),e.abrupt("return",r);case 23:case"end":return e.stop()}},e,this)}))}},{key:"start",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){var t,n,r,i,o,s,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return R.push(f.createElement(v.a,{header:!1},f.createElement(O.a,null))),e.next=3,V();case 3:return t=e.sent,n=t.url,r=t.ws,Object(k.n)(n),this.wsHost=r,e.next=10,this.loadUnit();case 10:if(i=e.sent,k.j.unit=i,void 0!==(o=this.local.guest.get())){e.next=17;break}return e.next=16,k.g.guest();case 16:o=e.sent;case 17:if(R.setGuest(o),s=document.location.hash,console.log("url=%s hash=%s",document.location.origin,s),this.isInFrame=void 0!==s&&""!==s&&s.startsWith("#tv"),!0!==this.isInFrame){e.next=28;break}if(void 0===(c=Object(y.h)(s))){e.next=28;break}return this.ws=g.d,console.log("this.ws = wsBridge in sub frame"),self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:c.hash},"*"),e.abrupt("return");case 28:if(void 0!==(u=this.local.user.get())){e.next=39;break}if(void 0===(l=this.nav.props.notLogined)){e.next=36;break}return e.next=34,l();case 34:e.next=38;break;case 36:return e.next=38,R.showLogin();case 38:return e.abrupt("return");case 39:return e.next=41,R.logined(u);case 41:case"end":return e.stop()}},e,this)}))}},{key:"showAppView",value:function(){return E(this,void 0,void 0,a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.nav.props.onLogined)){e.next=4;break}return R.push(f.createElement("div",null,"NavView has no prop onLogined")),e.abrupt("return");case 4:return R.clear(),e.next=7,t();case 7:console.log("logined: AppView shown");case 8:case"end":return e.stop()}},e,this)}))}},{key:"setGuest",value:function(e){this.local.guest.set(e),m.a.set(e.token)}},{key:"logined",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(this.ws=new k.d(this.wsHost,e.token)).connect(),console.log("logined: %s",JSON.stringify(e)),this.local.user.set(e),m.a.set(e.token),this.user=new p.a(e),console.log("ws.connect() in app main frame"),t.next=9,this.showAppView();case 9:case"end":return t.stop()}},t,this)}))}},{key:"showLogin",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){var r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(1).then(n.bind(null,146));case 2:r=t.sent,i=f.createElement(r.default,{withBack:e}),!0!==e&&(this.nav.clear(),this.pop()),this.nav.push(i);case 6:case"end":return t.stop()}},t,this)}))}},{key:"logout",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.local.logoutClear(),this.user=void 0,Object(k.i)(),Object(y.f)(),n=this.local.guest.get(),Object(k.m)(n&&n.token),this.ws=void 0,!0!==e){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,R.start();case 11:case"end":return t.stop()}},t,this)}))}},{key:"startWait",value:function(){this.nav.startWait()}},{key:"endWait",value:function(){this.nav.endWait()}},{key:"onError",value:function(e){return E(this,void 0,void 0,a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.nav.onError(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"show",value:function(e,t){this.nav.show(e,t)}},{key:"push",value:function(e,t){this.nav.push(e,t)}},{key:"replace",value:function(e,t){this.nav.replace(e,t)}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.nav.pop(e)}},{key:"clear",value:function(){this.nav.clear()}},{key:"navBack",value:function(){this.nav.navBack()}},{key:"ceaseTop",value:function(e){this.nav.ceaseTop(e)}},{key:"removeCeased",value:function(){this.nav.removeCeased()}},{key:"back",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return E(this,void 0,void 0,a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.nav.back(e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"regConfirmClose",value:function(e){this.nav.regConfirmClose(e)}},{key:"confirmBox",value:function(e){return this.nav.confirmBox(e)}},{key:"navToApp",value:function(e,t,n,r,i){var a=this,o=!0===Object(k.f)().includes("http://localhost:")?"sheet_debug":"sheet",s=void 0===i?Object(y.a)(e,t):Object(y.a)(e,t,o,[n,r,i]);console.log("navToApp: %s",JSON.stringify(s)),R.push(f.createElement("article",{className:"app-container"},f.createElement("span",{id:s.hash,onClick:function(){return a.back()},style:C},f.createElement("i",{className:"fa fa-arrow-left"})),f.createElement("iframe",{src:s.url})))}},{key:"navToSite",value:function(e){window.open(e)}},{key:"log",value:function(e){N.push(e)}},{key:"logMark",value:function(){var e=new Date;r=e.getTime(),N.push("log-mark: "+e.toTimeString())}},{key:"logStep",value:function(e){N.push(e+": "+((new Date).getTime()-r))}},{key:"guest",get:function(){var e=this.local.guest;if(void 0===e)return 0;var t=e.get();return void 0===t?0:t.guest}},{key:"level",get:function(){return this.nav.level}},{key:"logs",get:function(){return N}}]),e}();j([d.k],A.prototype,"user",void 0);var R=new A}).call(this,n(29))},,function(e,t,n){"use strict";var r=n(2),i=n.n(r),a=n(3),o=n.n(a),s=n(6),c=n(8),u=n(9),l=n(7),h=n(21),f=n(10),d=n(13),p=n(12),v=n(15),m=n(19),b=n(42),y=n.n(b),w=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},k=function(){function e(t,n,r){Object(s.a)(this,e),this.fieldMaps={},this.entities=t,this.name=n,this.typeId=r,this.sys=this.name.indexOf("$")>=0}return Object(c.a)(e,[{key:"getApiFrom",value:function(){return w(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.entities.usqApi);case 1:case"end":return e.stop()}},e,this)}))}},{key:"fieldMap",value:function(e){void 0===e&&(e="$");var t=this.fieldMaps[e];if(void 0===t){var n;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){var r=this.arrFields.find(function(t){return t.name===e});void 0!==r&&(n=r.fields)}else if(void 0!==this.returns){var i=this.returns.find(function(t){return t.name===e});void 0!==i&&(n=i.fields)}if(void 0===n)return{};t={};var a=!0,o=!1,s=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value;t[l.name]=l}}catch(h){o=!0,s=h}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}this.fieldMaps[e]=t}return t}},{key:"loadSchema",value:function(){return w(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.schema){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.entities.usqApi.schema(this.name);case 4:t=e.sent,this.setSchema(t);case 6:case"end":return e.stop()}},e,this)}))}},{key:"setSchema",value:function(e){if(void 0!==e&&void 0===this.schema){this.schema=e;var t=e.name,n=e.fields,r=e.arrs,i=e.returns;t!==this.name&&(this.jName=t),this.entities.buildFieldTuid(this.fields=n),this.entities.buildArrFieldsTuid(this.arrFields=r,n),this.entities.buildArrFieldsTuid(this.returns=i,n)}}},{key:"schemaStringify",value:function(){return JSON.stringify(this.schema,function(e,t){if("_tuid"!==e)return t},4)}},{key:"tuidFromField",value:function(e){var t=e._tuid,n=e.tuid;if(void 0!==n)return void 0!==t?t:e._tuid=this.entities.getTuid(n,void 0)}},{key:"tuidFromName",value:function(e,t){if(void 0!==this.schema){var n=this.schema,r=n.fields,i=n.arrs,a=this.entities,o=e.toLowerCase();if(void 0===t)return u(o,r);if(void 0!==i){var s=t.toLowerCase(),c=i.find(function(e){return e.name===s});if(void 0!==c)return u(o,c.fields)}}function u(e,t){if(void 0!==t){var n=t.find(function(t){return t.name===e});if(void 0!==n)return a.getTuid(n.tuid,void 0)}}}},{key:"pack",value:function(e){var t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);var r=this.arrFields;if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;this.packArr(t,u.fields,e[u.name])}}catch(l){a=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}}return t.join("")}},{key:"escape",value:function(e,t){var n=e[t.name];switch(typeof n){default:return n;case"object":var r=t._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var i=n.length,a="",o=0,s=0;s<i;s++){switch(n.charCodeAt(s)){case 9:a+=n.substring(o,s)+"\\t",o=s+1;break;case 10:a+=n.substring(o,s)+"\\n",o=s+1}}return a+n.substring(o);case"undefined":return""}}},{key:"packRow",value:function(e,t,n){var r=t.length;if(0!==r){var i="";i+=this.escape(n,t[0]);for(var a=1;a<r;a++){var o=t[a];i+="\t"+this.escape(n,o)}e.push(i+"\n")}}},{key:"packArr",value:function(e,t,n){if(void 0!==n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;this.packRow(e,t,c)}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}e.push("\n")}},{key:"unpackSheet",value:function(e){var t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));var i=this.arrFields;if(void 0!==i){var a=!0,o=!1,s=void 0;try{for(var c,u=i[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value;r=this.unpackArr(t,l,e,r)}}catch(h){o=!0,s=h}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}return t}},{key:"unpackReturns",value:function(e){var t={},n=0,r=this.returns;if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;n=this.unpackArr(t,u,e,n)}}catch(l){a=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}}return t}},{key:"unpackRow",value:function(e,t,n,r){for(var i=0,a=0,o=r,s=0,c=n.length,u=t.length;r<c;r++)if(i=a,9===(a=n.charCodeAt(r))){var l=t[s];if(8!==i){if(r>o){var h=n.substring(o,r);e[l.name]=this.to(e,h,l)}}else e[l.name]=null;if(o=r+1,++s>=u)break}else if(10===a){var f=t[s];if(8!==i){if(r>o){var d=n.substring(o,r);e[f.name]=this.to(e,d,f)}}else e[f.name]=null;++r,++s;break}return r}},{key:"to",value:function(e,t,n){switch(n.type){default:return t;case"datetime":case"date":case"time":return new Date(Number(t));case"tinyint":case"smallint":case"int":case"dec":return Number(t);case"bigint":var r=Number(t),i=n._tuid;return void 0===i?r:(i.useId(r,!0),i.boxId(r))}}},{key:"unpackArr",value:function(e,t,n,r){for(var i=[],a=n.length,o=t.name,s=t.fields;r<a;){if(10===n.charCodeAt(r)){++r;break}var c={};i.push(c),r=this.unpackRow(c,s,n,r)}return e[o]=i,r}},{key:"sName",get:function(){return this.jName||this.name}},{key:"tvApi",get:function(){return this.entities.usqApi}}]),e}(),g=n(77),x=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},O=function(e){function t(e,n,r){var i;return Object(s.a)(this,t),(i=Object(u.a)(this,Object(l.a)(t).call(this,e,n,r))).queue=[],i.waitingIds=[],i.cache=m.k.map({},{deep:!1}),i.buildIdBoxer(),i}return Object(f.a)(t,e),Object(c.a)(t,[{key:"buildIdBoxer",value:function(){this.BoxId=function(){};var e=this.BoxId.prototype;Object.defineProperty(e,"_$tuid",{value:this,writable:!1,enumerable:!1}),Object.defineProperty(e,"obj",{enumerable:!1,get:function(){if(!(void 0===this.id||this.id<=0))return this._$tuid.valueFromId(this.id)}}),e.valueFromFieldName=function(e){return this._$tuid.valueFromFieldName(e,this.obj)},e.toJSON=function(){return this.id}}},{key:"boxId",value:function(e){this.useId(e);var t=new this.BoxId;return t.id=e,t}},{key:"getTuidContent",value:function(){return this.entities.cUsq.getTuidContent(this)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"setSchema",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setSchema",this).call(this,e);var n=e.id,r=e.unique;this.idName=n,this.unique=r,this.schemaFrom=this.schema.from}},{key:"moveToHead",value:function(e){var t=this.queue.findIndex(function(t){return t===e});this.queue.splice(t,1),this.queue.push(e)}},{key:"valueFromId",value:function(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}var n=this.cache.get(t);return void 0!==this.owner&&"object"===typeof n&&(n.$owner=this.owner.boxId(n.owner)),n}},{key:"valueFromFieldName",value:function(e,t){if(void 0!==t){var n=this.fields.find(function(t){return t.name===e});if(void 0!==n){var r=t[e],i=n._tuid;return void 0===i?r:i.valueFromId(r)}}}},{key:"resetCache",value:function(e){this.cache.delete(e);var t=this.queue.findIndex(function(t){return t===e});this.queue.splice(t,1),this.useId(e)}},{key:"useId",value:function(e,t){if(void 0!==e&&0!==e&&!1!==Object(g.isNumber)(e))if(!0!==this.cache.has(e))if(this.entities.cacheTuids(!0===t?70:20),this.cache.set(e,e),this.waitingIds.findIndex(function(t){return t===e})>=0)this.moveToHead(e);else{if(this.queue.length>=1e3){var n=this.queue.shift();if(n===e)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex(function(e){return e===n});this.waitingIds.splice(r,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e)}},{key:"proxied",value:function(e,t){return x(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.entities.getTuid(e,void 0).useId(t),n.next=4,this.tvApi.proxied(this.name,e,t);case 4:return r=n.sent,this.cacheValue(r),n.abrupt("return",r);case 7:case"end":return n.stop()}},n,this)}))}},{key:"cacheValue",value:function(e){if(void 0===e)return!1;var t=this.getIdFromObj(e);if(void 0===t)return!1;var n=this.waitingIds.findIndex(function(e){return e===t});return n>=0&&this.waitingIds.splice(n,1),this.cache.set(t,e),!0}},{key:"afterCacheId",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=o._tuid;void 0!==s&&s.useId(e[o.name])}}catch(c){n=!0,r=c}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"cacheIds",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s,c,u,l,h;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.waitingIds.length){e.next=2;break}return e.abrupt("return");case 2:return void 0===this.owner?t=this.name:(t=this.owner.name,n=this.name),e.next=5,this.getApiFrom();case 5:return r=e.sent,e.next=8,r.tuidIds(t,n,this.waitingIds);case 8:a=e.sent,o=!0,s=!1,c=void 0,e.prev=12,u=a[Symbol.iterator]();case 14:if(o=(l=u.next()).done){e.next=23;break}if(h=l.value,!1!==this.cacheValue(h)){e.next=18;break}return e.abrupt("continue",20);case 18:this.cacheTuidFieldValues(h),this.afterCacheId(h);case 20:o=!0,e.next=14;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(12),s=!0,c=e.t0;case 29:e.prev=29,e.prev=30,o||null==u.return||u.return();case 32:if(e.prev=32,!s){e.next=35;break}throw c;case 35:return e.finish(32);case 36:return e.finish(29);case 37:case"end":return e.stop()}},e,this,[[12,25,29,37],[30,,32,36]])}))}},{key:"load",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e&&0!==e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.getApiFrom();case 4:return n=t.sent,t.next=7,n.tuidGet(this.name,e);case 7:if(void 0!==(r=t.sent)){t.next=10;break}return t.abrupt("return");case 10:return r._$tuid=this,this.cacheValue(r),this.cacheTuidFieldValues(r),t.abrupt("return",r);case 14:case"end":return t.stop()}},t,this)}))}},{key:"getDiv",value:function(e){}},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema,n=t.fields,r=t.arrs;if(this.cacheFieldsInValue(e,n),void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value,l=u.name,h=u.fields,f=e[l];if(void 0!==f){var d=this.getDiv(l),p=!0,v=!1,m=void 0;try{for(var b,y=f[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var w=b.value;w._$tuid=d,w.$owner=this.boxId(w.owner),this.cacheFieldsInValue(w,h)}}catch(k){v=!0,m=k}finally{try{p||null==y.return||y.return()}finally{if(v)throw m}}}}}catch(k){a=!0,o=k}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}}}},{key:"cacheFieldsInValue",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,c=s.name,u=s._tuid;if(void 0!==u){var l=e[c];e[c]=u.boxId(l)}}}catch(h){r=!0,i=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}},{key:"save",value:function(e,t){return x(this,void 0,void 0,i.a.mark(function n(){var r,a,o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=y.a.clone(t)).$id=e,n.next=4,this.tvApi.tuidSave(this.name,r);case 4:return a=n.sent,o=a.id,a.inId,void 0===o?(r.id=e,this.cacheValue(r)):o>0&&(r.id=o,this.cacheValue(r)),n.abrupt("return",a);case 8:case"end":return n.stop()}},n,this)}))}},{key:"search",value:function(e,t,n){return x(this,void 0,void 0,i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.searchArr(void 0,e,t,n);case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}},r,this)}))}},{key:"searchArr",value:function(e,t,n,r){return x(this,void 0,void 0,i.a.mark(function a(){var o,s,c,u,l,h,f,d,p,v,m;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=this.schema.fields,void 0!==this.owner?(s=this.owner.name,c=this.name):(s=this.name,c=void 0),i.next=4,this.getApiFrom();case 4:return u=i.sent,i.next=7,u.tuidSearch(s,c,e,t,n,r);case 7:for(l=i.sent,h=!0,f=!1,d=void 0,i.prev=11,p=l[Symbol.iterator]();!(h=(v=p.next()).done);h=!0)m=v.value,this.cacheFieldsInValue(m,o),void 0!==this.owner&&(m.$owner=this.owner.boxId(m.owner));i.next=19;break;case 15:i.prev=15,i.t0=i.catch(11),f=!0,d=i.t0;case 19:i.prev=19,i.prev=20,h||null==p.return||p.return();case 22:if(i.prev=22,!f){i.next=25;break}throw d;case 25:return i.finish(22);case 26:return i.finish(19);case 27:return i.abrupt("return",l);case 28:case"end":return i.stop()}},a,this,[[11,15,19,27],[20,,22,26]])}))}},{key:"loadArr",value:function(e,t,n){return x(this,void 0,void 0,i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==n&&0!==n){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,this.getApiFrom();case 4:return a=r.sent,r.next=7,a.tuidArrGet(this.name,e,t,n);case 7:return r.abrupt("return",r.sent);case 8:case"end":return r.stop()}},r,this)}))}},{key:"saveArr",value:function(e,t,n,r){return x(this,void 0,void 0,i.a.mark(function a(){var o;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(o=y.a.clone(r)).$id=n,i.next=4,this.tvApi.tuidArrSave(this.name,e,t,o);case 4:return i.abrupt("return",i.sent);case 5:case"end":return i.stop()}},a,this)}))}},{key:"posArr",value:function(e,t,n,r){return x(this,void 0,void 0,i.a.mark(function a(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.tvApi.tuidArrPos(this.name,e,t,n,r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a,this)}))}},{key:"showInfo",value:function(e){return x(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.entities.cUsq.showTuid(this,e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"typeName",get:function(){return"tuid"}}]),t}(k),j=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setSchema",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setSchema",this).call(this,e);var n=e.arrs;if(void 0!==n){this.divs={};var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value,u=c.name,f=new E(this.entities,u,this.typeId);f.owner=this,this.divs[u]=f,f.setSchema(c)}}catch(d){i=!0,a=d}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"getDiv",value:function(e){return this.divs[e]}},{key:"cacheIds",value:function(){var e=this,n=Object.create(null,{cacheIds:{get:function(){return Object(h.a)(Object(l.a)(t.prototype),"cacheIds",e)}}});return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.cacheIds.call(this);case 2:if(void 0!==this.divs){e.next=4;break}return e.abrupt("return");case 4:e.t0=i.a.keys(this.divs);case 5:if((e.t1=e.t0()).done){e.next=11;break}return t=e.t1.value,e.next=9,this.divs[t].cacheIds();case 9:e.next=5;break;case 11:case"end":return e.stop()}},e,this)}))}},{key:"cUsqFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.schemaFrom){e.next=2;break}return e.abrupt("return",this.entities.cUsq);case 2:return t=this.schemaFrom,n=t.owner,r=t.usq,e.next=5,this.entities.cUsq;case 5:if(a=e.sent,void 0!==(o=a.cApp)){e.next=9;break}return e.abrupt("return",a);case 9:return e.next=11,o.getImportUsq(n,r);case 11:if(void 0!==(s=e.sent)){e.next=16;break}return console.error("".concat(n,"/").concat(r," \u4e0d\u5b58\u5728")),e.abrupt("return",a);case 16:return e.next=18,s.loadSchema();case 18:if(void 0===(c=e.sent)){e.next=23;break}return console.error("cUsq.loadSchema: "+c),e.abrupt("return",a);case 23:return e.abrupt("return",s);case 24:case"end":return e.stop()}},e,this)}))}},{key:"getApiFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.from();case 2:if(void 0===(t=e.sent)){e.next=5;break}return e.abrupt("return",t.entities.usqApi);case 5:return e.abrupt("return",this.entities.usqApi);case 6:case"end":return e.stop()}},e,this)}))}},{key:"from",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cUsqFrom();case 2:return t=e.sent,e.abrupt("return",t.tuid(this.name));case 4:case"end":return e.stop()}},e,this)}))}},{key:"cFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cUsqFrom();case 2:return t=e.sent,e.abrupt("return",t.cTuidMainFromName(this.name));case 4:case"end":return e.stop()}},e,this)}))}},{key:"cEditFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cUsqFrom();case 2:return t=e.sent,e.abrupt("return",t.cTuidEditFromName(this.name));case 4:case"end":return e.stop()}},e,this)}))}},{key:"cInfoFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cUsqFrom();case 2:return t=e.sent,e.abrupt("return",t.cTuidInfoFromName(this.name));case 4:case"end":return e.stop()}},e,this)}))}},{key:"cSelectFrom",value:function(){return x(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cUsqFrom();case 2:if(void 0!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",t.cTuidSelectFromName(this.name));case 6:case"end":return e.stop()}},e,this)}))}},{key:"afterCacheId",value:function(e){if(Object(h.a)(Object(l.a)(t.prototype),"afterCacheId",this).call(this,e),void 0!==this.proxies){var n=e.type,r=e.$proxy;this.proxies[n].useId(r)}}},{key:"Main",get:function(){return this}}]),t}(O),E=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"Main",get:function(){return this.owner}}]),t}(O),C=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},N=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"submit",value:function(e){return C(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSchema();case 2:return n=this.pack(e),t.next=5,this.tvApi.action(this.name,{data:n});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}))}},{key:"typeName",get:function(){return"action"}}]),t}(k),S=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},P=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setSchema",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setSchema",this).call(this,e),this.states=e.states}},{key:"build",value:function(e){this.states=[];var t=!0,n=!1,r=void 0;try{for(var i,a=e.ops[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.states.push({name:o,actions:void 0})}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"createSheetState",value:function(e,t){var n={name:e,actions:[]},r=n.actions;for(var i in t){var a={name:i};r.push(a)}return n}},{key:"save",value:function(e,t){return S(this,void 0,void 0,i.a.mark(function n(){var r,a,o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.entities.appId,a=this.pack(t),n.next=4,this.tvApi.sheetSave(this.name,{app:r,discription:e,data:a});case 4:return o=n.sent,n.abrupt("return",o);case 6:case"end":return n.stop()}},n,this)}))}},{key:"action",value:function(e,t,n,r){return S(this,void 0,void 0,i.a.mark(function a(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.tvApi.sheetAction(this.name,{id:e,flow:t,state:n,action:r});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a,this)}))}},{key:"unpack",value:function(e){return S(this,void 0,void 0,i.a.mark(function t(){var n,r,a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e[0],r=n[0],a=this.unpackSheet(r.data),o=e[1],t.abrupt("return",{brief:r,data:a,flows:o});case 5:case"end":return t.stop()}},t,this)}))}},{key:"getSheet",value:function(e){return S(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.tvApi.getSheet(this.name,e);case 2:if(0!==(n=t.sent)[0].length){t.next=7;break}return t.next=6,this.getArchive(e);case 6:return t.abrupt("return",t.sent);case 7:return t.next=9,this.unpack(n);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},t,this)}))}},{key:"getArchive",value:function(e){return S(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.tvApi.sheetArchive(this.name,e);case 2:return n=t.sent,t.next=5,this.unpack(n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}))}},{key:"getArchives",value:function(e,t){return S(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.tvApi.sheetArchives(this.name,{pageStart:e,pageSize:t});case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}},n,this)}))}},{key:"getStateSheets",value:function(e,t,n){return S(this,void 0,void 0,i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.tvApi.stateSheets(this.name,{state:e,pageStart:t,pageSize:n});case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}},r,this)}))}},{key:"createPageStateItems",value:function(){return new F(this)}},{key:"stateSheetCount",value:function(){return S(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tvApi.stateSheetCount(this.name);case 2:return t=e.sent,e.abrupt("return",this.states.map(function(e){var n=e.name,r=0,i=t.find(function(e){return e.state===n});return void 0!==i&&(r=i.count),{state:n,count:r}}));case 4:case"end":return e.stop()}},e,this)}))}},{key:"typeName",get:function(){return"sheet"}}]),t}(k),F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,!0))).sheet=e,n.pageSize=10,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"load",value:function(e,t,n){return S(this,void 0,void 0,i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.sheet.getStateSheets(e,t,n);case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}},r,this)}))}},{key:"setPageStart",value:function(e){this.pageStart=void 0===e?0:e.id}}]),t}(p.g),V=n(27),A=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},R=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},q=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setSchema",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setSchema",this).call(this,e);var n=e.returns;this.returns=n,this.isPaged=void 0!==n.find(function(e){return"$page"===e.name})}},{key:"resetPage",value:function(e,t){this.pageStart=void 0,this.pageSize=e,this.params=t,this.more=!1,this.list=void 0}},{key:"loadPage",value:function(){return R(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.pageSize){e.next=2;break}throw"call resetPage(size:number, params:any) first";case 2:if(void 0===this.pageStart){e.next=10;break}e.t0=this.startField.type,e.next="date"===e.t0?8:"time"===e.t0?8:"datetime"===e.t0?8:6;break;case 6:return t=this.pageStart,e.abrupt("break",10);case 8:return t=this.pageStart.getTime(),e.abrupt("break",10);case 10:return e.next=12,this.loadSchema();case 12:return e.next=14,this.tvApi.page(this.name,t,this.pageSize+1,this.params);case 14:return n=e.sent,e.next=17,this.unpackReturns(n);case 17:r=e.sent,this.list=m.k.array([],{deep:!1}),void 0!==(a=r.$page)&&(a.length>this.pageSize?(this.more=!0,a.pop(),s=this.returns.find(function(e){return"$page"===e.name}),this.startField=s.fields[0],this.pageStart=a[a.length-1][this.startField.name]):this.more=!1,(o=this.list).push.apply(o,Object(V.a)(a)));case 21:case"end":return e.stop()}},e,this)}))}},{key:"page",value:function(e,t,n){return R(this,void 0,void 0,i.a.mark(function r(){var a,o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loadSchema();case 2:return r.next=4,this.tvApi.page(this.name,t,n+1,e);case 4:return a=r.sent,r.next=7,this.unpackReturns(a);case 7:return o=r.sent,r.abrupt("return",o.$page);case 9:case"end":return r.stop()}},r,this)}))}},{key:"query",value:function(e){return R(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSchema();case 2:return t.next=4,this.tvApi.query(this.name,e);case 4:return n=t.sent,t.next=7,this.unpackReturns(n);case 7:return r=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}},t,this)}))}},{key:"table",value:function(e){return R(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.query(e);case 2:n=t.sent,t.t0=i.a.keys(n);case 4:if((t.t1=t.t0()).done){t.next=9;break}return r=t.t1.value,t.abrupt("return",n[r]);case 9:case"end":return t.stop()}},t,this)}))}},{key:"obj",value:function(e){return R(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.table(e);case 2:if(!((n=t.sent).length>0)){t.next=5;break}return t.abrupt("return",n[0]);case 5:case"end":return t.stop()}},t,this)}))}},{key:"scalar",value:function(e){return R(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.obj(e);case 2:n=t.sent,t.t0=i.a.keys(n);case 4:if((t.t1=t.t0()).done){t.next=9;break}return r=t.t1.value,t.abrupt("return",n[r]);case 9:case"end":return t.stop()}},t,this)}))}},{key:"typeName",get:function(){return"query"}},{key:"hasMore",get:function(){return this.more}}]),t}(k);A([m.k],q.prototype,"list",void 0);var T=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).queryApiName="book",e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"typeName",get:function(){return"book"}}]),t}(q),I=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).queryApiName="history",e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"typeName",get:function(){return"history"}}]),t}(q),D=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},U=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).actions={},e.queries={},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setSchema",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setSchema",this).call(this,e),this.schemaFrom=this.schema.from;var n=e.actions,r=e.queries,i=e.keys;for(var a in this.entities.buildFieldTuid(this.keys=i),n){var o=n[a],s=o.name,c=this.entities.newAction(s,void 0);c.setSchema(o),this.actions[a]=c}for(var u in r){var f=r[u],d=(s=f.name,this.entities.newQuery(s,void 0));d.setSchema(f),this.queries[u]=d}}},{key:"add",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSchema();case 2:return t.next=4,this.actions.add.submit(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"del",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSchema();case 2:return t.next=4,this.actions.del.submit(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"all",value:function(){return D(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadSchema();case 2:return e.next=4,this.queries.all.query({});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"page",value:function(e,t,n){return D(this,void 0,void 0,i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loadSchema();case 2:return r.next=4,this.queries.page.page(e,t,n);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},r,this)}))}},{key:"query",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSchema();case 2:return t.next=4,this.queries.query.query(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"table",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.query(e);case 2:n=t.sent,t.t0=i.a.keys(n);case 4:if((t.t1=t.t0()).done){t.next=9;break}return r=t.t1.value,t.abrupt("return",n[r]);case 9:case"end":return t.stop()}},t,this)}))}},{key:"obj",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.table(e);case 2:if(!((n=t.sent).length>0)){t.next=5;break}return t.abrupt("return",n[0]);case 5:case"end":return t.stop()}},t,this)}))}},{key:"scalar",value:function(e){return D(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.obj(e);case 2:n=t.sent,t.t0=i.a.keys(n);case 4:if((t.t1=t.t0()).done){t.next=9;break}return r=t.t1.value,t.abrupt("return",n[r]);case 9:case"end":return t.stop()}},t,this)}))}},{key:"typeName",get:function(){return"map"}}]),t}(k),M=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).queryApiName="pending",e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"typeName",get:function(){return"pending"}}]),t}(q),L=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};function B(e){switch(e){case"tinyint":case"smallint":case"int":case"bigint":case"dec":return 0;case"char":case"text":return"";case"datetime":case"date":return"2000-1-1";case"time":return"0:00"}}var H=function(){function e(t,n,r){var i=this;Object(s.a)(this,e),this.tuids={},this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.loadIds=function(){for(var e in i.clearCacheTimer(),i.tuids){i.tuids[e].cacheIds()}},this.cUsq=t,this.usqApi=n,this.appId=r}return Object(c.a)(e,[{key:"tuid",value:function(e){return this.tuids[e.toLowerCase()]}},{key:"action",value:function(e){return this.actions[e.toLowerCase()]}},{key:"sheet",value:function(e){return this.sheets[e.toLowerCase()]}},{key:"query",value:function(e){return this.queries[e.toLowerCase()]}},{key:"book",value:function(e){return this.books[e.toLowerCase()]}},{key:"map",value:function(e){return this.maps[e.toLowerCase()]}},{key:"history",value:function(e){return this.histories[e.toLowerCase()]}},{key:"pending",value:function(e){return this.pendings[e.toLowerCase()]}},{key:"sheetFromTypeId",value:function(e){for(var t in this.sheets){var n=this.sheets[t];if(n.typeId===e)return n}}},{key:"loadAccess",value:function(){return L(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.usqApi.loadAccess();case 2:t=e.sent,this.buildEntities(t);case 4:case"end":return e.stop()}},e,this)}))}},{key:"loadEntities",value:function(){return L(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.usqApi.loadEntities();case 2:t=e.sent,this.buildEntities(t);case 4:case"end":return e.stop()}},e,this)}))}},{key:"buildEntities",value:function(e){var t=e.access,n=e.tuids;this.buildTuids(n),this.buildAccess(t)}},{key:"getTuid",value:function(e,t,n){var r=this.tuids[e];if(void 0!==r)return void 0===t?r:r.divs[t]}},{key:"cacheTuids",value:function(e){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,e)}},{key:"clearCacheTimer",value:function(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)}},{key:"buildTuids",value:function(e){var t={};for(var n in e){var r=e[n],i=(r.name,r.typeId),a=r.proxies;this.newTuid(n,i).sys=!0,void 0!==a&&(t[n]=a)}for(var o in e){var s=e[o];s.name;this.getTuid(o).setSchema(s)}for(var c in t){a=t[c];var u=this.tuids[c];u.proxies={};var l=!0,h=!1,f=void 0;try{for(var d,p=a[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value;u.proxies[v]=this.tuids[v]}}catch(m){h=!0,f=m}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}}},{key:"buildAccess",value:function(e){for(var t in e){var n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}}},{key:"newAction",value:function(e,t){var n=this.actions[e];return void 0!==n?n:(n=this.actions[e]=new N(this,e,t),this.actionArr.push(n),n)}},{key:"newTuid",value:function(e,t){var n=this.tuids[e];return void 0!==n?n:(n=this.tuids[e]=new j(this,e,t),this.tuidArr.push(n),n)}},{key:"newQuery",value:function(e,t){var n=this.queries[e];return void 0!==n?n:(n=this.queries[e]=new q(this,e,t),this.queryArr.push(n),n)}},{key:"newBook",value:function(e,t){var n=this.books[e];return void 0!==n?n:(n=this.books[e]=new T(this,e,t),this.bookArr.push(n),n)}},{key:"newMap",value:function(e,t){var n=this.maps[e];return void 0!==n?n:(n=this.maps[e]=new U(this,e,t),this.mapArr.push(n),n)}},{key:"newHistory",value:function(e,t){var n=this.histories[e];if(void 0===n)return n=this.histories[e]=new I(this,e,t),this.historyArr.push(n),n}},{key:"newPending",value:function(e,t){var n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new M(this,e,t),this.pendingArr.push(n),n}},{key:"newSheet",value:function(e,t){var n=this.sheets[e];return void 0!==n?n:(n=this.sheets[e]=new P(this,e,t),this.sheetArr.push(n),n)}},{key:"fromType",value:function(e,t){var n=t.split("|");t=n[0];var r=Number(n[1]);switch(t){case"usq":this.usqId=r;break;case"tuid":this.newTuid(e,r).sys=!1;break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r)}}},{key:"fromObj",value:function(e,t){switch(t.$){case"sheet":this.buildSheet(e,t)}}},{key:"buildSheet",value:function(e,t){var n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)}},{key:"buildFieldTuid",value:function(e,t){var n=this;if(void 0!==e){var r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value,u=c.tuid,l=c.arr,h=c.url;void 0!==u&&(c._tuid=this.getTuid(u,l,h))}}catch(y){i=!0,a=y}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var f=!0,d=!1,p=void 0;try{for(var v,m=function(){var r=v.value,i=r.owner;if(void 0===i)return"continue";var a=e.find(function(e){return e.name===i});if(void 0===a&&(void 0!==t&&(a=t.find(function(e){return e.name===i})),void 0===a))throw"owner field ".concat(i," is undefined");r._ownerField=a;var o=r.arr,s=r.url;if(r._tuid=n.getTuid(a._tuid.name,o,s),void 0===r._tuid)throw"owner field ${owner} is not tuid"},b=e[Symbol.iterator]();!(f=(v=b.next()).done);f=!0)m()}catch(y){d=!0,p=y}finally{try{f||null==b.return||b.return()}finally{if(d)throw p}}}}},{key:"buildArrFieldsTuid",value:function(e,t){if(void 0!==e){var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value.fields;void 0!==s&&this.buildFieldTuid(s,t)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}}]),e}(),W=n(16),K=n.n(W),Q=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).onClick=function(){return Q(Object(d.a)(Object(d.a)(n)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.start();case 2:case"end":return e.stop()}},e,this)}))},n.view=function(e){return a.createElement("div",{className:K()("px-3","py-2","align-items-center","cursor-pointer",e),onClick:n.onClick},n.icon," \xa0 ",n.label)},n.controller=e,n.icon=e.icon,n.label=e.label,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(e){return a.createElement(this.view,e)}}]),t}(function e(){Object(s.a)(this,e)}),J=n(25),X=function(){function e(t){Object(s.a)(this,e),this.view=function(){return a.createElement("div",null)},this.label=t}return Object(c.a)(e,[{key:"render",value:function(){return a.createElement("div",{key:this.key,className:"px-3"},a.createElement("div",{className:"form-group row"},a.createElement("label",{className:"col-sm-2 col-form-label"},this.label),a.createElement("div",{className:"col-sm-10"},this.renderContent())))}},{key:"setAddRow",value:function(e){}},{key:"getVFields",value:function(){}},{key:"getVArr",value:function(){}},{key:"getVSubmit",value:function(){}},{key:"renderContent",value:function(){return a.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"content")}},{key:"key",get:function(){return this.label}}]),e}(),Z=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).vField=n,r}return Object(f.a)(t,e),Object(c.a)(t,[{key:"getVFields",value:function(){return[this.vField]}},{key:"renderContent",value:function(){return this.vField.render()}},{key:"key",get:function(){return this.vField.name}}]),t}(X),G=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).vArr=n,r}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setAddRow",value:function(e){this.vArr.setAddRow(e)}},{key:"getVArr",value:function(){return this.vArr}},{key:"render",value:function(){return a.createElement(a.Fragment,{key:this.key},this.vArr&&this.vArr.render())}},{key:"key",get:function(){return this.vArr.name}}]),t}(X),Y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,void 0))).vSubmit=e,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"getVSubmit",value:function(){return this.vSubmit}},{key:"render",value:function(){return a.createElement("div",{key:"$submit",className:"px-3"},a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"offset-sm-2 col-sm-10"},this.vSubmit.render())))}},{key:"key",get:function(){return"$submit"}}]),t}(X);function $(e,t){switch(e.substr(0,1)){default:return t;case"$":case"_":return}}function _(e){return JSON.stringify(e,$," ")}var ee=Object(J.a)(function(e){var t=e.tuidValue,n=e.ui,r=e.x,i=e.nullUI,o=typeof t;switch(o){default:return void 0===n?a.createElement(a.Fragment,null,o,"-",t):n(t,r);case"undefined":return void 0===i?a.createElement(a.Fragment,null,"null"):i();case"object":return null===t?void 0===i?a.createElement(a.Fragment,null,"null"):i():function(e,t,n){var r=e.id,i=e._$tuid,o=e._$com,s=i;if(void 0===s)return void 0!==t?t(e,n):re(e,n);var c=t||o;void 0===c&&(c=e._$com=s.getTuidContent());var u=s.valueFromId(r);return"number"===typeof u&&(u={id:u}),void 0!==t?t(u,n):a.createElement(c,u)}(t,n,r);case"number":return a.createElement(a.Fragment,null,"id...",t)}}),te=function(e,t,n,r){return a.createElement(ee,{tuidValue:e,ui:t,x:n,nullUI:r})},ne=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"render",value:function(e){return void 0===this.view?a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):a.createElement(this.view,{vm:this,className:e})}}]),e}(),re=function(e,t){return a.createElement(a.Fragment,null,"content: ",_(e))},ie=Object(J.a)(re),ae=function(e){return a.createElement("div",{className:"px-3 py-2"},_(e))},oe=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},se=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ce=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).onClickSubmit=function(){return se(Object(d.a)(Object(d.a)(n)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vForm.submit();case 1:case"end":return e.stop()}},e,this)}))},n.view=Object(J.a)(function(){var e=n.vForm.isOk;return a.createElement("button",{type:"button",onClick:n.onClickSubmit,className:n.className,disabled:!1===e},n.caption)}),n.vForm=e,n.caption=n.vForm.submitCaption,n.className="btn btn-primary w-25",n}return Object(f.a)(t,e),t}(ne);oe([m.k],ce.prototype,"caption",void 0),oe([m.k],ce.prototype,"className",void 0);var ue=function e(){Object(s.a)(this,e)},le=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"check",value:function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push("\u4e0d\u80fd\u4e3a\u7a7a")}}]),t}(ue),he=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"check",value:function(e,t){void 0!==t&&null!==t&&(NaN===Number(t)&&e.push("\u5fc5\u987b\u662f\u6570\u5b57"))}}]),t}(ue),fe=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"check",value:function(e,t){if(void 0!==t&&null!==t){var n=Number(t);!0!==Number.isNaN(n)&&!1!==Number.isInteger(n)||e.push("\u5fc5\u987b\u662f\u6574\u6570")}}}]),t}(ue),de=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).min=e,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"check",value:function(e,n){Object(h.a)(Object(l.a)(t.prototype),"check",this).call(this,e,n),Number(n)<this.min&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.min)}}]),t}(he),pe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).max=e,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"check",value:function(e,n){Object(h.a)(Object(l.a)(t.prototype),"check",this).call(this,e,n),Number(n)>this.max&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.max)}}]),t}(he),ve=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},me=function(e){function t(e,n,r,i){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this))).form=e,a.field=n,a.name=n.name,a.fieldUI=r||{},a.fieldRes=i||{},a.init(),a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"init",value:function(){this.buildRules()}},{key:"buildRules",value:function(){this.rules=[],(!0===this.fieldUI.required||void 0!==this.field&&!1===this.field.null)&&this.rules.push(new le)}},{key:"setValue",value:function(e){this.form.values[this.name]=e}},{key:"parse",value:function(e){return e}},{key:"checkRules",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=this.rules[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.check(e,this.value)}}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"isOk",get:function(){return 0===this.rules.length||0===this.checkRules.length}},{key:"value",get:function(){return this.form.values[this.name]}},{key:"error",get:function(){return this.form.errors[this.name]},set:function(e){this.form.errors[this.name]=e}},{key:"readonly",get:function(){var e=this.form.mode;return e===Ne.readonly||e===Ne.edit&&!1===this.fieldUI.editable}}]),t}(ne);ve([m.d],me.prototype,"checkRules",null),ve([m.d],me.prototype,"isOk",null),ve([m.d],me.prototype,"value",null);var be=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).renderError=function(t){var n=e.form.errors[e.name];if(void 0!==n)return a.createElement("div",{className:t},a.createElement(v.b,{name:"exclamation-circle"})," ",n)},e.ref=function(t){e.input=t,e.setInputValue()},e.onFocus=function(){e.error=void 0},e.onBlur=function(){var t=e.checkRules;t.length>0&&(e.error=t[0]),e.form.computeFields()},e.onChange=function(t){var n=e.parse(t.currentTarget.value);null!==n&&e.setValue(n)},e.view=Object(J.a)(function(){var t,n,r,i=e.fieldUI.required,o=e.fieldRes,s=o.placeHolder,c=o.suffix,u=["form-control","form-control-input"];return!0===e.readonly?n=a.createElement("input",{className:K()(u,"bg-light"),ref:e.ref,type:e.inputType,readOnly:!0}):(n=a.createElement("input",{className:K()(u),ref:e.ref,type:e.inputType,onFocus:e.onFocus,onBlur:e.onBlur,onChange:e.onChange,placeholder:s,readOnly:!1,maxLength:e.maxLength,onKeyPress:e.onKeyPress}),!0!==i&&!1!==e.field.null||(t=a.createElement(ye,null))),r=void 0===c?n:a.createElement("div",{className:"input-group"},n,a.createElement("div",{className:"input-group-append"},a.createElement("span",{className:"input-group-text"},c))),a.createElement(a.Fragment,null,t,r,e.renderError("text-danger small mt-1 mx-2"))}),e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"setValue",value:function(e){Object(h.a)(Object(l.a)(t.prototype),"setValue",this).call(this,e),this.setInputValue()}},{key:"setInputValue",value:function(){if(this.input){var e=this.value;this.input.value=null===e||void 0===e?"":e}}},{key:"maxLength",get:function(){}}]),t}(me),ye=function(){return a.createElement("b",{style:{color:"red",position:"absolute",left:"0.1em",top:"0.5em"}},"*")},we=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).inputType="text",e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"maxLength",get:function(){return this.field.size}}]),t}(be),ke=45,ge=46,xe=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).inputType="number",e.onKeyPress=function(t){var n=t.charCode;if(!(8===n||0===n||13===n||n>=48&&n<=57))if(void 0!==e.extraChars&&e.extraChars.indexOf(n)>=0)switch(n){case ge:e.onKeyDot();break;case ke:e.onKeyNeg(),t.preventDefault()}else t.preventDefault()},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"init",value:function(){if(Object(h.a)(Object(l.a)(t.prototype),"init",this).call(this),this.extraChars=[],void 0!==this.fieldUI){var e=this.fieldUI,n=e.min;e.max;void 0!==n?n<0&&this.extraChars.push(ke):this.extraChars.push(ke)}switch(this.field.type){case"dec":case"bigint":case"int":case"smallint":case"tinyint":this.extraChars.push(ge)}}},{key:"buildRules",value:function(){Object(h.a)(Object(l.a)(t.prototype),"buildRules",this).call(this),this.rules.push(new he);var e=this.fieldUI,n=e.min,r=e.max;void 0!==n&&this.rules.push(new de(n)),void 0!==r&&this.rules.push(new pe(r))}},{key:"parse",value:function(e){try{if(0===e.trim().length)return;var t=Number(e);return NaN===t?null:t}catch(n){return null}}},{key:"setInputValue",value:function(){if(this.input){var e=this.value;this.parse(this.input.value)!=e&&(this.input.value=null===e||void 0===e?"":e)}}},{key:"onKeyDot",value:function(){var e=this.input.value;e.indexOf(".")>=0&&(this.input.value=e.replace(".",""))}},{key:"onKeyNeg",value:function(){var e=this.input.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.input.value=e}}]),t}(be),Oe=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"buildRules",value:function(){Object(h.a)(Object(l.a)(t.prototype),"buildRules",this).call(this),this.rules.push(new fe)}}]),t}(xe),je=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(xe),Ee=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(we),Ce=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(we);var Ne,Se=function(e){function t(e,n,r){var i;return Object(s.a)(this,t),(i=Object(u.a)(this,Object(l.a)(t).call(this,e,n,void 0,r))).view=Object(J.a)(function(){var e=i.form.values[i.field.name],t=i.fieldRes,n=t.placeHolder,r=t.suffix;null===e&&(e="");var a=o.a.createElement("input",{className:"form-control form-control-input bg-light",type:"text",placeholder:n,readOnly:!0,value:e});return void 0===r?a:o.a.createElement("div",{className:"input-group"},a,o.a.createElement("div",{className:"input-group-append"},o.a.createElement("span",{className:"input-group-text"},r)))}),i}return Object(f.a)(t,e),t}(me),Pe=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Fe=function(e){function t(e,n,r){var o;Object(s.a)(this,t),(o=Object(u.a)(this,Object(l.a)(t).call(this))).rowPage=function(){return a.createElement(p.f,{header:o.label,back:"close"},o.vForm.render("py-3"))},o.onSubmit=function(){return Pe(Object(d.a)(Object(d.a)(o)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.valueBoxs,e.next=3,this.onRowChanged(t);case 3:case"end":return e.stop()}},e,this)}))},o.onRowChanged=function(e){return Pe(Object(d.a)(Object(d.a)(o)),void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.rowValues){t.next=11;break}if(e.$owner=this.ownerForm.values,this.list.push(e),void 0!==this.onEditRow){t.next=7;break}this.vForm.reset(),t.next=9;break;case 7:return t.next=9,this.onEditRow(void 0,this.onRowChanged);case 9:t.next=13;break;case 11:y.a.merge(this.rowValues,e),void 0===this.onEditRow&&p.p.pop();case 13:case"end":return t.stop()}},t,this)}))},o.renderItem=function(e,t){return void 0===o.rowContent?a.createElement("div",{className:"px-3 py-2"},a.createElement(ie,Object.assign({},e))):a.createElement(o.rowContent,Object.assign({},e))},o.showRow=function(e){return Pe(Object(d.a)(Object(d.a)(o)),void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.onEditRow){t.next=4;break}return t.next=3,this.onEditRow(e,this.onRowChanged);case 3:return t.abrupt("return");case 4:this.vForm.reset(),void 0!==e&&this.vForm.setValues(e),p.p.push(a.createElement(this.rowPage,null));case 7:case"end":return t.stop()}},t,this)}))},o.editRow=function(e){return Pe(Object(d.a)(Object(d.a)(o)),void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.rowValues=e,void 0!==(n=this.vForm.vSubmit)&&(n.caption=this.editSubmitCaption,n.className="btn btn-outline-success"),this.vForm.mode=this.ownerForm.mode,t.next=6,this.showRow(e);case 6:case"end":return t.stop()}},t,this)}))},o.internalAddRow=function(){return Pe(Object(d.a)(Object(d.a)(o)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.rowValues=void 0,(t=this.vForm.vSubmit).caption=this.newSubmitCaption,t.className="btn btn-outline-success",this.vForm.reset(),this.vForm.mode=Ne.new,e.next=8,this.showRow(void 0);case 8:case"end":return e.stop()}},e,this)}))},o.view=function(){var e;void 0===o.addRow&&o.mode===Ne.readonly||(e=a.createElement("button",{onClick:o.addRow||o.internalAddRow,type:"button",className:"btn btn-link p-0"},o.ownerForm.arrTitleNewButton));var t=o.header||a.createElement("div",{className:"px-3 bg-light small",style:{paddingTop:"1px",paddingBottom:"1px"}},a.createElement("div",{className:"flex-fill align-self-center"},o.label),e);return a.createElement(v.e,{className:"pb-3",header:t,none:a.createElement(v.g,{className:"px-3 py-2"},o.none),items:o.list,item:{render:o.renderItem,onClick:o.editRow}})},o.ownerForm=e;var c=n.name,h=n.fields;o.name=c;var f=e.ui,m=e.res,b=e.mode,w=e.inputs,k=e.values,g=m.arrs,x=void 0!==g?g[c]:{},O=x.label,j=x.none,E=x.newSubmit,C=x.editSubmit;o.none=j||e.none,o.newSubmitCaption=E||e.arrNewCaption,o.editSubmitCaption=C||e.arrEditCaption,o.label=O||c;var N=f&&f.items[c]||{};return o.rowContent=N.rowContent,o.mode=b,void 0===o.onEditRow?o.vForm=new De({fields:h,arrs:void 0,ui:N,res:x,inputs:w[c],none:e.none,submitCaption:"submit",arrNewCaption:void 0,arrEditCaption:void 0,arrTitleNewButton:void 0,mode:b},b===Ne.readonly?void 0:o.onSubmit):o.onEditRow=r,o.list=k[c],o}return Object(f.a)(t,e),Object(c.a)(t,[{key:"reset",value:function(){this.vForm.reset(),this.list.clear()}},{key:"setAddRow",value:function(e){this.addRow=e}}]),t}(ne),Ve=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ae={textAlign:"left",paddingLeft:"0.75rem",paddingRight:"0.75rem",overflow:"hidden"},Re=function(e){function t(e,n,r,o){var c;return Object(s.a)(this,t),(c=Object(u.a)(this,Object(l.a)(t).call(this,e,n,r,o))).onClick=function(){return Ve(Object(d.a)(Object(d.a)(c)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.readonly){e.next=6;break}if(this.value){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.tuid.showInfo(this.value.id);case 5:return e.abrupt("return");case 6:if(void 0===this.input){e.next=12;break}return e.next=9,this.input.select(this.vForm,this.field,this.vForm.getValues());case 9:t=e.sent,e.next=14;break;case 12:alert("call undefined"),t=0;case 14:this.setValue(this.tuid.boxId(t));case 15:case"end":return e.stop()}},e,this)}))},c.view=Object(J.a)(function(){var e,t,n=c.fieldRes.placeHolder,r=!1,i=c.field._ownerField;if(void 0!==i){var o=i.name;i.arr;r=null===c.vForm.getValue(o)}if(null===c.value)e=a.createElement(a.Fragment,null,n||c.input.placeHolder);else if("object"===typeof c.value)e=te(c.value);else{var s=c.tuid.boxId(c.value);e=te(s)}return!0===c.readonly?a.createElement("div",{className:"form-control form-control-plaintext border border-info rounded bg-light cursor-pointer",onClick:c.onClick},e):(!0!==c.fieldUI.required&&!1!==c.field.null||(t=a.createElement(ye,null)),a.createElement(a.Fragment,null,t,a.createElement("button",{className:"form-control btn btn-outline-info",type:"button",disabled:r,style:Ae,onClick:c.onClick},e)))}),c.tuid=n._tuid,c.vForm=e,c.input=e.inputs[n.name],c}return Object(f.a)(t,e),t}(me),qe=function(){function e(t,n,r){Object(s.a)(this,e),this.vForm=t,this.onSubmit=r;var i=n.fields,a=n.arrs,o=n.ui,c=n.res;if(this.fields=i,this.arrs=a,void 0!==o){var u=o.items,l=o.layout;this.formItems=u,this.layout=l}this.res=c}return Object(c.a)(e,[{key:"build",value:function(){return void 0===this.layout?this.bandsOnFly():this.bandsFromLayout()}},{key:"resFromName",value:function(e,t){if(void 0!==t){var n=t.fields;if(void 0!==n)return n[e]||e}}},{key:"bandsOnFly",value:function(){var e=[];if(this.bandsFromFields(e,this.fields,this.res),void 0!==this.arrs){var t=!0,n=!1,r=void 0;try{for(var i,a=this.arrs[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.push(this.bandFromArr(o))}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}return void 0!==this.onSubmit&&e.push(new Y(new ce(this.vForm))),e}},{key:"bandsFromFields",value:function(e,t,n){if(void 0!==t){var r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;e.push(this.bandFromField(c,n))}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"bandsFromLayout",value:function(){return[]}},{key:"bandFromField",value:function(e,t){var n,r,i,a,o=e.name,s=this.resFromName(o,t);return"object"===typeof s?(r=s.label,n=s):(r=s,n=void 0),void 0!==this.formItems&&(a=this.formItems[o]),void 0===(i="function"===typeof a?new Se(this.vForm,e,n):function(e,t,n,r){var i;switch(t.type){default:return;case"tinyint":case"smallint":case"int":i=Oe;break;case"bigint":if(void 0!==t._tuid)return;i=Oe;break;case"dec":i=je;break;case"char":i=we;break;case"text":i=Ee;break;case"datetime":i=Ce}return new i(e,t,n,r)}(this.vForm,e,a,n))&&(i=new Re(this.vForm,e,a,n)),new Z(r||o,i)}},{key:"bandFromArr",value:function(e){var t=e.name,n=(e.fields,new Fe(this.vForm,e));return new G(t,n)}}]),e}(),Te=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},Ie=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};!function(e){e[e.new=0]="new",e[e.edit=1]="edit",e[e.readonly=2]="readonly"}(Ne||(Ne={}));var De=function(){function e(t,n){var r=this;Object(s.a)(this,e),this.vFields={},this.vArrs={},this.onFormSubmit=function(e){return e.preventDefault(),!1},this.view=Object(J.a)(function(e){var t=e.className;return a.createElement("form",{className:t,onSubmit:r.onFormSubmit},r.bands.map(function(e){return e.render()}))});var i=t.fields,o=t.arrs,c=t.ui,u=t.res,l=t.inputs,h=t.none,f=t.submitCaption,d=t.arrNewCaption,p=t.arrEditCaption,m=t.arrTitleNewButton,b=t.mode;this.fields=i,this.arrs=o,this.ui=c,void 0!==this.ui&&(this.formItems=this.ui.items),this.res=u,this.inputs=l,this.none=h,this.submitCaption=f,this.arrNewCaption=d,this.arrEditCaption=p,this.arrTitleNewButton=m||a.createElement("small",null,a.createElement(v.b,{name:"plus"})," \u65b0\u589e"),this.mode=void 0===n?Ne.readonly:b,this.buildFormValues(),this.buildBands(t,n),this.onSubmit=n}return Object(c.a)(e,[{key:"buildBands",value:function(e,t){this.bandColl={};var n=new qe(this,e,t);this.bands=n.build();var r=!0,i=!1,a=void 0;try{for(var o,s=this.bands[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;this.bandColl[c.key]=c;var u=c.getVFields();if(void 0!==u){var l=!0,h=!1,f=void 0;try{for(var d,p=u[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value;this.vFields[v.name]=v}}catch(y){h=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}var m=c.getVArr();void 0!==m&&(this.vArrs[m.name]=m);var b=c.getVSubmit();void 0!==b&&(this.vSubmit=b)}}catch(y){i=!0,a=y}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"getBand",value:function(e){return this.bandColl[e]}},{key:"computeFields",value:function(){if(void 0!==this.formItems){var e=this.values;for(var t in this.formItems){var n=this.formItems[t];"function"===typeof n&&(e[t]=n.call(e))}}}},{key:"submit",value:function(){return Ie(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.onSubmit){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.onSubmit();case 4:case"end":return e.stop()}},e,this)}))}},{key:"getValues",value:function(){var e={},t=this.values,n=!0,r=!1,i=void 0;try{for(var a,o=this.fields[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=t[p=a.value.name];e[p]=null!==s&&"object"===typeof s?s.id:s}}catch(q){r=!0,i=q}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}if(void 0!==this.arrs){var c=!0,u=!1,l=void 0;try{for(var h,f=this.arrs[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var d=h.value,p=d.name,v=d.fields,m=d.id,b=d.order,y=e[p]=[],w=this.vArrs[p].list,k=!0,g=!1,x=void 0;try{for(var O,j=w[Symbol.iterator]();!(k=(O=j.next()).done);k=!0){var E=O.value,C={};void 0!==m&&(C[m]=E[m]),void 0!==b&&(C[b]=E[b]);var N=!0,S=!1,P=void 0;try{for(var F,V=v[Symbol.iterator]();!(N=(F=V.next()).done);N=!0){var A=F.value.name,R=E[A];C[A]=null!==R&&"object"===typeof R?R.id:R}}catch(q){S=!0,P=q}finally{try{N||null==V.return||V.return()}finally{if(S)throw P}}y.push(C)}}catch(q){g=!0,x=q}finally{try{k||null==j.return||j.return()}finally{if(g)throw x}}}}catch(q){u=!0,l=q}finally{try{c||null==f.return||f.return()}finally{if(u)throw l}}}return e}},{key:"setValues",value:function(e){if(void 0!==e){var t=this.values,n=this.errors,r=!0,i=!1,a=void 0;try{for(var o,s=this.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value.name;n[c]=void 0;var u=e[c];t[c]=u}}catch(d){i=!0,a=d}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}for(var l in this.vArrs){var h=e[l];if(void 0!==h){var f=t[l];f.clear(),f.push.apply(f,Object(V.a)(h))}}}else this.reset()}},{key:"reset",value:function(){var e=this.values,t=this.errors,n=!0,r=!1,i=void 0;try{for(var a,o=this.fields[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value.name;e[s]=null,t[s]=void 0}}catch(h){r=!0,i=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}for(var c in this.vFields){var u=this.vFields[c];void 0!==u.name&&u.setValue(null)}for(var l in this.vArrs){this.vArrs[l].reset()}}},{key:"getValue",value:function(e){return this.values[e]}},{key:"setValue",value:function(e,t){this.values[e]=t}},{key:"setError",value:function(e,t){this.errors[e]=t}},{key:"buildFieldValues",value:function(e){var t={valueFromFieldName:function(e){return this[e]}},n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){t[a.value.name]=null}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}},{key:"buildObservableValues",value:function(){var e=this.buildFieldValues(this.fields);if(void 0!==this.arrs){var t=!0,n=!1,r=void 0;try{for(var i,a=this.arrs[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){e[i.value.name]=m.k.array([],{deep:!0})}}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}return Object(m.k)(e)}},{key:"buildFormValues",value:function(){this.values=this.buildObservableValues(),this.errors=Object(m.k)(this.buildFieldValues(this.fields))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"py-3";return a.createElement(this.view,{className:e})}},{key:"valueBoxs",get:function(){var e={},t=this.values,n=!0,r=!1,i=void 0;try{for(var a,o=this.fields[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,c=s.name,u=s._tuid,l=t[c];e[c]=void 0===u||"object"===typeof l?l:u.boxId(l)}}catch(R){r=!0,i=R}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}if(void 0===this.arrs)return e;var h=!0,f=!1,d=void 0;try{for(var p,v=this.arrs[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var m=p.value,b=(c=m.name,m.fields),y=(m.id,m.order,e[c]=this.vArrs[c].list.slice()),w=!0,k=!1,g=void 0;try{for(var x,O=y[Symbol.iterator]();!(w=(x=O.next()).done);w=!0){var j=x.value,E=!0,C=!1,N=void 0;try{for(var S,P=b[Symbol.iterator]();!(E=(S=P.next()).done);E=!0){var F=S.value,V=F.name,A=(u=F._tuid,j[V]);j[V]=void 0===u||"object"===typeof A?A:u.boxId(A)}}catch(R){C=!0,N=R}finally{try{E||null==P.return||P.return()}finally{if(C)throw N}}}}catch(R){k=!0,g=R}finally{try{w||null==O.return||O.return()}finally{if(k)throw g}}}}catch(R){f=!0,d=R}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}return e}},{key:"isOk",get:function(){for(var e in this.vFields)if(!1===this.vFields[e].isOk)return!1;return!0}}]),e}();function Ue(e,t){return o.a.createElement(v.b,{className:e,name:t,fixWidth:!0})}Te([m.d],De.prototype,"isOk",null);var Me={tuid:Ue("text-info","list-alt"),action:Ue("text-info","hand-o-right"),map:Ue("text-muted","list-ul"),book:Ue("text-muted","book"),query:Ue("text-warning","search"),history:Ue("text-info","hand-o-right"),pending:Ue("text-info","forward"),sheet:Ue("text-primary","wpforms")},Le=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,n))).cUsq=e,r}return Object(f.a)(t,e),t}(p.b),Be=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},He=function(e){function t(e,n,r,i){var a;Object(s.a)(this,t),a=Object(u.a)(this,Object(l.a)(t).call(this,e,i)),Object.setPrototypeOf(a.x,e.x);var o=n.name,c=n.typeName;return a.entity=n,a.ui=r,a.label=a.res.label||o,a.icon=Me[c],a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"beforeStart",value:function(){var e=this,n=Object.create(null,{beforeStart:{get:function(){return Object(h.a)(Object(l.a)(t.prototype),"beforeStart",e)}}});return Be(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.beforeStart.call(this);case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,this.entity.loadSchema();case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}},e,this)}))}},{key:"createForm",value:function(e,t,n){var r=this.buildFormOptions(n),i=new De(r,e);return i.setValues(t),i}},{key:"buildFormOptions",value:function(e){var t,n,r,i,a,o=this.entity,s=o.fields,c=o.arrFields;void 0!==this.res&&(t=this.res.none,n=this.res.submit,r=this.res.arrNew,i=this.res.arrEdit,a=this.res.arrTitleNewButton),void 0===t&&(t=this.cUsq.res.none||"none"),void 0===n&&(n=this.cUsq.res.submit||"Submit"),void 0===r&&(r=this.cUsq.res.arrNew||"New"),void 0===i&&(i=this.cUsq.res.arrEdit||"Edit"),void 0===a&&(a=this.cUsq.res.arrTitleNewButton),void 0===e&&(e=Ne.new);var u=this.ui.form;return{fields:s,arrs:c,ui:u,res:this.res||{},inputs:this.buildInputs(u),none:t,submitCaption:n,arrNewCaption:r,arrEditCaption:i,arrTitleNewButton:a,mode:e}}},{key:"buildInputs",value:function(e){var t=this.entity,n=t.fields,r=t.arrFields,i={};if(this.buildFieldsInputs(i,n,void 0,e),void 0!==r){var a=!0,o=!1,s=void 0;try{for(var c,u=r[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value,h=l.name,f=l.fields,d=e&&e.items;this.buildFieldsInputs(i,f,h,d&&d[h])}}catch(p){o=!0,s=p}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}return i}},{key:"buildFieldsInputs",value:function(e,t,n,r){if(void 0!==n){var i=e[n];void 0===i&&(e[n]=i={},e=i)}var a=!0,o=!1,s=void 0;try{for(var c,u=t[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value,h=l.name,f=l._tuid;if(void 0!==f){var d=r&&r.items&&r.items[h];e[h]={select:this.buildSelect(l,n,d),content:this.buildContent(l,n),placeHolder:this.cUsq.getTuidPlaceHolder(f)}}}}catch(p){o=!0,s=p}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}},{key:"buildSelect",value:function(e,t,n){var r=this;return function(e,t,a){return Be(r,void 0,void 0,i.a.mark(function r(){var a,o,s,c,u,l;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=t._tuid,o=t._ownerField,r.next=3,a.cSelectFrom();case 3:return s=r.sent,c=void 0,void 0!==o&&(c=e.getValue(o.name)),n&&!0===n.autoList&&(console.log("select search set param=empty string"),c=""),r.next=9,s.call(c);case 9:if(u=r.sent,s.removeCeased(),void 0!==u){r.next=13;break}return r.abrupt("return",void 0);case 13:return l=s.idFromItem(u),a.useId(l),r.abrupt("return",l);case 16:case"end":return r.stop()}},r,this)}))}}},{key:"buildContent",value:function(e,t){}},{key:"cQuerySelect",value:function(e){return this.cUsq.cQuerySelect(e)}}]),t}(Le),We=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).entity=e.entity,n.ui=e.ui,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"createForm",value:function(e,t,n){return this.controller.createForm(e,t,n)}},{key:"label",get:function(){return this.controller.label}}]),t}(p.l),Ke=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Qe=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).view=function(){return a.createElement(p.f,{header:e.label},"Book")},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Ke(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}}]),t}(We),ze=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Je=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return ze(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VBookMain);case 2:case"end":return e.stop()}},e,this)}))}},{key:"VBookMain",get:function(){return Qe}}]),t}(He),Xe=n(31),Ze=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ge=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).newClick=function(){return e.event("new")},e.schemaClick=function(){return e.event("schema")},e.archivesClick=function(){return e.event("archives")},e.sheetStateClick=function(t){return e.event("state",t)},e.renderState=function(t,n){var r=t.state,i=t.count;if(0===i)return null;var o=a.createElement(Xe.a,{className:"ml-5 align-self-end",color:"success"},i);return a.createElement(v.d,{className:"px-3 py-2",left:e.controller.getStateLabel(r),right:o})},e.view=Object(J.a)(function(){var t,n=e.controller.statesCount.filter(function(e){return e.count}),r=a.createElement("button",{className:"btn btn-outline-primary",onClick:e.archivesClick},"\u5df2\u5f52\u6863");return!0===e.isDev&&(t=a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.schemaClick},"\u6a21\u677f")),a.createElement(p.f,{header:e.label},a.createElement(v.d,{className:"mx-3 my-2",right:r},a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.newClick},"\u65b0\u5efa"),t),a.createElement(v.e,{className:"my-2",header:a.createElement(v.g,{className:"mx-3 my-1"},"\u5f85\u5904\u7406",e.label),none:"[ \u65e0 ]",items:n,item:{render:e.renderState,onClick:e.sheetStateClick}}))}),e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(){return Ze(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}}]),t}(We),Ye=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},$e=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSubmit=function(){return Ye(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.getValues(),n=this.vForm.values,e.next=4,this.controller.onSave(t,n);case 4:case"end":return e.stop()}},e,this)}))},e.view=function(){return a.createElement(p.f,{header:e.label},e.vForm.render())},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Ye(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.view);case 2:case"end":return t.stop()}},t,this)}))}}]),t}(We),_e={width:"8rem"},et=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).flowRow=function(e,t){var n,r=e.date,i=(e.user,e.preState,e.state),o=e.action;switch(void 0===o&&(o=a.createElement(a.Fragment,null,a.createElement(v.b,{className:"text-primary",name:"pencil-square-o"})," \u5236\u5355")),i){case"$":break;case"#":n=a.createElement(a.Fragment,null,a.createElement(v.b,{className:"text-success",name:"file-archive-o"}));break;default:n=a.createElement(a.Fragment,null,a.createElement(v.b,{className:"text-muted",name:"arrow-right"})," \xa0 ",i)}return a.createElement(v.d,{left:a.createElement("div",{className:"pl-3 py-2",style:_e},o),right:a.createElement("div",{className:"p-2"},a.createElement(v.g,null,a.createElement(v.a,{date:r})))},a.createElement("div",{className:"p-2"},n))},e.sheetView=function(){var t,n=e.sheetData,r=n.brief,i=n.flows;return"-"===r.state&&(t=a.createElement("div",{className:"mx-3 my-2",style:{color:"red"}},"\u672c\u5355\u636e\u4f5c\u5e9f")),a.createElement("div",null,t,e.vForm.render(),a.createElement(v.e,{header:a.createElement(v.g,{className:"mx-3 my-1"},"\u6d41\u7a0b"),items:i,item:{render:e.flowRow}}))},e}return Object(f.a)(t,e),t}(We),tt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},nt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSubmit=function(){return tt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.getValues(),e.next=3,this.controller.saveSheet(t,this.vForm.values);case 3:this.closePage(),this.returnCall(this.vForm.values);case 5:case"end":return e.stop()}},e,this)}))},e.view=function(){return a.createElement(p.f,{header:e.label},e.vForm.render())},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return tt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.sheetData=e,this.vForm=this.createForm(this.onSubmit,e.data,Ne.edit),this.openPage(this.view);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(et),rt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},it=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).actionClick=function(t){return rt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sheetData.brief,r=n.id,a=n.flow,o=n.state,e.next=3,this.controller.action(r,a,o,t.name);case 3:e.sent,this.ceasePage(),this.openPage(this.acted);case 6:case"end":return e.stop()}},e,this)}))},e.deleteClick=function(){return rt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:alert("\u5355\u636e\u4f5c\u5e9f\uff1a\u7a0b\u5e8f\u6b63\u5728\u8bbe\u8ba1\u4e2d");case 1:case"end":return e.stop()}},e,this)}))},e.editClick=function(){return rt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.editSheet(this.sheetData);case 2:t=e.sent,this.vForm.setValues(t);case 4:case"end":return e.stop()}},e,this)}))},e.page=function(){var t,n,r=e.sheetData.brief,i=r.state,a=r.no,s=e.controller.getStateLabel(i),c=e.entity.states.find(function(e){return e.name===i});if(void 0===c){var u,l;switch(i){default:u="\u4e0d\u8ba4\u8bc6\u7684\u5355\u636e\u72b6\u6001'"+i+"'",l="text-info";break;case"-":u="\u5df2\u4f5c\u5e9f",l="text-danger";break;case"#":u="\u5df2\u5f52\u6863",l="text-success"}t=o.a.createElement("div",{className:K()(l)},"[",u,"]")}else t=o.a.createElement("div",{className:"flex-grow-1"},c.actions.map(function(t,n){return o.a.createElement(Xe.b,{key:n,className:"mr-2",color:"primary",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel(i,t.name))})),"$"===i&&(n=o.a.createElement("div",null,o.a.createElement(Xe.b,{outline:!0,className:"ml-2",color:"info",onClick:e.editClick},"\u4fee\u6539"),o.a.createElement(Xe.b,{outline:!0,className:"ml-2",color:"danger",onClick:e.deleteClick},"\u4f5c\u5e9f")));return o.a.createElement(p.f,{header:e.label+":"+s+"-"+a},o.a.createElement("div",{className:"mb-2"},o.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},t,n),o.a.createElement(e.sheetView,null)))},e.acted=function(){var t=e.sheetData.brief.discription;return o.a.createElement(p.f,{header:"\u5df2\u5904\u7406",back:"close"},o.a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},o.a.createElement("div",{className:"p-3"},t),o.a.createElement("div",{className:"text-success"},o.a.createElement(v.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),o.a.createElement("div",{className:"p-3"},o.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de"))))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return rt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(et),at=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ot=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).view=function(){return a.createElement(p.f,{header:e.label+"\u6a21\u677f"},a.createElement("pre",{className:"mx-3 my-2"},e.entity.schemaStringify()))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return at(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}}]),t}(We),st=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ct=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).archiveClick=function(t){return st(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.processing){e.next=2;break}return e.abrupt("return");case 2:this.event("archived",t);case 3:case"end":return e.stop()}},e,this)}))},e.archiveRow=function(e,t){e.id,e.no,e.discription;var n=e.date,r=a.createElement(a.Fragment,null,1===e.processing?"... ":"",e.no," \xa0 ",e.discription),i=a.createElement(v.g,null,a.createElement(v.a,{date:n}));return a.createElement(v.d,{className:"px-3 py-2",left:r,right:i})},e.view=function(){return a.createElement(p.f,{header:"\u5df2\u5f52\u6863"+e.label},a.createElement(v.e,{items:e.list,item:{render:e.archiveRow,onClick:e.archiveClick}}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(){return st(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.getArchives(void 0,10);case 2:this.list=e.sent,this.openPage(this.view);case 4:case"end":return e.stop()}},e,this)}))}}]),t}(We),ut=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},lt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).rowClick=function(t){return ut(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.processing){e.next=3;break}return this.event("processing",t.id),e.abrupt("return");case 3:this.event("action",t.id);case 4:case"end":return e.stop()}},e,this)}))},e.onScrollBottom=function(){console.log("onScrollBottom"),e.controller.pageStateItems.more()},e.rowContent=function(e){e.id;var t=e.no,n=e.discription,r=e.date,i=e.processing,o=a.createElement(a.Fragment,null,t," \xa0 ",a.createElement(v.g,null,n)," ",1===i?"...":""),s=a.createElement(v.g,null,a.createElement(v.a,{date:r}));return a.createElement(v.d,{className:"px-3 py-2",left:o,right:s})},e.renderRow=function(t,n){return a.createElement(e.row,Object.assign({},t))},e.view=function(){var t=e.controller.pageStateItems;return a.createElement(p.f,{header:e.label+" - "+e.stateLabel,onScrollBottom:e.onScrollBottom},a.createElement(v.e,{items:t,item:{render:e.renderRow,onClick:e.rowClick}}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return ut(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.row=this.ui.listRow||this.rowContent,this.stateName=e.state,this.stateLabel=this.controller.getStateLabel(this.stateName),t.next=5,this.controller.pageStateItems.first(this.stateName);case 5:this.openPage(this.view);case 6:case"end":return t.stop()}},t,this)}))}}]),t}(We),ht=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ft=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).view=function(){var t=e.sheetData.brief;return a.createElement(p.f,{header:e.label+":-"+t.no},a.createElement(e.sheetView,null))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return ht(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.sheetData=e,this.vForm=this.createForm(void 0,this.sheetData.data),this.openPage(this.view);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(et),dt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},pt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).restart=function(){return dt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.ceasePage(),e.next=3,this.event("new");case 3:case"end":return e.stop()}},e,this)}))},e.actionClick=function(t){return dt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.ceasePage(),n=this.brief,r=n.id,a=n.flow,o=n.state,e.next=4,this.controller.action(r,a,o,t.name);case 4:e.sent,this.openPage(this.acted);case 6:case"end":return e.stop()}},e,this)}))},e.buttons=a.createElement(a.Fragment,null,a.createElement("button",{className:"btn btn-outline-primary mr-3",onClick:e.restart},"\u7ee7\u7eed\u5f00\u5355"),a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de")),e.view=function(){var t=e.entity.states,n=t.find(function(e){return"$"===e.name}),r=a.createElement(a.Fragment,null,n.actions.map(function(t,n){return a.createElement("button",{key:n,className:"btn btn-primary mr-3",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel("$",t.name))}));return a.createElement(p.f,{header:"\u5df2\u4fdd\u5b58",back:"close"},a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(v.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u4fdd\u5b58\uff01\u7cfb\u7edf\u5c1a\u672a\u5904\u7406"),a.createElement("div",{className:"p-3"},r,e.buttons)))},e.acted=function(){return a.createElement(p.f,null,a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(v.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),a.createElement("div",{className:"p-3"},e.buttons)))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return dt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.brief=e,this.openPage(this.view);case 2:case"end":return t.stop()}},t,this)}))}}]),t}(function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(We)),vt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},mt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).page=function(){var t=e.sheetData.brief,n=t.state,r=t.no,i=e.controller.getStateLabel(n);return o.a.createElement(p.f,{header:e.label+":"+i+"-"+r},o.a.createElement("div",{className:"mb-2"},o.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},"\u6b63\u5728\u5904\u7406\u4e2d..."),o.a.createElement(e.sheetView,null)))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return vt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(et),bt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},yt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).statesCount=m.k.array([],{deep:!0}),e.onSave=function(t,n){return bt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveSheet(t,n);case 2:return r=e.sent,this.ceasePage(),e.next=6,this.showSaved(r);case 6:case"end":return e.stop()}},e,this)}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return bt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadStateSheetCount();case 2:return this.pageStateItems=this.entity.createPageStateItems(),e.next=5,this.showVPage(this.VSheetMain);case 5:case"end":return e.stop()}},e,this)}))}},{key:"onMessage",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){var n,r,a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.type,r=e.body,a=e.from,o=e.to,e.push,"sheet"===n&&this.onSheet(a,o,r);case 2:case"end":return t.stop()}},t,this)}))}},{key:"onSheet",value:function(e,t,n){var r=this.user.id,i=n.id,a=n.preState,o=n.state;console.log({$:"onMessage sheet",from:e,to:t.join(","),id:i,preState:a,state:o,me:r,sheetData:n}),e===r&&this.sheetActPreState(i,a),void 0!==t.find(function(e){return e===r})&&this.sheetActState(i,o,n)}},{key:"sheetActPreState",value:function(e,t){if(this.changeStateCount(t,-1),void 0!==this.curState&&this.curState===t){var n=this.pageStateItems.items.findIndex(function(t){return t.id===e});n>=0&&this.pageStateItems.items.splice(n,1)}}},{key:"sheetActState",value:function(e,t,n){this.changeStateCount(t,1),void 0!==this.curState&&this.curState===t&&this.pageStateItems.items.findIndex(function(t){return t.id===e})<0&&this.pageStateItems.items.push(n)}},{key:"changeStateCount",value:function(e,t){if(void 0!==e){var n=this.statesCount.findIndex(function(t){return t.state===e});if(console.log({$:"changeState",state:e,delta:t,index:n}),!(n<0)){var r=this.statesCount[n];r.count+=t,r.count<0&&(r.count=0)}}}},{key:"onEvent",value:function(e,t){return bt(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e,n.next="new"===n.t0?4:"schema"===n.t0?6:"archives"===n.t0?8:"state"===n.t0?10:"archived"===n.t0?13:"action"===n.t0?16:"processing"===n.t0?19:3;break;case 3:return n.abrupt("return");case 4:return r=this.VSheetNew,n.abrupt("break",22);case 6:return r=this.VSheetSchema,n.abrupt("break",22);case 8:return r=this.VArchives,n.abrupt("break",22);case 10:return this.curState=t.state,r=this.VSheetList,n.abrupt("break",22);case 13:return n.next=15,this.showArchived(t);case 15:return n.abrupt("return");case 16:return n.next=18,this.showAction(t);case 18:return n.abrupt("return");case 19:return n.next=21,this.showProcessing(t);case 21:return n.abrupt("return");case 22:return n.next=24,this.showVPage(r,t);case 24:case"end":return n.stop()}},n,this)}))}},{key:"startSheet",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.beforeStart();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.onEvent("action",e);case 7:case"end":return t.stop()}},t,this)}))}},{key:"showAction",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSheetData(e);case 2:return n=t.sent,Object(p.q)({body:{$type:"msg",action:"$sheet",msg:{id:e,usq:this.cUsq.id,state:n.brief.state}}}),t.next=6,this.showVPage(this.VSheetAction,n);case 6:case"end":return t.stop()}},t,this)}))}},{key:"showProcessing",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSheetData(e);case 2:return n=t.sent,t.next=5,this.showVPage(this.VSheetProcessing,n);case 5:case"end":return t.stop()}},t,this)}))}},{key:"editSheet",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.vCall(this.VSheetEdit,e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},t,this)}))}},{key:"showArchived",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getArchived(e.id);case 2:return n=t.sent,t.next=5,this.showVPage(this.VArchived,n);case 5:case"end":return t.stop()}},t,this)}))}},{key:"showSaved",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showVPage(this.VSheetSaved,e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"getStateUI",value:function(e){var t=this.res.states;if(void 0!==t)return t[e]}},{key:"getStateLabel",value:function(e){var t=this.getStateUI(e),n=t&&t.label||e;switch(n){default:return n;case"$":return"\u65b0\u5355"}}},{key:"getActionLabel",value:function(e,t){var n=this.getStateUI(e);if(void 0===n)return t;var r=n.actions;if(void 0===r)return t;var i=r[t];return i&&i.label||t}},{key:"loadStateSheetCount",value:function(){return bt(this,void 0,void 0,i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.statesCount.clear(),e.next=3,this.entity.stateSheetCount();case 3:n=e.sent,(t=this.statesCount).splice.apply(t,[0,0].concat(Object(V.a)(n)));case 5:case"end":return e.stop()}},e,this)}))}},{key:"getSheetData",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.entity.getSheet(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"getArchived",value:function(e){return bt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.entity.getArchive(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"saveSheet",value:function(e,t){return bt(this,void 0,void 0,i.a.mark(function n(){var r,a,o;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.ui.sheetTitle,a=void 0===r?this.label:r(t,this.x),n.next=4,this.entity.save(a,e);case 4:return o=n.sent,n.abrupt("return",o);case 6:case"end":return n.stop()}},n,this)}))}},{key:"action",value:function(e,t,n,r){return bt(this,void 0,void 0,i.a.mark(function a(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.entity.action(e,t,n,r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a,this)}))}},{key:"VSheetMain",get:function(){return this.ui&&this.ui.main||Ge}},{key:"VSheetNew",get:function(){return this.ui.sheetNew||$e}},{key:"VSheetSaved",get:function(){return this.ui.sheetSaved||pt}},{key:"VSheetEdit",get:function(){return this.ui.sheetEdit||nt}},{key:"VSheetSchema",get:function(){return ot}},{key:"VArchives",get:function(){return ct}},{key:"VArchived",get:function(){return ft}},{key:"VSheetList",get:function(){return lt}},{key:"VSheetAction",get:function(){return this.ui.sheetAction||it}},{key:"VSheetProcessing",get:function(){return mt}}]),t}(He),wt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},kt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSubmit=function(){return wt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.getValues(),e.next=3,this.controller.submit(t);case 3:this.returns=e.sent,this.closePage(),this.openPage(this.resultPage);case 6:case"end":return e.stop()}},e,this)}))},e.mainPage=function(){var t=e.controller.label;return a.createElement(p.f,{header:t},e.vForm.render("mx-3 my-2"))},e.resultPage=function(){var t=e.controller.label;return a.createElement(p.f,{header:t,back:"close"},"\u5b8c\u6210\uff01",a.createElement("pre",null,_(e.returns)))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return wt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.mainPage);case 2:case"end":return t.stop()}},t,this)}))}}]),t}(We),gt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},xt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return gt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VActionMain);case 2:case"end":return e.stop()}},e,this)}))}},{key:"submit",value:function(e){return gt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.entity.submit(e));case 1:case"end":return t.stop()}},t,this)}))}},{key:"VActionMain",get:function(){return kt}}]),t}(He),Ot=function(e){return o.a.createElement("div",{className:"px-3 py-2"},_(e))},jt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Et=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSubmit=function(){return jt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.vForm.getValues(),!0!==this.entity.isPaged){e.next=9;break}return e.next=4,this.entity.resetPage(30,t);case 4:return e.next=6,this.entity.loadPage();case 6:this.replacePage(this.pageResult),e.next=13;break;case 9:return e.next=11,this.entity.query(t);case 11:n=e.sent,this.replacePage(this.queryResult,n);case 13:case"end":return e.stop()}},e,this)}))},e.again=function(){e.vForm.reset(),e.replacePage(e.view)},e.renderRow=function(t,n){return a.createElement(e.row,Object.assign({},t))},e.view=function(){return a.createElement(p.f,{header:e.label},e.vForm.render("mx-3 my-2"),e.renderExtra())},e.pageResult=function(){var t=e.entity,n=(t.name,t.list),r=a.createElement("button",{className:"btn btn-outline-success",onClick:e.again},a.createElement(v.b,{name:"search"})," \u518d\u67e5\u8be2");return a.createElement(p.f,{header:e.label,right:r},a.createElement(v.e,{items:n,item:{render:e.renderRow}}))},e.queryResult=Object(J.a)(function(t){var n=a.createElement("button",{className:"btn btn-outline-success",onClick:e.again},a.createElement(v.b,{name:"search"})," \u518d\u67e5\u8be2");return a.createElement(p.f,{header:e.label,right:n},a.createElement("pre",null,JSON.stringify(t,void 0,"\t")))}),e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return jt(this,void 0,void 0,i.a.mark(function t(){var n,r,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.vForm=this.createForm(this.onSubmit,e),n=this.ui,r=n.row,a=n.queryRow,this.row=a||r||Ot,this.openPage(this.view);case 4:case"end":return t.stop()}},t,this)}))}},{key:"renderExtra",value:function(){}}]),t}(We),Ct=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Nt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSearch=function(t){return Ct(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.PageItems.first(t);case 2:case"end":return e.stop()}},e,this)}))},e.renderRow=function(t,n){return a.createElement(e.row,Object.assign({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.view=function(){var t=a.createElement(v.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label});return a.createElement(p.f,{header:t},a.createElement(v.e,{items:e.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Ct(this,void 0,void 0,i.a.mark(function t(){var n,r,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.ui,r=n.row,a=n.selectRow,this.row=a||r||Ot,this.PageItems=new St(this.entity),t.next=5,this.onSearch(e);case 5:this.openPage(this.view);case 6:case"end":return t.stop()}},t,this)}))}},{key:"callOnSelected",value:function(e){this.closePage(),this.returnCall(e)}}]),t}(We),St=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).query=e,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"load",value:function(){return Ct(this,void 0,void 0,i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.loadSchema();case 2:if(!0!==this.query.isPaged){e.next=8;break}return e.next=5,this.query.page(this.param,this.pageStart,this.pageSize);case 5:t=e.sent,e.next=12;break;case 8:return e.next=10,this.query.query(this.param);case 10:n=e.sent,t=n[this.query.returns[0].name];case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}},e,this)}))}},{key:"setPageStart",value:function(e){void 0===e&&(this.pageStart=0)}}]),t}(p.g),Pt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ft=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(He),Vt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return Pt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VQueryMain);case 2:case"end":return e.stop()}},e,this)}))}},{key:"VQueryMain",get:function(){return this.ui&&this.ui.main||Et}}]),t}(Ft),At=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(e){return Pt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showVPage(this.VQuerySelect,e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"VQuerySelect",get:function(){return Nt}}]),t}(Ft),Rt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},qt=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onNew=function(){return e.event("new")},e.onList=function(){return e.event("list")},e.onSearch=function(t){return Rt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.event("list",t));case 1:case"end":return e.stop()}},e,this)}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Rt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}},{key:"entityRender",value:function(e,t){return e.render()}},{key:"entityClick",value:function(e){return Rt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onClick();case 2:case"end":return t.stop()}},t,this)}))}},{key:"view",get:function(){var e,t=this,n=this.controller,r=n.label,i=n.proxyLinks;return!1===n.isFrom&&(e=a.createElement(Xe.b,{className:"ml-3",color:"primary",onClick:this.onNew},"\u65b0\u589e")),function(){return a.createElement(p.f,{header:r},void 0===i?a.createElement(a.Fragment,null,a.createElement(v.i,{className:"w-100",onSearch:t.onSearch,placeholder:"\u641c\u7d22"+r}),a.createElement("div",{className:"my-3"},e,a.createElement(Xe.b,{className:"ml-3",color:"primary",onClick:t.onList},"\u5217\u8868"))):a.createElement(v.e,{className:"my-2",header:a.createElement(v.g,null,r," \u4ee3\u7406\u4e0b\u5217Tuid"),items:i,item:{render:t.entityRender,onClick:t.entityClick}}))}}}]),t}(We),Tt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},It=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).next=function(){return Tt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vForm.reset(),this.closePage();case 2:case"end":return e.stop()}},e,this)}))},e.finish=function(){e.closePage(2),e.event("edit-end")},e.onSubmit=function(){return Tt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n,r,o,s,c,u,l,h,f;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.getValues(),e.next=3,this.controller.entity.save(this.id,t);case 3:if(n=e.sent,!((r=n.id)<0)){e.next=28;break}if(void 0===(o=this.controller.entity.unique)){e.next=27;break}for(s=!0,c=!1,u=void 0,e.prev=11,l=o[Symbol.iterator]();!(s=(h=l.next()).done);s=!0)f=h.value,this.vForm.setError(f,"\u4e0d\u80fd\u91cd\u590d");e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),c=!0,u=e.t0;case 19:e.prev=19,e.prev=20,s||null==l.return||l.return();case 22:if(e.prev=22,!c){e.next=25;break}throw u;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return e.abrupt("return");case 28:if(!this.controller.isCalling){e.next=32;break}return this.returnCall(r),this.closePage(),e.abrupt("return");case 32:return this.openPageElement(a.createElement(p.f,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(v.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement(Xe.b,{className:"mr-3",color:"primary",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement(Xe.b,{color:"primary",outline:!0,onClick:this.finish},"\u4e0d\u7ee7\u7eed"))))),this.event("item-changed",{id:this.id,values:t}),e.abrupt("return");case 35:case"end":return e.stop()}},e,this,[[11,15,19,27],[20,,22,26]])}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Tt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.vForm=this.createForm(this.onSubmit,e),void 0!==e&&(this.id=e.id),this.openPage(this.editView);case 3:case"end":return t.stop()}},t,this)}))}},{key:"resetForm",value:function(){this.vForm.reset()}},{key:"editView",get:function(){var e=this;return function(){return a.createElement(p.f,{header:(void 0===e.id?"\u65b0\u589e":"\u7f16\u8f91")+" - "+e.label},e.vForm.render("py-3"))}}}]),t}(We),Dt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ut=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).mainView=Object(J.a)(function(){var t=o.a.createElement(v.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearchMain,placeholder:"\u641c\u7d22"+e.label});return o.a.createElement(p.f,{header:t,back:"close"},o.a.createElement(v.e,{items:e.controller.PageItems.items,item:{render:e.renderMainRow,onClick:e.clickMainRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e.onSearchMain=function(t){return Dt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.searchMain(t);case 2:case"end":return e.stop()}},e,this)}))},e.renderMainRow=function(t,n){return o.a.createElement(e.mainRowContent,Object.assign({},t))},e.clickMainRow=function(t){return Dt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ceasePage(),void 0!==this.controller.entity.owner){e.next=4;break}return this.returnCall(t),e.abrupt("return");case 4:return e.next=6,this.showDiv(this.entity.getIdFromObj(t));case 6:case"end":return e.stop()}},e,this)}))},e.divView=function(t){return o.a.createElement(p.f,{header:"\u9009\u62e9Div"},o.a.createElement(v.e,{items:t.items,item:{render:e.renderDivRow,onClick:e.clickDivRow}}))},e.renderDivRow=function(t,n){return o.a.createElement(e.divRowContent,Object.assign({},t))},e.clickDivRow=function(t){e.ceasePage(),e.returnCall(t)},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Dt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e){t.next=5;break}return t.next=3,this.showMain(e);case 3:t.next=7;break;case 5:return t.next=7,this.showDiv(e);case 7:case"end":return t.stop()}},t,this)}))}},{key:"showMain",value:function(e){return Dt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.mainRowContent=this.ui.rowContent||ae,t.next=3,this.controller.searchMain(e);case 3:this.openPage(this.mainView);case 4:case"end":return t.stop()}},t,this)}))}},{key:"showDiv",value:function(e){return Dt(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0!==(n=this.ui.divs)&&(this.divRowContent=n[this.entity.name].rowContent),void 0===this.divRowContent&&(this.divRowContent=ae),t.next=5,this.controller.getDivItems(e);case 5:r=t.sent,this.openPage(this.divView,{items:r});case 7:case"end":return t.stop()}},t,this)}))}}]),t}(We),Mt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Lt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).next=function(){return Mt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vForm.reset(),this.closePage();case 2:case"end":return e.stop()}},e,this)}))},e.finish=function(){e.closePage(2)},e.onSubmit=function(){return Mt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n,r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.vForm.getValues(),e.next=3,this.entity.save(this.id,t);case 3:return(n=e.sent)&&alert("\u8fd9\u91cc\u8fd8\u8981\u5224\u65ad\u8fd4\u56de\u503c\uff0c\u5148\u4e0d\u5904\u7406\u4e86 \n"+_(n)),this.openPage(function(){return a.createElement(p.f,{header:r.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(v.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement(Xe.b,{className:"mr-3",color:"primary",onClick:r.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement(Xe.b,{color:"primary",outline:!0,onClick:r.finish},"\u4e0d\u7ee7\u7eed"))))}),e.abrupt("return");case 7:case"end":return e.stop()}},e,this)}))},e.view=function(){return a.createElement(p.f,{header:e.label},e.vForm.render("py-3"))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"buildForm",value:function(e){this.vForm=this.createForm(void 0,e)}},{key:"showEntry",value:function(e){return Mt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.buildForm(e),this.openPage(this.view);case 2:case"end":return t.stop()}},t,this)}))}},{key:"render",value:function(e){return this.buildForm(e),this.vForm.render()}},{key:"loadId",value:function(e){return Mt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.id=e;case 1:case"end":return t.stop()}},t,this)}))}},{key:"resetForm",value:function(){this.vForm.reset()}}]),t}(We)),Bt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ht=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,!0))).tuid=e,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"load",value:function(e,t,n){return Bt(this,void 0,void 0,i.a.mark(function r(){var a;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.tuid.search(e,t,n);case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}},r,this)}))}},{key:"setPageStart",value:function(e){this.pageStart=void 0===e?0:e.id}}]),t}(p.g),Wt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},Kt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"onSelected",value:function(e){return Wt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:!1===this.controller.isFrom?this.event("edit",e.id):this.event("info",e.id);case 1:case"end":return t.stop()}},t,this)}))}}]),t}(function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onSearch=function(t){return Wt(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.searchMain(t);case 2:case"end":return e.stop()}},e,this)}))},e.renderRow=function(t,n){return a.createElement(e.rowContent,Object.assign({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.rowKey=function(e){return e.id},e.view=Object(J.a)(function(){var t,n=a.createElement(v.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label}),r=e.entity.owner;if(void 0!==r){var i=r.valueFromId(e.ownerId);t=a.createElement("div",null,"owner: ",_(i))}return a.createElement(p.f,{header:n},t,a.createElement(v.e,{items:e.controller.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow,key:e.rowKey},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return Wt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.rowContent=this.ui.rowContent||ae,void 0!==this.entity.owner&&(this.ownerId=Number(e)),t.next=4,this.controller.searchMain("");case 4:this.openPage(this.view);case 5:case"end":return t.stop()}},t,this)}))}},{key:"callOnSelected",value:function(e){void 0!==this.onSelected?this.onSelected(e):alert("onSelect is undefined")}}]),t}(We)),Qt=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},zt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"buildPageItems",value:function(){return new Ht(this.entity.owner||this.entity)}},{key:"searchMain",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0===e){t.next=4;break}return t.next=4,this.PageItems.first(e);case 4:case"end":return t.stop()}},t,this)}))}},{key:"getDivItems",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.entity.searchArr(e,void 0,0,1e3);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},t,this)}))}}]),t}(He),Jt=function(e){function t(e,n,r,i){var a;Object(s.a)(this,t);var o=(a=Object(u.a)(this,Object(l.a)(t).call(this,e,n,r,i))).entity;if(a.proxies=o.proxies,void 0!==a.proxies)for(var c in a.proxyLinks=[],a.proxies){var h=a.cUsq.linkFromName("tuid",c);a.proxyLinks.push(h)}return a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"from",value:function(){return Qt(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.cFrom();case 2:if(void 0!==(t=e.sent)){e.next=5;break}return e.abrupt("return",this);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}},e,this)}))}},{key:"cUsqFrom",value:function(){return Qt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.cUsqFrom();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}},{key:"cEditFrom",value:function(){return Qt(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.cUsqFrom();case 2:return t=e.sent,e.next=5,t.cTuidEditFromName(this.entity.name);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"cInfoFrom",value:function(){return Qt(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.cUsqFrom();case 2:return t=e.sent,e.next=5,t.cTuidInfoFromName(this.entity.name);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"cSelectFrom",value:function(){return Qt(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.cUsqFrom();case 2:return t=e.sent,e.next=5,t.cTuidSelectFromName(this.entity.name);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"getLable",value:function(e){if(e===this.entity)return this.label;var t=e.name,n=this.res.arrs;if(void 0!==n){var r=n[t];if(void 0!==r){var i=r.label;if(void 0!==i)return i}}return t}},{key:"internalStart",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,e.next=3,this.showVPage(this.VTuidMain);case 3:case"end":return e.stop()}},e,this)}))}},{key:"onEvent",value:function(e,t){return Qt(this,void 0,void 0,i.a.mark(function n(){var r,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e,n.next="new"===n.t0?4:"list"===n.t0?6:"edit"===n.t0?8:"item-changed"===n.t0?11:"info"===n.t0?13:3;break;case 3:return n.abrupt("return");case 4:return r=this.VTuidEdit,n.abrupt("break",17);case 6:return r=this.VTuidList,n.abrupt("break",17);case 8:return n.next=10,this.edit(t);case 10:return n.abrupt("return");case 11:return this.itemChanged(t),n.abrupt("return");case 13:return a=new Yt(this.cUsq,this.entity,this.ui,this.res),n.next=16,a.start(t);case 16:return n.abrupt("return");case 17:return n.next=19,this.showVPage(r,t);case 19:case"end":return n.stop()}},n,this)}))}},{key:"edit",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=void 0,void 0===e){t.next=5;break}return t.next=4,this.entity.load(e);case 4:n=t.sent;case 5:return r=this.VTuidEdit,t.next=8,this.showVPage(r,n);case 8:case"end":return t.stop()}},t,this)}))}},{key:"itemChanged",value:function(e){var t=e.id,n=e.values;if(void 0!==this.PageItems){var r=this.PageItems.items.find(function(e){return e.id===t});void 0!==r&&y.a.merge(r,n)}}},{key:"VTuidMain",get:function(){return qt}},{key:"VTuidEdit",get:function(){return It}},{key:"VTuidList",get:function(){return Kt}}]),t}(zt),Xt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.edit(e);case 2:case"end":return t.stop()}},t,this)}))}}]),t}(Jt),Zt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VTuidList);case 2:case"end":return e.stop()}},e,this)}))}}]),t}(Jt),Gt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showVPage(this.VTuidSelect,e);case 2:case"end":return t.stop()}},t,this)}))}},{key:"beforeStart",value:function(){var e=this,n=Object.create(null,{beforeStart:{get:function(){return Object(h.a)(Object(l.a)(t.prototype),"beforeStart",e)}}});return Qt(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.beforeStart.call(this);case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return",!1);case 5:return void 0!==this.PageItems&&this.PageItems.reset(),e.abrupt("return",!0);case 7:case"end":return e.stop()}},e,this)}))}},{key:"idFromItem",value:function(e){return e.id}},{key:"VTuidSelect",get:function(){return Ut}}]),t}(zt),Yt=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(e){return Qt(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.entity.load(e);case 2:return n=t.sent,t.next=5,this.showVPage(this.VTuidInfo,n);case 5:case"end":return t.stop()}},t,this)}))}},{key:"VTuidInfo",get:function(){return Lt}}]),t}(zt),$t=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},_t=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).itemRender=function(t,n){return a.createElement(e.ItemRow,{item:t})},e.ItemRow=Object(J.a)(function(t){var n,r,i,o,s,c,u=t.item,l=(u.tuid,u.box),h=u.children,f=u.isLeaf,d=u.keyIndex,p=u.values,m=e.controller.keyUIs[d],b=m.content,y=m.valuesContent,w=m.none;if(!1===e.isFrom&&(n=a.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.addClick(u)}},a.createElement(v.b,{name:"plus"})),r=a.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.removeClick(u)}},a.createElement(v.b,{className:"text-info",name:"trash"}))),!1===f?i=0===d?n:a.createElement(a.Fragment,null,r," \xa0 ",n):d>0&&(i=r),!0===f)o=void 0,p&&(c=(y||re)(p,e.x));else{s="border-bottom";var k=w&&w(e.x);o=a.createElement(v.e,{className:"ml-4",items:h,item:{onClick:void 0,render:e.itemRender},none:k})}return a.createElement("div",{className:"d-flex flex-column"},a.createElement(v.d,{className:K()("px-3","py-2",s),right:i},a.createElement("div",{className:"py-1"},te(l,b,e.x)),a.createElement("div",{className:"py-1 font-weight-bold"},c)),o)}),e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return $t(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.isFrom=this.controller.isFrom,this.openPage(this.view);case 2:case"end":return e.stop()}},e,this)}))}},{key:"view",get:function(){var e=this;return function(){return a.createElement(p.f,{header:e.label},a.createElement(v.e,{items:e.controller.items,item:{className:"my-2",onClick:void 0,render:e.itemRender}}))}}}]),t}(We),en=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},tn=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).onValuesSubmit=function(){return en(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.ceasePage(),t=this.vForm.getValues(),this.returnCall(t);case 3:case"end":return e.stop()}},e,this)}))},e.view=function(){return a.createElement(p.f,null,e.vForm.render())},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return en(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.vForm=this.createForm(this.onValuesSubmit),this.openPageElement(a.createElement(this.view,null));case 2:case"end":return e.stop()}},e,this)}))}}]),t}(We),nn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},rn=function e(t,n,r,i){Object(s.a)(this,e),this.children=m.k.array([],{deep:!0}),this.parent=t,this.tuid=n,this.box=r,this.keyIndex=i,this.isLeaf=!1},an=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).addClick=function(t){return nn(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,a,o,s,c,u,l,h,f,d,p,v,m,b,y,w,k,g,x,O,j,E,C,N,S,P,F,V,A,R,q,T;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.keyIndex,r=t.children,a=this.keyFields.length,o=a-1,!((s=n+1)>=a)){e.next=6;break}return e.abrupt("return");case 6:for(c=this.keyFields[s],u=c.name,l=c._tuid,h={},f={},d=t;void 0!==d;d=d.parent)v=(p=d).keyIndex,m=p.box,b=this.keyFields[v].name,h[b]=f[b]=m.id;return e.next=14,this.searchOnKey(c,h);case 14:if(!(void 0===(y=e.sent)||y<=0)){e.next=17;break}return e.abrupt("return");case 17:if(l.useId(y),w=l.boxId(y),k={},g={},n+1!==o){e.next=31;break}if(l.useId(y),g[u]=k[u]=w,!(this.entity.fields.length>0)){e.next=29;break}return e.next=27,this.vCall(tn,f);case 27:for(O in x=e.sent)g[O]=k[O]=x[O];case 29:e.next=54;break;case 31:for(g[u]=f[u]=w,j=s+1;j<o;j++)f[this.keyFields[j].name]=0;for(k[this.keyFields[o].name]=0,E=this.entity.fields,C=!0,N=!1,S=void 0,e.prev=38,P=E[Symbol.iterator]();!(C=(F=P.next()).done);C=!0)V=F.value,V.name,A=V.type,!0!==V.null&&(k[V.name]=B(A));e.next=46;break;case 42:e.prev=42,e.t0=e.catch(38),N=!0,S=e.t0;case 46:e.prev=46,e.prev=47,C||null==P.return||P.return();case 49:if(e.prev=49,!N){e.next=52;break}throw S;case 52:return e.finish(49);case 53:return e.finish(46);case 54:return f.arr1=[k],e.next=57,this.entity.actions.add.submit(f);case 57:(R=r.findIndex(function(e){return e.box.id===y}))<0?r.push(this.createItem(t,l,w,s,g)):void 0!==(q=this.entity.fields)&&q.length>0&&(T=r[R],r.splice(R,1),T.values=g,r.splice(R,0,T)),this.removeCeased();case 60:case"end":return e.stop()}},e,this,[[38,42,46,54],[47,,49,53]])}))},e.removeClick=function(t){return nn(Object(d.a)(Object(d.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,a,o,s,c,u,l,h,f,d,p,v,m,b,w;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.keyFields[t.keyIndex],r=n._tuid,a=this.cUsq.cTuidMain(r.Main),o=a.getLable(r),s=this.res.confirmDelete||y.a.template("do you really want to remove ${label}?"),!1!==confirm(s({label:o}))){e.next=7;break}return e.abrupt("return");case 7:for(c=this.entity,l=(u={}).arr1=[],h={},l.push(h),f=t;void 0!==f;f=f.parent)d=f.keyIndex,h[this.keyFields[d].name]=f.box.id;for(p=this.keyFields.length,v=t.keyIndex+1;v<p;v++)m=this.keyFields[v],h[m.name]=-1;return e.next=17,c.actions.del.submit(u);case 17:b=t.parent.children,(w=b.findIndex(function(e){return e===t}))>=0&&b.splice(w,1);case 20:case"end":return e.stop()}},e,this)}))},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return nn(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s,c,u,l,h,f,d,p,v,b,w,k;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.entity,n=t.keys,r=t.schemaFrom,this.isFrom=void 0!==r,a=this.entity.queries.all,e.next=5,a.query({});case 5:for(o=e.sent,s=o.ret,c=n.length,this.keyUIs=y.a.clone(this.ui.keys||[]),this.keyFields=[],u=a.returns[0].fields,l=0;l<c;l++)this.keyFields.push(u[l]),l>=this.keyUIs.length&&this.keyUIs.push({content:re});for(this.items=Object(m.k)([]),h=void 0,f=!0,d=!1,p=void 0,e.prev=17,v=s[Symbol.iterator]();!(f=(b=v.next()).done);f=!0)w=b.value,void 0!==(k=this.addItem(h,w))&&(this.items.push(k),h=k);e.next=25;break;case 21:e.prev=21,e.t0=e.catch(17),d=!0,p=e.t0;case 25:e.prev=25,e.prev=26,f||null==v.return||v.return();case 28:if(e.prev=28,!d){e.next=31;break}throw p;case 31:return e.finish(28);case 32:return e.finish(25);case 33:return e.next=35,this.showVPage(this.VMapMain);case 35:case"end":return e.stop()}},e,this,[[17,21,25,33],[26,,28,32]])}))}},{key:"createItem",value:function(e,t,n,r,i){var a=new rn(e,t,n,r);return r===this.keyFields.length-1&&(a.isLeaf=!0,a.values=i),a}},{key:"addItem",value:function(e,t){for(var n=void 0,r=this.keyFields.length,i=e,a=0;a<r;a++){var o=this.keyFields[a],s=o.name,c=o._tuid,u=t[s];if(void 0===u)break;var l=u.id;if(0!==a){var h=i,f=h.children,d=(h.box,f.length);if(d>0){var p=f[d-1];if(p.box.id===l){i=p;continue}}l>0&&f.push(i=this.createItem(i,c,u,a,t))}else{if(0===l)continue;void 0!==i&&i.box.id===l||(n=i=this.createItem(void 0,c,u,a,t))}}return n}},{key:"searchOnKey",value:function(e,t){return nn(this,void 0,void 0,i.a.mark(function n(){var r,a,o,s,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e._tuid,a=e._ownerField,o=this.cUsq.cTuidSelect(r),s=t,void 0!==a&&"object"===typeof(s=t[a.name])&&(s=s.id),n.next=6,o.call(s);case 6:return c=n.sent,n.abrupt("return",r.getIdFromObj(c));case 8:case"end":return n.stop()}},n,this)}))}},{key:"VMapMain",get:function(){return _t}}]),t}(He),on=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).isSysVisible=!1,n.view=function(){var e,t=n.controller,r=t.res,i=t.usq,a=t.error,s={render:function(e,t){return e.render()},onClick:void 0},c=[{header:r.tuid||"TUID",items:n.tuidLinks},{cn:"my-2",header:r.map||"MAP",items:n.mapLinks},{cn:"my-2",header:r.sheet||"SHEET",items:n.sheetLinks},{cn:"my-2",header:r.action||"ACTION",items:n.actionLinks},{cn:"my-2",header:r.query||"QUERY",items:n.queryLinks},{cn:"mt-2 mb-4",header:r.book||"BOOK",items:n.bookLinks},{cn:"mt-2 mb-4",header:r.history||"HISTORY",items:n.historyLinks},{cn:"mt-2 mb-4",header:r.pending||"PENDING",items:n.pendingLinks}];return e=void 0!==a?o.a.createElement("div",{className:"p-3 text-danger"},"\u8fde\u63a5\u9519\u8bef: ",a):c.map(function(e,t){var n=e.cn,r=e.header,i=e.items;return i.length>0&&o.a.createElement(v.e,{key:t,className:n,header:o.a.createElement("div",{className:"px-3 py-1 bg-light"},o.a.createElement(v.g,null,r)),items:i,item:s})}),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"px-3 py-1 small"},r.usq||i),e)};var r=e.entities,i=r.tuidArr,a=r.mapArr,c=r.sheetArr,h=r.actionArr,f=r.queryArr,d=r.bookArr,p=r.historyArr,m=r.pendingArr;return n.tuidLinks=i.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cTuidMain(e))}),n.mapLinks=a.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cMap(e))}),n.sheetLinks=c.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cSheet(e))}),n.actionLinks=h.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cAction(e))}),n.queryLinks=f.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cQuery(e))}),n.bookLinks=d.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cBook(e))}),n.historyLinks=p.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cHistory(e))}),n.pendingLinks=m.filter(function(e){return n.isVisible(e)}).map(function(e){return new z(n.controller.cPending(e))}),n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"isVisible",value:function(e){return!0!==e.sys||this.isSysVisible}},{key:"render",value:function(e){return void 0===this.view?o.a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):o.a.createElement(this.view)}}]),t}(p.m),sn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},cn=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).view=function(){return a.createElement(p.f,{header:e.label},"History")},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return sn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}}]),t}(We),un=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ln=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return un(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VHistoryMain);case 2:case"end":return e.stop()}},e,this)}))}},{key:"VHistoryMain",get:function(){return cn}}]),t}(He),hn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},fn=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).view=function(){return a.createElement(p.f,{header:e.label},"pending")},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return hn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.view);case 1:case"end":return e.stop()}},e,this)}))}}]),t}(We),dn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},pn=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return dn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showVPage(this.VPendingMain);case 2:case"end":return e.stop()}},e,this)}))}},{key:"VPendingMain",get:function(){return fn}}]),t}(He),vn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};function mn(e){if(void 0!==e)for(var t in e)e[t.toLowerCase()]=e[t]}var bn=function(e){function t(e,n,r,i,a,o){var c;Object(s.a)(this,t),(c=Object(u.a)(this,Object(l.a)(t).call(this,Object(p.r)(o.res)))).schemaLoaded=!1,c.isSysVisible=!1,c.cApp=e,c.usq=n,c.id=i,mn(o.tuid),mn(o.sheet),mn(o.map),mn(o.query),mn(o.action),mn(o.book),mn(o.history),mn(o.pending),c.ui=o,c.CTuidMain=o.CTuidMain||Jt,c.CTuidEdit=o.CTuidEdit||Xt,c.CTuidList=o.CTuidList||Zt,c.CTuidSelect=o.CTuidSelect||Gt,c.CTuidInfo=o.CTuidInfo||Yt,c.CQuery=o.CQuery||Vt,c.CQuerySelect=o.CQuerySelect||At,c.CMap=o.CMap||an,c.CAction=o.CAction||xt,c.CSheet=o.CSheet||yt,c.CBook=o.CBook||Je,c.CHistory=o.CHistory||ln,c.CPending=o.CPending||pn;var h,f,v=n.split("/");switch(v.length){case 1:h="$$$",f=v[0];break;case 2:h=v[0],f=v[1];break;default:return console.log("usq must be usqOwner/usqName format"),Object(u.a)(c)}var m,b,y=document.location.hash,w=void 0===y||""===y?"debug/":"tv/";return m=null===a||void 0===a||"*"===a?[]:a.split(";").map(function(e){return e.trim()}).filter(function(e){return e.length>0}),b="$$$/$unitx"===n?new p.j(p.o.unit):new p.k(w,h,f,m,!0),c.entities=new H(Object(d.a)(Object(d.a)(c)),b,r),c}return Object(f.a)(t,e),Object(c.a)(t,[{key:"internalStart",value:function(){return vn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}))}},{key:"loadEntites",value:function(){return vn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entities.loadAccess();case 2:case"end":return e.stop()}},e,this)}))}},{key:"loadSchema",value:function(){return vn(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!0!==this.schemaLoaded){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.loadEntites();case 5:void 0===this.id&&(this.id=this.entities.usqId),e.t0=i.a.keys(this.ui);case 7:if((e.t1=e.t0()).done){e.next=18;break}if(t=e.t1.value,void 0!==(n=this.ui[t])){e.next=12;break}return e.abrupt("continue",7);case 12:if(n.caption,void 0!==(r=n.collection)){e.next=15;break}return e.abrupt("continue",7);case 15:for(a in r)void 0===this.entities[t](a)&&console.warn(t+":'"+a+"' is not usql entity");e.next=7;break;case 18:return this.schemaLoaded=!0,e.abrupt("return");case 22:return e.prev=22,e.t2=e.catch(0),console.error(e.t2),e.abrupt("return",this.error=e.t2);case 26:case"end":return e.stop()}},e,this,[[0,22]])}))}},{key:"getQuerySearch",value:function(e){return vn(this,void 0,void 0,i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=this.entities.query(e))){t.next=5;break}alert("QUERY ".concat(e," \u6ca1\u6709\u5b9a\u4e49!")),t.next=9;break;case 5:return t.next=7,n.loadSchema();case 7:n.returns.length>1&&alert("QUERY ".concat(e," \u8fd4\u56de\u591a\u5f20\u8868, \u65e0\u6cd5\u505aQuerySearch"));case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}},t,this)}))}},{key:"getTuidPlaceHolder",value:function(e){var t=this.res,n=t.tuidPlaceHolder,r=t.entity,i=e.name;if(void 0!==r){var a=r[i];void 0!==a&&a.label}return n||"Select"}},{key:"getNone",value:function(){return this.res.none||"none"}},{key:"isVisible",value:function(e){return!0!==e.sys||this.isSysVisible}},{key:"navSheet",value:function(e,t){return vn(this,void 0,void 0,i.a.mark(function n(){var r,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=this.entities.sheetFromTypeId(e))){n.next=4;break}return alert("sheetTypeId "+e+" is not exists!"),n.abrupt("return");case 4:return a=this.cSheet(r),n.next=7,a.startSheet(t);case 7:case"end":return n.stop()}},n,this)}))}},{key:"sheet",value:function(e){return this.entities.sheet(e)}},{key:"action",value:function(e){return this.entities.action(e)}},{key:"query",value:function(e){return this.entities.query(e)}},{key:"book",value:function(e){return this.entities.book(e)}},{key:"map",value:function(e){return this.entities.map(e)}},{key:"history",value:function(e){return this.entities.history(e)}},{key:"pending",value:function(e){return this.entities.pending(e)}},{key:"tuid",value:function(e){return this.entities.tuid(e)}},{key:"tuidDiv",value:function(e,t){var n=this.entities.tuid(e);if(void 0!==n){var r=n.divs;if(void 0!==r)return r[t]}}},{key:"cSheetFromName",value:function(e){var t=this.entities.sheet(e);if(void 0!==t)return this.cSheet(t)}},{key:"cActionFromName",value:function(e){var t=this.entities.action(e);if(void 0!==t)return this.cAction(t)}},{key:"cQueryFromName",value:function(e){var t=this.entities.query(e);if(void 0!==t)return this.cQuery(t)}},{key:"cBookFromName",value:function(e){var t=this.entities.book(e);if(void 0!==t)return this.cBook(t)}},{key:"cMapFromName",value:function(e){var t=this.entities.map(e);if(void 0!==t)return this.cMap(t)}},{key:"cHistoryFromName",value:function(e){var t=this.entities.history(e);if(void 0!==t)return this.cHistory(t)}},{key:"cPendingFromName",value:function(e){var t=this.entities.pending(e);if(void 0!==t)return this.cPending(t)}},{key:"cTuidMainFromName",value:function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidMain(t)}},{key:"cTuidEditFromName",value:function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidEdit(t)}},{key:"cTuidInfoFromName",value:function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidInfo(t)}},{key:"cTuidSelectFromName",value:function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidSelect(t)}},{key:"cFromName",value:function(e,t){switch(e){case"sheet":var n=this.entities.sheet(t);if(void 0===n)return;return this.cSheet(n);case"action":var r=this.entities.action(t);if(void 0===r)return;return this.cAction(r);case"tuid":var i=this.entities.tuid(t);if(void 0===i)return;return this.cTuidMain(i);case"query":var a=this.entities.query(t);if(void 0===a)return;return this.cQuery(a);case"book":var o=this.entities.book(t);if(void 0===o)return;return this.cBook(o);case"map":var s=this.entities.map(t);if(void 0===s)return;return this.cMap(s);case"history":var c=this.entities.history(t);if(void 0===c)return;return this.cHistory(c);case"pending":var u=this.entities.pending(t);if(void 0===u)return;return this.cPending(u)}}},{key:"linkFromName",value:function(e,t){return this.link(this.cFromName(e,t))}},{key:"getUI",value:function(e){var t,n,r=e.name,i=e.typeName;if(void 0!==this.ui){var a=this.ui[i];void 0!==a&&(t=a[r])}var o=this.res.entity;return void 0!==o&&(n=o[r]),{ui:t||{},res:n||{}}}},{key:"link",value:function(e){return new z(e)}},{key:"cTuidMain",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidMain||this.CTuidMain)(this,e,n,r)}},{key:"cTuidEdit",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidEdit||this.CTuidEdit)(this,e,n,r)}},{key:"cTuidList",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidList||this.CTuidList)(this,e,n,r)}},{key:"cTuidSelect",value:function(e){var t=this.getUI(e.owner||e),n=t.ui,r=t.res;return new(n&&n.CTuidSelect||this.CTuidSelect)(this,e,n,r)}},{key:"cTuidInfo",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidInfo||this.CTuidInfo)(this,e,n,r)}},{key:"cSheet",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CSheet||this.CSheet)(this,e,n,r)}},{key:"cAction",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CAction||this.CAction)(this,e,n,r)}},{key:"cQuery",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CQuery||this.CQuery)(this,e,n,r)}},{key:"cQuerySelect",value:function(e){var t=this.entities.query(e);if(void 0!==t){var n=this.getUI(t),r=n.ui,i=n.res;return new(r&&r.CQuerySelect||this.CQuerySelect)(this,t,r,i)}}},{key:"cBook",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CBook||this.CBook)(this,e,n,r)}},{key:"cHistory",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CHistory||this.CHistory)(this,e,n,r)}},{key:"cPending",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CPending||this.CPending)(this,e,n,r)}},{key:"cMap",value:function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CMap||this.CMap)(this,e,n,r)}},{key:"getTuidContent",value:function(e){var t=e.owner;if(void 0===t){var n=this.getUI(e).ui;return n&&n.inputContent||re}var r=this.getUI(t).ui;return r&&r.divs&&r.divs[e.name].inputContent||re}},{key:"showTuid",value:function(e,t){return vn(this,void 0,void 0,i.a.mark(function n(){var r,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.owner,a=this.cTuidInfo(r||e),n.next=4,a.start(t);case 4:case"end":return n.stop()}},n,this)}))}},{key:"render",value:function(){return new this.VUsq(this).render()}},{key:"tuidLinks",get:function(){var e=this;return this.entities.tuidArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cTuidMain(t))})}},{key:"sheetLinks",get:function(){var e=this;return this.entities.sheetArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cSheet(t))})}},{key:"actionLinks",get:function(){var e=this;return this.entities.actionArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cAction(t))})}},{key:"queryLinks",get:function(){var e=this;return this.entities.queryArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cQuery(t))})}},{key:"bookLinks",get:function(){var e=this;return this.entities.bookArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cBook(t))})}},{key:"historyLinks",get:function(){var e=this;return this.entities.historyArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cHistory(t))})}},{key:"pendingLinks",get:function(){var e=this;return this.entities.pendingArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cPending(t))})}},{key:"mapLinks",get:function(){var e=this;return this.entities.mapArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cMap(t))})}},{key:"VUsq",get:function(){return on}}]),t}(p.b),yn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},wn=new(function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"userAppUnits",value:function(e){return yn(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("tie/user-app-units",{app:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(p.a))("tv/",void 0),kn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},gn=function(e){function t(e,n){var r;Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Object(p.r)(n&&n.res)))).cImportUsqs={},r.cUsqCollection={},r.renderRow=function(e,t){var n=e.id,r=e.nick,i=e.name;return a.createElement(v.d,{className:"px-3 py-2",right:"id: "+n},a.createElement("div",null,r||i))},r.onRowClick=function(e){return kn(Object(d.a)(Object(d.a)(r)),void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return p.o.unit=e.id,t.next=3,this.start();case 3:case"end":return t.stop()}},t,this)}))},r.selectUnitPage=function(){return a.createElement(p.f,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},a.createElement(v.e,{items:r.appUnits,item:{render:r.renderRow,onClick:r.onRowClick}}))};var o=e.split("/");if(2!==o.length)throw"tonvaApp name must be / separated, owner/app";return r.appOwner=o[0],r.appName=o[1],r.ui=n||{usqs:{}},r.caption=r.res.caption||"Tonva",r}return Object(f.a)(t,e),Object(c.a)(t,[{key:"startDebug",value:function(){return kn(this,void 0,void 0,i.a.mark(function e(){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.appOwner+"/"+this.appName,r=new t(n,{usqs:{}}),!0,e.next=5,r.start(!0);case 5:case"end":return e.stop()}},e,this)}))}},{key:"loadUsqs",value:function(){return kn(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s,c,u,l,h,f,d,v,m,b,y,w,k;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],p.o.unit,e.next=4,Object(p.n)(this.appOwner,this.appName);case 4:n=e.sent,r=n.id,a=n.usqs,this.id=r,o=!0,s=!1,c=void 0,e.prev=10,u=a[Symbol.iterator]();case 12:if(o=(l=u.next()).done){e.next=28;break}return h=l.value,f=h.id,d=h.usqOwner,v=h.usqName,h.url,h.urlDebug,h.ws,m=h.access,h.token,b=d+"/"+v,y=this.ui&&this.ui.usqs&&this.ui.usqs[b],w=this.newCUsq(b,f,m,y||{}),e.next=20,w.loadSchema();case 20:if(void 0===(k=e.sent)){e.next=24;break}return t.push(k),e.abrupt("continue",25);case 24:this.cUsqCollection[b]=w;case 25:o=!0,e.next=12;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(10),s=!0,c=e.t0;case 34:e.prev=34,e.prev=35,o||null==u.return||u.return();case 37:if(e.prev=37,!s){e.next=40;break}throw c;case 40:return e.finish(37);case 41:return e.finish(34);case 42:if(0!==t.length){e.next=44;break}return e.abrupt("return");case 44:return e.abrupt("return",t);case 45:case"end":return e.stop()}},e,this,[[10,30,34,42],[35,,37,41]])}))}},{key:"getImportUsq",value:function(e,t){return kn(this,void 0,void 0,i.a.mark(function n(){var r,a,o,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e+"/"+t,void 0===(a=this.cImportUsqs[r])){n.next=4;break}return n.abrupt("return",a);case 4:return o=this.ui&&this.ui.usqs&&this.ui.usqs[r],-1,this.cImportUsqs[r]=a=this.newCUsq(r,-1,void 0,o||{}),n.next=9,a.loadSchema();case 9:if(void 0===(s=n.sent)){n.next=14;break}return console.error(s),n.abrupt("return");case 14:return n.abrupt("return",a);case 15:case"end":return n.stop()}},n,this)}))}},{key:"newCUsq",value:function(e,t,n,r){var i=new(this.ui.CUsq||bn)(this,e,this.id,t,n,r);return Object.setPrototypeOf(i.x,this.x),i}},{key:"getCUsq",value:function(e){return this.cUsqCollection[e]}},{key:"beforeStart",value:function(){var e=this,n=Object.create(null,{beforeStart:{get:function(){return Object(h.a)(Object(l.a)(t.prototype),"beforeStart",e)}}});return kn(this,void 0,void 0,i.a.mark(function e(){var t,r,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.beforeStart.call(this);case 2:if(e.t0=e.sent,!1!==e.t0){e.next=5;break}return e.abrupt("return",!1);case 5:if(e.prev=5,(t=document.location.hash).startsWith("#tvdebug")?this.isProduction=!1:this.isProduction=t.startsWith("#tv"),r=p.o.unit,!1!==this.isProduction||!(void 0===r||r<=0)){e.next=30;break}return e.next=12,Object(p.n)(this.appOwner,this.appName);case 12:return o=e.sent,s=o.id,this.id=s,e.next=17,this.loadAppUnits();case 17:e.t1=this.appUnits.length,e.next=0===e.t1?20:1===e.t1?22:28;break;case 20:return this.showUnsupport(),e.abrupt("return",!1);case 22:if(!(void 0===(r=this.appUnits[0].id)||r<0)){e.next=26;break}return this.showUnsupport(),e.abrupt("return",!1);case 26:return p.o.unit=r,e.abrupt("break",30);case 28:return p.p.push(a.createElement(this.selectUnitPage,null)),e.abrupt("return",!1);case 30:return e.next=32,this.loadUsqs();case 32:if(void 0===(c=e.sent)){e.next=36;break}return this.openPage(a.createElement(p.f,{header:"ERROR"},a.createElement("div",{className:"m-3"},a.createElement("div",null,"Load Usqs \u53d1\u751f\u9519\u8bef\uff1a"),c.map(function(e,t){return a.createElement("div",{key:t},e)})))),e.abrupt("return",!1);case 36:return e.abrupt("return",!0);case 39:return e.prev=39,e.t2=e.catch(5),p.p.push(a.createElement(p.f,{header:"App start error!"},a.createElement("pre",null,"string"===typeof e.t2?e.t2:e.t2.message))),e.abrupt("return",!1);case 43:case"end":return e.stop()}},e,this,[[5,39]])}))}},{key:"internalStart",value:function(e){return kn(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!0!==e&&this.clearPrevPages(),t.next=3,this.showMainPage();case 3:case"end":return t.stop()}},t,this)}))}},{key:"load",value:function(){return kn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStart();case 2:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){return this.renderView(this.VAppMain)}},{key:"clearPrevPages",value:function(){p.p.clear()}},{key:"showUnsupport",value:function(){this.clearPrevPages(),this.openPage(a.createElement(p.f,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},a.createElement("div",{className:"m-3 text-danger container"},a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-2"},a.createElement(v.b,{name:"exclamation-triangle"})),a.createElement("div",{className:"col"},"\u7528\u6237\u4e0d\u652f\u6301APP")),a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-2"},"\u7528\u6237: "),a.createElement("div",{className:"col"},"".concat(p.p.user.name))),a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-2"},"App:"),a.createElement("div",{className:"col"},"".concat(this.appOwner,"/").concat(this.appName))))))}},{key:"showMainPage",value:function(){return kn(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=document.location.hash.split("-")).length>2)){e.next=15;break}if("sheet"!==(n=t[2])&&"sheet_debug"!==n){e.next=15;break}if(r=Number(t[3]),a=Number(t[4]),o=Number(t[5]),void 0!==(s=this.getCUsqFromId(r))){e.next=11;break}return alert("unknown usqId: "+r),e.abrupt("return");case 11:return this.clearPrevPages(),e.next=14,s.navSheet(a,o);case 14:return e.abrupt("return");case 15:this.showVPage(this.VAppMain);case 16:case"end":return e.stop()}},e,this)}))}},{key:"getCUsqFromId",value:function(e){for(var t in this.cUsqCollection){var n=this.cUsqCollection[t];if(n.id===e)return n}}},{key:"loadAppUnits",value:function(){return kn(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wn.userAppUnits(this.id);case 2:t=e.sent,this.appUnits=t,1===t.length&&(p.o.unit=t[0].id);case 5:case"end":return e.stop()}},e,this)}))}},{key:"cUsqArr",get:function(){var e=[];for(var t in this.cUsqCollection)e.push(this.cUsqCollection[t]);return e}},{key:"VAppMain",get:function(){return this.ui&&this.ui.main||xn}}]),t}(p.b),xn=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).apply(this,arguments))).appContent=function(){var t,n=e.controller.cUsqArr;return t=0===n.length?a.createElement("div",{className:"text-danger"},a.createElement(v.b,{name:""})," \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684USQ"):n.map(function(e,t){return a.createElement("div",{key:t},e.render())}),a.createElement(a.Fragment,null,t)},e}return Object(f.a)(t,e),Object(c.a)(t,[{key:"showEntry",value:function(e){return kn(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.appPage);case 1:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(e){return this.appContent()}},{key:"appPage",value:function(){var e=this.controller.caption;return a.createElement(p.f,{header:e,logout:function(){p.o.unit=void 0}},this.appContent())}}]),t}(p.l);var On=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};function jn(e){for(var t in e){var n=e[t];if(e[t.toLowerCase()]=n,"object"===typeof n&&!a.isValidElement(n))if(!0===Array.isArray(n)){var r=!0,i=!1,o=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){jn(s.value)}}catch(u){i=!0,o=u}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}}else jn(n)}}function En(e,t){return On(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return jn(t),r=new(t&&t.CApp||gn)(e,t||{usqs:{}}),n.next=4,r.start();case 4:case"end":return n.stop()}},n,this)}))}n.d(t,"b",function(){return En}),n.d(t,"a",function(){return gn}),n.d(t,"c",function(){return te})},,,,,,function(e,t,n){"use strict";n.d(t,"f",function(){return m}),n.d(t,"g",function(){return y}),n.d(t,"d",function(){return w}),n.d(t,"h",function(){return j}),n.d(t,"a",function(){return E}),n.d(t,"e",function(){return C}),n.d(t,"b",function(){return N}),n.d(t,"c",function(){return P});var r=n(2),i=n.n(r),a=n(6),o=n(8),s=n(35),c=n.n(s),u=n(45),l=n(46),h=n(36),f=n(38),d=n(43),p=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},v={};function m(){for(var e in v)v[e]=void 0}var b={},y=new(function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,[{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e}}]),e}());function w(){return self!==window.parent}function k(e){var t,n,r=e.data,i=e.source;Object(f.c)(i),t=r.hash,void 0!==(n=document.getElementById(t))&&(n.hidden=!0);var a=c.a.clone(u.j.user);a.type="init-sub-win",i.postMessage(a,"*")}function g(e){return p(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("initSubWin: set nav.user",e),u.j.user=e,t.next=4,u.j.showAppView();case 4:case"end":return t.stop()}},t,this)}))}function x(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,a,o,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=b[e])){n.next=3;break}return n.abrupt("return",{name:t,url:void 0,urlDebug:void 0,token:void 0});case 3:return a=r.unit,o=t.split("/"),n.next=7,h.k.usq({unit:a,usqOwner:o[0],usqName:o[1]});case 7:if(void 0!==(s=n.sent)){n.next=11;break}throw console.log("apiTokenApi.api return undefined. api=%s, unit=%s",t,a),"api not found";case 11:return n.abrupt("return",{name:t,url:s.url,urlDebug:s.urlDebug,token:s.token});case 12:case"end":return n.stop()}},n,this)}))}function O(e){return p(this,void 0,void 0,i.a.mark(function t(){var n,r,a,o,s,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.apiName,r=e.url,a=e.urlDebug,o=e.token,void 0!==(s=v[n])){t.next=4;break}throw"error app api return";case 4:return t.next=6,Object(d.b)(r,a);case 6:c=t.sent,console.log("onAppApiReturn(message:any): url="+r+", debug="+a+", real="+c),s.url=c,s.token=o,s.resolve(s);case 11:case"end":return t.stop()}},t,this)}))}function j(e){var t=e.split("-"),n=t.length;return y.hash=t[0].substr(3),n>0&&(y.unit=Number(t[1])),n>1&&(y.page=t[2]),n>2&&(y.param=t.slice(3)),y}function E(e,t,n,r){for(var i;;){if(i=Object(l.a)(),void 0===b[i]){b[i]={hash:i,unit:t};break}}if(e+="#tv"+i+"-"+t,void 0!==n&&(e+="-"+n,void 0!==r))for(var a=0;a<r.length;a++)e+="-"+r[a];return{url:e,hash:i}}function C(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=new h.b("tv/",void 0),a=y.unit,n.next=4,r.usqs(a,e,t);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}},n,this)}))}function N(e,t,n){return p(this,void 0,void 0,i.a.mark(function r(){var a,o,s,c,u,l=this;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===(a=v[e])){r.next=3;break}return r.abrupt("return",a);case 3:if(w()){r.next=19;break}return r.next=6,h.k.usq({unit:y.unit,usqOwner:t,usqName:n});case 6:if(void 0!==(a=r.sent)){r.next=10;break}throw"unauthorized call: usqTokenApi center return undefined!","unauthorized call: usqTokenApi center return undefined!";case 10:return void 0===a.token&&(a.token=h.f),s=(o=a).url,c=o.urlDebug,r.next=14,Object(d.b)(s,c);case 14:return u=r.sent,console.log("realUrl: %s",u),a.url=u,v[e]=a,r.abrupt("return",a);case 19:return console.log("appApi parent send: %s",y.hash),a={name:e,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},v[e]=a,r.abrupt("return",new Promise(function(t,n){a.resolve=function(e){return p(l,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e;case 2:r=n.sent,console.log("return from parent window: %s",JSON.stringify(r)),a.url=r.url,a.urlDebug=r.urlDebug,a.token=r.token,t(a);case 8:case"end":return n.stop()}},n,this)}))},a.reject=n,(window.opener||window.parent).postMessage({type:"app-api",apiName:e,hash:y.hash},"*")}));case 23:case"end":return r.stop()}},r,this)}))}window.addEventListener("message",function(e){return p(this,void 0,void 0,i.a.mark(function t(){var n,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data,t.t0=n.type,t.next="sub-frame-started"===t.t0?4:"ws"===t.t0?6:"init-sub-win"===t.t0?9:"pop-app"===t.t0?12:"center-api"===t.t0?14:"center-api-return"===t.t0?17:"app-api"===t.t0?19:"app-api-return"===t.t0?26:31;break;case 4:return k(e),t.abrupt("break",33);case 6:return t.next=8,u.j.onReceive(n.msg);case 8:return t.abrupt("break",33);case 9:return t.next=11,g(n);case 11:return t.abrupt("break",33);case 12:return u.j.navBack(),t.abrupt("break",33);case 14:return t.next=16,F(e.source,n);case 16:return t.abrupt("break",33);case 17:return V(n),t.abrupt("break",33);case 19:return console.log("receive PostMessage: %s",JSON.stringify(n)),t.next=22,x(n.hash,n.apiName);case 22:return r=t.sent,console.log("onReceiveAppApiMessage: %s",JSON.stringify(r)),e.source.postMessage({type:"app-api-return",apiName:n.apiName,url:r.url,urlDebug:r.urlDebug,token:r.token},"*"),t.abrupt("break",33);case 26:return console.log("app-api-return: %s",JSON.stringify(n)),console.log("await onAppApiReturn(message);"),t.next=30,O(n);case 30:return t.abrupt("break",33);case 31:return this.console.log("message: %s",JSON.stringify(n)),t.abrupt("break",33);case 33:case"end":return t.stop()}},t,this)}))});var S={};function P(e,t,n){return p(this,void 0,void 0,i.a.mark(function r(){var a=this;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",e,t),r.next=3,new Promise(function(r,o){return p(a,void 0,void 0,i.a.mark(function a(){var s;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(s=Object(l.a)(),void 0!==S[s]){i.next=5;break}return S[s]={id:s,resolve:r,reject:o},i.abrupt("break",7);case 5:i.next=0;break;case 7:(window.opener||window.parent).postMessage({type:"center-api",callId:s,url:e,method:t,body:n},"*");case 8:case"end":return i.stop()}},a,this)}))});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},r,this)}))}function F(e,t){return p(this,void 0,void 0,i.a.mark(function n(){var r,a,o,s,c;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.callId,a=t.url,o=t.method,s=t.body,n.next=3,h.e.directCall(a,o,s);case 3:c=n.sent,e.postMessage({type:"center-api-return",callId:r,result:c},"*");case 5:case"end":return n.stop()}},n,this)}))}function V(e){var t=e.callId,n=e.result,r=S[t];void 0!==r&&(S[t]=void 0,r.resolve(n))}},,function(e,t,n){"use strict";var r=n(38),i=n(43),a=n(2),o=n.n(a),s=n(6),c=n(8),u=n(9),l=n(7),h=n(10),f=n(47),d=n(36),p=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},v=new(function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"guest",value:function(){return p(this,void 0,void 0,o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("",{});case 2:t=e.sent,e.t0=typeof t,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(f.b)(t));case 8:return n=Object(f.b)(t.token),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}))}},{key:"unitFromName",value:function(e){return p(this,void 0,void 0,o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get(e);case 2:return n=t.sent,t.abrupt("return",n&&n.unit);case 4:case"end":return t.stop()}},t,this)}))}}]),t}(d.a))("tv/guest/",void 0),m=n(32),b=n(49);n(50);n.d(t,"d",function(){return r.a}),n.d(t,"k",function(){return r.b}),n.d(t,"l",function(){return i.c}),n.d(t,"g",function(){return v}),n.d(t,"i",function(){return d.h}),n.d(t,"c",function(){return d.d}),n.d(t,"b",function(){return d.c}),n.d(t,"n",function(){return d.j}),n.d(t,"f",function(){return d.g}),n.d(t,"m",function(){return d.i}),n.d(t,"a",function(){return d.a}),n.d(t,"j",function(){return m.g}),n.d(t,"h",function(){return m.e}),n.d(t,"e",function(){return b.a})},,function(e,t,n){"use strict";var r=n(2),i=n.n(r),a=n(6),o=n(8),s=n(9),c=n(7),u=n(10),l=n(35),h=n(50),f=n(24),d=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,[{key:"startWait",value:function(){f.c.startWait()}},{key:"endWait",value:function(){f.c.endWait()}},{key:"showError",value:function(e){return d(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f.c.endWait(),t.next=3,f.c.onError(e);case 3:case"end":return t.stop()}},t,this)}))}}]),e}(),v=n(32),m=n(43);n.d(t,"h",function(){return k}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return j}),n.d(t,"j",function(){return E}),n.d(t,"g",function(){return C}),n.d(t,"f",function(){return P}),n.d(t,"i",function(){return F}),n.d(t,"a",function(){return V}),n.d(t,"k",function(){return A}),n.d(t,"e",function(){return R}),n.d(t,"b",function(){return q});var b=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},y={},w={};function k(){y={},w={},x={}}var g=function(e){function t(e,n,r,i,o){var u;return Object(a.a)(this,t),u=Object(s.a)(this,Object(c.a)(t).call(this,e,o)),r&&(u.usqOwner=n,u.usqName=r,u.usq=n+"/"+r),u.access=i,u.showWaiting=o,u}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.showWaiting||void 0===this.showWaiting?(t=y,n=new p):t=w,void 0===(r=t[this.usq])){e.next=4;break}return e.abrupt("return",r);case 4:return e.next=6,Object(v.b)(this.usq,this.usqOwner,this.usqName);case 6:return a=e.sent,this.token=a.token,r=new h.a(!1,a.url,a.token,n),e.abrupt("return",t[this.usq]=r);case 10:case"end":return e.stop()}},e,this)}))}},{key:"update",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("update");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}},{key:"loadAccess",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===this.access?"":this.access.join("|"),e.next=3,this.get("access",{acc:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}))}},{key:"loadEntities",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("entities");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}},{key:"schema",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("schema/"+e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"schemas",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.post("schema",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"tuidGet",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("tuid/"+e+"/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"tuidGetAll",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("tuid-all/"+e+"/");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"tuidSave",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("tuid/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"tuidSearch",value:function(e,t,n,r,a,o){return b(this,void 0,void 0,i.a.mark(function s(){var c;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuids/"+e,{arr:t,owner:n,key:r,pageStart:a,pageSize:o});case 2:return c=i.sent,i.abrupt("return",c);case 4:case"end":return i.stop()}},s,this)}))}},{key:"tuidArrGet",value:function(e,t,n,r){return b(this,void 0,void 0,i.a.mark(function a(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get("tuid-arr/"+e+"/"+n+"/"+t+"/"+r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a,this)}))}},{key:"tuidArrGetAll",value:function(e,t,n){return b(this,void 0,void 0,i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get("tuid-arr-all/"+e+"/"+n+"/"+t+"/");case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"tuidArrSave",value:function(e,t,n,r){return b(this,void 0,void 0,i.a.mark(function a(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuid-arr/"+e+"/"+n+"/"+t+"/",r);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},a,this)}))}},{key:"tuidArrPos",value:function(e,t,n,r,a){return b(this,void 0,void 0,i.a.mark(function o(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post("tuid-arr-pos/"+e+"/"+n+"/"+t+"/",{id:r,$order:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},o,this)}))}},{key:"tuidIds",value:function(e,t,n){return b(this,void 0,void 0,i.a.mark(function r(){var a,o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,a="tuidids/"+e+"/",a+=void 0!==t?t:"$",r.next=5,this.post(a,n);case 5:return o=r.sent,r.abrupt("return",o);case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}},r,this,[[0,9]])}))}},{key:"proxied",value:function(e,t,n){return b(this,void 0,void 0,i.a.mark(function r(){var a,o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,a="tuid-proxy/"+e+"/"+t+"/"+n,r.next=4,this.get(a);case 4:return o=r.sent,r.abrupt("return",o);case 8:r.prev=8,r.t0=r.catch(0),console.error(r.t0);case 11:case"end":return r.stop()}},r,this,[[0,8]])}))}},{key:"sheetSave",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetAction",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.put("sheet/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"stateSheets",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e+"/states",t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"stateSheetCount",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("sheet/"+e+"/statecount");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"getSheet",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("sheet/"+e+"/get/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetArchives",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("sheet/"+e+"/archives",t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"sheetArchive",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.get("sheet/"+e+"/archive/"+t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"action",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("action/"+e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"page",value:function(e,t,n,r){return b(this,void 0,void 0,i.a.mark(function a(){var o;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=typeof r,i.next="undefined"===i.t0?3:5;break;case 3:return o={key:""},i.abrupt("break",7);case 5:return o=l.clone(r),i.abrupt("break",7);case 7:return o.$pageStart=t,o.$pageSize=n,i.next=11,this.post("query-page/"+e,o);case 11:return i.abrupt("return",i.sent);case 12:case"end":return i.stop()}},a,this)}))}},{key:"query",value:function(e,t){return b(this,void 0,void 0,i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post("query/"+e,t);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}},n,this)}))}},{key:"user",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))}}]),t}(m.a),x={};var O,j=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,"tv/",void 0,void 0,void 0,!0))).unitId=e,n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=x[this.unitId])){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,this.buildChannel();case 5:return e.abrupt("return",x[this.unitId]=e.sent);case 6:case"end":return e.stop()}},e,this)}))}},{key:"buildChannel",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p,n=new q("tv/",void 0),e.next=4,n.unitxUsq(this.unitId);case 4:return r=e.sent,a=r.token,o=r.url,s=r.urlDebug,e.next=8,Object(m.b)(o,s);case 8:return c=e.sent,this.token=a,e.abrupt("return",new h.a(!1,c,a,t));case 11:case"end":return e.stop()}},e,this)}))}}]),t}(g);function E(e){console.log("setCenterUrl %s",e),O=e,P=void 0,S=void 0,N=void 0}function C(){return O}var N,S,P=void 0;function F(e){P=e,console.log("setCenterToken %s",e),S=void 0,N=void 0}var V=function(e){function t(e,n){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,e,n))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getHttpChannel",value:function(){return b(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0===this.showWaiting||void 0===this.showWaiting?void 0!==N?N:N=new h.a(!0,O,P,new p):void 0!==S?S:S=new h.a(!0,O,P));case 1:case"end":return e.stop()}},e,this)}))}}]),t}(m.a),A=new(function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"usq",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("app-usq",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(V))("tv/tie/",void 0),R=new(function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"directCall",value:function(e,t,n){return this.call(e,t,n)}}]),t}(V))("",void 0);console.log("CenterApi"),console.log(V);var q=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"usqs",value:function(e,t,n){return b(this,void 0,void 0,i.a.mark(function r(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.get("tie/app-usqs",{unit:e,appOwner:t,appName:n});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"unitxUsq",value:function(e){return b(this,void 0,void 0,i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.get("tie/unitx-usq",{unit:e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),t}(V)},,function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"d",function(){return b}),n.d(t,"a",function(){return y});var r,i=n(9),a=n(7),o=n(10),s=n(2),c=n.n(s),u=n(6),l=n(8),h=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};function f(e){void 0!==r&&r.postMessage({type:"ws",msg:e},"*")}function d(e){r=e}function p(e){window.top.postMessage({type:"ws",msg:e},"*")}var v=function(){function e(){Object(u.a)(this,e),this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return Object(l.a)(e,[{key:"onWsReceiveAny",value:function(e){var t=this.handlerSeed++;return this.anyHandlers[t]=e,t}},{key:"onWsReceive",value:function(e,t){var n=this.handlerSeed++;return this.msgHandlers[n]={type:e,handler:t},n}},{key:"endWsReceive",value:function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}},{key:"receive",value:function(e){return h(this,void 0,void 0,c.a.mark(function t(){var n,r,i,a,o,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.$type,t.t0=c.a.keys(this.anyHandlers);case 2:if((t.t1=t.t0()).done){t.next=8;break}return r=t.t1.value,t.next=6,this.anyHandlers[r](e);case 6:t.next=2;break;case 8:t.t2=c.a.keys(this.msgHandlers);case 9:if((t.t3=t.t2()).done){t.next=18;break}if(i=t.t3.value,a=this.msgHandlers[i],o=a.type,s=a.handler,o===n){t.next=14;break}return t.abrupt("continue",9);case 14:return t.next=16,s(e);case 16:t.next=9;break;case 18:case"end":return t.stop()}},t,this)}))}}]),e}(),m=1,b=new(function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(i.a)(this,Object(a.a)(t).apply(this,arguments))).wsBaseId="WsBridge seed "+m++,e}return Object(o.a)(t,e),t}(v)),y=function(e){function t(e,n){var r;return Object(u.a)(this,t),(r=Object(i.a)(this,Object(a.a)(t).call(this))).wsBaseId="WSChannel seed "+m++,r.wsHost=e,r.token=n,r}return Object(o.a)(t,e),Object(l.a)(t,[{key:"connect",value:function(){var e=this;if(void 0===this.ws){var n=this;return new Promise(function(r,i){var a=new WebSocket(e.wsHost,e.token||t.centerToken);console.log("connect webSocket %s",e.wsHost),a.onopen=function(t){console.log("webSocket connected %s",e.wsHost),n.ws=a,r()},a.onerror=function(e){i("webSocket can't open!")},a.onmessage=function(t){return h(e,void 0,void 0,c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.wsMessage(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))},a.onclose=function(e){n.ws=void 0,console.log("webSocket closed!")}})}}},{key:"close",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}},{key:"wsMessage",value:function(e){return h(this,void 0,void 0,c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("websocket message: %s",e.data),f(n=JSON.parse(e.data)),t.next=6,this.receive(n);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("ws msg error: ",t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))}},{key:"sendWs",value:function(e){var t=this;this.connect().then(function(){t.ws.send(e)})}}],[{key:"setCenterToken",value:function(e){t.centerToken=e}}]),t}(v)},,,function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var r=n(6),i=n(8),a=!1,o=function(){function e(t){Object(r.a)(this,e),this.name=t}return Object(i.a)(e,[{key:"get",value:function(){if(void 0!==this.value)return this.value;var e=localStorage.getItem(this.name);return this.value=null===e?void 0:JSON.parse(e)}},{key:"set",value:function(e){e?(this.value=e,localStorage.setItem(this.name,JSON.stringify(e))):this.clear()}},{key:"clear",value:function(){this.value=void 0,localStorage.removeItem(this.name)}}]),e}(),s=function(){function e(){Object(r.a)(this,e),this.user=new o("user"),this.guest=new o("guest"),this.unit=new o("unit"),this.homeTabCur=new o("homeTabCur")}return Object(i.a)(e,[{key:"logoutClear",value:function(){[this.user,this.homeTabCur].map(function(e){return e.clear()})}}]),e}()},,function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return p});var r=n(6),i=n(8),a=n(2),o=n.n(a),s=n(41),c=n(49),u=n(63),l=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};function h(e,t,n,r,i){return l(this,void 0,void 0,o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.fetch(t,n,r,i);case 2:case"end":return a.stop()}},a,this)}))}var f=function(){function e(t,n){Object(r.a)(this,e),this.path=t||"",this.showWaiting=n}return Object(i.a)(e,[{key:"call",value:function(e,t,n){return l(this,void 0,void 0,o.a.mark(function r(){var i;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getHttpChannel();case 2:return i=r.sent,r.next=5,i.callFetch(e,t,n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,this)}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.get(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"post",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.post(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"put",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.put(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"delete",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getHttpChannel();case 2:return r=n.sent,n.next=5,r.delete(this.path+e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}}]),e}();function d(e,t,n,r){if(e.indexOf(t)>0){var i=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"})[r]||n;e=e.replace(t,"://"+i+"/")}return e}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hello";return l(this,void 0,void 0,o.a.mark(function r(){var i,a,l,h;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!0===s.b){r.next=2;break}return r.abrupt("return",e);case 2:if(t){r.next=4;break}return r.abrupt("return",e);case 4:return r.prev=4,i=t,!1===t.endsWith("/")&&(t+="/"),t=d(t,"://centerhost/",c.a,"REACT_APP_CENTER_DEBUG_HOST"),t=d(t,"://usqhost/",c.c,"REACT_APP_USQ_DEBUG_HOST"),t=d(t,"://unitxhost/",c.c,"REACT_APP_USQ_DEBUG_HOST"),t=d(t,"://usql-server/",c.b,"REACT_APP_DEBUG_USQL_SERVER"),void 0===n&&(n=""),a=t+n,console.log("urlDebug: "+i+" ---- "+t+" === "+a),l={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},r.next=17,Object(u.a)(a,l);case 17:return h=r.sent,r.next=20,h.text();case 20:return r.sent,r.abrupt("return",t);case 24:return r.prev=24,r.t0=r.catch(4),console.log("cannot connect %s, so use %s",t,e),console.error(r.t0),r.abrupt("return",e);case 29:case"end":return r.stop()}},r,this,[[4,24]])}))}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});const r={usqOrder:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/order",usqProduct:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/product",usqCommon:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/common",usqWebUser:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/webuser",usqCustomer:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customer",usqCustomerDiscount:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customerDiscount",usqWarehouse:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/warehouse",usqMember:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/member",appIcon:"http://101.200.46.56/imgs/Bear-icon.png"}},function(e,t,n){"use strict";var r=n(24),i=(n(55),n(52)),a=n(11),o=n(6),s=n(8),c=n(9),u=n(7),l=n(10),h=n(23),f=n.n(h),d=(a.Component,a.Component,n(2)),p=n.n(d),v=n(41),m=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},b=function(){function e(t){var n=this;Object(o.a)(this,e),this.isDev=v.b,this.onMessageReceive=function(e){return m(n,void 0,void 0,p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onMessage(e);case 2:case"end":return t.stop()}},t,this)}))},this.res=t||{},this.x=this.res.x||{}}return Object(s.a)(e,[{key:"dispose",value:function(){r.c.unregisterReceiveHandler(this.receiveHandlerId),this.onDispose()}},{key:"onDispose",value:function(){}},{key:"showVPage",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new e(this).showEntry(t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"renderView",value:function(e,t){return new e(this).render(t)}},{key:"event",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.onEvent(e,t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"onEvent",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}))}},{key:"msg",value:function(e){alert(e)}},{key:"errorPage",value:function(e,t){this.openPage(a.createElement(i.a,{header:"App error!"},a.createElement("pre",null,"string"===typeof t?t:t.message)))}},{key:"onMessage",value:function(e){}},{key:"beforeStart",value:function(){return m(this,void 0,void 0,p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.registerReceiveHandler(),e.abrupt("return",!0);case 2:case"end":return e.stop()}},e,this)}))}},{key:"registerReceiveHandler",value:function(){this.receiveHandlerId=r.c.registerReceiveHandler(this.onMessageReceive)}},{key:"start",value:function(e){return m(this,void 0,void 0,p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.disposer=this.dispose.bind(this),t.next=3,this.beforeStart();case 3:if(!1!==t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,this.internalStart(e);case 8:case"end":return t.stop()}},t,this)}))}},{key:"call",value:function(e){return m(this,void 0,void 0,p.a.mark(function t(){var n=this;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===this._resolve_$&&(this._resolve_$=[]),t.abrupt("return",new Promise(function(t,r){return m(n,void 0,void 0,p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._resolve_$.push(t),n.next=3,this.start(e);case 3:case"end":return n.stop()}},n,this)}))}));case 2:case"end":return t.stop()}},t,this)}))}},{key:"vCall",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function n(){var r=this;return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===this._resolve_$&&(this._resolve_$=[]),n.abrupt("return",new Promise(function(n,i){return m(r,void 0,void 0,p.a.mark(function r(){return p.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this._resolve_$.push(n),r.next=3,new e(this).showEntry(t);case 3:case"end":return r.stop()}},r,this)}))}));case 2:case"end":return n.stop()}},n,this)}))}},{key:"returnCall",value:function(e){if(void 0!==this._resolve_$){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Coordinator call already returned, or not called")}}},{key:"openPage",value:function(e){r.c.push(e,this.disposer),this.disposer=void 0}},{key:"replacePage",value:function(e){r.c.replace(e,this.disposer),this.disposer=void 0}},{key:"backPage",value:function(){r.c.back()}},{key:"closePage",value:function(e){r.c.pop(e)}},{key:"ceasePage",value:function(e){r.c.ceaseTop(e)}},{key:"removeCeased",value:function(){r.c.removeCeased()}},{key:"regConfirmClose",value:function(e){r.c.regConfirmClose(e)}},{key:"user",get:function(){return r.c.user}},{key:"isLogined",get:function(){var e=r.c.user;return void 0!==e&&e.id>0}},{key:"isCalling",get:function(){return void 0!==this._resolve_$}}]),e}(),y=function(){function e(t){Object(o.a)(this,e),this.controller=t,this.res=t.res,this.x=t.x}return Object(s.a)(e,[{key:"renderVm",value:function(e,t){return new e(this.controller).render(t)}},{key:"showVPage",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new e(this.controller).showEntry(t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"event",value:function(e,t){return m(this,void 0,void 0,p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.controller.event(e,t);case 2:case"end":return n.stop()}},n,this)}))}},{key:"returnCall",value:function(e){this.controller.returnCall(e)}},{key:"openPage",value:function(e,t){this.controller.openPage(a.createElement(e,t))}},{key:"replacePage",value:function(e,t){this.controller.replacePage(a.createElement(e,t))}},{key:"openPageElement",value:function(e){this.controller.openPage(e)}},{key:"replacePageElement",value:function(e){this.controller.replacePage(e)}},{key:"backPage",value:function(){this.controller.backPage()}},{key:"closePage",value:function(e){this.controller.closePage(e)}},{key:"ceasePage",value:function(e){this.controller.ceasePage(e)}},{key:"removeCeased",value:function(){this.controller.removeCeased()}},{key:"regConfirmClose",value:function(e){this.controller.regConfirmClose(e)}},{key:"isDev",get:function(){return v.b}}]),e}(),w=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(e){return null}}]),t}(y),k=n(13),g=n(18),x=n(37),O=n(27),j=n(21),E=n(35),C=n.n(E),N=function e(){Object(o.a)(this,e)},S=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this))).func=e,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"check",value:function(e,t){var n=this.func(t);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void e.push(n);default:return void e.push.apply(e,Object(O.a)(n))}}}]),t}(N),P=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this))).res=e,n}return Object(l.a)(t,e),t}(N),F=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"check",value:function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push(this.res.required)}}]),t}(P),V=function(e){function t(e,n,r){var i;return Object(o.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e))).minMsg=C.a.template(e.min),i.maxMsg=C.a.template(e.max),i.min=n,i.max=r,i}return Object(l.a)(t,e),Object(s.a)(t,[{key:"check",value:function(e,t){if(void 0!==t&&null!==t){var n=Number(t);NaN===n?e.push(this.res.number):this.checkMore(e,n)}}},{key:"checkMore",value:function(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))}}]),t}(P),A=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"checkMore",value:function(e,n){Object(j.a)(Object(u.a)(t.prototype),"checkMore",this).call(this,e,n),!1===Number.isInteger(n)&&e.push(this.res.integer)}}]),t}(V),R=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},q=function(){function e(t,n,r,i){var a=this;Object(o.a)(this,e),this.errors=[],this.contextErrors=[],this.onChange=function(e){var t,n,r=a.value;void 0!==a.ui&&(t=a.ui.onChanging,n=a.ui.onChanged);var i=!0;void 0!==t&&(a.isChanging=!0,i=t(a.context,a.value,r),a.isChanging=!1),!0===i&&(a.setDataValue(e.currentTarget.value),void 0!==n&&(a.isChanging=!0,n(a.context,a.value,r),a.isChanging=!1))},this.context=t;var s=n.name;if(this.name=s,this.itemSchema=n,this.fieldProps=r,this.children=i,this.ui=t.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var c=this.ui,u=c.readOnly,l=c.disabled,h=c.visible;this.readOnly=!0===u,this.disabled=!0===l,this.visible=!(!1===h)}this.value=this.defaultValue=t.getValue(s),this.init()}return Object(s.a)(e,[{key:"init",value:function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new F(this.context.form.res)),this.buildRules(),void 0!==this.ui){var e=this.ui.rules;if(void 0!==e)if(!1!==Array.isArray(e)){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.rules.push(new S(o))}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}else this.rules.push(new S(e))}}},{key:"buildRules",value:function(){}},{key:"checkRules",value:function(){var e,t=[],n=!0,r=!1,i=void 0;try{for(var a,o=this.rules[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.check(t,this.value)}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}0===t.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(e=this.errors).push.apply(e,t))}},{key:"setError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.errors.push(e):(t=this.errors).push.apply(t,Object(O.a)(e)))}},{key:"setContextError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.contextErrors.push(e):(t=this.contextErrors).push.apply(t,Object(O.a)(e)))}},{key:"clearError",value:function(){this.errors.splice(0)}},{key:"clearContextError",value:function(){this.contextErrors.splice(0)}},{key:"parse",value:function(e){return e}},{key:"setElementValue",value:function(e){}},{key:"setDataValue",value:function(e){!0!==this.isChanging&&(this.context.data[this.name]=this.value=this.parse(e))}},{key:"setValue",value:function(e){!0!==this.isChanging&&(this.setDataValue(e),this.setElementValue(e))}},{key:"getValue",value:function(){return this.context.getValue(this.name)}},{key:"getReadOnly",value:function(){return this.readOnly}},{key:"getDisabled",value:function(){return this.disabled}},{key:"getVisible",value:function(){return this.visible}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setVisible",value:function(e){this.visible=e}},{key:"renderContainer",value:function(){if(!1===this.visible)return null;var e,t=this.context,n=t.form;if(!0===t.inNode)return this.render();if(void 0===this.ui)e=this.name;else{var r=this.ui.label;null===r&&(e=null),e=r||this.name}return!0===this.itemSchema.required&&!1!==n.props.requiredFlag&&null!==e&&(e=a.createElement(a.Fragment,null,e,"\xa0",a.createElement("span",{className:"text-danger"},"*"))),n.FieldContainer(e,this.render())}},{key:"renderTemplet",value:function(){if(void 0!==this.children)return a.createElement(a.Fragment,null,this.children);if(void 0!==this.ui){var e=this.ui.Templet;return"function"===typeof e?e(this.context,this.name,this.value):e}}},{key:"renderErrors",value:function(){var e=[].concat(Object(O.a)(this.errors),Object(O.a)(this.contextErrors));if(0===e.length)return null;var t=!0===this.context.inNode?"span":"div";return e.map(function(e){return a.createElement(t,{key:e,className:"text-danger d-inline-block my-2 ml-3"},a.createElement(a.Fragment,null,a.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e))})}},{key:"hasError",get:function(){return this.errors.length+this.contextErrors.length>0}},{key:"isOk",get:function(){return 0===this.errors.length}},{key:"className",get:function(){var e;return!1===this.context.inNode&&(e="form-control"),f()(e,this.context.form.FieldClass,this.ui&&this.ui.className)}}]),e}();R([g.k],q.prototype,"errors",void 0),R([g.k],q.prototype,"contextErrors",void 0),R([g.d],q.prototype,"hasError",null),R([g.k],q.prototype,"visible",void 0),R([g.d],q.prototype,"isOk",null);var T=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="text",e.onBlur=function(){e.checkRules(),e.context.checkContextRules()},e.onFocus=function(){e.clearError(),e.context.removeErrorWidget(Object(k.a)(Object(k.a)(e))),e.context.removeErrors()},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setElementValue",value:function(e){this.input.value=e}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,a.createElement(a.Fragment,null,a.createElement("input",{ref:function(t){return e.input=t},className:f()(this.className,n),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onChange,placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,maxLength:this.itemSchema.maxLength}),this.renderErrors())}},{key:"placeholder",get:function(){return this.ui&&this.ui.placeholder||this.name}}]),t}(q),I=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).onChange=function(t){e.setValue(t.currentTarget.value)},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setElementValue",value:function(e){this.input.value=e}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this;return a.createElement("textarea",{ref:function(t){return e.input=t},rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onChange})}}]),t}(q),D=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="password",e}return Object(l.a)(t,e),t}(T),U=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="url",e}return Object(l.a)(t,e),t}(T),M=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="email",e}return Object(l.a)(t,e),t}(T),L=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="number",e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"buildRules",value:function(){Object(j.a)(Object(u.a)(t.prototype),"buildRules",this).call(this);var e=this.context.form.res,n=this.itemSchema,r=n.min,i=n.max;this.rules.push("integer"===this.itemSchema.type?new V(e,r,i):new A(e,r,i))}},{key:"parse",value:function(e){if(void 0!==e&&null!==e)return Number(e)}}]),t}(T),B=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="number",e.onKeyDown=function(e){var t=e.keyCode;event.returnValue=46===t||8===t||37===t||39===t||t>=48&&t<=57||t>=96&&t<=105||109===t||189===t},e}return Object(l.a)(t,e),t}(L),H=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="date",e}return Object(l.a)(t,e),t}(T),W=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="datetime",e}return Object(l.a)(t,e),t}(T),K=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="time",e}return Object(l.a)(t,e),t}(T),Q=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="month",e}return Object(l.a)(t,e),t}(T),z=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).onChange=function(t){e.setDataValue(!0===t.target.checked?e.trueValue:e.falseValue)},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"init",value:function(){if(Object(j.a)(Object(u.a)(t.prototype),"init",this).call(this),void 0!==this.ui){var e=this.ui,n=e.trueValue,r=e.falseValue;this.trueValue=void 0===n||n,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1}},{key:"setElementValue",value:function(e){this.input.checked=e===this.trueValue}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=f()(this.className,"form-check-inline"),n=a.createElement("input",{ref:function(t){return e.input=t},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onChange});return this.context.inNode?a.createElement("label",{className:t},n," ",this.ui&&this.ui.label||this.name):a.createElement("div",{className:t},n)}}]),t}(q),J=1,X=function e(t,n,r){Object(o.a)(this,e),this.key=J++,this.form=t,this.arrSchema=n;var i=t.uiSchema;void 0!==i&&(this.uiArr=i.items[n.name]),this.data=r},Z=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},G=function(){function e(t,n,r,i){var s=this;if(Object(o.a)(this,e),this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(x.a)(function(){var e=s.errors;return 0===e.length?null:a.createElement(a.Fragment,null,e.map(function(e){return a.createElement("span",{key:e,className:"text-danger inline-block my-1 ml-3"},a.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)}))}),this.form=t,this.uiSchema=n,this.data=r,this.inNode=i,void 0!==n){var c,u=n.rules;if(void 0!==u)this.rules=[],!1===Array.isArray(u)?this.rules.push(u):(c=this.rules).push.apply(c,Object(O.a)(u))}}return Object(s.a)(e,[{key:"getValue",value:function(e){return this.data[e]}},{key:"setValue",value:function(e,t){this.data[e]=t;var n=this.widgets[e];void 0!==n&&n.setValue(t)}},{key:"getDisabled",value:function(e){var t=this.widgets[e];if(void 0!==t)return t.getDisabled()}},{key:"setDisabled",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setDisabled(t)}},{key:"getReadOnly",value:function(e){var t=this.widgets[e];void 0!==t&&t.getReadOnly()}},{key:"setReadOnly",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setReadOnly(t)}},{key:"getVisible",value:function(e){var t=this.widgets[e];void 0!==t&&t.getVisible()}},{key:"setVisible",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setVisible(t)}},{key:"checkFieldRules",value:function(){for(var e in this.widgets)this.widgets[e].checkRules()}},{key:"checkContextRules",value:function(){if(void 0!==this.rules){this.clearContextErrors();var e=!0,t=!1,n=void 0;try{for(var r,i=this.rules[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a,o=(0,r.value)(this);if(void 0!==o)if(!0===Array.isArray(o))(a=this.errors).push.apply(a,Object(O.a)(o));else if("string"===typeof o)this.errors.push(o);else for(var s in o)this.setError(s,o[s])}}catch(c){t=!0,n=c}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}},{key:"setError",value:function(e,t){var n=this.widgets[e];void 0!==n&&(n.setContextError(t),this.addErrorWidget(n))}},{key:"clearContextErrors",value:function(){for(var e in this.widgets)this.widgets[e].clearContextError()}},{key:"checkRules",value:function(){this.checkFieldRules(),this.checkContextRules()}},{key:"addErrorWidget",value:function(e){this.errorWidgets.findIndex(function(t){return t===e})<0&&this.errorWidgets.push(e)}},{key:"removeErrorWidget",value:function(e){var t=this.errorWidgets.findIndex(function(t){return t===e});t>=0&&this.errorWidgets.splice(t,1)}},{key:"checkHasError",value:function(){return this.errorWidgets.length+this.errors.length>0}},{key:"removeErrors",value:function(){for(var e in this.errors.splice(0),this.errorWidgets.splice(0),this.widgets){var t=this.widgets[e];void 0!==t&&t.clearContextError()}}},{key:"arrName",get:function(){}},{key:"hasError",get:function(){return this.checkHasError()}}]),e}();Z([g.k],G.prototype,"errors",void 0),Z([g.k],G.prototype,"errorWidgets",void 0),Z([g.d],G.prototype,"hasError",null);var Y=function(e){function t(e,n,r,i,a){var s,l;Object(o.a)(this,t);var h=e.form.uiSchema;if(void 0!==h){var f=h.items;void 0!==f&&(l=f[n.name])}return(s=Object(c.a)(this,Object(u.a)(t).call(this,e.form,l,r,i))).formContext=e,s.arrSchema=n,s.row=a,s}return Object(l.a)(t,e),Object(s.a)(t,[{key:"getItemSchema",value:function(e){return this.arrSchema.itemSchemas[e]}},{key:"getUiItem",value:function(e){if(void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)return t[e]}}},{key:"isRow",get:function(){return!0}},{key:"arrName",get:function(){return this.arrSchema.name}}]),t}(G),$=function(e){function t(e,n){var r;return Object(o.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e,e.uiSchema,e.data,n))).rowContexts={},r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"getItemSchema",value:function(e){return this.form.itemSchemas[e]}},{key:"getUiItem",value:function(e){var t=this.form.uiSchema;if(void 0!==t){var n=t.items;if(void 0!==n)return n[e]}}},{key:"checkFieldRules",value:function(){for(var e in Object(j.a)(Object(u.a)(t.prototype),"checkFieldRules",this).call(this),this.rowContexts){var n=this.rowContexts[e];for(var r in n)n[r].checkFieldRules()}}},{key:"checkContextRules",value:function(){for(var e in Object(j.a)(Object(u.a)(t.prototype),"checkContextRules",this).call(this),this.rowContexts){var n=this.rowContexts[e];for(var r in n){var i=n[r];i.removeErrors(),i.checkContextRules()}}}},{key:"isRow",get:function(){return!1}},{key:"hasError",get:function(){if(!0===Object(j.a)(Object(u.a)(t.prototype),"checkHasError",this).call(this))return!0;for(var e in this.rowContexts){var n=this.rowContexts[e];for(var r in n)if(!0===n[r].hasError)return!0}return!1}}]),t}(G);Z([g.d],$.prototype,"hasError",null);var _=a.createContext({}),ee=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},te=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).onChange=function(t){e.setDataValue(t.target.value)},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setElementValue",value:function(e){this.select.value=e}},{key:"setReadOnly",value:function(e){this.select.disabled=this.readOnly=!e}},{key:"setDisabled",value:function(e){this.select.disabled=this.disabled=e}},{key:"render",value:function(){var e=this;if(!0===this.readOnly){var t=this.ui.list.find(function(t){return t.value===e.value}),n=void 0===t?"(???)":t.title;return a.createElement("span",{className:"form-control w-min-6c"},n)}return a.createElement("select",{ref:function(t){return e.select=t},className:f()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onChange},this.ui.list.map(function(e,t){var n=e.title,r=e.value;return a.createElement("option",{className:void 0,key:t,value:r},n||r)}))}}]),t}(q);ee([g.k],te.prototype,"readOnly",void 0);var ne=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputs={},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"render",value:function(){var e,t=this,n=this.ui,r=n.defaultValue,i=n.list,o=this.context,s=o.isRow;o.inNode;!0===s&&(e=this.context.row.key);var c=f()(this.className,"form-radio-inline");return a.createElement("span",{className:c},i.map(function(n,i){var o=n.value,s=n.title,c=t.name;return void 0!==e&&(c+="-"+e),a.createElement("label",{key:i,className:"form-radio-inline"},a.createElement("input",{ref:function(e){return t.inputs[i]=e},type:"radio",name:c,value:o,defaultChecked:(t.defaultValue||r)===o}),s||o)}))}}]),t}(q),re=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).inputType="range",e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.ui,n=t.min,r=t.max,i=t.step;return a.createElement(a.Fragment,null,a.createElement("input",{ref:function(t){return e.input=t},className:f()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onChange,max:r,min:n,step:i}))}}]),t}(q),ie=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},ae=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},oe=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).onClick=function(){return ae(Object(k.a)(Object(k.a)(e)),void 0,void 0,p.a.mark(function e(){var t,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.ui&&this.ui.pickId)){e.next=4;break}return alert("no pickId defined!"),e.abrupt("return");case 4:return e.next=6,t(this.context,this.name,this.value);case 6:n=e.sent,this.setDataValue(n),this.clearError(),this.clearContextError(),this.checkRules();case 11:case"end":return e.stop()}},e,this)}))},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"render",value:function(){var e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(n=e||"placeholder",r["text-muted"]=!0):n=void 0===t?a.createElement(a.Fragment,null,this.value):"function"===typeof t?t(this.context,this.name,this.value):t,a.createElement(a.Fragment,null,a.createElement("div",{className:f()(r),onClick:this.onClick},n),this.renderErrors())}}]),t}(q);ie([g.k],oe.prototype,"value",void 0);var se=function(e,t,n){return a.createElement("span",{className:"text-danger"},"!!data type ",e," only support ",(n||[]).join(", "),", can't use ui ",t,"!!")},ce=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},ue=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).apply(this,arguments))).onClick=function(){return ce(Object(k.a)(Object(k.a)(e)),void 0,void 0,p.a.mark(function e(){var t,n,r,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.clearError(),this.clearContextError(),t=this.itemSchema,n=t.name,"submit"!==t.type){e.next=7;break}if(this.context.checkRules(),!0!==this.context.hasError){e.next=7;break}return e.abrupt("return");case 7:if(void 0!==(r=this.context.form.props.onButtonClick)){e.next=11;break}return alert("button ".concat(n," clicked. you should define form onButtonClick")),e.abrupt("return");case 11:return e.next=13,r(n,this.context);case 13:if(void 0!==(i=e.sent)){e.next=16;break}return e.abrupt("return");case 16:this.context.setError(n,i);case 17:case"end":return e.stop()}},e,this)}))},e.observerRender=Object(x.a)(function(){var t,n,r,i=e.itemSchema,o=i.name,s=i.type;if(void 0!==e.ui){var c=e.ui.widget;if("button"!==c)return se(s,c,["button"]);t=e.ui.Templet,n=e.ui.className,r=e.ui.label}var u,l=e.context,h=l.form,f=l.hasError,d=e.context,p="submit"===s&&f;u=void 0!==e.children?e.children:"function"===typeof t?t(d,o):void 0!==t?t:r;var v=a.createElement("button",{className:n,type:"button",disabled:p,onClick:e.onClick},u||o);return!0===d.inNode?a.createElement(a.Fragment,null,v,e.renderErrors()):a.createElement("div",{className:h.ButtonClass},a.createElement("div",null,e.renderErrors()),v)}),e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.createElement(this.observerRender,null)}},{key:"renderContainer",value:function(){if(!1===this.visible)return null;var e=this.context,t=e.form;return!0===e.inNode?this.render():t.FieldContainer(null,this.render())}}]),t}(q),le={id:{dataTypes:["id"],widget:oe},text:{dataTypes:["integer","number","string"],widget:T},textarea:{dataTypes:["string"],widget:I},password:{dataTypes:["string"],widget:D},date:{dataTypes:["date"],widget:H},datetime:{dataTypes:["date"],widget:W},time:{dataTypes:["date"],widget:K},month:{dataTypes:["date"],widget:Q},select:{dataTypes:["integer","number","string","date","boolean"],widget:te},url:{dataTypes:["string"],widget:U},email:{dataTypes:["string"],widget:M},number:{dataTypes:["integer","number"],widget:L},updown:{dataTypes:["integer","number"],widget:B},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:z},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:ne},range:{dataTypes:["integer"],widget:re},button:{dataTypes:["button","submit"],widget:ue}};function he(e,t,n,r){if(void 0===e)return null;if(void 0!==t){var i,o=t.name,s=t.type;switch(s){case"arr":var c=e.getItemSchema(o);return a.createElement(fe,{formContext:e,arrSchema:c,children:n})}var u=e.getUiItem(o);if(void 0===u)i=v(s);else{var l=u.widget;switch(l){default:if(void 0!==l)i=le[l].widget;void 0===i&&(i=v(s));break;case"group":return a.createElement("span",null,"impletment group")}}var h=e.isRow,f=e.widgets,d=new i(e,t,r,n);if(f[o]=d,!1===h){var p=Object(x.a)(function(){return d.renderContainer()});return a.createElement(p,null)}return d.renderContainer()}function v(e){switch(e){default:return T;case"id":return oe;case"integer":return B;case"number":return L;case"string":return T;case"date":return H;case"boolean":return z;case"button":case"submit":return ue}}}var fe=Object(x.a)(function(e){var t=e.formContext,n=e.arrSchema,r=e.children,i=n.name,o=n.arr,s=t.data[i],c=t.form,u=t.rowContexts,l=u[i];void 0===l&&(u[i]=l={});var h,d,p,v,m=t.getUiItem(i),b=i;if(void 0!==m){var y=m.widget,w=m.label,k=m.selectable,g=m.deletable,O=m.restorable;if(d=k,p=g,v=O,h=m.Templet,"arr"!==y)return se(n.type,y,["arr"]);b=w||b}var j=c.ArrContainer,E=c.RowContainer,C=c.uiSchema;if(void 0!==C){var N=C.selectable,S=C.deletable,P=C.restorable;!0!==d&&(d=N),!0!==p&&(p=S),!0!==v&&(v=P)}var F=!0;return j(b,a.createElement(a.Fragment,null,s.map(function(e,i){var u=e.$row;void 0===u&&(e.$row=u=new X(c,n,e));var m,b,y=u.key;if(!0===d){m=a.createElement("div",{className:"form-row-checkbox"},a.createElement("input",{type:"checkbox",onClick:function(t){e.$isSelected=t.target.checked}}))}var w=!(void 0===e.$isDeleted||!1===e.$isDeleted);if(!0===p){var k=w?"fa-undo":"fa-trash";b=a.createElement("div",{className:"form-row-edit align-self-start text-info cursor-pointer",onClick:function(){if(!0===v)e.$isDeleted=!w;else{var t=s.indexOf(e);t>=0&&s.splice(t,1)}}},a.createElement("i",{className:f()("fa",k,"fa-fw")}))}var g,O,j=!0===d||!0===p?function(t){return a.createElement("fieldset",{disabled:w},a.createElement("div",{className:f()("d-flex",{deleted:w,"row-selected":e.$isSelected})},m,a.createElement("div",{className:"flex-grow-1"},t),b))}:function(e){return e},C=void 0;if(!1===F?C=c.RowSeperator:F=!1,void 0!==r)g=new Y(t,n,e,!0,u),O=a.createElement(a.Fragment,null,"children");else{var N=typeof h;"function"===N?(g=new Y(t,n,e,!0,u),O=a.createElement(Object(x.a)(h))):"object"===N?(g=new Y(t,n,e,!0,u),O=h):(g=new Y(t,n,e,!1,u),O=a.createElement(a.Fragment,null,o.map(function(e,t){return a.createElement(a.Fragment,{key:e.name},he(g,e,void 0))})))}return l[y]=g,a.createElement(_.Provider,{key:y,value:g},C,E(j(a.createElement(a.Fragment,null,a.createElement(g.renderErrors,null),O))))})))}),de=(n(72),{_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}}),pe=n(48),ve=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},me=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).DefaultContainer=function(e){return a.createElement("form",{className:f()(n.props.className)},e)},n.DefaultFieldContainer=function(e,t){var r=n.props.fieldLabelSize;if(r>0){var i;null===e?r=0:i=a.createElement("label",{className:f()("col-sm-"+r,"col-form-label")},e);var o="col-sm-"+(12-r);return a.createElement("div",{className:"form-group row"},i,a.createElement("div",{className:o},t))}return a.createElement("div",{className:"form-group"},null===e?null:a.createElement("label",{className:"col-form-label"},e),t)},n.DefaultFieldClass=void 0,n.DefaultArrContainer=function(e,t){return a.createElement("div",null,a.createElement("div",{className:f()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},e),t)},n.DefaultRowContainer=function(e){var t=f()({"py-3":!0});return a.createElement("div",{className:t},e)},n.DefaultButtonClass="text-center py-2",n.DefaultRowSeperator=a.createElement("div",{className:"border border-gray border-top"}),n.DefaultRes=Object(pe.a)(de);var r=e.schema,i=e.uiSchema,s=e.formData,l=e.Container,h=e.FieldContainer,d=e.FieldClass,p=e.ArrContainer,v=e.RowContainer,m=e.ButtonClass,b=e.RowSeperator,y=e.res;n.Container=l||n.DefaultContainer,n.FieldContainer=h||n.DefaultFieldContainer,n.FieldClass=void 0!==d&&""!==d&&null!==d?d:n.DefaultFieldClass,n.ArrContainer=p||n.DefaultArrContainer,n.RowContainer=v||n.DefaultRowContainer,n.res=y||n.DefaultRes,n.ButtonClass=m||n.DefaultButtonClass,n.RowSeperator=b||n.DefaultRowSeperator,n.schema=r,n.itemSchemas={},n.uiSchema=i,n.data={},void 0===s&&(s={});var w=!0,x=!1,O=void 0;try{for(var j,E=r[Symbol.iterator]();!(w=(j=E.next()).done);w=!0){var C=j.value,N=C.name,S=C.type;if(n.itemSchemas[N]=C,"button"===S)   ;else if("arr"===S){var P=C,F=P.arr;if(void 0===F)continue;var V=P.itemSchemas={},A=!0,R=!1,q=void 0;try{for(var T,I=F[Symbol.iterator]();!(A=(T=I.next()).done);A=!0){var D=T.value;V[D.name]=D}}catch(re){R=!0,q=re}finally{try{A||null==I.return||I.return()}finally{if(R)throw q}}var U=s[N];void 0===U?U=[{}]:!1===Array.isArray(U)&&(U=[U]);var M=[],L=!0,B=!1,H=void 0;try{for(var W,K=U[Symbol.iterator]();!(L=(W=K.next()).done);L=!0){var Q=W.value,z={},J=!0,X=!1,Z=void 0;try{for(var G,Y=F[Symbol.iterator]();!(J=(G=Y.next()).done);J=!0){var _=G.value.name,ee=Q[_];void 0===ee&&(ee=null),z[_]=ee}}catch(re){X=!0,Z=re}finally{try{J||null==Y.return||Y.return()}finally{if(X)throw Z}}M.push(z)}}catch(re){B=!0,H=re}finally{try{L||null==K.return||K.return()}finally{if(B)throw H}}n.data[N]=Object(g.k)(M)}else n.data[N]=s[N]}}catch(re){x=!0,O=re}finally{try{w||null==E.return||E.return()}finally{if(x)throw O}}void 0!==n.props.children||n.uiSchema&&n.uiSchema.Templet;var te,ne=n.props.children;void 0!==ne?(n.content=a.createElement(a.Fragment,null,ne),n.formContext=new $(Object(k.a)(Object(k.a)(n)),!0)):(void 0!==n.uiSchema&&(te=n.uiSchema.Templet),void 0!==te?(n.content="function"===typeof te?te(n.context):te,n.formContext=new $(Object(k.a)(Object(k.a)(n)),!0)):(n.formContext=new $(Object(k.a)(Object(k.a)(n)),!1),n.content=a.createElement(a.Fragment,null,n.schema.map(function(e,t){return a.createElement(a.Fragment,{key:t},he(n.formContext,e,ne))}))));return n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.beforeShow;void 0!==e&&e(this.formContext)}},{key:"render",value:function(){return a.createElement(_.Provider,{value:this.formContext},a.createElement(this.formContext.renderErrors,null),this.Container(this.content))}}]),t}(a.Component);ve([g.k],me.prototype,"data",void 0),(function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.children,r=this.context;if(void 0===r)return a.createElement("span",{className:"text-danger"},"!only in Form!");var i=r.getItemSchema(t),o=he(r,i,n,this.props);return void 0===o?a.createElement("span",{className:"text-danger"},"!!",t," is not defined!!"):o}}]),t}(a.Component)).contextType=_;var be=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},ye=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"content",get:function(){return!0!==this.selected?this._content:void 0!==this._content?this._content:this._content=this.contentBuilder()}}]),e}();be([g.k],ye.prototype,"selected",void 0);var we=function(e,t,n){return a.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},a.createElement("div",null,a.createElement("i",{className:"fa fa-lg fa-"+t})),a.createElement("small",null,e))},ke=function(e){function t(e){var n,r;Object(o.a)(this,t),(r=Object(c.a)(this,Object(u.a)(t).call(this,e))).tabs=[],r.tabClick=function(e){r.selectedTab.selected=!1,e.selected=!0,r.selectedTab=e};var i=r.props,a=i.size,s=i.tabs,l=i.tabBack,h=i.contentBack,f=i.sep,d=i.selected;switch(a){default:case"md":r.size="3.2rem";break;case"sm":r.size="4rem";break;case"lg":r.size="2.5rem"}return(n=r.tabs).push.apply(n,Object(O.a)(s.map(function(e){var t=new ye;return t.name=e.name,t.selected=!1,t.caption=e.caption,t.contentBuilder=e.content,t.notify=e.notify,t}))),r.tabBack=l||"bg-light",r.contentBack=h,r.sep=f||"border-top border-gray",void 0!==d&&(r.selectedTab=r.tabs.find(function(e){return e.name===d})),void 0===r.selectedTab&&(r.selectedTab=r.tabs[0]),r.selectedTab.selected=!0,r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return a.createElement("div",{className:"tab"},a.createElement("div",{className:this.contentBack,style:{height:"calc(100% - "+this.size+")"}},this.tabs.map(function(e,t){var n={display:!0===e.selected?void 0:"none"};return a.createElement("div",{key:t,style:n},e.content)})),a.createElement("div",{className:f()(this.tabBack,this.sep),style:{height:this.size}},this.tabs.map(function(t,n){var r,i=t.selected,o=t.caption,s=t.notify;if(void 0!==s){var c=s.get();void 0!==c&&(c>0?r=a.createElement("u",null,c>99?"99+":c):c<0&&(r=a.createElement("u",{className:"dot"})))}return a.createElement("div",{key:n,className:"",onClick:function(){return e.tabClick(t)}},a.createElement("div",{className:"align-self-center"},r,o(i)))})))}}]),t}(a.Component);be([g.k],ke.prototype,"selectedTab",void 0),be([g.k],ke.prototype,"tabs",void 0),ke=be([x.a],ke);var ge=n(62);n.d(t,"d",function(){return r.a}),n.d(t,"j",function(){return r.c}),n.d(t,"e",function(){return i.a}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return y}),n.d(t,"h",function(){return w}),n.d(t,"b",function(){return me}),n.d(t,"k",function(){return pe.a}),n.d(t,"f",function(){return we}),n.d(t,"g",function(){return ke}),n.d(t,"c",function(){return ge.a})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function a(){for(var e=r.length,t="",n=0;n<i;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(6),i=n(8),a=n(64),o=n.n(a),s=function(){function e(t){Object(r.a)(this,e),this.user=t}return Object(i.a)(e,[{key:"id",get:function(){return this.user.id}},{key:"name",get:function(){return this.user.name}},{key:"nick",get:function(){return this.user.nick}},{key:"icon",get:function(){return this.user.icon||"http://101.200.46.56/imgs/Bear-icon.png"}},{key:"guest",get:function(){return this.user.guest}},{key:"token",get:function(){return this.user.token}}]),e}();function c(e){var t=o()(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function u(e){return{id:0,guest:o()(e).guest,token:e}}},function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n(35),i=n.n(r),a={lang:void 0,district:void 0};function o(e){var t=a.lang,n=a.district,r={};if(void 0===e)return r;i.a.merge(r,e._);var o=e[t];if(void 0===o)return r;i.a.merge(r,o._);var s=o[n];if(void 0===s)return r;i.a.merge(r,s);var c=r.entity;if(void 0!==c)for(var u in c)c[u.toLowerCase()]=c[u];return r}!function(){var e,t,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");e=r[0],r.length>1&&(t=r[1])}else e="zh",t="CN";!function(e,t){a.lang=e,a.district=t}(e,t)}()},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a});var r="localhost:3000",i="localhost:3015",a="localhost:3009"},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(6),i=n(8),a=n(2),o=n.n(a),s=n(32),c=n(24),u=n(41),l=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})};var h=function(){function e(t,n,i,a){var s=this;Object(r.a)(this,e),this.startWait=function(){void 0!==s.ui&&s.ui.startWait()},this.endWait=function(e,t){void 0!==s.ui&&s.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)},this.showError=function(e){return l(s,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.ui){t.next=3;break}return t.next=3,this.ui.showError(e);case 3:case"end":return t.stop()}},t,this)}))},this.isCenter=t,this.hostUrl=n,this.apiToken=i,this.ui=a,this.timeout=!0===u.b?5e5:5e3}return Object(i.a)(e,[{key:"used",value:function(){this.post("",{})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return l(this,void 0,void 0,o.a.mark(function n(){var r,i,a,s,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=15;break}if(!((r=Object.keys(t)).length>0)){n.next=15;break}i="?",a=0;case 5:if(!(a<r.length)){n.next=15;break}if(s=r[a],void 0!==t[s]){n.next=10;break}return n.abrupt("continue",12);case 10:e+=i+s+"="+t[s],i="&";case 12:a++,n.next=5;break;case 15:return(c=this.buildOptions()).method="GET",n.next=19,this.innerFetch(e,c);case 19:return n.abrupt("return",n.sent);case 20:case"end":return n.stop()}},n,this)}))}},{key:"post",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="POST",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"put",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="PUT",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"delete",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.buildOptions()).method="DELETE",r.body=JSON.stringify(t),n.next=5,this.innerFetch(e,r);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}},n,this)}))}},{key:"fetch",value:function(e){function t(t,n,r,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n,r){return l(this,void 0,void 0,o.a.mark(function i(){var a,s,u,h,f,d,p,v=this;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return u=function(e){return{channel:a,url:s,options:t,resolve:n,reject:r,error:e}},a=this,this.startWait(),s=e,i.prev=4,console.log("%s %s",t.method,s),h=setTimeout(function(){return a.endWait(e,r)},this.timeout),i.next=9,fetch(encodeURI(s),t);case 9:if(!1!==(f=i.sent).ok){i.next=15;break}throw clearTimeout(h),a.endWait(),console.log("call error %s",f.statusText),f.statusText;case 15:if(!((d=f.headers.get("content-type"))&&d.indexOf("json")>=0)){i.next=20;break}return i.abrupt("return",f.json().then(function(e){return l(v,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(clearTimeout(h),a.endWait(),!0!==e.ok){t.next=4;break}return t.abrupt("return",n(e.res));case 4:if(void 0!==e.error){t.next=9;break}return t.next=7,a.showError(u("not valid tonva json"));case 7:t.next=12;break;case 9:return t.next=11,a.showError(u(e.error));case 11:r(e.error);case 12:case"end":return t.stop()}},t,this)}))}).catch(function(e){return l(v,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.showError(u(e.message));case 2:case"end":return t.stop()}},t,this)}))}));case 20:return i.next=22,f.text();case 22:p=i.sent,clearTimeout(h),a.endWait(),n(p);case 26:i.next=36;break;case 28:if(i.prev=28,i.t0=i.catch(4),"string"!==typeof i.t0){i.next=34;break}if(!0!==i.t0.toLowerCase().startsWith("unauthorized")){i.next=34;break}return c.c.logout(),i.abrupt("return");case 34:return i.next=36,this.showError(u(i.t0.message));case 36:case 37:case"end":return i.stop()}},i,this,[[4,28]])}))})},{key:"innerFetch",value:function(e,t){return l(this,void 0,void 0,o.a.mark(function n(){var r,i=this;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.hostUrl+e,!0!==this.isCenter||void 0!==this.apiToken||!Object(s.d)()){n.next=5;break}return n.next=4,Object(s.c)(r,t.method,t.body);case 4:return n.abrupt("return",n.sent);case 5:return n.next=7,new Promise(function(e,n){return l(i,void 0,void 0,o.a.mark(function i(){return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.fetch(r,t,e,n);case 2:case"end":return i.stop()}},i,this)}))});case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}},n,this)}))}},{key:"callFetch",value:function(e,t,n){return l(this,void 0,void 0,o.a.mark(function r(){var i,a=this;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(i=this.buildOptions()).method=t,i.body=n,r.next=5,new Promise(function(t,n){return l(a,void 0,void 0,o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.fetch(e,i,t,n);case 2:case"end":return r.stop()}},r,this)}))});case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,this)}))}},{key:"buildOptions",value:function(){var e=c.c.language,t=c.c.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=e;return t&&(r+="-"+t),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),{headers:n}}}]),e}()},,function(e,t,n){"use strict";n.d(t,"a",function(){return x});var r=n(2),i=n.n(r),a=n(6),o=n(8),s=n(9),c=n(7),u=n(10),l=n(13),h=n(11),f=n(37),d=n(23),p=n.n(d),v=n(35),m=n.n(v),b=n(55),y=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},w=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},k=100,g=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).apply(this,arguments))).bottomTime=0,e.topTime=0,e.onScroll=function(t){return w(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){var n,r,a,o,s,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props,r=n.onScroll,a=n.onScrollTop,o=n.onScrollBottom,r&&this.props.onScroll(t),(s=t.target).scrollTop<30&&void 0!==a&&(c=(new Date).getTime())-this.topTime>k&&(this.topTime=c,a()),s.scrollTop+s.offsetHeight>s.scrollHeight-30&&void 0!==o&&(u=(new Date).getTime())-this.bottomTime>k&&(this.bottomTime=u,o());case 5:case"end":return e.stop()}},e,this)}))},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"eachChild",value:function(e,t){var n=this,r=e.props;if(void 0!==r){var i=r.children;void 0!==i&&h.Children.forEach(i,function(e,r){var i=e._$scroll;i&&i(t),console.log(e.toString()),n.eachChild(e,t)})}}},{key:"render",value:function(){return h.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)}}]),t}(h.Component),x=function(e){function t(e){var n;Object(a.a)(this,t),n=Object(s.a)(this,Object(c.a)(t).call(this,e));var r,i=e.tabs;if(void 0===i||0===i.length)return Object(s.a)(n);n.tabs=i;var o=[],u=!0,l=!1,h=void 0;try{for(var f,d=i[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var p=f.value,v=m.a.clone(p);void 0===r&&!0===v.isSelected?r=v:v.isSelected=!1,v.isMounted=!1,o.push(v)}}catch(b){l=!0,h=b}finally{try{u||null==d.return||d.return()}finally{if(l)throw h}}return n.state={cur:r,tabs:o},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){return w(this,void 0,void 0,i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.tabs){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==(t=this.state.tabs[0])){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.onTabClick(t);case 7:case"end":return e.stop()}},e,this)}))}},{key:"onTabClick",value:function(e){return w(this,void 0,void 0,i.a.mark(function t(){var n,r,a,o,s,c,u,l,h;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==e.isSelected){t.next=2;break}return t.abrupt("return");case 2:for(r=this.state.tabs,a=!0,o=!1,s=void 0,t.prev=6,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)(l=u.value)===e?(l.isSelected=!0,n=l):l.isSelected=!1;t.next=14;break;case 10:t.prev=10,t.t0=t.catch(6),o=!0,s=t.t0;case 14:t.prev=14,t.prev=15,a||null==c.return||c.return();case 17:if(t.prev=17,!o){t.next=20;break}throw s;case 20:return t.finish(17);case 21:return t.finish(14);case 22:if(!0===n.isMounted){t.next=27;break}if(void 0===(h=n.load)){t.next=27;break}return t.next=27,h();case 27:this.setState({cur:n,tabs:r});case 28:case"end":return t.stop()}},t,this,[[6,10,14,22],[15,,17,21]])}))}},{key:"onTouchStart",value:function(e){}},{key:"renderTabs",value:function(e){var t,n=this,r=this.props,i=r.header,a=r.back,o=r.right,s=r.keepHeader,c=this.state.cur,u=h.createElement("div",null,this.state.tabs.map(function(e,t){var r,i,a,o=e.icon,s=e.isSelected,c=e.title,u=e.redDot;if(void 0!==o&&(r=h.createElement("img",{src:o})),void 0!==u){var l=u.get();l<0?(a=p()("red-dot"),i=h.createElement("u",null)):l>0&&(a=p()("red-dot","num"),i=h.createElement("u",null,l))}return h.createElement("div",{key:t,className:p()("va-tab",{cur:s}),onClick:function(){return n.onTabClick(e)}},r,h.createElement("div",{className:a},c,i))}));return!1!==i&&(t=h.createElement(b.a,{back:a,center:!0===s?i:c&&(c.header||c.title),right:o})),h.createElement("article",{className:"page-container"},t,h.createElement("section",null,this.state.tabs.map(function(e,t){var n=e.isSelected,r=e.isMounted,i=e.content;if(!0===n||!0===r)return e.isMounted=!0,h.createElement(g,{key:t,className:p()({invisible:!1===n}),onScroll:e.onScroll,onScrollTop:e.onScrollTop,onScrollBottom:e.onScrollBottom},"function"===typeof i?i():i)})),u,e)}},{key:"renderSingle",value:function(e){var t,n=this.props,r=n.back,i=n.header,a=n.right,o=n.onScroll,s=n.onScrollTop,c=n.onScrollBottom,u=n.children;return!1!==i&&(t=h.createElement(b.a,{back:r,center:i,right:a,logout:this.props.logout})),h.createElement("article",{className:"page-container",onTouchStart:this.onTouchStart},t,h.createElement("section",null,h.createElement(g,{onScroll:o,onScrollTop:s,onScrollBottom:c},u)),e)}},{key:"render",value:function(){var e,t=this.props.footer;return void 0!==t&&(e=h.createElement("footer",null,t)),void 0!==this.tabs?this.renderTabs(e):this.renderSingle(e)}}]),t}(h.Component);x=y([f.a],x)},,,function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(2),i=n.n(r),a=n(6),o=n(8),s=n(9),c=n(7),u=n(10),l=n(13),h=n(11),f=n(24),d=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).logoutClick=function(){if(!1!==confirm("Really want to logout?")){var e=n.props.logout;"function"===typeof e&&e(),f.c.logout()}},n.navChange=n.navChange.bind(Object(l.a)(Object(l.a)(n))),n.state={hasBack:!1},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"navChange",value:function(){this.setState({hasBack:f.c.level>1})}},{key:"componentWillMount",value:function(){this.navChange()}},{key:"componentWillUnmount",value:function(){}},{key:"back",value:function(){return d(this,void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.c.back();case 2:case"end":return e.stop()}},e,this)}))}},{key:"openWindow",value:function(){window.open(document.location.href)}},{key:"render",value:function(){var e,t,n,r,i=this.state.hasBack||self!=top,a=this.props,o=a.right,s=a.center,c=a.logout;if(void 0!==c&&self===top&&("boolean"===typeof c&&!0===c||"function"===typeof c)){var u=f.c.user,l=u.nick,d=u.name;n=h.createElement("div",{className:"d-flex align-items-center"},h.createElement("small",{className:"text-light"},l||d),h.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},h.createElement("i",{className:"fa fa-sign-out"})))}if(i)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=h.createElement("nav",{onClick:this.back},h.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":e=h.createElement("nav",{onClick:this.back},h.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),t=h.createElement("header",{onClick:this.openWindow})),(o||n)&&(r=h.createElement("aside",null,o," ",n)),h.createElement("header",{style:f.b},t,e,h.createElement("div",null,s),r)}}]),t}(h.Component)},function(e,t,n){"use strict";n.r(t);var r=n(17),i=n(26),a=n(5),o=n(12),s=n(33);class c extends o.m{constructor(){super(...arguments),this.showCart=(()=>r.a(this,void 0,void 0,function*(){yield this.controller.start()})),this.content=Object(s.a)(()=>a.createElement("div",null,a.createElement("button",{className:"btn btn-info btn-sm",onClick:this.showCart},"Cart: ",a.createElement("span",{className:"badge badge-light"},this.controller.sum.count))))}render(e){return a.createElement(this.content,null)}}var u=n(22),l=n(15);class h extends o.l{constructor(){super(...arguments),this.inputRefs={},this.checkBoxs={},this.mapInputRef=((e,t)=>{if(null!==e)return e.value=t.quantity,this.inputRefs[t.pack.id]=e}),this.mapCheckBox=((e,t)=>{if(null!==e)return e.checked=t.checked||!1,this.checkBoxs[t.pack.id]=e}),this.updateChecked=(e=>r.a(this,void 0,void 0,function*(){let t=this.checkBoxs[e.pack.id];yield this.controller.updateChecked(e,t.checked)})),this.updateQuantity=(e=>r.a(this,void 0,void 0,function*(){let t=this.inputRefs[e.pack.id];yield this.controller.updateQuantity(e,Number(t.value))})),this.minusQuantity=(e=>r.a(this,void 0,void 0,function*(){e.quantity>1&&(yield this.controller.updateQuantity(e,e.quantity-1))})),this.plusQuantity=(e=>r.a(this,void 0,void 0,function*(){yield this.controller.updateQuantity(e,e.quantity+1)})),this.renderProduct=(e=>a.createElement("strong",null,e.description)),this.renderPack=(e=>a.createElement(a.Fragment,null,e.name)),this.renderItem=(e=>a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},a.createElement("img",{src:"favicon.ico",alt:e.product.obj.description})),a.createElement("div",{className:"col-9"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},Object(i.c)(e.product,this.renderProduct))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},Object(i.c)(e.pack,this.renderPack)),a.createElement("div",{className:"col-3"},a.createElement("strong",{className:"text-danger"},e.price)),a.createElement("div",{className:"col-6 text-right d-flex"},a.createElement("div",{onClick:()=>this.minusQuantity(e)},a.createElement(l.b,{name:"minus-circle text-success"})),a.createElement("span",{className:"px-4 bg-light"},e.quantity),a.createElement("div",{onClick:()=>this.plusQuantity(e)},a.createElement(l.b,{name:"plus-circle text-success"})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},"\u8d27\u671f"))))),this.onCartItemRender=(e=>{let t,n,r,{isDeleted:o}=e,s=a.createElement(a.Fragment,null,Object(i.c)(e,this.renderItem));a.createElement("input",{className:"text-center",style:{width:"60px"},ref:t=>this.mapInputRef(t,e),type:"number",onChange:()=>this.updateQuantity(e),disabled:o});!0===o?(r=a.createElement("del",null,s),t=(()=>e.isDeleted=!1),n=a.createElement(l.b,{name:"rotate-left"})):(r=a.createElement("div",null,s),t=(()=>e.isDeleted=!0),n=a.createElement(l.b,{name:"trash-o"}));let c=a.createElement("button",{className:"btn btn-light",type:"button",onClick:t},n);return a.createElement(l.d,{className:"px-2 py-2",left:a.createElement("input",{className:"mr-3",type:"checkbox",ref:t=>this.mapCheckBox(t,e),onChange:()=>this.updateChecked(e),disabled:o}),right:a.createElement(a.Fragment,null,c)},r)}),this.CheckOutButton=Object(s.a)(()=>{let{checkOut:e,sum:t}=this.controller,{count:n,amount:r}=t,i=r>0?a.createElement(a.Fragment,null,"\u53bb\u7ed3\u7b97"," (",r," \u5143)"):a.createElement(a.Fragment,null,"\u53bb\u7ed3\u7b97");return a.createElement("button",{className:"btn btn-success w-100",type:"button",onClick:e,disabled:r<=0},i)}),this.page=(()=>{let{cartData:e}=this.controller;return a.createElement(o.f,{header:"\u8d2d\u7269\u8f66",footer:a.createElement(this.CheckOutButton,null)},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},a.createElement(l.e,{items:e,item:{render:this.onCartItemRender}}))))})}showEntry(){return r.a(this,void 0,void 0,function*(){this.openPage(this.page)})}render(e){return this.page()}}var f=n(79);class d extends o.b{constructor(e,t){super(t),this.cartData=[],this.checkOut=(()=>r.a(this,void 0,void 0,function*(){if(this.isLogined){let e=this.cartData.filter(e=>e.checked&&!(!0===e.isDeleted));if(!e||0===e.length)return;let{cOrder:t}=this.cApp;yield t.start(e)}else;})),this.cApp=e;let{cUsqOrder:n}=this.cApp;this.addToCartAction=n.action("addtocart"),this.getCartQuery=n.query("getcart"),this.setCartAction=n.action("setcart"),this.removeFromCartAction=n.action("removefromcart")}get sum(){return this.cartData.reduce((e,t)=>{let{isDeleted:n,quantity:r,price:i,checked:a}=t,{count:o,amount:s}=e;return!0===n?e:{count:o+r,amount:s+(!0!==a?0:r*i)}},{count:0,amount:0})}load(){return r.a(this,void 0,void 0,function*(){let e=yield this.getCartQuery.page(void 0,0,100);this.cartData.push(...e)})}internalStart(e){return r.a(this,void 0,void 0,function*(){this.showVPage(h)})}AddToCart(e,t,n,i){return r.a(this,void 0,void 0,function*(){let r=this.cartData.find(t=>t.pack.id===e.id);r?(r.quantity+=t,r.price=n):(r=this.createCartItem(e,t,n,i),this.cartData.push(r)),yield this.addToCartAction.submit({product:r.product.id,pack:r.pack.id,price:r.price,currency:i.id,quantity:t})})}createCartItem(e,t,n,r){return{checked:!0,pack:e,product:e.obj.$owner,price:n,currency:r,quantity:t,isDeleted:!1,createdate:Date.now()}}updateChecked(e,t){return r.a(this,void 0,void 0,function*(){let n=this.cartData.find(t=>t.pack.id===e.pack.id);n&&(n.checked=t)})}updateQuantity(e,t){return r.a(this,void 0,void 0,function*(){yield this.setCartAction.submit({product:e.product.id,pack:e.pack.id,price:e.price,quantity:t});let n=this.cartData.find(t=>t.pack.id===e.pack.id);n&&(n.quantity=t)})}removeDeletedItem(){return r.a(this,void 0,void 0,function*(){let e=this.cartData.filter(e=>!0===e.isDeleted);e&&(yield this.removeFromCart(e))})}removeFromCart(e){return r.a(this,void 0,void 0,function*(){yield this.removeFromCartAction.submit({rows:e}),f.pullAllBy(this.cartData,e,"pack.id")})}onDispose(){this.removeDeletedItem()}renderCartLabel(){return this.renderView(c)}renderCart(){return this.renderView(h)}}r.b([u.k],d.prototype,"cartData",void 0),r.b([u.d],d.prototype,"sum",null);class p extends o.l{constructor(){super(...arguments),this.inputRef=((e,t)=>{null!==e&&(t.input=e)}),this.onProductPackRender=((e,t)=>{let{pack:n,retail:r,currency:i}=e,o=a.createElement(a.Fragment,null,a.createElement("input",{className:"text-center",style:{width:"60px"},ref:t=>this.inputRef(t,e),type:"number",defaultValue:"1"}),a.createElement("button",{type:"button",className:"btn btn-light",onClick:()=>this.onProductPackClicked(e)},a.createElement(l.b,{name:"cart-plus",className:"text-info"})),a.createElement("button",{type:"button",className:"btn btn-light"},a.createElement(l.b,{name:"heart-o",className:"text-danger small"})));return a.createElement(l.d,{className:"pt-3",right:o},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-2"},n.obj.name),a.createElement("div",{className:"col-2"},r,i&&i.name),a.createElement("div",{className:"col-2"},r)))}),this.onProductPackClicked=(e=>r.a(this,void 0,void 0,function*(){let{pack:t,retail:n,currency:r}=e,{cCart:i}=L,a=e.input;yield i.AddToCart(t,Number(a.value),n,r)})),this.page=Object(s.a)(e=>{let{product:t}=this.controller,n=L.cHome.renderSearchHeader(),r=L.cCart.renderCartLabel(),s=a.createElement(l.d,{className:"pt-3",right:"quantity  cart  favorite"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-2"},"SKU"),a.createElement("div",{className:"col-2"},"price"),a.createElement("div",{className:"col-2"},"vip price")));return a.createElement(o.f,{header:n,right:r},a.createElement("div",{className:"px-2 py-2 bg-white"},Object(i.c)(t)),a.createElement(l.e,{items:this.packRows,item:{render:this.onProductPackRender},header:s,className:"px-2 bg-white"}))}),this.renderChemical=((e,t)=>a.createElement(a.Fragment,null,a.createElement("div",{className:"col-4 col-md-2 text-muted"},"CAS:"),a.createElement("div",{className:"col-8 col-md-4"},e.CAS),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u7eaf\u5ea6:"),a.createElement("div",{className:"col-8 col-md-4"},t),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u5f0f:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularFomula),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u91cf:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularWeight))),this.renderBrand=(e=>a.createElement(a.Fragment,null,a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u54c1\u724c:"),a.createElement("div",{className:"col-8 col-md-4"},e.name))),this.productRow=((e,t)=>a.createElement("div",{className:"row d-flex"},a.createElement("div",{className:"col-12"},a.createElement("div",{className:"row py-2"},a.createElement("div",{className:"col-12"},a.createElement("strong",null,e.description))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},a.createElement("img",{src:"favicon.ico",alt:"structure"})),a.createElement("div",{className:"col-9"},a.createElement("div",{className:"row"},Object(i.c)(e.chemical,this.renderChemical,e.purity),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u4ea7\u54c1\u7f16\u53f7:"),a.createElement("div",{className:"col-8 col-md-4"},e.origin),Object(i.c)(e.brand,this.renderBrand)))))))}showEntry(e){return r.a(this,void 0,void 0,function*(){let{packTuid:t}=this.controller;this.packRows=[];let n={};for(let r of e.prices){let e={pack:r.pack,retail:r.retail,vipPrice:r.vipPrice,currency:r.currency};n[r.pack.id]=e,this.packRows.push(e)}for(let r of e.packx){let{id:e}=r,i=n[e];void 0===i&&(i={},this.packRows.push(i),i.pack=t.boxId(e))}this.openPage(this.page,e)})}}class v extends o.l{constructor(){super(...arguments),this.renderChemical=((e,t)=>a.createElement(a.Fragment,null,a.createElement("div",{className:"col-4 col-md-2 text-muted"},"CAS:"),a.createElement("div",{className:"col-8 col-md-4"},e.CAS),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u7eaf\u5ea6:"),a.createElement("div",{className:"col-8 col-md-4"},t),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u5f0f:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularFomula),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u91cf:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularWeight))),this.renderBrand=(e=>a.createElement(a.Fragment,null,a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u54c1\u724c:"),a.createElement("div",{className:"col-8 col-md-4"},e.name))),this.productRow=((e,t)=>a.createElement("div",{className:"row d-flex"},a.createElement("div",{className:"col-12"},a.createElement("div",{className:"row py-2"},a.createElement("div",{className:"col-12"},a.createElement("strong",null,e.description))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},a.createElement("img",{src:"favicon.ico",alt:"structure"})),a.createElement("div",{className:"col-9"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-4 col-md-2 text-muted"},"CAS:"),a.createElement("div",{className:"col-8 col-md-4"},e.CAS),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u7eaf\u5ea6:"),a.createElement("div",{className:"col-8 col-md-4"},e.purity),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u5f0f:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularFomula),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u91cf:"),a.createElement("div",{className:"col-8 col-md-4"},e.molecularWeight),a.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u4ea7\u54c1\u7f16\u53f7:"),a.createElement("div",{className:"col-8 col-md-4"},e.origin),Object(i.c)(e.brand,this.renderBrand))))))),this.onProductClick=(e=>r.a(this,void 0,void 0,function*(){this.controller.showProductDetail(e.id)})),this.onScrollBottom=(()=>r.a(this,void 0,void 0,function*(){yield this.controller.pageProducts.more()})),this.page=Object(s.a)(()=>{let{pageProducts:e}=this.controller,t=L.cHome.renderSearchHeader(),n=L.cCart.renderCartLabel();return a.createElement(o.f,{header:t,right:n,onScrollBottom:this.onScrollBottom},a.createElement(l.e,{before:"",items:e,item:{render:this.productRow,onClick:this.onProductClick},className:"bg-white px-2"}))})}showEntry(e){return r.a(this,void 0,void 0,function*(){let t=e;this.controller.pageProducts.first({key:t}),this.openPage(this.page)})}}class m extends o.g{constructor(e){super(),this.firstSize=this.pageSize=3,this.searchProductQuery=e}load(e,t,n){return r.a(this,void 0,void 0,function*(){let{key:r}=e;return void 0===t&&(t=0),yield this.searchProductQuery.page({key:r},t,n)})}setPageStart(e){return void 0===e?0:e.id}}class b extends o.b{constructor(e,t){super(t),this.showProductDetail=(e=>r.a(this,void 0,void 0,function*(){this.product=yield this.productTuid.load(e),this.productChemical=yield this.productChemicalMap.obj({product:e}),this.productChemical&&(this.product.chemical=this.productChemical.chemical,this.product.purity=this.productChemical.purity);let{salesRegion:t}=L;this.prices=yield this.priceMap.table({product:e,salesRegion:t.id});let n=0;if(this.isLogined){let e=yield this.getCustomerDiscount.table({brand:this.product.brand.id,person:this.user.id});n=e&&e[0]&&e[0].discount}this.prices.forEach(e=>{e.vipprice=e.price*(1-n),e.currency=t.currency.obj}),this.product.prices=this.prices,this.showVPage(p,this.product)})),this.getDeliveryTimeDescription=((e,t,n)=>r.a(this,void 0,void 0,function*(){let r=yield this.getInventoryAllocationQuery.table({product:e,pack:t,salesRegion:n});if(r.length>0)return r[0].deliveryTimeDescription;{let t=yield this.getFutureDeliveryTime.table({product:e,salesRegion:n});if(t.length>0)return t[0].deliveyTimeDescription}}));let{cUsqProduct:n,cUsqCustomerDiscount:i,cUsqWarehouse:a}=L,o=n.query("searchProduct");this.pageProducts=new m(o),this.productTuid=n.tuid("productx"),this.packTuid=this.productTuid.divs.packx,this.productChemicalMap=n.map("productChemical"),this.priceMap=n.map("price2"),this.getCustomerDiscount=i.query("getdiscount"),this.getInventoryAllocationQuery=a.query("getInventoryAllocation"),this.getFutureDeliveryTime=n.query("getFutureDeliveryTime")}internalStart(e){return r.a(this,void 0,void 0,function*(){this.showVPage(v,e)})}}class y extends o.l{constructor(){super(...arguments),this.RenderDeliveryContact=(e=>{return a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},e.name,e.mobile,a.createElement("br",null),e.address))}),this.nullContact=(()=>a.createElement(a.Fragment,null,"\u8bf7\u70b9\u51fb\u8f93\u5165\u5730\u5740")),this.renderProduct=(e=>a.createElement("strong",null,e.description)),this.renderPack=(e=>a.createElement(a.Fragment,null,e.name)),this.renderItem=(e=>a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},a.createElement("img",{src:"favicon.ico",alt:e.product.obj.description})),a.createElement("div",{className:"col-9"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},Object(i.c)(e.product,this.renderProduct))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-3"},e.pack.obj.name),a.createElement("div",{className:"col-3"},a.createElement("strong",{className:"text-danger"},e.price)),a.createElement("div",{className:"col-6 text-right"},"\u6570\u91cf: ",a.createElement("span",{className:"px-4 bg-light"},e.quantity))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-12"},"\u8d27\u671f"))))),this.renderOrderItem=(e=>a.createElement(a.Fragment,null,Object(i.c)(e,this.renderItem),a.createElement("br",null))),this.page=Object(s.a)(()=>{let{orderData:e,submitOrder:t,openContactList:n}=this.controller,{orderItems:r,deliveryContact:i}=e,s=a.createElement("button",{type:"button",className:"btn btn-danger w-100",onClick:t},"\u63d0\u4ea4\u8ba2\u5355",e.amount),c=a.createElement(l.b,{name:"chevron-right"});return a.createElement(o.f,{header:"\u8ba2\u5355\u9884\u89c8",footer:s},a.createElement(l.d,{right:c,onClick:n,className:"px-2 py-2"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-4"},i.name),a.createElement("div",{className:"col-8"},i.mobile),a.createElement("div",{className:"col-12"},i.addressString))),a.createElement(l.e,{items:r,item:{render:this.renderOrderItem,className:"px-2"}}))})}showEntry(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.page)})}}class w{constructor(){this.deliveryContact={},this.orderItems=[]}get amount(){return this.orderItems.reduce((e,t)=>e+t.subAmount,0)}getPostData(){return{webUser:this.webUser,organization:this.organization&&this.organization.id,customer:this.customer&&this.customer.id,orderitems:this.orderItems.map(e=>({product:e.product.id,pack:e.pack.id,price:e.price,quantity:e.quantity,subAmount:e.subAmount})),deliveryOrderContact:this.deliveryContact.id,amount:this.amount,currency:this.currency&&this.currency.id}}}r.b([u.k],w.prototype,"deliveryContact",void 0),r.b([u.k],w.prototype,"orderItems",void 0),r.b([u.d],w.prototype,"amount",null);class k{get subAmount(){return this.price*this.quantity}}r.b([u.k],k.prototype,"price",void 0),r.b([u.k],k.prototype,"quantity",void 0),r.b([u.d],k.prototype,"subAmount",null);class g extends o.l{constructor(){super(...arguments),this.page=(e=>a.createElement(o.f,null,a.createElement("div",null,e.no)))}showEntry(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.page,e)})}}class x extends o.b{constructor(e,t){super(t),this.orderData=new w,this.createOrderFromCart=(e=>r.a(this,void 0,void 0,function*(){if(this.orderData.webUser=this.user.id,void 0===this.orderData.deliveryContact){let e,t=yield this.webUserCustomerMap.obj({webUser:this.user.id});if(void 0!==t?(e=yield this.customerConsigneeContactMap.table({customer:t.customer.id}),this.orderData.customer=t.customer):(e=yield this.webUserConsigneeContactMap.table({webUser:this.user.id}),console.log(e)),e&&e.length>0){let t=e.find(e=>{if(!0===e.isDefault)return e});t||(t=e[0]),this.setContact(t.contact.obj)}}void 0!==e&&e.length>0&&(this.orderData.currency=e[0].currency,this.orderData.orderItems=e.map((e,t)=>{var n=new k;return n.product=e.product,n.pack=e.pack,n.price=e.price,n.quantity=e.quantity,n}))})),this.setContact=(e=>{this.orderData.deliveryContact=Object.assign({},e)}),this.submitOrder=(()=>r.a(this,void 0,void 0,function*(){if(!this.orderData.deliveryContact)return void this.openContactList();let e=this.orderData.getPostData();yield this.orderSheet.loadSchema();let t=yield this.orderSheet.save("",e);L.cCart.removeFromCart(this.orderData.orderItems),this.closePage(1),this.showVPage(g,t)})),this.openContactList=(()=>{L.cUser.start()});let{cUsqWebUser:n,cUsqCustomer:i,cUsqOrder:a}=L;this.webUserCustomerMap=n.map("webUserCustomer"),this.webUserConsigneeContactMap=n.map("webUserConsigneeContact"),this.customerConsigneeContactMap=i.map("customerConsigneeContact"),this.orderSheet=a.sheet("order")}internalStart(e){return r.a(this,void 0,void 0,function*(){let t=e;yield this.createOrderFromCart(t),this.showVPage(y)})}}r.b([u.k],x.prototype,"orderData",void 0);var O=n(80),j=n.n(O);class E extends o.m{render(){let e=a.createElement(l.b,{name:"globe"}),t=(a.createElement("div",null,"\u767b\u5f55"),a.createElement("img",{src:j.a,alt:"logo"})),n=this.controller.cApp.cCart.renderCartLabel(),r=a.createElement("div",{className:"d-flex flex-row mr-1 align-items-center"},e," \xa0 ",n);return a.createElement(l.d,{className:"align-items-end pb-1",left:t,right:r},a.createElement("div",{className:"h4 px-3 mb-0"},"\u767e\u7075\u5a01\u79d1\u6280"))}}class C extends o.m{constructor(){super(...arguments),this.onSearch=(e=>r.a(this,void 0,void 0,function*(){let{cProduct:t}=this.controller.cApp;t.start(e)}))}render(e){return a.createElement(l.i,{className:"px-1 my-1 w-100",onSearch:this.onSearch,placeholder:"Search product name, CAS, MDL etc."})}}const N=5;class S extends o.m{constructor(){super(...arguments),this.renderSection=((e,t)=>a.createElement("section",null,a.createElement("h4",null,e.title,a.createElement("small",{className:"text-muted"},e.subtitle)),a.createElement("p",null,e.content))),this.page=Object(s.a)(()=>{let{openMetaView:e}=this.controller,t=a.createElement(a.Fragment,null);return this.controller.isLogined&&this.controller.user.id===N&&(t=a.createElement("button",{type:"button",className:"btn w-100",onClick:e},"view")),a.createElement(o.f,{header:!1,footer:t},this.content())}),this.content=(()=>{let e=this.controller.renderSiteHeader();return a.createElement(a.Fragment,null,e,this.controller.renderSearchHeader(),this.controller.renderCategoryRootList())})}showEntry(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.page)})}render(e){return a.createElement(this.content,null)}}class P extends o.b{constructor(e,t){super(t),this.renderSiteHeader=(()=>this.renderView(E)),this.renderSearchHeader=(()=>this.renderView(C)),this.renderCategoryRootList=(()=>{let{cProductCategory:e}=this.cApp;return e.renderRootList()}),this.renderHome=(()=>this.renderView(S)),this.openMetaView=(()=>{this.cApp.startDebug()}),this.cApp=e}internalStart(e){return r.a(this,void 0,void 0,function*(){let{cProductCategory:e}=this.cApp;yield e.start(),this.showVPage(S)})}}class F extends o.m{constructor(){super(...arguments),this.catClick=(e=>r.a(this,void 0,void 0,function*(){yield this.controller.openMainPage(e)})),this.onRootCategoryRender=((e,t)=>{let{category:n,children:r}=e,i=a.createElement("div",{className:"h4"},n.obj.name);return a.createElement("div",{className:"row bg-light py-2"},a.createElement("div",{className:"col-12"},a.createElement(l.d,{left:i,right:"\u66f4\u591a...",className:"px-3 cursor-pointer",onClick:()=>this.catClick(e)})),a.createElement("div",{className:"col-12"},a.createElement("div",{className:"row mx-3 cussor-pointer"},r&&r.map(e=>a.createElement("div",{className:"col-12 col-md-4 py-2",onClick:()=>this.catClick(e)},e.category.obj.name,a.createElement("hr",{className:"my-1"}))))))})}render(e){let{rootCategories:t}=this.controller;return a.createElement(l.e,{items:t,item:{render:this.onRootCategoryRender},className:"mx-1"})}}class V extends o.l{constructor(){super(...arguments),this.childUI=(e=>a.createElement("div",{className:"py-2"},a.createElement(l.b,{name:"hand-o-right mr-2"}),e.name)),this.renderChild=(e=>Object(i.c)(e.category,this.childUI)),this.catClick=(e=>r.a(this,void 0,void 0,function*(){yield this.controller.openMainPage(e)})),this.page=(e=>{let{cHome:t}=this.controller.cApp,n=t.renderSearchHeader(),r=this.controller.cApp.cCart.renderCartLabel();return a.createElement(o.f,{header:n,right:r},a.createElement("h3",null,Object(i.c)(e.category,e=>e.name)),a.createElement("hr",null),a.createElement(l.e,{items:e.children,item:{render:this.renderChild,onClick:this.catClick},className:"bg-white px-2"}))})}showEntry(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.page,e)})}}class A extends o.b{constructor(e,t){super(t),this.rootCategories=[],this.renderRootList=(()=>this.renderView(F)),this.cApp=e;let{cUsqProduct:n}=this.cApp;this.categoryTuid=n.tuid("productCategory"),this.categoryTreeMap=n.map("productCategoryTree")}internalStart(e){return r.a(this,void 0,void 0,function*(){this.rootCategories=yield this.categoryTreeMap.table({parent:0}),this.rootCategories.forEach(e=>r.a(this,void 0,void 0,function*(){e.isleaf||(e.children=yield this.getCategoryChildren(e.category.id))}))})}getCategoryChildren(e){return r.a(this,void 0,void 0,function*(){return yield this.categoryTreeMap.table({parent:e})})}openMainPage(e){return r.a(this,void 0,void 0,function*(){e.isleaf||(e.children=yield this.getCategoryChildren(e.category.id),this.showVPage(V,e))})}}r.b([u.k],A.prototype,"rootCategories",void 0);class R extends o.l{constructor(){super(...arguments),this.onContactRender=(e=>{let{onContactEdit:t,onContactSelected:n}=this.controller;return a.createElement("div",{className:"row"},a.createElement("div",{className:"col-10",onClick:()=>n(e)},Object(i.c)(e)),a.createElement("div",{className:"col-2"},a.createElement("button",{type:"button",className:"btn btn-primary",onClick:()=>t(e)},"edit")))}),this.page=(()=>{let{currentUser:e,onContactEdit:t}=this.controller,{consigneeContacts:n}=e;return a.createElement(o.f,{footer:a.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:()=>t()},"\u6dfb\u52a0\u65b0\u5730\u5740")},a.createElement(l.e,{items:n,item:{render:this.onContactRender},none:"\u4f60\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u6536\u8d27\u5730\u5740\uff0c\u8bf7\u6dfb\u52a0\u65b0\u5730\u5740"}))})}showEntry(){return r.a(this,void 0,void 0,function*(){this.openPage(this.page)})}}const q=[{name:"webUser",type:"id",required:!1},{name:"name",type:"string",required:!0},{name:"organizationName",type:"string",required:!0},{name:"mobile",type:"string",required:!0},{name:"telephone",type:"string",required:!1},{name:"email",type:"string",required:!1},{name:"address",type:"id",required:!1},{name:"addressString",type:"string",required:!0},{name:"isDefault",type:"integer",required:!0},{name:"submit",type:"submit"}],T={items:{webUser:{visible:!1},name:{widget:"text",label:"\u59d3\u540d"},organizationName:{widget:"text",label:"\u5355\u4f4d\u540d\u79f0"},mobile:{widget:"text",label:"\u624b\u673a\u53f7"},telephone:{widget:"text",label:"\u7535\u8bdd"},addressString:{widget:"text",label:"\u8be6\u7ec6\u5730\u5740"},isDefault:{widget:"checkbox",label:"\u4f5c\u4e3a\u9ed8\u8ba4\u5730\u5740"},submit:{widget:"button",label:"\u63d0\u4ea4"}}};class I extends o.l{constructor(){super(...arguments),this.saveContact=(()=>r.a(this,void 0,void 0,function*(){})),this.onFormButtonClick=((e,t)=>r.a(this,void 0,void 0,function*(){t.form.data.isDefault?t.form.data.isDefault=1:t.form.data.isDefault=0,yield this.controller.saveContact(t.form.data)})),this.page=(()=>{let e=a.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:this.saveContact},"\u4fdd\u5b58\u5e76\u4f7f\u7528");return a.createElement(o.f,{header:"\u6dfb\u52a0\u6536\u8d27\u4eba",footer:e},a.createElement("div",{className:"App-container container text-left"},a.createElement(o.c,{schema:q,uiSchema:T,formData:{webUser:this.controller.user.id},onButtonClick:this.onFormButtonClick,fieldLabelSize:3,className:"my-3"})))})}showEntry(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.page)})}}class D extends o.b{constructor(e,t){super(t),this.consigneeContacts=[],this.onContactEdit=(e=>r.a(this,void 0,void 0,function*(){this.showVPage(I)})),this.saveContact=(e=>r.a(this,void 0,void 0,function*(){let t=yield this.contactTuid.save(void 0,e);yield this.webUserConsigneeContactMap.add({webUser:this.user.id,arr1:[{contact:t.id}]}),this.onContactSelected(e)})),this.onContactSelected=(e=>{let{cOrder:t}=L;t.setContact(e),this.backPage()});let{cUsqWebUser:n,cUsqCustomer:i,cUsqOrder:a}=L;this.webUserCustomerMap=n.map("webUserCustomer"),this.webUserConsigneeContactMap=n.map("webUserConsigneeContact"),this.customerTuid=i.tuid("customer"),this.customerConsigneeContactMap=i.map("customerConsigneeContact"),this.contactTuid=i.tuid("contact")}internalStart(e){return r.a(this,void 0,void 0,function*(){let e;this.currentUser=this.user,this.currentUser.consigneeContacts=[];let t=yield this.webUserCustomerMap.obj({webUser:this.user.id});(e=void 0!==t?yield this.customerConsigneeContactMap.table({customer:t.customer.id}):yield this.webUserConsigneeContactMap.table({webUser:this.user.id}))&&e.length>0&&e.forEach(e=>{this.currentUser.consigneeContacts.push(e.contact.obj)}),this.showVPage(R)})}}class U extends o.l{constructor(){super(...arguments),this.content=(()=>{let{member:e,user:t}=this.controller,n=a.createElement("img",{src:t.icon,alt:"\u5934\u50cf"}),r=a.createElement("p",{className:"h4"},"\u6211\u7684\u79ef\u5206"),i=a.createElement("p",{className:"small align-self-end"},"\u67e5\u770b\u8be6\u60c5 ",a.createElement(l.b,{name:"angle-right"})),o=a.createElement(a.Fragment,null,a.createElement("p",{className:"h5 mb-0"},"0"),a.createElement(l.g,null,"\u672c\u5468")),s=a.createElement(a.Fragment,null,a.createElement("p",{className:"h5 mb-0"},e.point),a.createElement(l.g,null,"\u7d2f\u8ba1")),c=a.createElement("p",{className:"h4"},"\u6211\u7684\u7c89\u4e1d"),u=a.createElement("p",{className:"small align-self-end"},"\u67e5\u770b\u8be6\u60c5 ",a.createElement(l.b,{name:"angle-right"}));return a.createElement("div",null,a.createElement(l.d,{className:"shadow bg-white rounded p-3 mb-1",left:n},a.createElement("div",null,a.createElement("div",null,t.name),a.createElement("div",null,"\u9080\u8bf7\u7801:",e.recommendationCode))),a.createElement("div",{className:"shadow bg-white rounded p-3 mb-1"},a.createElement(l.d,{left:r,right:i}),a.createElement(l.d,{className:"pb-2"},a.createElement("p",{className:"h4 mb-0"},"0"),a.createElement(l.g,null,"\u4eca\u65e5")),a.createElement(l.d,{left:o,right:s})),a.createElement("div",{className:"shadow bg-white rounded p-3 mb-1"},a.createElement(l.d,{left:c,right:u}),a.createElement(l.d,{className:"pb-2"},a.createElement("p",{className:"h4 mb-0"},"0"),a.createElement(l.g,null,"\u4eca\u65e5")),a.createElement(l.d,{left:o,right:s})))})}showEntry(e){return r.a(this,void 0,void 0,function*(){})}render(e){return a.createElement(this.content,null)}}class M extends o.b{constructor(e,t){super(t),this.renderMember=(()=>this.renderView(U)),this.render=Object(s.a)(()=>void 0===this.member?a.createElement(o.d,null):this.renderMember()),this.cApp=e}internalStart(e){return r.a(this,void 0,void 0,function*(){let e=this.cApp.cUsqMember.tuid("member"),t=yield e.load(this.user.id),n=this.cApp.cUsqMember.query("getPoint"),r=yield n.obj({member:t.id});t.point=void 0===r?0:r.point,this.member=t})}}r.b([u.k],M.prototype,"member",void 0);var L,B=n(44);n.d(t,"CCartApp",function(){return H}),n.d(t,"cCartApp",function(){return L});class H extends i.a{internalStart(){return r.a(this,void 0,void 0,function*(){this.cUsqOrder=this.getCUsq(B.a.usqOrder),this.cUsqProduct=this.getCUsq(B.a.usqProduct),this.cUsqCommon=this.getCUsq(B.a.usqCommon),this.cUsqWebUser=this.getCUsq(B.a.usqWebUser),this.cUsqCustomer=this.getCUsq(B.a.usqCustomer),this.cUsqCustomerDiscount=this.getCUsq(B.a.usqCustomerDiscount),this.cUsqWarehouse=this.getCUsq(B.a.usqWarehouse),this.cUsqMember=this.getCUsq(B.a.usqMember),L=this,this.cProductCategory=new A(this,void 0),this.cCart=new d(this,void 0),this.cHome=new P(this,void 0),this.cProduct=new b(this,void 0),this.cOrder=new x(this,void 0),this.cUser=new D(this,void 0),this.cMember=new M(this,void 0);let e=this.cUsqCommon.tuid("salesregion");this.salesRegion=yield e.load(1),this.isLogined,yield this.cCart.load()})}}},,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(11);function i(){return r.createElement("div",{style:{height:"100%"},className:"d-flex flex-fill align-items-center justify-content-center"},r.createElement("div",{className:"d-flex align-items-center justify-content-center slide text-info",style:{width:"5em",height:"2em"}},"\u52a0\u8f7d\u4e2d..."))}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=2e3;function i(e,t){return new Promise(function(n,i){fetch(e,t).then(n).catch(i);var a=new Error("Connection timed out");setTimeout(i,r,a)})}},,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(36),i=n(38),a={set:function(e){Object(r.i)(e),i.a.setCenterToken(e)},clear:function(){Object(r.i)(void 0),i.a.setCenterToken(void 0)}}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(2),i=n.n(r),a=n(6),o=n(8),s=n(9),c=n(7),u=n(10),l=n(13),h=n(11),f=n(34),d=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).apply(this,arguments))).reApi=function(){return d(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){var t,n,r,a,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.clearError(),t=this.props,n=t.channel,r=t.url,a=t.options,o=t.resolve,s=t.reject,e.next=4,Object(f.l)(n,r,a,o,s);case 4:case"end":return e.stop()}},e,this)}))},e.close=function(){return d(Object(l.a)(Object(l.a)(e)),void 0,void 0,i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.clearError();case 1:case"end":return e.stop()}},e,this)}))},e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.error,r=t.url;if("object"===typeof n){var i=[];for(var a in n)i.push(h.createElement("li",{key:a},h.createElement("label",null,a),h.createElement("div",null,n[a])));e=h.createElement("ul",null,i)}else e=h.createElement("div",null,n);return h.createElement("li",null,h.createElement("article",{className:"page-container"},h.createElement("section",null,h.createElement("div",{className:"va-error"},h.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),h.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),h.createElement("div",null,"url: ",r),e,h.createElement("div",{className:"p-3"},h.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),h.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))}}]),t}(h.Component)},,,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAABz1SURBVHja1Ht5eBzVle+5tXb1JnWrtcuSbNmSjY2RWcxmiIGEDIEJMEmALB8fecMkhJdMlknCy3skE4YhkH0jTDIZAsO8gQyEhLwQJiFgMEsMBizvkixrX1otqffu6q6qW/e+c6sleZNsky//pP2VW6rl1j3b7/zOuVeEcw47128B3zndAIzB4ocA0LEpUDtWAcfzUsAPUlUYiCJD4Ze/AZbJgtLSAtwqg7Z2DZCaGsCh8DmC5yywX3sDuOMASybBTaVAX9cFbjaH1yXgpgmsWARjy0Xg33opgE8DbtvgJmZg2Y8Yt2wBy+UBJAlO64MTIqoKPJf7YOnNXV8/f7SnVYG/lA8KyUslcEdHPSFO9xmQlag7l/x4OZdfIU795QgsrGUYINfVAqeuZ/FT3S+8hqWz77EHhy5Jq1LxL0tgDCsSMEBqqAeeyZ2WWzuzs808lf4KI0Sa0aT4X5bAntAIEsK6rgsVwICTx3wqfRufTa4pIEZkm2NDpyuwUKUsnAQPesoXLULe4jMM+DEPkfkxRSAG8Mh548474indWsPHqsPLuDRZ/EIAfAedit8u4+tTuhovVocfO1bgEwYgAp2vc4aGbkKtBtWu1dvkjrbvmS/+kQmE9lyK4EOEcHEvQZdjmQwiMxWxcy0CzAc5pTJQ+v+Iz/cIyLKY8GX43//AwYPgMsrL9nbURZBI0ll4fS+O+T28VjqZ1bz3Vt59oj7Q8t5ZSa6iI2N3SaVSlOF7Mwp5yyHkmSMCs0qASz4fAgKtqIgQPzdLH3X6Dr0XdI3JK5pfZvkiE0iJL2zBmNqC6WUN3t+P9/4RNHUSheaEOuBMTl2GqegGFATkttYDxrouwiYnrqej418DRekiqgJSKPhjIpPtck30QRyzGzSN4/tDpxJYpEiR9o6JYQ/By+CMjgsEl8C2vkDHJy+RMQVmZXCnNfIq3jWzKLCwijMwjHm1CaTq6oV8vJoVCp1cyK7pE1K46hnn0CC4E5NXcc7uwTfXsHyuzMxypzMy+qRslj4mogaNbrj5wpmACpRbmvKha646ZI+O3mYPj30DJxuUNC2jdnY8TCcm70RlWSyZ6ncz2QOsVHwSBTJPGcMuXR6whBc59HI6NHordylqW4EZXUrkA8arflqJGk9gIkvA8gUov/EWaKs7PA0Sv389KxQbOQ4ihwIjbnz6MOEsjNb4Ki+a3UpT4yVqe1un1bPnZzQx24iTkLmLSEqkNaxorhSTkiIRlc4l7yi98PJKls0GcczDJBT8RzkafZROTnnehMr6KnqQD8MmiYounDKvLiesiC7OY2x45EvpXLbej8Ji+ELcJ+9QDKOHmkU4JoaJonjoh25XcRlVbcL4q0IXoeiGL7izcyU5HGzAeIySfMECx7nCGR59N1ptVNa0e/E7KUKa5bKbkGHVEU0DdCsfutmZgGFAdB2kcOgFbV3no55rIgvzAFCSBr14XDiWFXbp69680Sg4Z12amftcNp28LCMTqMZ7kwq3Erry32CVC4xxOAGlOXNBaW4CuTYWLu/bfw4UCgKXTElVd+I58b46KRBQEAF9bjJ9l9zSPKKsaPkoJvYXZNsCFakmWuo8jGVjgRl5VtdVzm0HpeRbpGBgE/7co52xDuNN86zsIe/JPkhnl1QGKsw60CuIiCwr6u1sNvnpMaCkWtJBQQHHwlqf0dD4NHrmIv4v+IcAi050iprKFd4mSdK53mQVZVquqtotydJ7rYO9j9L4dJVkGHnOERFVZRKBKYJT+RzG5nl4r4bx3YWuSTwcUJW0HI38GM/vJmgF5MFr7AN9Zwjr43nk58Z8PiVLI7K4JksntbwIRZaY2SL1HfrspJn1F3QV6ogKyOD5uCH/X0VREqgNDGfliMC8XP4OL5nPIHX7FE3MyOWdb651c/l6MQ+5oX4nc90Wa9+B+91kqg7d55MkGv0UWmecDg1f6AwcflwKh7+MYNdEZ2dX4QRavXjSdQuF+pYcqb6dBIMD81RPwXR0Jf7sBwEiboVEiAxxjFuLOMX7nYFBvOYIxVYEl44cooiZd/MWJV+4J1vIrxivq4a22noIOAyGg3oKve8ZfCtwvE8cR1A6X7jVC6dYzUfQEjKz6TsxRsNSdbgkRaMPOYcPb2KZ3ArJb7yCk9uJSpmSDeOvmeO8T0wWh0qCrh4mtnIBuvMqhtZVamufxee/gQKKd824cykQaQoR/CqWTJ+Fb91RsW7WEw4V61VSnnHRxe3+Q+CmMyA11gHD6krE6mLRgEpyEWcQE2qgULwXXfnioaYohDd1w+p9wzBuFWFyRdcvo21tg+Q4KlNBacMYw4m3InHoQO3d6bk1gYR+5oZ/xbjejmVhqyDszLK24IsRdCCHsN+F8TjMSnILouNK4rob3aJ5JsYkw3tMydCfQytTtDDQqalX0CI3codV82LR7ybnLpZCodeOZmDOyNhRQCRXhETXt/oGgMUTINfXgxKLzisth/dPSGpby53aTPIjQ0EdrCsugfMQmtyhEak3ZuSaNN8PjLJjnQAHXvqKRv7eTadvwuQdFAaXI5EiKuA/0RUR4Uqu1r3xv52h0a+w6cR5KFCV5PerxKX3I2Jvk+rr36GuaDZ4Pv88y+WSnPExSZXLiMLPQrnsuSiO96Kk619kth0WbIiXrH4mCAJDIFgudgWqitAQltW1ebeWK+6MliaG73bSf/i2ObsE/Stir3QzeTbyxq5r9ykUzDXrfnDJdG5/rrYBGJFOFBhT0K8x9fwBf9KIJGMODtiYZkwPeMRBaQKteTcPBqqgYMrIkhhaKuO9PBR8g0SqCbIyjq72LI7x7OKkPSAVwCMn8NzDR+VT4k3+eH8Tz2G6EqxJpDi+THpi5fLHlLJ1j8OZr6cpOhGtq7un7cXXr0nH49LeiLZ9JVceN5n7lZFE/ElOyIETBRaT4lywHHOhFDuhSKgIn61onx17uC73zi+HpicWHHxJ2ojWZ6k0onegAkrHP4cKRmZ3GyRmvsHLpdBbATmNqfDOc225zZlO3NwXC0LNed0/X3No4sp4If/F4ZLyMj61hMCnKLMWBVmYgHC1gN+LJ49AHN0a+pOKexwikwa3iARlOYKBXoFx/TE+NvlNKWcGX5cda1RRP3tD1j7gm8v8YoI5oezaNb9ZX9+yJrjr0C2zdvEQ0+p2k+NSnnLKtoplV+whhAyFvOLb19gIgXvu9HpQ+Qce9DoR6OJvX3AhmKiy8sVKnSuel5Wl7pNYqfR30vT0tyGTC+wyCJQ2n//vN+bpM/LhoQeyqVTbxPoOvqKzKxp+7pXLCslUtNAS2a5mCwWJwGkKLGgiap0Oj4o8Dfo5m0CqqwNraKRyHfMoMi2I3v9NcHbtgRKCizVwGGMQgdGnn56wSGxcUWrySqW5zH0EXf1j0lzyXqSogR6Nw8yF5/7npZGmf9CnDt5ZKpXeP2KgqwcCpH7XgYshmYKMJkM5UvViiQp6dyqBF9wWBRCJ38t98nw8zVtQTE6S5+leNgfq2k7wXXIRqKvaIfuVr3mxuKTnCrIhxvNATbCkvFepSeIcX1LYBnzms2rZvh2zRrAnJLPJLRc+dF5rxydqduy+qTg0/KmcxMHG51cOjAKzMQOgC2fCftu/etUewPGP97pjBUaNg654nJp4lE5dahJBzMl/Vy4UxsGxf7GooFQK5OveAz4kBPQ7P4JFEJtnRpi3AZkPMFSQiHuey1cQnCxNK7kstdCZ2W/7LHoDRQW+pFiFQaL8042z5reDAzsuKM7O/NCViF/Ms4tJYOL4ObRsddmB2YC+vUTpHrWq6gR8XERpwXUJ8lsPHV26RDzLmBHImTJ17x4YHnhn8be/+TQg+T8WSbkX58ql58Ga4UkAUXXNJT1mpDU2ACAJccxSJfWIppwoHpbADebQd0jl8j2+dP7iPCq/pzaQHAwE77o+7f6wZt+hbpPaP3E5q+JITGqQtiddC/okCpuYDDldhilmPa4VclksKE5AemURdYVbLdSax90kkj8dGT2TlK1/s1xncz+3nvbNJJ5QlgAYPjMDWl0UYCxeIeylSgNDpBpRogmrkuVKQUKQYrEbMV7vVG1nXUKTYBsvvVFq67jvA2PZX9X6jE0Flv8ZA2kD4RIY6JBZy4T9jdXQrBpQPTYDfRF9gNfWvo5exDGEYUmm5fV5teWBBq1f6yaT98nJ9Oa0Lpet6vAjxaEhDB++VIYBL4IRSC7B2sRZsOGpEbwOefj/1E3789ym/j6w3RcM6YnGtq67biprfcyyu4vMehDZWrfQlQ8ZVN4sQE/XCrv54i3krOdeV8edEoz6g09gldbr0qU7mxUuvVwnn1Qk4KZ5NTNL79GwiM9pEGe6voMI6y7TwWyiHC4G9YiwJ0drDHD2LrlU+oxetv4q4zqwS4fp14PKjwOMfP0aJWL5y+ZFKdP8PpflTcjtwMBhU9SCV6u14brW1kc3HJq4vjQydMYBjfUnqPU4mYov212tcOnamuWbZrbd4MzO3kpENwTHcKqrh1QOJYIF//HyCP2IPHCRScA11FP3jQGaERM+rJbLn6Zlq+kQofBHH30+79fvXaX6n/8rW4NgvviJVDr1JUbICh3foKKjTPIyvB7zv95+/gX/a8PBkXOc/b0rRkO6le5c+Uhd0L9fPomelfl6ePkcaDtXMeqcjxQeiThAzrZ2uXOzWfn4OBftRhSiy5WBh6KnWvNR0MWvV8zC7SSb2xonLvT7pMN7DennBvH/4CotPLtJ8VcVndLtyeHhO3CSVX58hGKt8QYvwa4a/1Od1ZFPXODI77KnZu6ec0rGVPemwsXXXTsUzQm85icXWPDXZQXmfAsRhTviiVea+TRuIRIqx4UkRYk7ygzWlbBgDy0rqGjOb0Xyf7Ni2ddlsHrq9UOuV5V+XZDY/ZcbtTvbiQaNstY1k0n+Ey/Z70f1ScJikxStqtJ+uaPtXy/VAt9duX/ootJI8uvUKhvja9qhtq096Pvtc9fEZxJPS7KydDPw/3xm3sKi47D0J4KTW7NQmIu40P1+2QjoRGHHarEkE2hPYVFO6DwTJcfGOCFRRN+vSqXSDQgn9Qg+QIN+iJ259leXxxN/79f0XHPJkQlnH8mkk59nheIGWeRvPN7Swdxv6E8EytI9N9SvGqjKFz80R+2vU6Y0DvrQCI110LF3AHoG+1qGFR7A4nFJgd+9YGHRuFu6LoU6e2CwRqSShRYJE+QED36UwBZe25CnEEGmQ0Xlh+ypODEJxdaWCjqTSuBQagd8rlsfFp6CQBnG+6KHRq/SOdyitNQcKKTjH8aa+ibM0YbgBV4Kw3e1xhpfW0PI5/1VWlodHf9qMp3+Ilc1Y1ZikEVbbBiYwpRfhpnm2EEzEsoqLju5S5PjimSPR4u4dtmZeKlZwAuft1htKuf48zI/kpIQoJAc1GAeJLJaaQHiNQmLjhr8vSQzTB9FkQnMg3WhL5fNTKLFcq7vsHin4TKJZtJ1RVX9rjQ6WsICIXB0mSneybBmjiVS3WoweBPV3YsL8ekbiddVkEDlDFowljS3DHFDTmdDwW1E08qcnSKGldUrj5VXVaDcsxfcdJrysiWIsyeIjJqLGYHmoKFrqHmPjgmXM7CCCiOlc4PasR6CrE1PJEGNT0N5ZSs4ujJVIPC/34wGHkyazm3rSuyWWLEcI5RJDi0EZMHRQQb3KNARuEEdO+qkkj9c4CaK4C3oOXn0JluVoKZE4SDhO+bAfUGlTqVbcjKBj89ZmPhB71odtqYSq51cTvE6jMLFcEKK5Vzg6mqUuY4pXJshm9JOtuznWUmCkMuhtexCOhiCfU5xMKcpX9gdNv64Lqt9c0Uy12GLrRRozaBY4xI9LVk+pv72JovfPlSJjUL1gJUprO2Kn58srkuUp5xCNPp4F5OTrOicvMW9uCZzDLNCrc7Mvo9NxT+FMeivNAFQcahRLV9oDfi0dWpz04SEdbCLrk/6D6PA0pFSm2DVQUgYKalYghHccsaVpfyGIgUaxVo6gTGH0Dso818Nb+zKGhOzP4kMDK/OR8KQwTEj8USlxXMU/RTMSgDlJFiwQ6ejoY41/7xVNrrp9PC6vSH96Quq6n5xtquCK518zdUT2J2aPtEquXwLS8y0eG3YhfJNcG7G9VCu+DeBTQ1/kBrqgM7NQbF3AF3bQ2bkp+QyVjL/GvP3Cnt4tJOUSjl8eIgXCgctn2+7wtjLmyWDFRHVTUw1JUPfljh7/W2+ZOaBmGV1FrZ0l4p9A8zYdzAgChFvOvjuBN47rBNz0Cc/2wrBL29Vq1q0g/13vloTGGtf0fLrhvHZK7YZUk+C2eMyLF1bf2aReJgnLtoRTX0TLT+NQjQc4+6ibi8Wb6Rm8Q2Z0p+5rruQhrq4bd0hhIUii1UUOeX1mokinecm5lzQtVlSy35dJPw76AKHznUk6KUMbF17vhCr/pyvf+iXoUOD44Vg4D9cw/dBlbEzuKjSkHBMNNe+1Ufsf77Qlrd1lXiTsr/vm7slu029eMvkRfHsJw8k9kZ31Rq35AlfVuBFC9uDQ0tdG8OKYw4UpWGJRemI1XvobnkmOcRsS7Rgz2Tp7AOYhLcc0/dSlKMW112ZF80Gpzzxccnv76Kx2O2Kovau6R+BaZ8BTFN/xxrqHyO9Ax+QOlpHzJWtDwVHJr8mcaYyHHONasTriP+pFrO4idDSwyPM2pAzNNiwp7/JnJxujjfF3iRVxpiRTFaaEydNS+HwUmijIc1SuegaSPIJNaubmGly51J3yc0Nj6E0N2HNuwUlPLbsO/pn0dKVKlUTKxa3Et13HwsaNyNCZzuH4yDpfpfXq0/SdOZmlkx/gG5Y+4/gsL8hExMXMny/byZ1dqAm+h3Xdq50bHt9EM+tLqHTjE+SOLVpXA/8PNDYMEpiNUuvVR0tsO/ss5ZC1wlr1+5xJ5nqIr4lNCasx+FSNzG7BVOE5P1OTr7pgy+s8Qoik05tBah+rxUJ/wf3+6BKcAWV7Ceh4G55du4S3aZcbaj7FovHH8EHA+htTXQ68Vkxjo6aS2O1NKMSvIAFfyQ0adfVbldopcVzqg0rYk13qWNWCod2S4av0vpZTgpKJb7IppbWKDIpTF1Y6fD53nulWxkmVvnGZGOsur+uCijmfsSBCU7pNvyOQCZzFd64gwRDvQthoiCA+HAug0g09q9fyZuitVDAcnKstvoprmm7KTI3iteXO46sHuYLJx7ZfLUcDNYTw++1Y06rb328sDjPEtYuPVhLbuPF/nGg2QU9IdqL/v1mlOVccR+dioMzPumwgplS0IJmIX+25dKULCs7xDN6ZTsQ7CQW7WmofrC7uf33DTkT+sLaYbe58WFd1aiGKU3z+ZY9Fl3a2t+31HxX4XGht2CtyG+7ty7KRxMn2NNQNT3M7Ts3Fegr/bq8Osj170cyxQ4mXJvS2szQ4KqspkJXtozPoG1DIVVKpcA2fDU0i/SkVO51ZIkNuZa0X2KH9PWdX3tnrKm/fvvOB3qsvJm68KxvocJ3czit7VQLoBVaeoEkhxXBPMs61YYsNt/aIYu7CdCNAga0Nrf+rvvw2KMxpA1zqlGtFIpJVyIdfnw1WhDSIyNaCr9ZXXtlpd9xmSAdLoFOWZHq9WjELqaTfL9KfuGXlc9cWSTMyE8+vK+Y2VS69spd77z2ut+AQ0/bEBUuXRtbylWHMceOuqXS2uWFRYKC/4TbYnmDh4Q0knhcmKKSgo4Lkf7Ry9xy6SFTlsOBDD3ftaywAK4514Zev5xjazfOVRs6FgA6KLbDnf4Bx+trE2JBtMblAZqRUsnS5uZVO1pjdZaz7aVv9bn2lfEVMdjokHUjjz1+Naatn56OsBd+6PqlufT8uQwJBA9CKvPu5RbKZERFS1ehf2XTGM1mJltSua5qkMM6FqoiBzP0jrJltWGp1ybSkSQW3ZG27pWcxH6NvgLR8C/PuuD8Z8INjaC+1gOSWdaUSHXMyU9ArlAciMXoHFdkP75ZrTLLHy+PT95IVXkz6AZszDmQf34721ulFthp7ib+8CLTWqbhRfz6fxGJXI3u2bkcMAknhHDwX/pp4d8P2dIWw3LWb/IHb+go0XV0YZfNkQYKojSzkQn9qKzr90k+n+P6dPAXTdAbGxFMyq18eORSEUKzZbNYH58qc9UfRfdWyMh4p8CFPHqUISkQKlrwVkTfI7ev+J1yqp21x7u02t623PUe2We8Zu3b3ykKf2814ugVVPwdQYU3JnOmXdcU32OVnpjB46z2FS8oQ/HfOsVCgBwV/wJYKCG02YXhzUXXmVZNqN7TC/WmA7bY/M1ZO1a13UVNYWW/vtsIhh2SzlPZccCPITNNS3AwoILYLTeGJVq6pfZRIxhMEw5vT2BpHrKXiOOVru7byI/QhuM2xnGxGqGFOGzt9lU91B5tzT85lwJJ07fTWORJks/dfPS+SBHz6E3SmGsFLCxBfZN5MKYzWEdXgYuVEmQLm9WypSZUMpktm8+H6uqAmPZ6LEnlXrBh7Nz1+bW1TQH/71+UehrDr8o1Nf8ldhq9DXkrAtOJ8eUWbpNseCwuUbebLZWaxGo8ajs4l1mr+QKt9T7jwHvWnwNBrHIKqn6/Npu8VC0W2110a6+BACJVMTLu17TDiOCbLAJRRwNXxLZhXENSmU+WUTe9iruvo67lYIvia5k2zUtfIuV8Sle+u4XKMy3DUz98JaCWaGfH3cFgaO7tLtF6PkrE4tkSBw42Z4eC38ciPy0tsyJY+VuEcic1zfcVDZ1s2Hg2+NFjLJ/2Rjbs/57YGyAhyRC7HMRK4UzYbzactbH/by0DLnA1zESKWDW5ns3MPSBZVuOkT6bqxvXPdbevyTqJmXekC9lVgSu23re1YeW/NL114F2v7H3LGWmquSMYrvqDLLZFKsppH0eIh7w8zJl+48VSNPhv1cnc5zXOCTseIMTiF+OyOzZ+g15T81ui6W/VtLTC9N49YNbFfjpXEzmv5uDhD8mUEYcziBh+uanIzg46YNmcrXEJvRoc53IZqWYRlbxPhT+0UfKzdoeQ2cT0VrlYMjYqgWsDJfvqHgMunOve/ONotPoBmRBGKnz+bX08gX8fCyy/0602aPna637UdWjs8ob+4XOIono18Qn7IEvOep7N3ovM7G9hbm68um8IYrruWFZ5D4bD+zC3Ir/TIDydDMNc5t4SVqWoKbH3cD7GCfRV+1LVPv2nl42l0tmuyI2O67w/hIFAn31h8ytu0Zo6o+O7Gy+//JuBQNBllMKf8vEEXl1Vs+wNLlolHAyP1vkiT7nDE+f4LAccrdKdJEfzaSwynInJd5GXX73DGRq+Q6qurnEpvV3KF29FM/i4XOm9sErBIZ7RFni4QIdR0W3v3ji5OVMupnsHb4UDvf+gZXPVSXzsgF+a3O/K98Zk+Ufezj3Glk2lpyXwZStWn5Q6IhLDRNB8YnRdx9aGXQeu8LkK2DLx6CQ/an1ZTKS0d99H5aqqemRoTZw6FwnrextL+PLFhiueVwhsGE+ujCYzPzGtcrtllWBEB3evyp/NhrRvaGX+IvyJQp4gcJmeqtNHgPqN/qm2plvihw9/aZUDH63D/C+MIpZYvP7xAhurqvJjXnw/Eb0wBCvRfRT5lx2X2MgiDycecnZRCWjfQDCBjHRaV+CwLu2ZDfseMV3nMYPzOP0zCPu2/qrF+5sG4BNZVfpC3pBfjxatmxq5fEmIsqCOMCt7m8MrUlC815rfeKZzF1SEanV+TwifDwbJ22HBwMbrFgJfllAaD6szk5zuTKrsKRbwvaSp6rAijEHgz/Z5W3/GIxiNwrlZlskjvT7y9GFNuSJI4TKfWV4b8ilnIMWLIFsCS/MVMy7dqUdipprOxKoYOUuzbZ+3BCJVdk45KKypKVDU1WSSll/KMvosM4xByxGlHmR9Qil/Jqse/fn/AgwAOY4uqSLnKwwAAAAASUVORK5CYII="},function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.ee7cd8ed.svg"},function(e,t,n){e.exports=n(145)},,,,,function(e,t,n){},,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,,,,,,,,,,,,,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(51),a=n(17),o=(n(88),n(12)),s=n(26),c=n(56);var u={tuid:{product:{inputContent:e=>{let t=e;r.createElement("div",null,"image");return r.createElement("div",{className:"row d-flex"},r.createElement("div",{className:"col-12"},r.createElement("div",{className:"row py-2"},r.createElement("div",{className:"col-12"},r.createElement("strong",null,t.description))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement("img",{src:"favicon.ico",alt:"structure"})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u4ea7\u54c1\u7f16\u53f7:"),r.createElement("div",{className:"col-8 col-md-4"},t.origin))))))}},address:{inputContent:e=>{let{description:t}=e;return r.createElement("div",null,t)}},contact:{inputContent:e=>r.createElement("div",null,"gee")}}};var l={CApp:c.CCartApp,usqs:{"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/cart":u}},h=n(22);var f=n(53),d=n.n(f);const p={homeCount:h.k.box(-1),cartCount:h.k.box(101)},v=[{name:"home",label:"\u9996\u9875",icon:"home",content:function(){return r.createElement(r.Fragment,null,c.cCartApp.cHome.renderHome())},notify:p.homeCount},{name:"member",label:"\u4f1a\u5458",icon:"vcard",content:()=>{let e=d()({loader:()=>Promise.resolve().then(n.bind(null,56)),loading:o.d,render(e,t){let{cCartApp:n}=e;return n.cMember.start(),r.createElement(n.cMember.render,null)}});return r.createElement(e,null)}},{name:"cart",label:"\u8d2d\u7269\u8f66",icon:"shopping-cart",content:()=>{let e=d.a.Map({loader:{a:()=>Promise.resolve().then(n.bind(null,56))},loading:o.d,render(e,t){let{cCartApp:n}=e.a;return r.createElement("div",null,n.cCart.renderCart())}});return r.createElement(e,null)},notify:p.cartCount},{name:"me",label:"\u6211\u7684",icon:"user",content:()=>{let e=d()({loader:()=>n.e(2).then(n.bind(null,147)),loading:o.d});return r.createElement(e,null)}}].map(e=>{let{name:t,label:n,icon:r,content:i,notify:a}=e;return{name:t,caption:e=>Object(o.h)(n,r,(e=>!0===e?"text-primary":"text-muted")(e)),content:i,notify:a}}),m="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/cart";var b=class extends r.Component{constructor(){super(...arguments),this.onLogined=(()=>a.a(this,void 0,void 0,function*(){yield Object(s.b)(m,l);let e=r.createElement(o.f,{header:!1},r.createElement(o.i,{tabs:v}));o.p.push(e)}))}render(){return r.createElement(o.e,{onLogined:this.onLogined,notLogined:this.onLogined})}};const y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=(()=>{const t=e.installing;t&&(t.onstatechange=(()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}))})}).catch(e=>{console.error("Error during service worker registration:",e)})}n(141),n(143);i.render(r.createElement(b,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="./service-worker.js";y?(function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):w(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):w(e)})}}()}],[[83,4,3]]]);
//# sourceMappingURL=main.caafe84b.chunk.js.map