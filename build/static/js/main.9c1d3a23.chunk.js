(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(t,e,n){"use strict";n(89),n(48);var r=n(28);n.d(e,"CenterApi",function(){return r.a}),n.d(e,"UnitxApi",function(){return r.b}),n.d(e,"UsqApi",function(){return r.c}),n.d(e,"loadAppUsqs",function(){return r.h}),n.d(e,"meInFrame",function(){return r.j}),n.d(e,"postWsToTop",function(){return r.k});var i=n(40);n.o(i,"Controller")&&n.d(e,"Controller",function(){return i.Controller}),n.o(i,"Field")&&n.d(e,"Field",function(){return i.Field}),n.o(i,"Form")&&n.d(e,"Form",function(){return i.Form}),n.o(i,"Loading")&&n.d(e,"Loading",function(){return i.Loading}),n.o(i,"NavView")&&n.d(e,"NavView",function(){return i.NavView}),n.o(i,"Page")&&n.d(e,"Page",function(){return i.Page}),n.o(i,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return i.TabCaptionComponent}),n.o(i,"Tabs")&&n.d(e,"Tabs",function(){return i.Tabs}),n.o(i,"VPage")&&n.d(e,"VPage",function(){return i.VPage}),n.o(i,"View")&&n.d(e,"View",function(){return i.View}),n.o(i,"nav")&&n.d(e,"nav",function(){return i.nav}),n.o(i,"resLang")&&n.d(e,"resLang",function(){return i.resLang});n(44);var o=n(98);n.d(e,"PageItems",function(){return o.a});n(99)},,,function(t,e,n){"use strict";var r,i=n(4),o=n(19),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},u=function(){function t(t){this.formView=t}return t.prototype.render=function(){return i.createElement("div",{className:"col-sm-10"},this.renderControl())},Object.defineProperty(t.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t.prototype.clearErrors=function(){},t.prototype.readValues=function(t){},t.prototype.setError=function(t,e){},t.prototype.setInitValues=function(t){},t.prototype.isOk=function(){return this.validate(),!this.hasError},t.prototype.validate=function(){},a([o.d],t.prototype,"hasError",null),a([o.d],t.prototype,"filled",null),t}(),c=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.field=n,i.face=r,i.init(),i.setProps(),i}return s(e,t),e.prototype.ref=function(t){this.element=t},e.prototype.init=function(){var t;this.rules=[];var e=this.field.rules;void 0!==e&&(!0===Array.isArray(e)?(t=this.rules).push.apply(t,e):this.rules.push(e))},e.prototype.setProps=function(){return this.props={ref:this.ref.bind(this),name:this.field.name}},Object.defineProperty(e.prototype,"hasError",{get:function(){return void 0!==this.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return void 0!==this.value&&this.value!==this.field.defaultValue},enumerable:!0,configurable:!0}),e.prototype.clearValue=function(){this.value=void 0},e.prototype.clear=function(){this.clearErrors(),this.clearValue()},e.prototype.clearErrors=function(){this.isOK=void 0,this.error=void 0},e.prototype.readValues=function(t){t[this.field.name]=this.value},e.prototype.setError=function(t,e){},e.prototype.setInitValues=function(t){},e.prototype.getValueFromElement=function(){return this.value},e.prototype.validate=function(){try{var t=this.getValueFromElement();if(this.rules.length>0){for(var e=void 0,n=0,r=this.rules;n<r.length;n++){var i=r[n];console.log("validate: %s",t);var o=i(t);if(console.log("validate: %s err: %s",t,o),!0===o)this.error=void 0,e=!0;else if(void 0!==o)return this.error=o,void(this.isOK=!1)}this.isOK=e}this.value=t}catch(s){this.error=s.message}},e.prototype.render=function(){var t;if(void 0!==this.face){var e=this.face.notes;void 0!==e&&(t=i.createElement("small",{className:"text-muted"},e))}return i.createElement("div",{className:"col-sm-10"},this.renderControl(),t)},a([o.k],e.prototype,"isOK",void 0),a([o.k],e.prototype,"error",void 0),a([o.k],e.prototype,"value",void 0),a([o.d],e.prototype,"hasError",null),a([o.d],e.prototype,"filled",null),e}(u),l=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e){var n=t.call(this,e)||this;return n.otherClick=n.otherClick.bind(n),n}return l(e,t),e.prototype.otherClick=function(){var t=this.formView.props.onOther;void 0!==t&&t(this.formView.readValues())},e.prototype.renderControl=function(){console.log("buttons.renderControl");var t=this.formView.nothing,e=this.formView.hasError,n=this.formView.props;console.log("buttons.renderControl nothing:%s hasError:%s",t,e);var r,o=n.submitButton,s=n.otherButton;n.onOther;return void 0!==s&&(r=i.createElement("button",{className:"btn btn-outline-info ml-auto",onClick:this.otherClick},s)),i.createElement("div",{className:"d-flex justify-content-start"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:t||e},o||"\u63d0\u4ea4"),r)},e}(u),p=n(31),d=n(7),f=n.n(d),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.init=function(){t.prototype.init.call(this),!0===this.field.required&&this.rules.push(function(t){return null!==t&&void 0!==t&&0!==t.trim().length||"\u5fc5\u987b\u586b\u5165\u8981\u6c42\u5185\u5bb9"})},e.prototype.getValueFromElement=function(){return this.parseValue(this.element.value)},e.prototype.setProps=function(){t.prototype.setProps.call(this),p.assign(this.props,{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)});var e=this.face;return void 0!==e&&p.assign(this.props,{placeholder:e.placeholder}),this.props},e.prototype.parseValue=function(t){return t},e.prototype.onBlur=function(){this.validate()},e.prototype.onChange=function(){console.log("onChange"),this.validate()},e.prototype.onFocus=function(){this.clearErrors()},e.prototype.className=function(){return d({"form-control":!0,"has-success":!0===this.isOK,"is-invalid":void 0!==this.error,"is-valid":void 0===this.error&&!0===this.isOK})},e.prototype.renderInput=function(){return i.createElement("input",v({className:this.className()},this.props))},e.prototype.ref=function(e){t.prototype.ref.call(this,e),e&&(e.value=void 0===this.value?"":this.value)},e.prototype.renderError=function(){return void 0===this.error?null:i.createElement("div",{className:"invalid-feedback"},this.error)},e.prototype.clearValue=function(){t.prototype.clearValue.call(this),this.element.value=""},e.prototype.setError=function(t,e){this.field.name===t&&(this.error=e)},e.prototype.setInitValues=function(t){var e=t[this.field.name];void 0!==e&&(this.value=e)},e.prototype.renderControl=function(){return i.createElement(i.Fragment,null,this.renderInput(),this.renderError())},e}(c),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this);return p.assign(e,{type:"text",maxLength:this.field.maxLength}),e},e.prototype.parseValue=function(t){if(void 0!==t&&0!==t.trim().length)return t},e}(b),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this);return p.assign(e,{type:"password",maxLength:this.field.maxLength}),e},e}(g),E=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.extraChars=[];var e=this.field,n=e.min,r=e.max;switch(void 0!==n?(this.rules.push(function(t){if(void 0!==t)return!(t<n)||"\u6700\u5c0f\u503c\u4e3a"+n}),n<0&&this.extraChars.push(45)):this.extraChars.push(45),void 0!==r&&this.rules.push(function(t){if(void 0!==t)return!(t>r)||"\u6700\u5927\u503c\u4e3a"+r}),this.field.type){case"dec":case"number":this.extraChars.push(46)}},e.prototype.parseValue=function(t){if(void 0!==t&&0!==t.trim().length){var e=Number.parseFloat(t);if(isNaN(e))throw new Error("\u65e0\u6548\u7684\u6570\u5b57");return e}},e.prototype.setProps=function(){t.prototype.setProps.call(this),p.assign(this.props,{type:"number",step:this.field.step,onKeyPress:this.onKeyPress.bind(this)})},e.prototype.onKeyPress=function(t){var e=t.charCode;if(!(8===e||0===e||13===e||e>=48&&e<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(e)>=0)switch(e){case 46:this.onKeyDot();break;case 45:this.onKeyNeg(),t.preventDefault()}else t.preventDefault()},e.prototype.onKeyDot=function(){var t=this.element.value;t.indexOf(".")>=0&&(this.element.value=t.replace(".",""))},e.prototype.onKeyNeg=function(){var t=this.element.value,e=t.indexOf("-");t=e>=0?t.replace("-",""):"-"+t,this.element.value=t},e}(b),k=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.field,n=e.trueValue,r=e.falseValue;void 0===n&&(this.trueValue=1),void 0===r&&(this.falseValue=0)},e.prototype.setProps=function(){t.prototype.setProps.call(this),p.assign(this.props,{onChange:this.onChange.bind(this)})},e.prototype.clearValue=function(){this.element.checked=this.field.defaultValue===this.trueValue,this.value=this.getValueFromElement()},e.prototype.setInitValues=function(t){var e=t[this.field.name];void 0===e&&(e=this.field.defaultValue)},e.prototype.getValueFromElement=function(){return this.element.checked?this.trueValue:this.falseValue},e.prototype.onChange=function(){this.value=this.getValueFromElement()},e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static"},i.createElement("label",{className:"form-control"},i.createElement("label",{className:"custom-control custom-checkbox mb-0"},i.createElement("input",{type:"checkbox",name:this.field.name,ref:this.props.ref,onChange:this.props.onChange,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},this.face.label))))},e}(c),O=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return O(e,t),e.prototype.renderControl=function(){var t=this;return i.createElement("div",{className:"form-control-static"},i.createElement("div",{className:"form-control"},this.face.list.map(function(e,n){var r;return"object"!==typeof e?r=e:(r=e.text,e.value),i.createElement("label",{key:n,className:"custom-control custom-radio w-25"},i.createElement("input",{type:"radio",name:t.field.name,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},r))})))},e}(c),S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(){return(x=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this),n=this.field.maxLength,r=this.face.rows;return p.assign(e,{maxLength:n,rows:r}),e},e.prototype.renderInput=function(){var t=this;return i.createElement("textarea",x({ref:function(e){t.el=e,void 0!==e&&(e.value="")},className:this.className()},this.props))},e}(b),V=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.ref=i.ref.bind(i),i}return V(e,t),e.prototype.getValueFromElement=function(){var t=this.element,e=(t.selectedIndex,t.selectedOptions[0].value);switch(this.field.type){case"number":e=Number(e);break;case"date":e=new Date(e);break;case"bool":"string"===typeof e&&(e="true"===e.toLowerCase())}return e},e.prototype.renderControl=function(){var t=this.face.list,e=[];return void 0===this.face.default&&e.push(i.createElement("option",{key:-1,value:void 0},"\u8bf7\u9009\u62e9")),e.push.apply(e,t.map(function(t,e){var n,r;return"object"!==typeof t?n=r=t:(n=t.text,r=t.value),i.createElement("option",{key:e,value:r},n)})),i.createElement("div",{className:"form-control-static"},i.createElement("select",{name:this.field.name,className:"form-control",ref:this.ref},e))},e}(c),A=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return A(e,t),e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},i.createElement("div",{className:"alert alert-primary",role:"alert"},"don't know how to create control",i.createElement("br",null),"field: ",JSON.stringify(this.field)," must be object ",i.createElement("br",null),"face: ",JSON.stringify(this.face)," must be object ",i.createElement("br",null)))},e}(c),I=function(t){function e(e,n){var r=t.call(this,e)||this;return r.element=n,r}return A(e,t),e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},this.element)},e}(u),q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},D=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},U=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return D(e,void 0,void 0,function(){var t,e,n,r,i,o,s;return U(this,function(a){switch(a.label){case 0:return t=this.face,e=t.pick,n=t.fromPicked,[4,e(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=a.sent())?(this.value=void 0,[2]):void 0===n?(this.value=r.id,[2]):(i=n(r),o=i.id,s=i.caption,this.value=o,this.caption=s,[2])}})})},e.onPicked=function(t){e.value=t.id},e}return q(e,t),e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.controlContent=function(){var t=this.face,e=t.itemFromId,n=t.fromPicked,r=t.initCaption;if(void 0===this.value)return r||"\u8bf7\u9009\u62e9Id";if(void 0!==this.caption)return this.caption;if(void 0!==e&&void 0!==n){var i=e(this.value);if(i){var o=n(i);if(void 0!==o)return o.caption}}return String(this.value)},e.prototype.renderControl=function(){var t=this.face,e=t.tuid,n=t.input;return void 0===n?i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer",onClick:this.onClick},this.controlContent()):i.createElement("div",{className:"form-control-static "},i.createElement(n.component,{id:this.value,ui:e}))},R([o.k],e.prototype,"caption",void 0),e}(c),M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return(B=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},H=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},W=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.onIdChanged=i.onIdChanged.bind(i),i}return M(e,t),e.prototype.onIdChanged=function(t){this.value=t.id},e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.buildContent=function(){var t=this;return i.createElement(this.face.input.component,B({},this.face,{id:this.value,onFormValues:function(){return t.formView.readValues()},onIdChanged:this.onIdChanged}))},e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static "},this.buildContent())},H([o.k],e.prototype,"caption",void 0),e}(c),K=n(30),Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},z=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},X=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return z(e,void 0,void 0,function(){var t,e,n,r,i,o,s;return X(this,function(a){switch(a.label){case 0:return t=this.face,e=t.pick,n=t.fromPicked,[4,e(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(r=a.sent())?(this.value=void 0,[2]):(i=n(r),o=i.id,s=i.caption,this.value=o,this.caption=s,[2])}})})},e.view=Object(K.a)(function(){var t,n=e.face.content;return t=void 0===e.value||null===e.value?"\u8bf7\u9009\u62e9":i.createElement(n,{id:e.value}),i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer bg-light",onClick:e.onClick},t)}),e}return Q(e,t),e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.renderControl=function(){return i.createElement(this.view,null)},J([o.k],e.prototype,"caption",void 0),e}(c),Z=function(t,e){e.label;return void 0!==e.group?function(t,e,n){return new T(t,n,void 0)}(t,0,e):void 0!==e.field?function(t,e,n){var r=n.field,i=n.face;switch(typeof r){case"string":r={name:r,type:"string"};break;case"object":break;default:return new T(t,r,i)}var o=r.type||"string";if(void 0===i){if(void 0===(i=Y[o]))return new T(t,r,i)}else if(void 0===i.type){var s=Y[o];i.type=void 0===s?"string":s.type}return new(G[i.type||o]||T)(t,r,i)}(t,0,e):new I(t,e.help)},G={string:g,password:w,number:C,checkbox:P,radiobox:N,select:F,"pick-id":L,"pick-tuid":W,textarea:j,pick:_},Y={string:{type:"string"},number:{type:"number"},int:{type:"number"},dec:{type:"number"},bool:{type:"checkbox"}};var $=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(){function t(t,e){if(this.form=t,this.row=e,void 0===e.type){var n=e.createControl;void 0===n&&(n=t.createControl),void 0===n&&(n=Z),this.control=n(t,e)}}return t.prototype.isOk=function(){return void 0===this.control||this.control.isOk()},t.prototype.contains=function(t){var e=this.row.field;if(void 0!==e)return t===e.name;var n=this.row.group;return void 0!==n&&void 0!==n.find(function(e){return e.field.name===t})},Object.defineProperty(t.prototype,"hasError",{get:function(){return this.control.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return this.control.filled},enumerable:!0,configurable:!0}),t.prototype.clear=function(){void 0!==this.control&&this.control.clear()},t.prototype.clearErrors=function(){void 0!==this.control&&this.control.clearErrors()},t.prototype.readValues=function(t){void 0!==this.control&&this.control.readValues(t)},t.prototype.setError=function(t,e){void 0!==this.control&&this.control.setError(t,e)},t.prototype.setInitValues=function(t){void 0!==this.control&&this.control.setInitValues(t)},t}(),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.render=function(t){return i.createElement("div",{key:t,className:"form-group"},this.row)},Object.defineProperty(e.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(tt),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.render=function(t){return i.createElement("div",{key:t,className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.row.label),this.control.render())},e}(tt);function rt(t,e){return new nt(t,e)}function it(t,e){return new et(t,e)}var ot="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",st=8;function at(){for(var t=ot.length,e="",n=0;n<st;n++)e+=ot.charAt(Math.floor(Math.random()*t));return e}var ut=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ct=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},lt=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ht=function(){function t(t){this.rows=[],this.uid=at(),this.props=t,this.buildRows(t),this.createControl=t.createControl,this.onSubmit=this.onSubmit.bind(this)}return Object.defineProperty(t.prototype,"hasError",{get:function(){var t=this.rows.map(function(t,e){return e+": "+t.hasError+"\n"});return console.log(t),this.rows.some(function(t){return t.hasError})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nothing",{get:function(){return this.rows.every(function(t){return!t.filled})},enumerable:!0,configurable:!0}),t.prototype.readValues=function(){for(var t={},e=0,n=this.rows;e<n.length;e++){n[e].readValues(t)}return t},t.prototype.clear=function(){for(var t=0,e=this.rows;t<e.length;t++){e[t].clear()}},t.prototype.clearErrors=function(){for(var t=0,e=this.rows;t<e.length;t++){e[t].clearErrors()}},t.prototype.setError=function(t,e){for(var n=0,r=this.rows;n<r.length;n++){r[n].setError(t,e)}},t.prototype.setInitValues=function(t){if(void 0!==t)for(var e=0,n=this.rows;e<n.length;e++){n[e].setInitValues(t)}},t.prototype.buildRows=function(t){var e=t.formRows,n=t.createRow;if(void 0!==e){for(var r=0,o=e;r<o.length;r++){var s=o[r];this.rows.push(this.buildRow(s,n))}!0!==this.props.readOnly&&(this.buttonsRow=this.buildRow({createControl:this.createButtons.bind(this)},void 0))}else this.rows.push(it(this,i.createElement("div",{className:"text-warning"},"TonvaForm need formRows defined")))},t.prototype.buildRow=function(t,e){var n;return void 0!==t.type?n=it:void 0===(n=t.createRow)&&void 0===(n=e)&&(n=rt),n(this,t)},t.prototype.createButtons=function(t,e){return new h(t)},t.prototype.isOk=function(){for(var t=!0,e=0,n=this.rows;e<n.length;e++){n[e].isOk()||(t=!1)}return t},t.prototype.render=function(){var t=this;return i.createElement("form",{onSubmit:this.onSubmit},this.rows.map(function(e,n){return e.render(t.uid+n)}),this.buttons())},t.prototype.buttons=function(){if(void 0!==this.buttonsRow)return this.buttonsRow.render(this.uid+this.rows.length)},t.prototype.onSubmit=function(t){return ct(this,void 0,void 0,function(){var e;return lt(this,function(n){switch(n.label){case 0:return t.preventDefault(),this.isOk()?(e=this.readValues(),[4,this.props.onSubmit(e)]):[2];case 1:return n.sent(),[2]}})})},ut([o.d],t.prototype,"hasError",null),ut([o.d],t.prototype,"nothing",null),t}(),pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};var ft=function(t){function e(e){var n=t.call(this,e)||this;return n.formView=new ht(n.props),n}return pt(e,t),e.prototype.componentWillMount=function(){this.formView.setInitValues(this.props.initValues)},e.prototype.debug=function(){},e.prototype.render=function(){var t=this.props,e=t.className,n=t.children;t.initValues;return i.createElement("div",{className:e},void 0===n?this.formView.render():i.createElement("form",{onSubmit:this.formView.onSubmit},n))},e=dt([K.a],e)}(i.Component),mt=n(63),vt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bt=(function(t){function e(e){var n=t.call(this,e)||this;return n.toggle=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={dropdownOpen:!1},n}vt(e,t),e.prototype.render=function(){var t=this.props,e=t.icon,n=t.actions,r=t.isRight;void 0===r&&(r=!0);var o=n.some(function(t){return void 0!==t.icon});return i.createElement(mt.d,{isOpen:this.state.dropdownOpen,toggle:this.toggle},i.createElement(mt.c,{caret:!0,size:"sm",className:"cursor-pointer"},i.createElement("i",{className:d("fa","fa-"+(e||"ellipsis-v"))})),i.createElement(mt.b,{right:r},n.map(function(t,e){var n,r=t.icon,s=t.caption,a=t.action;return void 0===r&&void 0===s?i.createElement("div",{className:"dropdown-divider"}):(!0===o&&(void 0!==r&&(r="fa-"+r),n=i.createElement(i.Fragment,null,i.createElement("i",{className:d("fa",r,"fa-fw"),"aria-hidden":!0}),"\xa0 ")),void 0===a?i.createElement("h6",{className:"dropdown-header"},n," ",s):i.createElement(mt.a,{key:e,onClick:a},n," ",s))})))}}(i.Component),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bt(e,t),e.prototype.render=function(){var t=this.props.date;if(!t)return null;var e="string"===typeof t?new Date(Date.parse(t)):t,n=new Date,r=n.getTime()-e.getTime(),i=n.getDate(),o=e.getDate(),s=e.getHours(),a=e.getMinutes(),u=e.getMonth()+1,c=s+(a<10?":0":":")+a;return r<-864e5?e.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5 "+c:r<864e5?o!==i?(r<0?"\u660e\u5929 ":"\u6628\u5929 ")+c:c:r<31536e6?u+"\u6708"+o+"\u65e5 ":e.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5"},e}(i.Component),gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wt=function(){function t(){}return t.prototype.setValues=function(t){},t}(),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.render=function(t){return i.createElement("div",{key:"_b_"+t,className:""},i.createElement("div",{className:"col-sm-12"},i.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))},e}(wt),Ct=function(t){function e(e){var n=t.call(this)||this;return n.param=e,n}return gt(e,t),e.prototype.render=function(t){var e;switch(this.param){default:e="py-2";break;case"=":e="py-1";break;case"-":e="pb-1"}var n=d(e);return i.createElement("div",{key:"_g_"+t,className:n,style:{backgroundColor:"#f0f0f0"}})},e}(wt),kt=function(t){function e(e,n){var r=t.call(this)||this;return r.gridProps=e,r.prop=n,r}return gt(e,t),e.prototype.render=function(t){var e=this.prop,n=e.onClick,r=e.bk,o=d({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return i.createElement("div",{key:t,className:o,onClick:n},this.renderLabel(),this.renderProp())},e.prototype.renderLabel=function(){var t=this.prop.label;return void 0===t?null:i.createElement("label",{className:"col-sm-2 col-form-label"},t)},e.prototype.renderProp=function(){var t,e,n=this.prop,r=n.label,o=n.full;switch(this.gridProps.alignValue){case"left":t="justify-content-start";break;case"center":t="justify-content-center";break;case"right":t="justify-content-end"}switch(this.prop.vAlign){case"top":e="align-items-start";break;default:case"center":e="align-items-center";break;case"bottom":e="align-items-end";break;case"stretch":e="align-items-stretch"}var s=d(t,e,!0!==o?void 0===r?"col-sm-12":"col-sm-10":"w-100","d-flex");return i.createElement("div",{className:s},this.renderPropBody())},e.prototype.renderPropBody=function(){return i.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())},e.prototype.renderPropContent=function(){return this.content},e}(wt),Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.setValues=function(t){this.content=void 0===t?void 0:t[this.prop.name]},e}(kt),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.setValues=function(t){this.content=void 0===t?void 0:t[this.prop.name]},e}(kt),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.setValues=function(t){if(void 0===t)this.content=void 0;else{var e=this.prop.list;this.content="string"===typeof e?t[e]:void 0}},e.prototype.renderPropBody=function(){var t=this.prop,e=t.list,n=t.row,r="string"===typeof e?this.content:e;return void 0===r?i.createElement("div",null):i.createElement("div",{className:"w-100"},r.map(function(t,e){return i.createElement(i.Fragment,{key:e},0===e?null:i.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),i.createElement(n,t))}))},e}(kt),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.renderPropBody=function(){return this.prop.component},e}(kt),xt=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}gt(e,t),e.prototype.render=function(t){return i.createElement("div",{className:"bg-white"},i.createElement("label",{className:"col-sm-2 col-form-label"},"AAABBBCCC"),i.createElement("div",{className:"col-sm-10"},i.createElement("div",{className:"form-control-plaintext"},"dsfasfa sdf asdf a")))}}(wt),function(){function t(t,e){this.gridProps=t,this.props=e,this.buildRows()}return t.prototype.buildRows=function(){this.rows=[];for(var t=!0,e=0,n=this.props;e<n.length;e++){var r=n[e];if("string"===typeof r)this.rows.push(new Ct(r)),t=!0;else{t||this.rows.push(new Et);var i=void 0;switch(r.type){default:continue;case"string":i=new Pt(this.gridProps,r);break;case"number":i=new Ot(this.gridProps,r);break;case"list":i=new Nt(this.gridProps,r);break;case"component":i=new St(this.gridProps,r)}this.rows.push(i),t=!1}}},t.prototype.setValues=function(t){for(var e=0,n=this.rows;e<n.length;e++){n[e].setValues(t)}},t.prototype.render=function(){return this.rows.map(function(t,e){return t.render(String(e))})},t}()),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jt(e,t),e.prototype.render=function(){var t=this.props,e=t.className,n=t.rows,r=t.values,o=new xt(this.props,n);o.setValues(r);var s=d("container-fluid",e);return i.createElement("div",{className:s},o.render())},e=Vt([K.a],e)}(i.Component),At=(n(145),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Tt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},It=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}At(e,t),e.prototype.render=function(){var t,e=this.props,n=e.className,r=e.badge,o=e.size,s=e.color,a=e.badgeAlign,u=e.badgeVertical,c=e.children,l=d(n,"va-badge",o&&"va-badge-"+o,"va-badge-"+(s||"secondary"),a&&"va-badg-"+a,u&&"va-badg-"+u);return r&&(t=i.createElement("b",null,r)),i.createElement("div",{className:l},c,t)},e=Tt([K.a],e)}(i.Component),n(147),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),qt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return It(e,t),e.prototype.render=function(){var t,e,n,r=this.props,o=r.className,s=r.left,a=r.children,u=r.right,c=r.onClick;return void 0!==s&&(t=i.createElement("header",null,s)),void 0!==u&&(e=i.createElement("footer",null,u)),void 0!==c&&(n="cursor-pointer"),i.createElement("div",{className:d("va-lmr",o,n),onClick:c},t,i.createElement("div",null,a),e)},e=qt([K.a],e)}(i.Component),Dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dt(e,t),e.prototype.render=function(){var t=this.props,e=t.name,n=t.className,r=t.size,o=t.spin,s=t.fixWidth,a=t.border,u=t.pull,c=t.pulse,l=t.rotate,h=t.flip,p=t.inverse,f=d(n,"fa",e&&"fa-"+e,r&&"fa-"+r,s&&"fa-fw",a&&"fa-border",u&&"fa-pull-"+u,o&&"fa-spin",c&&"fa-pulse",l&&"fa-rotate-"+l,h&&"fa-flip-"+h,p&&"fa-inverse");return i.createElement("i",{className:f})},e}(i.Component),Lt=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Dt(e,t),e.prototype.render=function(){var t=this.props,e=t.className,n=t.size,r=t.children,o=d("fa-stack",e,n&&"fa-"+n);return i.createElement("span",{className:o},r)}}(i.Component),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lt(e,t),e.prototype.render=function(){var t=this.props,e=t.icon,n=t.iconClass,r=t.text,o=t.textClass;return i.createElement("div",{className:"py-2"},i.createElement(Ut,{className:n,name:e,fixWidth:!0}),i.createElement("span",{className:o},r))},e}(i.Component),Bt=function(t){return i.createElement("small",{className:d("text-muted",t.className),style:t.style},t.children)},Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wt={width:"4rem",height:"4rem"},Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ht(e,t),e.prototype.render=function(){var t,e=this.props,n=e.icon,r=e.main,o=e.discription,s=e.px,a=e.py;t="string"===typeof o?i.createElement("div",null,o):o;var u=n;"string"===typeof n&&(u=i.createElement("img",{className:"d-flex mr-3",src:n,alt:"img",style:Wt}));var c=d("media",void 0===s?"px-0":"px-"+s,void 0===a?"py-2":"py-"+a);return i.createElement("div",{className:c},u,i.createElement("div",{className:"media-body"},i.createElement("h5",{className:"mt-0"},r),t))},e}(i.Component),Qt=(n(149),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Jt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},zt=function(t){function e(e){var n=t.call(this,e)||this;return n.state={pressed:!1},n}return Qt(e,t),e.prototype.render=function(){var t,e,n,r,o,s,a=this.props,u=(a.date,a.main),c=a.vice,l=a.middle,h=a.midSize,p=a.icon,f=a.unread,m=a.right,v=a.onClick;if(void 0!==f){var b=void 0;(b="number"===typeof f?f:f.get())>0?n=i.createElement("b",null,b):b<0&&(n=i.createElement("b",{className:"dot"}))}switch(typeof p){case"object":t=i.createElement("header",null,p,n),e=!1;break;case"string":t=i.createElement("header",{className:"icon"},i.createElement("img",{src:p}),n),e=!0}if(void 0!==l)switch(typeof l){case"string":r=i.createElement("div",{style:{flex:h}},l);break;default:r=l}void 0!==m&&(o="string"===typeof m?i.createElement("footer",null,i.createElement("small",{className:"text-muted"},m)):i.createElement("footer",null,m)),void 0!==c&&(s=i.createElement("span",null,c));var y=d("va-row",{icon:e,pressed:this.state.pressed},{"va-action":void 0!==v});return i.createElement("li",{className:y,onClick:v},t,i.createElement("div",null,i.createElement("div",null,u),s),r,o)},e=Jt([K.a],e)}(i.Component),Xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_t=function(){return(_t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Zt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Gt=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Xt(e,t),e.prototype.render=function(){var t,e,n=this,r=this.props,o=r.header,s=r.items,a=r.beforeLoad,u=r.none,c=r.renderRow,l=r.className,h=r.footer,p=r.itemClick,f=r.converter,m=d(l,"va-list");return t=void 0===s?null===a?null:i.createElement("li",{className:"empty"},a||"..."):0===s.length?i.createElement("li",{className:"empty"},u||"[none]"):void 0!==c?s.map(function(t,e){return c(t,e,n.props.ex)}):s.map(function(t,e){var n,r=t.onClick;if(void 0===r&&void 0!==p&&(r=function(){return p(t)}),void 0!==f){if(void 0===(n=f(t)))return null}else n=_t({},t);return void 0===n.key&&(n.key=n.main),i.createElement(zt,_t({onClick:r},n))}),void 0!==o&&(e="string"===typeof o?i.createElement("div",{className:"va-list-header"},o):o),i.createElement("div",{className:m},e,i.createElement("ul",null,t),h)},e=Zt([K.a],e)}(i.Component),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),Yt=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},$t=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},te=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=function(t){n.key=t.target.value,void 0!==n.key&&(n.key=n.key.trim()),n.setState({disabled:!n.key})},n.ref=function(t){n.input=t,n.key=n.props.initKey||"",null!==t&&(t.value=n.key)},n.onSubmit=function(t){return Yt(n,void 0,void 0,function(){return $t(this,function(e){switch(e.label){case 0:return t.preventDefault(),this.key?(this.input&&(this.input.disabled=!0),[4,this.props.onSearch(this.key)]):[2];case 1:return e.sent(),this.input&&(this.input.disabled=!1),[2]}})})},n.state={disabled:!1},n}return Gt(e,t),e.prototype.render=function(){var t,e,n=this.props,r=n.className,o=n.label,s=n.placeholder,a=n.buttonText,u=n.maxLength;switch(n.size){default:case"sm":t="input-group-sm";break;case"md":t="input-group-md";break;case"lg":t="input-group-lg"}return void 0!==o&&(e=i.createElement("label",{className:"input-group-addon"},o)),i.createElement("form",{className:r,onSubmit:this.onSubmit},i.createElement("div",{className:d("input-group",t)},e,i.createElement("input",{onChange:this.onChange,type:"text",name:"key",ref:this.ref,className:"form-control",placeholder:s,maxLength:u}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.state.disabled},i.createElement("i",{className:"fa fa-search"}),i.createElement("i",{className:"fa"}),a))))},e}(i.Component),ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(){return(ne=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},re=(function(t){function e(e){var n=t.call(this,e)||this;return n.values={},n.stepViews=[],n.state={topView:void 0,stepViews:[]},n.onPrev=n.onPrev.bind(n),n.onNext=n.onNext.bind(n),n}ee(e,t),e.prototype.setStep=function(t){var e=this.props.steps[t];if(void 0!==e){var n,r;void 0!==this.topView&&this.stepViews.push(this.topView),this.stepViews.length>0&&(n=i.createElement(re,{prefix:"undo",text:"\u4e0a\u4e00\u6b65"}),r=this.onPrev);var o=this.props,s=(o.header,o.footer,void 0===e.next?{prefix:"cloud-upload",text:this.props.submitButton||"\u63d0\u4ea4"}:{suffix:"arrow-right",text:"\u4e0b\u4e00\u6b65"}),a={formRows:e.formRows,submitButton:i.createElement(re,ne({},s)),onSubmit:this.onNext,otherButton:n,onOther:r};this.stepViews.length;this.topView={stepName:t,step:e,props:a},this.setState({topView:this.topView,stepViews:this.stepViews})}},e.prototype.componentWillMount=function(){this.setStep(this.props.first)},e.prototype.onPrev=function(t){p.assign(this.values,t),this.topView=this.stepViews.pop(),this.setState({topView:this.topView,stepViews:this.stepViews})},e.prototype.onNext=function(t){p.assign(this.values,t);var e,n=this.topView.step.next;if(void 0===n)return this.props.onSubmit(this.values);e="string"===typeof n?n:n(this.values),this.setStep(e)},e.prototype.render=function(){var t=this.props,e=t.className,n=t.header,r=t.footer,o=this.state,s=o.topView,a=o.stepViews,u=s.stepName,c=s.step,l=a.length+1;return i.createElement("div",{className:e},i.createElement("div",null,n&&n(c,l),i.createElement(ft,ne({key:u,initValues:this.values},s.props)),r&&r(c,l)))}}(i.Component),function(t){var e,n,r=t.prefix,o=(t.text,t.suffix);return void 0!==r&&(e=i.createElement("i",{className:d("fa","fa-"+r)})),void 0!==o&&(n=i.createElement("i",{className:d("fa","fa-"+o)})),i.createElement(i.Fragment,null,e," ",t.text," ",n)}),ie=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},oe=function(){function t(t){this.list=t}return Object.defineProperty(t.prototype,"isPaged",{get:function(){var t=this.list.props.items;return null!==t&&void 0!==t&&!1===Array.isArray(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this.list.props.items;return null===t?null:void 0!==t?!0===Array.isArray(t)?t:t.items:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loading",{get:function(){var t=this.list.props.items;if(null===t)return!1;if(void 0===t)return!0;var e=t;return void 0!==e.items&&e.loading},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.updateProps=function(t){},t.prototype.renderContent=function(t,e){var n=this.list.props.item.render;return void 0===n?i.createElement("div",{className:"px-3 py-2"},JSON.stringify(t)):n(t,e)},ie([o.d],t.prototype,"loading",null),t}(),se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return se(e,t),e.prototype.render=function(t,e){var n=this.list.props.item,r=n.className,o=n.key,s=n.onClick;return i.createElement("li",{key:void 0===o?e:o(t),className:d("va-row-clickable",r),onClick:function(){return s(t)}},this.renderContent(t,e))},e}(oe),ue=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ue(e,t),e.prototype.render=function(t,e){var n=this.list.props.item,r=n.className,o=n.key;n.render;if("string"===typeof t){var s=d("va-list-gap","px-3","pt-1");return i.createElement("li",{key:at(),className:s},t)}return i.createElement("li",{key:void 0===o?e:o(t),className:d(r)},this.renderContent(t,e))},e}(oe),le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return le(e,t),e.prototype.buildItems=function(){console.log("buildItems in selectable.tsx");var t,e=this.list.props,n=e.items,r=e.selectedItems,i=e.compare;return void 0===n?this._items=void 0:null===n?this._items=null:(t=!0===Array.isArray(n)?n:n.items,this._selectedItems=r,this._items=void 0===r?t.map(function(t){return{selected:!1,item:t,labelId:at()}}):void 0===i?t.map(function(t){return{selected:void 0!==r.find(function(e){return e===t}),item:t,labelId:at()}}):t.map(function(t){return{selected:void 0!==r.find(function(e){return i(t,e)}),item:t,labelId:at()}}))},Object.defineProperty(e.prototype,"items",{get:function(){return this.buildItems(),this._items},enumerable:!0,configurable:!0}),e.prototype.updateProps=function(t){t.selectedItems!==this._selectedItems&&this.buildItems()},e.prototype.onSelect=function(t,e){t.selected=e;var n=this._items.some(function(t){return t.selected});this.list.props.item.onSelect(t.item,e,n)},Object.defineProperty(e.prototype,"selectedItems",{get:function(){return this._items.filter(function(t){return!0===t.selected}).map(function(t){return t.item})},enumerable:!0,configurable:!0}),e.prototype.render=function(t,e){var n=this,r=this.list.props.item,o=r.className,s=r.key,a=(r.render,r.onSelect,t.labelId),u=t.selected;return i.createElement("li",{key:void 0===s?e:s(t),className:d(o)},i.createElement("div",{className:"d-flex align-items-center px-3"},i.createElement("input",{ref:function(t){t&&(n.input=t,t.checked=u)},className:"",type:"checkbox",value:"",id:a,defaultChecked:u,onChange:function(e){n.onSelect(t,e.target.checked)}}),i.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:a},this.renderContent(t.item,e))))},he([o.d],e.prototype,"items",null),e}(oe),de=(n(151),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),fe=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},me=function(t){function e(e){var n=t.call(this,e)||this;n._$scroll=function(t){console.log("############### items scroll to "+t)};var r=n.props.item,i=r.onClick,o=r.onSelect;return n.listBase=void 0!==o?new pe(n):void 0!==i?new ae(n):new ce(n),n}return de(e,t),e.prototype.componentWillUpdate=function(t,e,n){this.listBase.updateProps(t)},Object.defineProperty(e.prototype,"selectedItems",{get:function(){return this.listBase.selectedItems},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this,e=this.props,n=e.className,r=e.header,o=e.footer,s=e.before,a=e.loading,u=e.none;e.item,e.selectedItems;void 0===s&&(s="before"),void 0===a&&(a="loading"),void 0===u&&(u="none");var c,l=this.listBase,h=(l.isPaged,l.items);l.loading;function p(t,e){if(t)switch(typeof t){default:case"string":return i.createElement("li",{className:"va-list-"+e},t);case"function":return i.createElement("li",{className:"va-list-"+e},t());case"object":return i.createElement("li",null,t)}}return c=null===h?p(s,"before"):void 0===h?p(a,"loading"):0===h.length?p(u,"none"):h.map(function(e,n){return t.listBase.render(e,n)}),i.createElement("ul",{className:f()("va-list",n)},p(r,"header"),c,p(o,"footer"))},e=fe([K.a],e)}(i.Component);n.d(e,"a",function(){return yt}),n.d(e,"h",function(){return Ft}),n.d(e,"d",function(){return Rt}),n.d(e,"b",function(){return Ut}),n.d(e,"c",function(){return Mt}),n.d(e,"g",function(){return Bt}),n.d(e,"f",function(){return Kt}),n.d(e,"i",function(){return te}),n.d(e,"e",function(){return me})},,,,function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return u});var r=n(0),i=n(5),o=n(50),s=n(68),a=function(t){function e(e,n,r,i){var o=t.call(this,e,i)||this;Object.setPrototypeOf(o.x,e.x);var a=n.name,u=n.typeName;return o.entity=n,o.ui=r,o.label=o.res.label||a,o.icon=s.a[u],o}return r.d(e,t),e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.loadSchema()];case 1:return t.sent(),[2,!0]}})})},e.prototype.createForm=function(t,e,n){var r=this.buildFormOptions(n),i=new o.b(r,t);return i.setValues(e),i},e.prototype.buildFormOptions=function(t){var e,n,r,i,s,a=this.entity,u=a.fields,c=a.arrFields;void 0!==this.res&&(e=this.res.none,n=this.res.submit,r=this.res.arrNew,i=this.res.arrEdit,s=this.res.arrTitleNewButton),void 0===e&&(e=this.cUsq.res.none||"none"),void 0===n&&(n=this.cUsq.res.submit||"Submit"),void 0===r&&(r=this.cUsq.res.arrNew||"New"),void 0===i&&(i=this.cUsq.res.arrEdit||"Edit"),void 0===s&&(s=this.cUsq.res.arrTitleNewButton),void 0===t&&(t=o.a.new);var l=this.ui.form;return{fields:u,arrs:c,ui:l,res:this.res||{},inputs:this.buildInputs(l),none:e,submitCaption:n,arrNewCaption:r,arrEditCaption:i,arrTitleNewButton:s,mode:t}},e.prototype.buildInputs=function(t){var e=this.entity,n=e.fields,r=e.arrFields,i={};if(this.buildFieldsInputs(i,n,void 0,t),void 0!==r)for(var o=0,s=r;o<s.length;o++){var a=s[o],u=a.name,c=a.fields,l=t&&t.items;this.buildFieldsInputs(i,c,u,l&&l[u])}return i},e.prototype.buildFieldsInputs=function(t,e,n,r){if(void 0!==n){var i=t[n];void 0===i&&(t[n]=i={},t=i)}for(var o=0,s=e;o<s.length;o++){var a=s[o],u=a.name,c=a._tuid;if(void 0!==c){var l=r&&r.items&&r.items[u];t[u]={select:this.buildSelect(a,n,l),content:this.buildContent(a,n),placeHolder:this.cUsq.getTuidPlaceHolder(c)}}}},e.prototype.buildSelect=function(t,e,n){var i=this;return function(t,e,o){return r.b(i,void 0,Promise,function(){var i,o,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return i=e._tuid,o=e._ownerField,[4,i.cSelectFrom()];case 1:return s=r.sent(),a=void 0,void 0!==o&&(a=t.getValue(o.name)),n&&!0===n.autoList&&(console.log("select search set param=empty string"),a=""),[4,s.call(a)];case 2:return u=r.sent(),s.removeCeased(),void 0===u?[2,void 0]:(c=s.idFromItem(u),i.useId(c),[2,c])}})})}},e.prototype.buildContent=function(t,e){},e.prototype.cQuerySelect=function(t){return this.cUsq.cQuerySelect(t)},e}(n(69).a),u=function(t){function e(e){var n=t.call(this,e)||this;return n.entity=e.entity,n.ui=e.ui,n}return r.d(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this.controller.label},enumerable:!0,configurable:!0}),e.prototype.createForm=function(t,e,n){return this.controller.createForm(t,e,n)},e}(i.VPage)},,,,,,,,,,function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return b}),n.d(e,"a",function(){return w}),n.d(e,"c",function(){return E});var r,i=n(0),o=n(1),s=n(9),a=n(48),u=n(53),c=n(82),l=n(108),h=n(33),p=n(109),d=n(28),f=(n(90),n(115),n(128),n(130),n(37)),m=n(49),v=n(66),b=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0,y=(n(116),[]),g=1,w=function(e){function n(t){var n=e.call(this,t)||this;return n.waitCount=0,n.isHistoryBack=!1,n.clearError=function(){n.setState({fetchError:void 0})},n.back=n.back.bind(n),n.navBack=n.navBack.bind(n),n.stack=[],n.state={stack:n.stack,wait:0,fetchError:void 0},n}return i.d(n,e),n.prototype.componentWillMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){return window.addEventListener("popstate",this.navBack),[2]})})},n.prototype.componentDidMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return E.set(this),[4,E.start()];case 1:return t.sent(),[2]}})})},Object.defineProperty(n.prototype,"level",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),n.prototype.startWait=function(){var e=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=t.setTimeout(function(){e.waitTimeHandler=void 0,e.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})},n.prototype.endWait=function(){var t=this;setTimeout(function(){--t.waitCount,0===t.waitCount&&(void 0!==t.waitTimeHandler&&(clearTimeout(t.waitTimeHandler),t.waitTimeHandler=void 0),t.setState({wait:0}))},100)},n.prototype.onError=function(t){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(n){switch(n.label){case 0:return void 0===(e=t.error)||!0!==e.unauthorized?[3,2]:[4,E.showLogin()];case 1:return n.sent(),[2];case 2:return this.setState({fetchError:t}),[2]}})})},n.prototype.show=function(t,e){return this.clear(),this.push(t,e)},n.prototype.push=function(t,e){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=g++;return this.stack.push({key:n,view:t,ceased:!1,disposer:e}),this.refresh(),n},n.prototype.replace=function(t,e){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var i=g++;return this.stack.push({key:i,view:t,ceased:!1,disposer:e}),void 0!==n&&this.dispose(n.disposer),this.refresh(),i},n.prototype.ceaseTop=function(t){void 0===t&&(t=1);for(var e=this.stack.length-1,n=0;n<t&&!(e<0);n++,e--){this.stack[e].ceased=!0}},n.prototype.pop=function(t){void 0===t&&(t=1);var e=this.stack,n=e.length;if(!(t<=0||n<=1)){n<t&&(t=n);for(var r=0,i=0;i<t&&0!==e.length;i++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}},n.prototype.popTo=function(t){throw new Error("to be designed")},n.prototype.removeCeased=function(){for(;;){var t=this.stack.length-1;if(t<0)break;if(!1===this.stack[t].ceased)break;var e=this.stack.pop().disposer;this.dispose(e)}this.refresh()},n.prototype.popAndDispose=function(){this.removeCeased();var t=this.stack.pop();if(void 0!==t){var e=t.disposer;return this.dispose(e),this.removeCeased(),t}},n.prototype.dispose=function(t){void 0!==t&&(void 0===this.stack.find(function(e){return e.disposer===t})&&t())},n.prototype.clear=function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose();this.refresh()},n.prototype.regConfirmClose=function(t){var e=this.stack,n=e.length;0!==n&&(e[n-1].confirmClose=t)},n.prototype.navBack=function(){E.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1},n.prototype.back=function(t){return void 0===t&&(t=!0),i.b(this,void 0,void 0,function(){var e,n,r;return i.e(this,function(i){switch(i.label){case 0:return e=this.stack,0===(n=e.length)?[2]:1===n?(self!=window.top&&window.top.postMessage({type:"pop-app"},"*"),[2]):(r=e[n-1],!0===t&&r.confirmClose?[4,r.confirmClose()]:[3,2]);case 1:return!0===i.sent()&&this.pop(),[3,3];case 2:this.pop(),i.label=3;case 3:return[2]}})})},n.prototype.confirmBox=function(t){return window.confirm(t)},n.prototype.render=function(){var t=this.state,e=t.wait,n=t.fetchError,r=this.state.stack,s=r.length-1,a=null,u=null;switch(e){case 1:a=o.createElement("li",{className:"va-wait va-wait1"});break;case 2:a=o.createElement("li",{className:"va-wait va-wait2"},o.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),o.createElement("span",{className:"sr-only"},"Loading..."))}return n&&(u=o.createElement(l.a,i.a({clearError:this.clearError},n))),o.createElement("ul",{className:"va"},r.map(function(t,e){var n=t.key,r=t.view;return o.createElement("li",{key:n,style:e<s?{visibility:"hidden"}:void 0},r)}),a,u)},n.prototype.refresh=function(){this.setState({stack:this.stack})},n}(o.Component),E=new(function(){function t(){this.local=new p.a,this.user=void 0;var t=m.b.lang,e=m.b.district;this.language=t,this.culture=e}return Object.defineProperty(t.prototype,"guest",{get:function(){var t=this.local.guest;if(void 0===t)return 0;var e=t.get();return void 0===e?0:e.guest},enumerable:!0,configurable:!0}),t.prototype.set=function(t){this.nav=t},t.prototype.registerReceiveHandler=function(t){if(void 0!==this.ws)return this.ws.onWsReceiveAny(t)},t.prototype.unregisterReceiveHandler=function(t){void 0!==this.ws&&void 0!==t&&this.ws.endWsReceive(t)},t.prototype.onReceive=function(t){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return void 0===this.ws?[2]:[4,this.ws.receive(t)];case 1:return e.sent(),[2]}})})},t.prototype.getUnitName=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,fetch("unit.json",{})];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().unit];case 3:return t.sent(),this.local.unit.clear(),[2];case 4:return[2]}})})},t.prototype.loadUnit=function(){return i.b(this,void 0,void 0,function(){var t,e,n;return i.e(this,function(r){switch(r.label){case 0:return void 0===(e=this.local.unit.get())?[3,2]:!0!==d.g?[2,e.id]:[4,this.getUnitName()];case 1:return void 0===(t=r.sent())?[2]:e.name===t?[2,e.id]:[3,4];case 2:return[4,this.getUnitName()];case 3:if(void 0===(t=r.sent()))return[2];r.label=4;case 4:return[4,d.e.unitFromName(t)];case 5:return void 0!==(n=r.sent())&&this.local.unit.set({id:n,name:t}),[2,n]}})})},t.prototype.start=function(){return i.b(this,void 0,void 0,function(){var t,e,n,r,s,a,c,l;return i.e(this,function(i){switch(i.label){case 0:return E.clear(),E.push(o.createElement(u.a,{header:!1},o.createElement(v.a,null))),[4,d.f.start()];case 1:return i.sent(),t=d.f.url,e=d.f.ws,this.centerHost=t,this.wsHost=e,Object(d.n)(t),[4,this.loadUnit()];case 2:return n=i.sent(),d.j.unit=n,void 0!==(r=this.local.guest.get())?[3,4]:[4,d.e.guest()];case 3:r=i.sent(),i.label=4;case 4:return E.setGuest(r),s=document.location.hash,console.log("url=%s hash=%s",document.location.origin,s),this.isInFrame=void 0!==s&&""!==s&&s.startsWith("#tv"),!0===this.isInFrame&&void 0!==(a=Object(h.h)(s))?(this.ws=f.d,console.log("this.ws = wsBridge in sub frame"),self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:a.hash},"*"),[2]):void 0!==(c=this.local.user.get())?[3,9]:void 0===(l=this.nav.props.notLogined)?[3,6]:[4,l()];case 5:return i.sent(),[3,8];case 6:return[4,E.showLogin()];case 7:i.sent(),i.label=8;case 8:return[2];case 9:return[4,E.logined(c)];case 10:return i.sent(),[2]}})})},t.prototype.showAppView=function(){return i.b(this,void 0,void 0,function(){var t;return i.e(this,function(e){switch(e.label){case 0:return void 0===(t=this.nav.props.onLogined)?(E.push(o.createElement("div",null,"NavView has no prop onLogined")),[2]):(E.clear(),[4,t()]);case 1:return e.sent(),console.log("logined: AppView shown"),[2]}})})},t.prototype.setGuest=function(t){this.local.guest.set(t),c.a.set(0,t.token)},t.prototype.logined=function(t){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return(this.ws=new d.d(this.wsHost,t.token)).connect(),console.log("logined: %s",JSON.stringify(t)),this.local.user.set(t),c.a.set(t.id,t.token),this.user=new a.a(t),[4,this.showAppView()];case 1:return e.sent(),[2]}})})},t.prototype.showLogin=function(t){return i.b(this,void 0,void 0,function(){var e,r;return i.e(this,function(i){switch(i.label){case 0:return[4,n.e(1).then(n.bind(null,184))];case 1:return e=i.sent(),r=o.createElement(e.default,{withBack:t}),!0!==t&&(this.nav.clear(),this.pop()),this.nav.push(r),[2]}})})},t.prototype.logout=function(t){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(n){switch(n.label){case 0:return this.local.logoutClear(),this.user=void 0,Object(d.i)(),Object(h.f)(),e=this.local.guest.get(),Object(d.m)(0,e&&e.token),this.ws=void 0,!0===t?[2]:[4,E.start()];case 1:return n.sent(),[2]}})})},Object.defineProperty(t.prototype,"level",{get:function(){return this.nav.level},enumerable:!0,configurable:!0}),t.prototype.startWait=function(){this.nav.startWait()},t.prototype.endWait=function(){this.nav.endWait()},t.prototype.onError=function(t){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return[4,this.nav.onError(t)];case 1:return e.sent(),[2]}})})},t.prototype.show=function(t,e){this.nav.show(t,e)},t.prototype.push=function(t,e){this.nav.push(t,e)},t.prototype.replace=function(t,e){this.nav.replace(t,e)},t.prototype.pop=function(t){void 0===t&&(t=1),this.nav.pop(t)},t.prototype.clear=function(){this.nav.clear()},t.prototype.navBack=function(){this.nav.navBack()},t.prototype.ceaseTop=function(t){this.nav.ceaseTop(t)},t.prototype.removeCeased=function(){this.nav.removeCeased()},t.prototype.back=function(t){return void 0===t&&(t=!0),i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return[4,this.nav.back(t)];case 1:return e.sent(),[2]}})})},t.prototype.regConfirmClose=function(t){this.nav.regConfirmClose(t)},t.prototype.confirmBox=function(t){return this.nav.confirmBox(t)},t.prototype.navToApp=function(t,e,n,r,i){var s=this,a=!0===this.centerHost.includes("http://localhost:")?"sheet_debug":"sheet",u=void 0===i?Object(h.a)(t,e):Object(h.a)(t,e,a,[n,r,i]);console.log("navToApp: %s",JSON.stringify(u)),E.push(o.createElement("article",{className:"app-container"},o.createElement("span",{id:u.hash,onClick:function(){return s.back()},style:b},o.createElement("i",{className:"fa fa-arrow-left"})),o.createElement("iframe",{src:u.url})))},t.prototype.navToSite=function(t){window.open(t)},Object.defineProperty(t.prototype,"logs",{get:function(){return y},enumerable:!0,configurable:!0}),t.prototype.log=function(t){y.push(t)},t.prototype.logMark=function(){var t=new Date;r=t.getTime(),y.push("log-mark: "+t.toTimeString())},t.prototype.logStep=function(t){y.push(t+": "+((new Date).getTime()-r))},i.c([s.l],t.prototype,"user",void 0),t}())}).call(this,n(34))},,function(t,e,n){"use strict";n.d(e,"startApp",function(){return a});var r=n(0),i=n(1),o=n(54);n(55);n.o(o,"CApp")&&n.d(e,"CApp",function(){return o.CApp}),n.o(o,"tv")&&n.d(e,"tv",function(){return o.tv});n(70);var s=n(27);function a(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return function t(e){for(var n in e){var r=e[n];if(e[n.toLowerCase()]=r,"object"===typeof r&&!i.isValidElement(r))if(!0===Array.isArray(r))for(var o=0,s=r;o<s.length;o++)t(s[o]);else t(r)}}(e),[4,new(e&&e.CApp||o.CApp)(t,e||{usqs:{}}).start()];case 1:return n.sent(),[2]}})})}n.d(e,"tv",function(){return s.b})},function(t,e,n){"use strict";n.d(e,"c",function(){return c}),n.d(e,"b",function(){return l}),n.d(e,"a",function(){return h});var r=n(0),i=n(1),o=n(9),s=n(13),a=function(){function t(t,e,n,r,o){var a,u=this;if(this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(s.a)(function(){var t=u.errors;return 0===t.length?null:i.createElement(i.Fragment,null,t.map(function(t){return i.createElement("span",{key:t,className:"text-danger inline-block my-1 ml-3"},i.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t)}))}),this.form=t,this.uiSchema=e,this.initData=n,this.inNode=r,this.isRow=o,void 0!==e){var c=e.rules;void 0!==c&&(this.rules=[],!1===Array.isArray(c)?this.rules.push(c):(a=this.rules).push.apply(a,c))}}return t.prototype.getArrRowContexts=function(t){void 0===this.subContexts&&(this.subContexts={});var e=this.subContexts[name];return void 0===e&&(this.subContexts[name]=e={}),e},Object.defineProperty(t.prototype,"arrName",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.getValue=function(t){return this.initData[t]},t.prototype.setValue=function(t,e){this.initData[t]=e;var n=this.widgets[t];void 0!==n&&n.setValue(e)},t.prototype.getDisabled=function(t){var e=this.widgets[t];if(void 0!==e)return e.getDisabled()},t.prototype.setDisabled=function(t,e){var n=this.widgets[t];void 0!==n&&n.setDisabled(e)},t.prototype.getReadOnly=function(t){var e=this.widgets[t];void 0!==e&&e.getReadOnly()},t.prototype.setReadOnly=function(t,e){var n=this.widgets[t];void 0!==n&&n.setReadOnly(e)},t.prototype.getVisible=function(t){var e=this.widgets[t];void 0!==e&&e.getVisible()},t.prototype.setVisible=function(t,e){var n=this.widgets[t];void 0!==n&&n.setVisible(e)},t.prototype.checkFieldRules=function(){for(var t in this.widgets)this.widgets[t].checkRules();if(void 0!==this.subContexts)for(var t in this.subContexts){var e=this.subContexts[t];for(var n in e)e[n].checkFieldRules()}},t.prototype.checkContextRules=function(){var t;if(void 0!==this.rules){this.clearContextErrors();for(var e=0,n=this.rules;e<n.length;e++){var r=(0,n[e])(this);if(void 0!==r)if(!0===Array.isArray(r))(t=this.errors).push.apply(t,r);else if("string"===typeof r)this.errors.push(r);else for(var i in r)this.setError(i,r[i])}if(void 0!==this.subContexts)for(var i in this.subContexts){var o=this.subContexts[i];for(var s in o){var a=o[s];a.removeErrors(),a.checkContextRules()}}}},t.prototype.setError=function(t,e){var n=this.widgets[t];void 0!==n&&(n.setContextError(e),this.addErrorWidget(n))},t.prototype.clearContextErrors=function(){for(var t in this.widgets)this.widgets[t].clearContextError()},t.prototype.checkRules=function(){this.checkFieldRules(),this.checkContextRules()},t.prototype.addErrorWidget=function(t){this.errorWidgets.findIndex(function(e){return e===t})<0&&this.errorWidgets.push(t)},t.prototype.removeErrorWidget=function(t){var e=this.errorWidgets.findIndex(function(e){return e===t});e>=0&&this.errorWidgets.splice(e,1)},t.prototype.checkHasError=function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var t in this.subContexts){var e=this.subContexts[t];for(var n in e)if(!0===e[n].hasError)return!0}return!1},Object.defineProperty(t.prototype,"hasError",{get:function(){return this.checkHasError()},enumerable:!0,configurable:!0}),t.prototype.removeErrors=function(){for(var t in this.errors.splice(0),this.errorWidgets.splice(0),this.widgets){var e=this.widgets[t];void 0!==e&&e.clearContextError()}},r.c([o.l],t.prototype,"errors",void 0),r.c([o.l],t.prototype,"errorWidgets",void 0),r.c([o.e],t.prototype,"hasError",null),t}(),u=1,c=function(t){function e(e,n,r,i){var o,s=this,a=e.uiSchema;if(void 0!==a){var c=a.items;void 0!==c&&(o=c[n.name])}return(s=t.call(this,e.form,o,r,i,!0)||this).parentContext=e,s.arrSchema=n,s.rowKey=u++,s.data=r,s}return r.d(e,t),e.prototype.getItemSchema=function(t){return this.arrSchema.itemSchemas[t]},e.prototype.getUiItem=function(t){if(void 0!==this.uiSchema){var e=this.uiSchema.items;if(void 0!==e)return e[t]}},Object.defineProperty(e.prototype,"arrName",{get:function(){return this.arrSchema.name},enumerable:!0,configurable:!0}),e.prototype.removeErrors=function(){t.prototype.removeErrors.call(this),this.parentContext.removeErrors()},e}(a),l=function(t){function e(e,n){return t.call(this,e,e.uiSchema,e.data,n,!1)||this}return r.d(e,t),e.prototype.getItemSchema=function(t){return this.form.itemSchemas[t]},e.prototype.getUiItem=function(t){var e=this.form.uiSchema;if(void 0!==e){var n=e.items;if(void 0!==n)return n[t]}},e}(a),h=i.createContext({})},function(t,e,n){"use strict";n.d(e,"d",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return c});var r=n(1),i=n(13),o=n(27),s=function(){function t(){}return t.prototype.render=function(t){return void 0===this.view?r.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):r.createElement(this.view,{vm:this,className:t})},t}(),a=function(t,e){return r.createElement(r.Fragment,null,"content: ",Object(o.a)(t))},u=Object(i.a)(a),c=function(t){return r.createElement("div",{className:"px-3 py-2"},Object(o.a)(t))}},function(t,e,n){"use strict";function r(t,e){switch(t.substr(0,1)){default:return e;case"$":case"_":return}}function i(t){return JSON.stringify(t,r," ")}var o=n(1),s=n(13),a=n(54);var u=Object(s.a)(function(t){var e=t.tuidValue,n=t.ui,r=t.x,i=t.nullUI,s=typeof e;switch(s){default:if(void 0===n)return o.createElement(o.Fragment,null,s,"-",e);var u=n(e,r);return void 0!==u?u:o.createElement(o.Fragment,null,e);case"undefined":break;case"object":if(null!==e)return function(t,e,n){if("number"===typeof t)return o.createElement(o.Fragment,null,t);var r=t,i=r.id,s=r._$tuid,u=r._$com,c=s;if(void 0===c)return void 0!==e?e(t,n):Object(a.PureJSONContent)(t,n);var l=e||u;void 0===l&&(l=t._$com=c.getTuidContent());var h=c.valueFromId(i);if("number"===typeof h&&(h={id:h}),void 0!==e){var p=e(h,n);return void 0!==p?p:o.createElement(o.Fragment,null,i)}return o.createElement(l,h)}(e,n,r);break;case"number":return o.createElement(o.Fragment,null,"id...",e)}return void 0===i?o.createElement(o.Fragment,null,"null"):i()}),c=function(t,e,n,r){return o.createElement(u,{tuidValue:t,ui:e,x:n,nullUI:r})};n.d(e,"a",function(){return i}),n.d(e,"b",function(){return c})},function(t,e,n){"use strict";var r=n(37),i=n(60),o=n(0),s=n(48),a=n(35),u=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.guest=function(){return o.b(this,void 0,Promise,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return[4,this.get("",{})];case 1:switch(typeof(t=e.sent())){default:return[2];case"string":return[2,Object(s.b)(t)];case"object":return[2,Object(s.b)(t.token)]}return[2]}})})},e.prototype.unitFromName=function(t){return o.b(this,void 0,Promise,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.get(t)];case 1:return[2,(e=n.sent())&&e.unit]}})})},e}(a.a))("tv/guest/",void 0),c=n(33),l=n(41);n(51);n.d(e,"d",function(){return r.a}),n.d(e,"k",function(){return r.b}),n.d(e,"l",function(){return i.b}),n.d(e,"e",function(){return u}),n.d(e,"i",function(){return a.g}),n.d(e,"c",function(){return a.d}),n.d(e,"b",function(){return a.c}),n.d(e,"n",function(){return a.i}),n.d(e,"m",function(){return a.h}),n.d(e,"a",function(){return a.a}),n.d(e,"j",function(){return c.g}),n.d(e,"h",function(){return c.e}),n.d(e,"g",function(){return l.b}),n.d(e,"f",function(){return l.a})},,,,,function(t,e,n){"use strict";n.d(e,"f",function(){return p}),n.d(e,"g",function(){return f}),n.d(e,"d",function(){return m}),n.d(e,"h",function(){return g}),n.d(e,"a",function(){return w}),n.d(e,"e",function(){return E}),n.d(e,"b",function(){return C}),n.d(e,"c",function(){return P});var r=n(0),i=n(21),o=n.n(i),s=n(40),a=n(44),u=n(35),c=n(37),l=n(41),h={};function p(){for(var t in h)h[t]=void 0}var d={},f=new(function(){function t(){}return Object.defineProperty(t.prototype,"unit",{get:function(){return this._unit},set:function(t){this._unit=t},enumerable:!0,configurable:!0}),t}());function m(){return self!==window.parent}function v(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return console.log("initSubWin: set nav.user",t),s.nav.user=t,[4,s.nav.showAppView()];case 1:return e.sent(),[2]}})})}function b(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return void 0===(n=d[t])?[2,{name:e,url:void 0,urlDebug:void 0,token:void 0}]:(i=n.unit,o=e.split("/"),[4,u.j.usq({unit:i,usqOwner:o[0],usqName:o[1]})]);case 1:if(void 0===(s=r.sent()))throw console.log("apiTokenApi.api return undefined. api=%s, unit=%s",e,i),"api not found";return[2,{name:e,url:s.url,urlDebug:s.urlDebug,token:s.token}]}})})}function y(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a;return r.e(this,function(r){if(e=t.apiName,n=t.url,i=t.urlDebug,o=t.token,void 0===(s=h[e]))throw"error app api return";return a=l.a.getUrlOrDebug(n,i),console.log("onAppApiReturn(message:any): url="+n+", debug="+i+", real="+a),s.url=a,s.token=o,s.resolve(s),[2]})})}function g(t){var e=t.split("-"),n=e.length;return f.hash=e[0].substr(3),n>0&&(f.unit=Number(e[1])),n>1&&(f.page=e[2]),n>2&&(f.param=e.slice(3)),f}function w(t,e,n,r){for(var i;;){if(i=Object(a.a)(),void 0===d[i]){d[i]={hash:i,unit:e};break}}if(t+="#tv"+i+"-"+e,void 0!==n&&(t+="-"+n,void 0!==r))for(var o=0;o<r.length;o++)t+="-"+r[o];return{url:t,hash:i}}function E(t,e){return r.b(this,void 0,Promise,function(){var n,i,o;return r.e(this,function(r){switch(r.label){case 0:return n=new u.b("tv/",void 0),i=f.unit,[4,n.usqs(i,t,e)];case 1:return o=r.sent(),n.checkUsqs(i,t,e).then(function(t){!1===t&&s.nav.start()}),[2,o]}})})}function C(t,e,n){return r.b(this,void 0,Promise,function(){var i,o,s,a,c=this;return r.e(this,function(p){switch(p.label){case 0:return void 0!==(i=h[t])?[2,i]:m()?[3,2]:[4,u.j.usq({unit:f.unit,usqOwner:e,usqName:n})];case 1:if(void 0===(i=p.sent()))throw"unauthorized call: usqTokenApi center return undefined!","unauthorized call: usqTokenApi center return undefined!";return void 0===i.token&&(i.token=u.f),o=i.url,s=i.urlDebug,a=l.a.getUrlOrDebug(o,s),console.log("realUrl: %s",a),i.url=a,h[t]=i,[2,i];case 2:return console.log("appApi parent send: %s",f.hash),i={name:t,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},h[t]=i,[2,new Promise(function(e,n){i.resolve=function(t){return r.b(c,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),console.log("return from parent window: %s",JSON.stringify(n)),i.url=n.url,i.urlDebug=n.urlDebug,i.token=n.token,e(i),[2]}})})},i.reject=n,(window.opener||window.parent).postMessage({type:"app-api",apiName:t,hash:f.hash},"*")})]}})})}window.addEventListener("message",function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:switch(e=t.data,e.type){case"sub-frame-started":return[3,1];case"ws":return[3,2];case"init-sub-win":return[3,4];case"pop-app":return[3,6];case"center-api":return[3,7];case"center-api-return":return[3,9];case"app-api":return[3,10];case"app-api-return":return[3,12]}return[3,14];case 1:return function(t){var e=t.data,n=t.source;Object(c.c)(n),r=e.hash,i=document.getElementById(r),void 0!==i&&(i.hidden=!0);var r,i;var a=o.a.clone(s.nav.user);a.type="init-sub-win",n.postMessage(a,"*")}(t),[3,15];case 2:return[4,s.nav.onReceive(e.msg)];case 3:return r.sent(),[3,15];case 4:return[4,v(e)];case 5:return r.sent(),[3,15];case 6:return s.nav.navBack(),[3,15];case 7:return[4,O(t.source,e)];case 8:return r.sent(),[3,15];case 9:return function(t){var e=t.callId,n=t.result,r=k[e];if(void 0===r)return;k[e]=void 0,r.resolve(n)}(e),[3,15];case 10:return console.log("receive PostMessage: %s",JSON.stringify(e)),[4,b(e.hash,e.apiName)];case 11:return n=r.sent(),console.log("onReceiveAppApiMessage: %s",JSON.stringify(n)),t.source.postMessage({type:"app-api-return",apiName:e.apiName,url:n.url,urlDebug:n.urlDebug,token:n.token},"*"),[3,15];case 12:return console.log("app-api-return: %s",JSON.stringify(e)),console.log("await onAppApiReturn(message);"),[4,y(e)];case 13:return r.sent(),[3,15];case 14:return this.console.log("message: %s",JSON.stringify(e)),[3,15];case 15:return[2]}})})});var k={};function P(t,e,n){return r.b(this,void 0,Promise,function(){var i=this;return r.e(this,function(o){switch(o.label){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",t,e),[4,new Promise(function(o,s){return r.b(i,void 0,void 0,function(){var i;return r.e(this,function(r){for(;;)if(i=Object(a.a)(),void 0===k[i]){k[i]={id:i,resolve:o,reject:s};break}return(window.opener||window.parent).postMessage({type:"center-api",callId:i,url:t,method:e,body:n},"*"),[2]})})})];case 1:return[2,o.sent()]}})})}function O(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=e.callId,i=e.url,o=e.method,s=e.body,[4,u.e.directCall(i,o,s)];case 1:return a=r.sent(),t.postMessage({type:"center-api-return",callId:n,result:a},"*"),[2]}})})}},,function(t,e,n){"use strict";var r=n(0),i=n(21),o=n.n(i),s=n(51),a=n(22),u=function(){function t(){}return t.prototype.startWait=function(){a.c.startWait()},t.prototype.endWait=function(){a.c.endWait()},t.prototype.showError=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return a.c.endWait(),[4,a.c.onError(t)];case 1:return e.sent(),[2]}})})},t}(),c=n(33),l=n(60),h=n(41);n.d(e,"g",function(){return f}),n.d(e,"d",function(){return v}),n.d(e,"c",function(){return g}),n.d(e,"i",function(){return w}),n.d(e,"f",function(){return k}),n.d(e,"h",function(){return O}),n.d(e,"a",function(){return N}),n.d(e,"j",function(){return S}),n.d(e,"e",function(){return x}),n.d(e,"b",function(){return j});var p={},d={};function f(){p={},d={},b={}}var m=new(function(){function t(){}return t.prototype.loadAccess=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a,u,c,l,h,p,d,f,m;return r.e(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),e=t.usqOwner,n=t.usqName,void 0===this.local&&null!==(i=localStorage.getItem("usqLocalEntities"))&&(this.local=JSON.parse(i)),void 0!==this.local)if(s=this.local,a=s.user,u=s.usqs,a!==P||void 0===u)this.local=void 0;else for(c in u)u[c].isNet=void 0;return void 0===this.local&&(this.local={user:P,unit:void 0,usqs:{}}),l=void 0,h=e+"/"+n,void 0!==(p=this.local.usqs[h])&&(d=p.value,l=d),void 0!==l?[3,2]:[4,t.__loadAccess()];case 1:l=r.sent(),this.local.usqs[h]={value:l,isNet:!0},f=JSON.stringify(this.local),localStorage.setItem("usqLocalEntities",f),r.label=2;case 2:return[2,o.a.cloneDeep(l)];case 3:throw m=r.sent(),this.local=void 0,localStorage.removeItem("usqLocalEntities"),m;case 4:return[2]}})})},t.prototype.checkAccess=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return e=t.usqOwner,n=t.usqName,i=e+"/"+n,s=this.local.usqs[i],a=s.isNet,u=s.value,!0===a?[2,!0]:[4,t.__loadAccess()];case 1:return c=r.sent(),[2,o.a.isMatch(u,c)]}})})},t}()),v=function(t){function e(e,n,r,i,o){var s=t.call(this,e,o)||this;return r&&(s.usqOwner=n,s.usqName=r,s.usq=n+"/"+r),s.access=i,s.showWaiting=o,s}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i;return r.e(this,function(r){switch(r.label){case 0:return!0===this.showWaiting||void 0===this.showWaiting?(t=p,e=new u):t=d,void 0!==(n=t[this.usq])?[2,n]:[4,Object(c.b)(this.usq,this.usqOwner,this.usqName)];case 1:return i=r.sent(),this.token=i.token,n=new s.a(!1,i.url,i.token,e),[2,t[this.usq]=n]}})})},e.prototype.update=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("update")];case 1:return[2,t.sent()]}})})},e.prototype.__loadAccess=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=void 0===this.access?"":this.access.join("|"),[4,this.get("access",{acc:t})];case 1:return[2,e.sent()]}})})},e.prototype.loadAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,m.loadAccess(this)];case 1:return[2,t.sent()]}})})},e.prototype.loadEntities=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("entities")];case 1:return[2,t.sent()]}})})},e.prototype.checkAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,m.checkAccess(this)];case 1:return[2,t.sent()]}})})},e.prototype.schema=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("schema/"+t)];case 1:return[2,e.sent()]}})})},e.prototype.schemas=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.post("schema",t)];case 1:return[2,e.sent()]}})})},e.prototype.tuidGet=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("tuid/"+t+"/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.tuidGetAll=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tuid-all/"+t+"/")];case 1:return[2,e.sent()]}})})},e.prototype.tuidSave=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("tuid/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.tuidSearch=function(t,e,n,i,o,s){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuids/"+t,{arr:e,owner:n,key:i,pageStart:o,pageSize:s})];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrGet=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr/"+t+"/"+n+"/"+e+"/"+i)];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrGetAll=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr-all/"+t+"/"+n+"/"+e+"/")];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrSave=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr/"+t+"/"+n+"/"+e+"/",i)];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrPos=function(t,e,n,i,o){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr-pos/"+t+"/"+n+"/"+e+"/",{id:i,$order:o})];case 1:return[2,r.sent()]}})})},e.prototype.tuidIds=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuidids/"+t+"/",i+=void 0!==e?e:"$",[4,this.post(i,n)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},e.prototype.proxied=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuid-proxy/"+t+"/"+e+"/"+n,[4,this.get(i)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},e.prototype.sheetSave=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetAction=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.put("sheet/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.stateSheets=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t+"/states",e)];case 1:return[2,n.sent()]}})})},e.prototype.stateSheetCount=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("sheet/"+t+"/statecount")];case 1:return[2,e.sent()]}})})},e.prototype.getSheet=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+t+"/get/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetArchives=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t+"/archives",e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetArchive=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+t+"/archive/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.action=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("action/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.page=function(t,e,n,i){return r.b(this,void 0,Promise,function(){var s;return r.e(this,function(r){switch(r.label){case 0:switch(typeof i){case"undefined":s={key:""};break;default:s=o.a.clone(i)}return s.$pageStart=e,s.$pageSize=n,[4,this.post("query-page/"+t,s)];case 1:return[2,r.sent()]}})})},e.prototype.query=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("query/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.user=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("user")];case 1:return[2,t.sent()]}})})},e}(l.a),b={};var y,g=function(t){function e(e){var n=t.call(this,"tv/",void 0,void 0,void 0,!0)||this;return n.unitId=e,n}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(t=b[this.unitId])?[2,t]:(e=b,n=this.unitId,[4,this.buildChannel()]);case 1:return[2,e[n]=r.sent()]}})})},e.prototype.buildChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o,a;return r.e(this,function(r){switch(r.label){case 0:return t=new u,[4,new j("tv/",void 0).unitxUsq(this.unitId)];case 1:return e=r.sent(),n=e.token,i=e.url,o=e.urlDebug,a=h.a.getUrlOrDebug(i,o),this.token=n,[2,new s.a(!1,a,n,t)]}})})},e}(v);function w(t){console.log("setCenterUrl %s",t),y=t,k=void 0,C=void 0,E=void 0}var E,C,k=void 0,P=0;function O(t,e){k=e,console.log("setCenterToken %s",e),C=void 0,E=void 0}var N=function(t){function e(e,n){return t.call(this,e,n)||this}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2,!0===this.showWaiting||void 0===this.showWaiting?void 0!==E?E:E=new s.a(!0,y,k,new u):void 0!==C?C:C=new s.a(!0,y,k)]})})},e}(l.a),S=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.usq=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o,s,a,u,c,l,h,p,d,f,m;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=t.unit,n=t.usqOwner,i=t.usqName,void 0===this.local&&null!==(o=localStorage.getItem("usqTokens"))&&(this.local=JSON.parse(o)),void 0!==this.local&&(s=this.local,a=s.unit,u=s.user,a===e&&u===P||(this.local=void 0)),void 0===this.local&&(this.local={user:P,unit:t.unit,usqs:{}}),c=n+"/"+i,l=(new Date).getTime(),void 0!==(h=this.local.usqs[c])&&(p=h.tick,d=h.value,l-p<864e5)?[2,d]:[4,this.get("app-usq",t)];case 1:return f=r.sent(),this.local.usqs[c]={tick:l,value:f},localStorage.setItem("usqTokens",JSON.stringify(this.local)),[2,f];case 2:throw m=r.sent(),this.local=void 0,localStorage.removeItem("usqTokens"),m;case 3:return[2]}})})},e}(N))("tv/tie/",void 0),x=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.directCall=function(t,e,n){return this.call(t,e,n)},e}(N))("",void 0),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.usqs=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,s,a,u,c,l,h,p;return r.e(this,function(r){switch(r.label){case 0:return null!==(s=localStorage.getItem("appUsqs"))&&(a=JSON.parse(s),u=a.unit,c=a.appOwner,l=a.appName,h=a.value,t===u&&e===c&&n===l&&(i=h)),void 0!==i?[3,2]:[4,this.usqsPure(t,e,n)];case 1:i=r.sent(),p={unit:t,appOwner:e,appName:n,value:i},localStorage.setItem("appUsqs",JSON.stringify(p)),r.label=2;case 2:return[2,this.cachedUsqs=o.a.cloneDeep(i)]}})})},e.prototype.usqsPure=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tie/app-usqs",{unit:t,appOwner:e,appName:n})];case 1:return[2,r.sent()]}})})},e.prototype.checkUsqs=function(t,e,n){return r.b(this,void 0,Promise,function(){var i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.usqsPure(t,e,n)];case 1:return i=r.sent(),[2,o.a.isMatch(this.cachedUsqs,i)]}})})},e.prototype.unitxUsq=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tie/unitx-usq",{unit:t})];case 1:return[2,e.sent()]}})})},e}(N)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(14),s=n.n(o),a=function(t){function e(e){var n=t.call(this)||this;return n.onClick=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.start()];case 1:return t.sent(),[2]}})})},n.view=function(t){return i.createElement("div",{className:s()("px-3","py-2","align-items-center","cursor-pointer",t),onClick:n.onClick},n.icon," \xa0 ",n.label)},n.controller=e,n.icon=e.icon,n.label=e.label,n}return r.d(e,t),e.prototype.render=function(t){return i.createElement(this.view,t)},e}(function(){return function(){}}());n.d(e,"a",function(){return a})},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"d",function(){return c}),n.d(e,"a",function(){return l});var r,i=n(0);function o(t){r=t}function s(t){window.top.postMessage({type:"ws",msg:t},"*")}var a=function(){function t(){this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return t.prototype.onWsReceiveAny=function(t){var e=this.handlerSeed++;return this.anyHandlers[e]=t,e},t.prototype.onWsReceive=function(t,e){var n=this.handlerSeed++;return this.msgHandlers[n]={type:t,handler:e},n},t.prototype.endWsReceive=function(t){delete this.anyHandlers[t],delete this.msgHandlers[t]},t.prototype.receive=function(t){return i.b(this,void 0,void 0,function(){var e,n,r,o,s,a,u,c,l,h,p;return i.e(this,function(i){switch(i.label){case 0:for(r in e=t.$type,n=[],this.anyHandlers)n.push(r);o=0,i.label=1;case 1:return o<n.length?(c=n[o],[4,this.anyHandlers[c](t)]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:for(a in s=[],this.msgHandlers)s.push(a);u=0,i.label=5;case 5:return u<s.length?(c=s[u],l=this.msgHandlers[c],h=l.type,p=l.handler,h!==e?[3,7]:[4,p(t)]):[3,8];case 6:i.sent(),i.label=7;case 7:return u++,[3,5];case 8:return[2]}})})},t}(),u=1,c=new(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wsBaseId="WsBridge seed "+u++,e}return i.d(e,t),e}(a)),l=function(t){function e(e,n){var r=t.call(this)||this;return r.wsBaseId="WSChannel seed "+u++,r.wsHost=e,r.token=n,r}return i.d(e,t),e.setCenterToken=function(t){e.centerToken=t},e.prototype.connect=function(){var t=this;if(void 0===this.ws){var n=this;return new Promise(function(r,o){var s=new WebSocket(t.wsHost,t.token||e.centerToken);console.log("connect webSocket %s",t.wsHost),s.onopen=function(e){console.log("webSocket connected %s",t.wsHost),n.ws=s,r()},s.onerror=function(t){o("webSocket can't open!")},s.onmessage=function(e){return i.b(t,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return[4,n.wsMessage(e)];case 1:return[2,t.sent()]}})})},s.onclose=function(t){n.ws=void 0,console.log("webSocket closed!")}})}},e.prototype.close=function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)},e.prototype.wsMessage=function(t){return i.b(this,void 0,Promise,function(){var e,n;return i.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),console.log("websocket message: %s",t.data),function(t){void 0!==r&&r.postMessage({type:"ws",msg:t},"*")}(e=JSON.parse(t.data)),[4,this.receive(e)];case 1:return i.sent(),[3,3];case 2:return n=i.sent(),console.log("ws msg error: ",n),[3,3];case 3:return[2]}})})},e.prototype.sendWs=function(t){var e=this;this.connect().then(function(){e.ws.send(t)})},e}(a)},,,function(t,e,n){"use strict";var r=n(22);n.d(e,"NavView",function(){return r.a}),n.d(e,"nav",function(){return r.c});n(61);var i=n(53);n.d(e,"Page",function(){return i.a});n(91),n(92);var o=n(93);n.d(e,"Controller",function(){return o.a}),n.d(e,"VPage",function(){return o.b}),n.d(e,"View",function(){return o.c});var s=n(94);n.o(s,"Field")&&n.d(e,"Field",function(){return s.Field}),n.o(s,"Form")&&n.d(e,"Form",function(){return s.Form}),n.o(s,"Loading")&&n.d(e,"Loading",function(){return s.Loading}),n.o(s,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return s.TabCaptionComponent}),n.o(s,"Tabs")&&n.d(e,"Tabs",function(){return s.Tabs}),n.o(s,"resLang")&&n.d(e,"resLang",function(){return s.resLang});var a=n(49);n.d(e,"resLang",function(){return a.a});var u=n(106);n.d(e,"TabCaptionComponent",function(){return u.a}),n.d(e,"Tabs",function(){return u.b});var c=n(66);n.d(e,"Loading",function(){return c.a})},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return s});var r=n(0),i=!1,o={centerhost:{value:"localhost:3000",env:"REACT_APP_CENTER_DEBUG_HOST",local:!1},usqhost:{value:"localhost:3015",env:"REACT_APP_USQ_DEBUG_HOST",local:!1},unitxhost:{value:"localhost:3015",env:"REACT_APP_USQ_DEBUG_HOST",local:!1},"usql-server":{value:"localhost:3009",env:"REACT_APP_DEBUG_USQL_SERVER",local:!1}};var s=new(function(){function t(){}return t.prototype.start=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return!0!==i?[3,2]:[4,this.tryLocal()];case 1:e.sent(),e.label=2;case 2:return t=this.getCenterHost(),this.url=function(t){return"http://"+t+"/"}(t),this.ws=function(t){return"ws://"+t+"/tv/"}(t),[2]}})})},t.prototype.debugHostUrl=function(t){return"http://"+t+"/hello"},t.prototype.tryLocal=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,s,a,u,l,h,p;return r.e(this,function(r){switch(r.label){case 0:for(h in t=[],o)e=(p=o[h]).value,n=p.env,i=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"})[n]||e,s=this.debugHostUrl(i),a={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},t.push(c(s,a));return[4,Promise.all(t)];case 1:for(h in u=r.sent(),l=0,o)(p=o[h]).local=u[l],++l;return[2]}})})},t.prototype.getCenterHost=function(){var t=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||"localhost:3000";return!0===document.location.hash.includes("sheet_debug")?t:"101.200.46.56"},t.prototype.getUrlOrDebug=function(t,e){if(!0!==i)return t;if(!e)return t;for(var n in o){var r=o[n],s=r.env,a=r.value,u=r.local,c="://"+n+"/";if(e.indexOf(c)>0){if(!1===u)break;return e=e.replace(c,"://"+(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"})[s]||a)+"/")}}return t},t}()),a=100;function u(t,e){return new Promise(function(n,r){fetch(t,e).then(function(t){t.text().then(n).catch(r)}).catch(r);var i=new Error("Connection timed out");setTimeout(r,a,i)})}function c(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,u(t,e)];case 1:return n.sent(),[2,!0];case 2:return n.sent(),[2,!1];case 3:return[2]}})})}},,function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={usqOrder:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/order",usqProduct:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/product",usqCommon:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/common",usqWebUser:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/webuser",usqCustomer:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customer",usqCustomerDiscount:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customerDiscount",usqWarehouse:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/warehouse",usqMember:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/member",appIcon:"http://101.200.46.56/imgs/Bear-icon.png"}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function o(){for(var t=r.length,e="",n=0;n<i;n++)e+=r.charAt(Math.floor(Math.random()*t));return e}},,,function(t,e,n){"use strict";var r=n(0),i=n(21),o=n.n(i),s=n(12),a=n(1),u=n.n(a),c=n(8),l=n(32),h=n(5),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onNew=function(){return e.event("new")},e.onList=function(){return e.event("list")},e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return[2,this.event("list",t)]})})},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e.prototype.entityRender=function(t,e){return t.render()},e.prototype.entityClick=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,t.onClick()];case 1:return e.sent(),[2]}})})},Object.defineProperty(e.prototype,"view",{get:function(){var t,e=this,n=this.controller,r=n.label,i=n.proxyLinks;return!1===n.isFrom&&(t=a.createElement(l.b,{className:"ml-3",color:"primary",onClick:this.onNew},"\u65b0\u589e")),function(){return a.createElement(h.Page,{header:r},void 0===i?a.createElement(a.Fragment,null,a.createElement(c.i,{className:"w-100",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+r}),a.createElement("div",{className:"my-3"},t,a.createElement(l.b,{className:"ml-3",color:"primary",onClick:e.onList},"\u5217\u8868"))):a.createElement(c.e,{className:"my-2",header:a.createElement(c.g,null,r," \u4ee3\u7406\u4e0b\u5217Tuid"),items:i,item:{render:e.entityRender,onClick:e.entityClick}}))}},enumerable:!0,configurable:!0}),e}(s.b),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.next=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.reset(),this.closePage(),[2]})})},e.finish=function(){e.closePage(2),e.event("edit-end")},e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,o,s,u;return r.e(this,function(r){switch(r.label){case 0:return t=this.vForm.getValues(),[4,this.controller.entity.save(this.id,t)];case 1:if(e=r.sent(),(n=e.id)<0){if(void 0!==(i=this.controller.entity.unique))for(o=0,s=i;o<s.length;o++)u=s[o],this.vForm.setError(u,"\u4e0d\u80fd\u91cd\u590d");return[2]}return this.controller.isCalling?(this.returnCall(n),this.closePage(),[2]):(this.openPageElement(a.createElement(h.Page,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement(l.b,{className:"mr-3",color:"primary",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement(l.b,{color:"primary",outline:!0,onClick:this.finish},"\u4e0d\u7ee7\u7eed"))))),this.event("item-changed",{id:this.id,values:t}),[2])}})})},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),void 0!==t&&(this.id=t.id),this.openPage(this.editView),[2]})})},Object.defineProperty(e.prototype,"editView",{get:function(){var t=this;return function(){return a.createElement(h.Page,{header:(void 0===t.id?"\u65b0\u589e":"\u7f16\u8f91")+" - "+t.label},t.vForm.render("py-3"))}},enumerable:!0,configurable:!0}),e.prototype.resetForm=function(){this.vForm.reset()},e}(s.b),f=n(26),m=n(13),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainView=Object(m.a)(function(){var t=u.a.createElement(c.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearchMain,placeholder:"\u641c\u7d22"+e.label});return u.a.createElement(h.Page,{header:t,back:"close"},u.a.createElement(c.e,{items:e.controller.PageItems.items,item:{render:e.renderMainRow,onClick:e.clickMainRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e.onSearchMain=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderMainRow=function(t,n){return u.a.createElement(e.mainRowContent,r.a({},t))},e.clickMainRow=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.ceasePage(),void 0===this.controller.entity.owner?(this.returnCall(t),[2]):[4,this.showDiv(this.entity.getIdFromObj(t))];case 1:return e.sent(),[2]}})})},e.divView=function(t){return u.a.createElement(h.Page,{header:"\u9009\u62e9Div"},u.a.createElement(c.e,{items:t.items,item:{render:e.renderDivRow,onClick:e.clickDivRow}}))},e.renderDivRow=function(t,n){return u.a.createElement(e.divRowContent,r.a({},t))},e.clickDivRow=function(t){e.ceasePage(),e.returnCall(t)},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==t?[3,2]:[4,this.showMain(t)];case 1:return e.sent(),[3,4];case 2:return[4,this.showDiv(t)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype.showMain=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.mainRowContent=this.ui.rowContent||f.c,[4,this.controller.searchMain(t)];case 1:return e.sent(),this.openPage(this.mainView),[2]}})})},e.prototype.showDiv=function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(e=this.ui.divs)&&(this.divRowContent=e[this.entity.name].rowContent),void 0===this.divRowContent&&(this.divRowContent=f.c),[4,this.controller.getDivItems(t)];case 1:return n=r.sent(),this.openPage(this.divView,{items:n}),[2]}})})},e}(s.b),b=n(27),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.next=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.reset(),this.closePage(),[2]})})},e.finish=function(){e.closePage(2)},e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e,n=this;return r.e(this,function(r){switch(r.label){case 0:return t=this.vForm.getValues(),[4,this.entity.save(this.id,t)];case 1:return(e=r.sent())&&alert("\u8fd9\u91cc\u8fd8\u8981\u5224\u65ad\u8fd4\u56de\u503c\uff0c\u5148\u4e0d\u5904\u7406\u4e86 \n"+Object(b.a)(e)),this.openPage(function(){return a.createElement(h.Page,{header:n.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.b,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement(l.b,{className:"mr-3",color:"primary",onClick:n.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement(l.b,{color:"primary",outline:!0,onClick:n.finish},"\u4e0d\u7ee7\u7eed"))))}),[2]}})})},e.view=function(){return a.createElement(h.Page,{header:e.label},e.vForm.render("py-3"))},e}return r.d(e,t),e.prototype.buildForm=function(t){this.vForm=this.createForm(void 0,t)},e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.buildForm(t),this.openPage(this.view),[2]})})},e.prototype.render=function(t){return this.buildForm(t),this.vForm.render()},e.prototype.loadId=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.id=t,[2]})})},e.prototype.resetForm=function(){this.vForm.reset()},e}(s.b)),g=function(t){function e(e){var n=t.call(this,!0)||this;return n.tuid=e,n}return r.d(e,t),e.prototype.load=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tuid.search(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(h.PageItems),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.onSelected=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return!1===this.controller.isFrom?this.event("edit",t.id):this.event("info",t.id),[2]})})},e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,n){return a.createElement(e.rowContent,r.a({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.rowKey=function(t){return t.id},e.view=Object(m.a)(function(){var t,n=a.createElement(c.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label}),r=e.entity.owner;if(void 0!==r){var i=r.valueFromId(e.ownerId);t=a.createElement("div",null,"owner: ",Object(b.a)(i))}return a.createElement(h.Page,{header:n},t,a.createElement(c.e,{items:e.controller.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow,key:e.rowKey},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.rowContent=this.ui.rowContent||f.c,void 0!==this.entity.owner&&(this.ownerId=Number(t)),[4,this.controller.searchMain("")];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){void 0!==this.onSelected?this.onSelected(t):alert("onSelect is undefined")},e}(s.b)),E=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.onSelected=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.event("edit",t.id),[2]})})}}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,e){return a.createElement("div",{className:"px-3 py-2"},Object(b.a)(t))},e.clickRow=function(t){e.callOnSelected(t)},e.view=Object(m.a)(function(){var t,n=a.createElement(c.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label}),r=e.entity.owner;if(void 0!==r){var i=r.valueFromId(e.ownerId);t=a.createElement("div",null,"owner: ",Object(b.a)(i))}return a.createElement(h.Page,{header:n},t,a.createElement(c.e,{items:e.controller.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.entity.owner&&(this.ownerId=Number(t)),[4,this.controller.searchMain("")];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){void 0!==this.onSelected?this.onSelected(t):alert("onSelect is undefined")},e}(s.b)),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.buildPageItems=function(){return new g(this.entity.owner||this.entity)},e.prototype.searchMain=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0===t?[3,2]:[4,this.PageItems.first(t)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.getDivItems=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.searchArr(t,void 0,0,1e3)];case 1:return[2,e.sent()]}})})},e}(s.a)),C=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,i)||this,s=o.entity;if(o.proxies=s.proxies,void 0!==o.proxies)for(var a in o.proxyLinks=[],o.proxies){var u=o.cUsq.linkFromName("tuid",a);o.proxyLinks.push(u)}return o}return r.d(e,t),e.prototype.from=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.cFrom()];case 1:return void 0===(t=e.sent())?[2,this]:[2,t]}})})},e.prototype.cUsqFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.cUsqFrom()];case 1:return[2,t.sent()]}})})},e.prototype.cEditFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.cUsqFrom()];case 1:return[4,t.sent().cTuidEditFromName(this.entity.name)];case 2:return[2,t.sent()]}})})},e.prototype.cInfoFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.cUsqFrom()];case 1:return[4,t.sent().cTuidInfoFromName(this.entity.name)];case 2:return[2,t.sent()]}})})},e.prototype.cSelectFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.cUsqFrom()];case 1:return[4,t.sent().cTuidSelectFromName(this.entity.name)];case 2:return[2,t.sent()]}})})},e.prototype.getLable=function(t){if(t===this.entity)return this.label;var e=t.name,n=this.res.arrs;if(void 0!==n){var r=n[e];if(void 0!==r){var i=r.label;if(void 0!==i)return i}}return e},Object.defineProperty(e.prototype,"VTuidMain",{get:function(){return p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VTuidEdit",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VTuidList",{get:function(){return w},enumerable:!0,configurable:!0}),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.showVPage(this.VTuidMain)];case 1:return t.sent(),[2]}})})},e.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:switch(t){case"new":return[3,2];case"list":return[3,3];case"edit":return[3,4];case"item-changed":return[3,6];case"info":return[3,7]}return[3,1];case 1:return[2];case 2:return n=this.VTuidEdit,[3,9];case 3:return n=this.VTuidList,[3,9];case 4:return[4,this.edit(e)];case 5:return r.sent(),[2];case 6:return this.itemChanged(e),[2];case 7:return[4,new N(this.cUsq,this.entity,this.ui,this.res).start(e)];case 8:return r.sent(),[2];case 9:return[4,this.showVPage(n,e)];case 10:return r.sent(),[2]}})})},e.prototype.edit=function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return e=void 0,void 0===t?[3,2]:[4,this.entity.load(t)];case 1:e=r.sent(),r.label=2;case 2:return n=this.VTuidEdit,[4,this.showVPage(n,e)];case 3:return r.sent(),[2]}})})},e.prototype.itemChanged=function(t){var e=t.id,n=t.values;if(void 0!==this.PageItems){var r=this.PageItems.items.find(function(t){return t.id===e});void 0!==r&&o.a.merge(r,n)}},e}(E),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.edit(t)];case 1:return e.sent(),[2]}})})},e}(C),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VTuidList)];case 1:return t.sent(),[2]}})})},e}(C),O=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return alert("tuid div: "+this.entity.name),[2]})})}}(E),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.showVPage(this.VTuidSelect,t)];case 1:return e.sent(),[2]}})})},e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.loadSchema()];case 1:return t.sent(),void 0!==this.PageItems&&this.PageItems.reset(),[2,!0]}})})},Object.defineProperty(e.prototype,"VTuidSelect",{get:function(){return v},enumerable:!0,configurable:!0}),e.prototype.idFromItem=function(t){return t.id},e}(E)),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.entity.load(t)];case 1:return e=n.sent(),[4,this.showVPage(this.VTuidInfo,e)];case 2:return n.sent(),[2]}})})},Object.defineProperty(e.prototype,"VTuidInfo",{get:function(){return y},enumerable:!0,configurable:!0}),e}(E);n.d(e,"d",function(){return C}),n.d(e,"a",function(){return k}),n.d(e,"c",function(){return P}),n.d(e,"e",function(){return O}),n.d(e,"b",function(){return N})},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return a});var r=n(81),i=n.n(r),o=function(){function t(t){this.user=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this.user.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.user.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nick",{get:function(){return this.user.nick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return this.user.icon||"http://101.200.46.56/imgs/Bear-icon.png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guest",{get:function(){return this.user.guest},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"token",{get:function(){return this.user.token},enumerable:!0,configurable:!0}),t}();function s(t){var e=i()(t);return{id:e.id,name:e.name,guest:e.guest,token:t}}function a(t){return{id:0,guest:i()(t).guest,token:t}}},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return s});var r=n(21),i=n.n(r),o={lang:void 0,district:void 0};function s(t){var e=o.lang,n=o.district,r={};if(void 0===t)return r;i.a.merge(r,t._);var s=t[e];if(void 0===s)return r;i.a.merge(r,s._);var a=s[n];if(void 0===a)return r;i.a.merge(r,a);var u=r.entity;if(void 0!==u)for(var c in u)u[c.toLowerCase()]=u[c];return r}!function(){var t,e,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");t=r[0],r.length>1&&(e=r[1])}else t="zh",e="CN";!function(t,e){o.lang=t,o.district=e}(t,e)}()},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n.n(i),s=n(13),a=function(){function t(t){this.view=function(){return i.createElement("div",null)},this.label=t}return t.prototype.render=function(){return i.createElement("div",{key:this.key,className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.label),i.createElement("div",{className:"col-sm-10"},this.renderContent())))},t.prototype.setAddRow=function(t){},Object.defineProperty(t.prototype,"key",{get:function(){return this.label},enumerable:!0,configurable:!0}),t.prototype.getVFields=function(){},t.prototype.getVArr=function(){},t.prototype.getVSubmit=function(){},t.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"content")},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.vField=n,r}return r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this.vField.name},enumerable:!0,configurable:!0}),e.prototype.getVFields=function(){return[this.vField]},e.prototype.renderContent=function(){return this.vField.render()},e}(a),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.vArr=n,r}return r.d(e,t),e.prototype.setAddRow=function(t){this.vArr.setAddRow(t)},Object.defineProperty(e.prototype,"key",{get:function(){return this.vArr.name},enumerable:!0,configurable:!0}),e.prototype.getVArr=function(){return this.vArr},e.prototype.render=function(){return i.createElement(i.Fragment,{key:this.key},this.vArr&&this.vArr.render())},e}(a),l=(function(t){function e(e,n){var r=t.call(this,e)||this;return r.vFields=n,r}r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this.vFields[0].name},enumerable:!0,configurable:!0}),e.prototype.getVFields=function(){return this.vFields},e.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"fields")}}(a),function(t){function e(e){var n=t.call(this,void 0)||this;return n.vSubmit=e,n}return r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return"$submit"},enumerable:!0,configurable:!0}),e.prototype.getVSubmit=function(){return this.vSubmit},e.prototype.render=function(){return i.createElement("div",{key:"$submit",className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"offset-sm-2 col-sm-10"},this.vSubmit.render())))},e}(a)),h=n(26),p=n(9),d=function(t){function e(e){var n=t.call(this)||this;return n.onClickSubmit=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.submit(),[2]})})},n.view=Object(s.a)(function(){var t=n.vForm.isOk;return i.createElement("button",{type:"button",onClick:n.onClickSubmit,className:n.className,disabled:!1===t},n.caption)}),n.vForm=e,n.caption=n.vForm.submitCaption,n.className="btn btn-primary w-25",n}return r.d(e,t),r.c([p.l],e.prototype,"caption",void 0),r.c([p.l],e.prototype,"className",void 0),e}(h.d),f=n(14),m=n.n(f),v=n(8),b=function(){return function(){}}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){switch(typeof e){default:case"boolean":return;case"object":if(null!==e)return;break;case"string":if(e.trim().length>0)return;break;case"number":if(NaN!==e)return;break;case"undefined":}t.push("\u4e0d\u80fd\u4e3a\u7a7a")},e}(b),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){void 0!==e&&null!==e&&(NaN===Number(e)&&t.push("\u5fc5\u987b\u662f\u6570\u5b57"))},e}(b),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){if(void 0!==e&&null!==e){var n=Number(e);!0!==Number.isNaN(n)&&!1!==Number.isInteger(n)||t.push("\u5fc5\u987b\u662f\u6574\u6570")}},e}(b),E=function(t){function e(e){var n=t.call(this)||this;return n.min=e,n}return r.d(e,t),e.prototype.check=function(e,n){t.prototype.check.call(this,e,n),Number(n)<this.min&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.min)},e}(g),C=function(t){function e(e){var n=t.call(this)||this;return n.max=e,n}return r.d(e,t),e.prototype.check=function(e,n){t.prototype.check.call(this,e,n),Number(n)>this.max&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.max)},e}(g),k=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.form=e,o.field=n,o.name=n.name,o.fieldUI=r||{},o.fieldRes=i||{},o.init(),o}return r.d(e,t),e.prototype.init=function(){this.buildRules()},e.prototype.buildRules=function(){this.rules=[],(!0===this.fieldUI.required||void 0!==this.field&&!1===this.field.null)&&this.rules.push(new y)},Object.defineProperty(e.prototype,"checkRules",{get:function(){for(var t=[],e=0,n=this.rules;e<n.length;e++){n[e].check(t,this.value)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOk",{get:function(){return 0===this.rules.length||0===this.checkRules.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.form.values[this.name]},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){this.form.values[this.name]=t},Object.defineProperty(e.prototype,"error",{get:function(){return this.form.errors[this.name]},set:function(t){this.form.errors[this.name]=t},enumerable:!0,configurable:!0}),e.prototype.parse=function(t){return t},Object.defineProperty(e.prototype,"readonly",{get:function(){var t=this.form.mode;return t===I.readonly||t===I.edit&&!1===this.fieldUI.editable},enumerable:!0,configurable:!0}),r.c([p.e],e.prototype,"checkRules",null),r.c([p.e],e.prototype,"isOk",null),r.c([p.e],e.prototype,"value",null),e}(h.d),P=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return i.createElement("input",{type:"text",className:"form-control form-control-plaintext border border-info rounded bg-light",placeholder:"unkown control: -"})},e}r.d(e,t)}(k),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderError=function(t){var n=e.form.errors[e.name];if(void 0!==n)return i.createElement("div",{className:t},i.createElement(v.b,{name:"exclamation-circle"})," ",n)},e.ref=function(t){e.input=t,e.setInputValue()},e.onFocus=function(){e.error=void 0},e.onBlur=function(){var t=e.checkRules;t.length>0&&(e.error=t[0]),e.form.computeFields()},e.onChange=function(t){var n=e.parse(t.currentTarget.value);null!==n&&e.setValue(n)},e.view=Object(s.a)(function(){var t,n,r,o=e.fieldUI.required,s=e.fieldRes,a=s.placeHolder,u=s.suffix,c=["form-control","form-control-input"];return!0===e.readonly?n=i.createElement("input",{className:m()(c,"bg-light"),ref:e.ref,type:e.inputType,readOnly:!0}):(n=i.createElement("input",{className:m()(c),ref:e.ref,type:e.inputType,onFocus:e.onFocus,onBlur:e.onBlur,onChange:e.onChange,placeholder:a,readOnly:!1,maxLength:e.maxLength,onKeyPress:e.onKeyPress}),!0!==o&&!1!==e.field.null||(t=i.createElement(O,null))),r=void 0===u?n:i.createElement("div",{className:"input-group"},n,i.createElement("div",{className:"input-group-append"},i.createElement("span",{className:"input-group-text"},u))),i.createElement(i.Fragment,null,t,r,e.renderError("text-danger small mt-1 mx-2"))}),e}return r.d(e,t),Object.defineProperty(e.prototype,"maxLength",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e){t.prototype.setValue.call(this,e),this.setInputValue()},e.prototype.setInputValue=function(){if(this.input){var t=this.value;this.input.value=null===t||void 0===t?"":t}},e}(k)),O=function(){return i.createElement("b",{style:{color:"red",position:"absolute",left:"0.1em",top:"0.5em"}},"*")},N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="text",e}return r.d(e,t),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this.field.size},enumerable:!0,configurable:!0}),e}(P),S=45,x=46,j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e.onKeyPress=function(t){var n=t.charCode;if(!(8===n||0===n||13===n||n>=48&&n<=57))if(void 0!==e.extraChars&&e.extraChars.indexOf(n)>=0)switch(n){case x:e.onKeyDot();break;case S:e.onKeyNeg(),t.preventDefault()}else t.preventDefault()},e}return r.d(e,t),e.prototype.init=function(){if(t.prototype.init.call(this),this.extraChars=[],void 0!==this.fieldUI){var e=this.fieldUI,n=e.min;e.max;void 0!==n?n<0&&this.extraChars.push(S):this.extraChars.push(S)}switch(this.field.type){case"dec":case"bigint":case"int":case"smallint":case"tinyint":this.extraChars.push(x)}},e.prototype.buildRules=function(){t.prototype.buildRules.call(this),this.rules.push(new g);var e=this.fieldUI,n=e.min,r=e.max;void 0!==n&&this.rules.push(new E(n)),void 0!==r&&this.rules.push(new C(r))},e.prototype.parse=function(t){try{if(0===t.trim().length)return;var e=Number(t);return NaN===e?null:e}catch(n){return null}},e.prototype.setInputValue=function(){if(this.input){var t=this.value;this.parse(this.input.value)!=t&&(this.input.value=null===t||void 0===t?"":t)}},e.prototype.onKeyDot=function(){var t=this.input.value;t.indexOf(".")>=0&&(this.input.value=t.replace(".",""))},e.prototype.onKeyNeg=function(){var t=this.input.value,e=t.indexOf("-");t=e>=0?t.replace("-",""):"-"+t,this.input.value=t},e}(P),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.buildRules=function(){t.prototype.buildRules.call(this),this.rules.push(new w)},e}(j),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(j),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(N),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(N);var I,q=function(t){function e(e,n,r){var i=t.call(this,e,n,void 0,r)||this;return i.view=Object(s.a)(function(){var t=i.form.values[i.field.name],e=i.fieldRes,n=e.placeHolder,r=e.suffix;null===t&&(t="");var s=o.a.createElement("input",{className:"form-control form-control-input bg-light",type:"text",placeholder:n,readOnly:!0,value:t});return void 0===r?s:o.a.createElement("div",{className:"input-group"},s,o.a.createElement("div",{className:"input-group-append"},o.a.createElement("span",{className:"input-group-text"},r)))}),i}return r.d(e,t),e}(k),R=n(21),D=n.n(R),U=n(5),L=function(t){function e(e,n,o){var s=t.call(this)||this;s.rowPage=function(){return i.createElement(U.Page,{header:s.label,back:"close"},s.vForm.render("py-3"))},s.onSubmit=function(){return r.b(s,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this.vForm.valueBoxs,[4,this.onRowChanged(t)];case 1:return e.sent(),[2]}})})},s.onRowChanged=function(t){return r.b(s,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.rowValues?[3,4]:(t.$owner=this.ownerForm.values,this.list.push(t),void 0!==this.onEditRow?[3,1]:(this.vForm.reset(),[3,3]));case 1:return[4,this.onEditRow(void 0,this.onRowChanged)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:D.a.merge(this.rowValues,t),void 0===this.onEditRow&&U.nav.pop(),e.label=5;case 5:return[2]}})})},s.renderItem=function(t,e){return void 0===s.rowContent?i.createElement("div",{className:"px-3 py-2"},i.createElement(h.a,r.a({},t))):i.createElement(s.rowContent,r.a({},t))},s.showRow=function(t){return r.b(s,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.onEditRow?[3,2]:[4,this.onEditRow(t,this.onRowChanged)];case 1:return e.sent(),[2];case 2:return this.vForm.reset(),void 0!==t&&this.vForm.setValues(t),U.nav.push(i.createElement(this.rowPage,null)),[2]}})})},s.editRow=function(t){return r.b(s,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return this.rowValues=t,void 0!==(e=this.vForm.vSubmit)&&(e.caption=this.editSubmitCaption,e.className="btn btn-outline-success"),this.vForm.mode=this.ownerForm.mode,[4,this.showRow(t)];case 1:return n.sent(),[2]}})})},s.internalAddRow=function(){return r.b(s,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return this.rowValues=void 0,(t=this.vForm.vSubmit).caption=this.newSubmitCaption,t.className="btn btn-outline-success",this.vForm.reset(),this.vForm.mode=I.new,[4,this.showRow(void 0)];case 1:return e.sent(),[2]}})})},s.view=function(){var t;void 0===s.addRow&&s.mode===I.readonly||(t=i.createElement("button",{onClick:s.addRow||s.internalAddRow,type:"button",className:"btn btn-link p-0"},s.ownerForm.arrTitleNewButton));var e=s.header||i.createElement("div",{className:"px-3 bg-light small",style:{paddingTop:"1px",paddingBottom:"1px"}},i.createElement("div",{className:"flex-fill align-self-center"},s.label),t);return i.createElement(v.e,{className:"pb-3",header:e,none:i.createElement(v.g,{className:"px-3 py-2"},s.none),items:s.list,item:{render:s.renderItem,onClick:s.editRow}})},s.ownerForm=e;var a=n.name,u=n.fields;s.name=a;var c=e.ui,l=e.res,p=e.mode,d=e.inputs,f=e.values,m=l.arrs,b=void 0!==m?m[a]:{},y=b.label,g=b.none,w=b.newSubmit,E=b.editSubmit;s.none=g||e.none,s.newSubmitCaption=w||e.arrNewCaption,s.editSubmitCaption=E||e.arrEditCaption,s.label=y||a;var C=c&&c.items[a]||{};return s.rowContent=C.rowContent,s.mode=p,void 0===s.onEditRow?s.vForm=new K({fields:u,arrs:void 0,ui:C,res:b,inputs:d[a],none:e.none,submitCaption:"submit",arrNewCaption:void 0,arrEditCaption:void 0,arrTitleNewButton:void 0,mode:p},p===I.readonly?void 0:s.onSubmit):s.onEditRow=o,s.list=f[a],s}return r.d(e,t),e.prototype.reset=function(){this.vForm.reset(),this.list.clear()},e.prototype.setAddRow=function(t){this.addRow=t},e}(h.d),M=n(27),B={textAlign:"left",paddingLeft:"0.75rem",paddingRight:"0.75rem",overflow:"hidden"},H=function(t){function e(e,n,o,a){var u=t.call(this,e,n,o,a)||this;return u.onClick=function(){return r.b(u,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return!0!==this.readonly?[3,2]:this.value?[4,this.tuid.showInfo(this.value.id)]:[2];case 1:return e.sent(),[2];case 2:return void 0===this.input?[3,4]:[4,this.input.select(this.vForm,this.field,this.vForm.getValues())];case 3:return t=e.sent(),[3,5];case 4:alert("call undefined"),t=0,e.label=5;case 5:return this.setValue(this.tuid.boxId(t)),[2]}})})},u.view=Object(s.a)(function(){var t,e,n=u.fieldRes.placeHolder,r=!1,o=u.field._ownerField;if(void 0!==o){var s=o.name;o.arr;r=null===u.vForm.getValue(s)}if(null===u.value)t=i.createElement(i.Fragment,null,n||u.input.placeHolder);else if("object"===typeof u.value)t=Object(M.b)(u.value);else{var a=u.tuid.boxId(u.value);t=Object(M.b)(a)}return!0===u.readonly?i.createElement("div",{className:"form-control form-control-plaintext border border-info rounded bg-light cursor-pointer",onClick:u.onClick},t):(!0!==u.fieldUI.required&&!1!==u.field.null||(e=i.createElement(O,null)),i.createElement(i.Fragment,null,e,i.createElement("button",{className:"form-control btn btn-outline-info",type:"button",disabled:r,style:B,onClick:u.onClick},t)))}),u.tuid=n._tuid,u.vForm=e,u.input=e.inputs[n.name],u}return r.d(e,t),e}(k),W=function(){function t(t,e,n){this.vForm=t,this.onSubmit=n;var r=e.fields,i=e.arrs,o=e.ui,s=e.res;if(this.fields=r,this.arrs=i,void 0!==o){var a=o.items,u=o.layout;this.formItems=a,this.layout=u}this.res=s}return t.prototype.build=function(){return void 0===this.layout?this.bandsOnFly():this.bandsFromLayout()},t.prototype.resFromName=function(t,e){if(void 0!==e){var n=e.fields;if(void 0!==n)return n[t]||t}},t.prototype.bandsOnFly=function(){var t=[];if(this.bandsFromFields(t,this.fields,this.res),void 0!==this.arrs)for(var e=0,n=this.arrs;e<n.length;e++){var r=n[e];t.push(this.bandFromArr(r))}return void 0!==this.onSubmit&&t.push(new l(new d(this.vForm))),t},t.prototype.bandsFromFields=function(t,e,n){if(void 0!==e)for(var r=0,i=e;r<i.length;r++){var o=i[r];t.push(this.bandFromField(o,n))}},t.prototype.bandsFromLayout=function(){return[]},t.prototype.bandFromField=function(t,e){var n,r,i,o,s=t.name,a=this.resFromName(s,e);return"object"===typeof a?(r=a.label,n=a):(r=a,n=void 0),void 0!==this.formItems&&(o=this.formItems[s]),void 0===(i="function"===typeof o?new q(this.vForm,t,n):function(t,e,n,r){var i;switch(e.type){default:return;case"tinyint":case"smallint":case"int":i=V;break;case"bigint":if(void 0!==e._tuid)return;i=V;break;case"dec":i=F;break;case"char":i=N;break;case"text":i=A;break;case"datetime":i=T}return new i(t,e,n,r)}(this.vForm,t,o,n))&&(i=new H(this.vForm,t,o,n)),new u(r||s,i)},t.prototype.bandFromArr=function(t){var e=t.name,n=(t.fields,new L(this.vForm,t));return new c(e,n)},t}();!function(t){t[t.new=0]="new",t[t.edit=1]="edit",t[t.readonly=2]="readonly"}(I||(I={}));var K=function(){function t(t,e){var n=this;this.vFields={},this.vArrs={},this.onFormSubmit=function(t){return t.preventDefault(),!1},this.view=Object(s.a)(function(t){var e=t.className;return i.createElement("form",{className:e,onSubmit:n.onFormSubmit},n.bands.map(function(t){return t.render()}))});var r=t.fields,o=t.arrs,a=t.ui,u=t.res,c=t.inputs,l=t.none,h=t.submitCaption,p=t.arrNewCaption,d=t.arrEditCaption,f=t.arrTitleNewButton,m=t.mode;this.fields=r,this.arrs=o,this.ui=a,void 0!==this.ui&&(this.formItems=this.ui.items),this.res=u,this.inputs=c,this.none=l,this.submitCaption=h,this.arrNewCaption=p,this.arrEditCaption=d,this.arrTitleNewButton=f||i.createElement("small",null,i.createElement(v.b,{name:"plus"})," \u65b0\u589e"),this.mode=void 0===e?I.readonly:m,this.buildFormValues(),this.buildBands(t,e),this.onSubmit=e}return t.prototype.buildBands=function(t,e){this.bandColl={};var n=new W(this,t,e);this.bands=n.build();for(var r=0,i=this.bands;r<i.length;r++){var o=i[r];this.bandColl[o.key]=o;var s=o.getVFields();if(void 0!==s)for(var a=0,u=s;a<u.length;a++){var c=u[a];this.vFields[c.name]=c}var l=o.getVArr();void 0!==l&&(this.vArrs[l.name]=l);var h=o.getVSubmit();void 0!==h&&(this.vSubmit=h)}},t.prototype.getBand=function(t){return this.bandColl[t]},t.prototype.computeFields=function(){if(void 0!==this.formItems){var t=this.values;for(var e in this.formItems){var n=this.formItems[e];"function"===typeof n&&(t[e]=n.call(t))}}},t.prototype.submit=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0===this.onSubmit?[2]:[4,this.onSubmit()];case 1:return t.sent(),[2]}})})},t.prototype.getValues=function(){for(var t={},e=this.values,n=0,r=this.fields;n<r.length;n++){var i=e[u=r[n].name];t[u]=null!==i&&"object"===typeof i?i.id:i}if(void 0!==this.arrs)for(var o=0,s=this.arrs;o<s.length;o++)for(var a=s[o],u=a.name,c=a.fields,l=a.id,h=a.order,p=t[u]=[],d=0,f=this.vArrs[u].list;d<f.length;d++){var m=f[d],v={};void 0!==l&&(v[l]=m[l]),void 0!==h&&(v[h]=m[h]);for(var b=0,y=c;b<y.length;b++){var g=y[b].name;i=m[g];v[g]=null!==i&&"object"===typeof i?i.id:i}p.push(v)}return t},Object.defineProperty(t.prototype,"valueBoxs",{get:function(){for(var t={},e=this.values,n=0,r=this.fields;n<r.length;n++){var i=(v=r[n]).name,o=v._tuid,s=e[i];t[i]=void 0===o||"object"===typeof s?s:o.boxId(s)}if(void 0===this.arrs)return t;for(var a=0,u=this.arrs;a<u.length;a++)for(var c=u[a],l=(i=c.name,c.fields),h=(c.id,c.order,0),p=t[i]=this.vArrs[i].list.slice();h<p.length;h++)for(var d=p[h],f=0,m=l;f<m.length;f++){var v,b=(v=m[f]).name;o=v._tuid,s=d[b];d[b]=void 0===o||"object"===typeof s?s:o.boxId(s)}return t},enumerable:!0,configurable:!0}),t.prototype.setValues=function(t){if(void 0!==t){for(var e=this.values,n=this.errors,r=0,i=this.fields;r<i.length;r++){var o=i[r].name;n[o]=void 0;var s=t[o];e[o]=s}for(var a in this.vArrs){var u=t[a];if(void 0!==u){var c=e[a];c.clear(),c.push.apply(c,u)}}}else this.reset()},Object.defineProperty(t.prototype,"isOk",{get:function(){for(var t in this.vFields)if(!1===this.vFields[t].isOk)return!1;return!0},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t=this.values,e=this.errors,n=0,r=this.fields;n<r.length;n++){var i=r[n].name;t[i]=null,e[i]=void 0}for(var o in this.vFields){var s=this.vFields[o];void 0!==s.name&&s.setValue(null)}for(var o in this.vArrs){this.vArrs[o].reset()}},t.prototype.getValue=function(t){return this.values[t]},t.prototype.setValue=function(t,e){this.values[t]=e},t.prototype.setError=function(t,e){this.errors[t]=e},t.prototype.buildFieldValues=function(t){for(var e={valueFromFieldName:function(t){return this[t]}},n=0,r=t;n<r.length;n++){e[r[n].name]=null}return e},t.prototype.buildObservableValues=function(){var t=this.buildFieldValues(this.fields);if(void 0!==this.arrs)for(var e=0,n=this.arrs;e<n.length;e++){t[n[e].name]=p.l.array([],{deep:!0})}return Object(p.l)(t)},t.prototype.buildFormValues=function(){this.values=this.buildObservableValues(),this.errors=Object(p.l)(this.buildFieldValues(this.fields))},t.prototype.render=function(t){return void 0===t&&(t="py-3"),i.createElement(this.view,{className:t})},r.c([p.e],t.prototype,"isOk",null),t}();n.d(e,"a",function(){return I}),n.d(e,"b",function(){return K})},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(33),o=n(22),s=n(41);var a=function(){function t(t,e,n,i){var o=this;this.startWait=function(){void 0!==o.ui&&o.ui.startWait()},this.endWait=function(t,e){void 0!==o.ui&&o.ui.endWait(),void 0!==e&&e("\u8bbf\u95eewebapi\u8d85\u65f6 "+t)},this.showError=function(t){return r.b(o,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.ui?[3,2]:[4,this.ui.showError(t)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},this.isCenter=t,this.hostUrl=e,this.apiToken=n,this.ui=i,this.timeout=!0===s.b?5e5:5e3}return t.prototype.used=function(){this.post("",{})},t.prototype.get=function(t,e){return void 0===e&&(e=void 0),r.b(this,void 0,Promise,function(){var n,i,o,s,a,u;return r.e(this,function(r){switch(r.label){case 0:if(e&&(n=Object.keys(e)).length>0)for(i="?",o=0,s=n;o<s.length;o++)a=s[o],void 0!==e[a]&&(t+=i+a+"="+e[a],i="&");return(u=this.buildOptions()).method="GET",[4,this.innerFetch(t,u)];case 1:return[2,r.sent()]}})})},t.prototype.post=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="POST",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.put=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="PUT",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.delete=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="DELETE",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.fetch=function(t,e,n,i){return r.b(this,void 0,Promise,function(){function s(t){return{channel:a,url:u,options:e,resolve:n,reject:i,error:t}}var a,u,c,l,h,p,d,f=this;return r.e(this,function(m){switch(m.label){case 0:a=this,this.startWait(),u=t,m.label=1;case 1:return m.trys.push([1,6,,8]),console.log("%s %s",e.method,u),c=setTimeout(function(){return a.endWait(t,i)},this.timeout),[4,fetch(encodeURI(u),e)];case 2:if(!1===(l=m.sent()).ok)throw clearTimeout(c),a.endWait(),console.log("call error %s",l.statusText),l.statusText;return(h=l.headers.get("content-type"))&&h.indexOf("json")>=0?[2,l.json().then(function(t){return r.b(f,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return clearTimeout(c),a.endWait(),!0===t.ok?[2,n(t.res)]:void 0!==t.error?[3,2]:[4,a.showError(s("not valid tonva json"))];case 1:return e.sent(),[3,4];case 2:return[4,a.showError(s(t.error))];case 3:e.sent(),i(t.error),e.label=4;case 4:return[2]}})})}).catch(function(t){return r.b(f,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,a.showError(s(t.message))];case 1:return e.sent(),[2]}})})})]:[3,3];case 3:return[4,l.text()];case 4:p=m.sent(),clearTimeout(c),a.endWait(),n(p),m.label=5;case 5:return[3,8];case 6:return"string"===typeof(d=m.sent())&&!0===d.toLowerCase().startsWith("unauthorized")?(o.c.logout(),[2]):[4,this.showError(s(d.message))];case 7:return m.sent(),[3,8];case 8:return[2]}})})},t.prototype.innerFetch=function(t,e){return r.b(this,void 0,Promise,function(){var n,o=this;return r.e(this,function(s){switch(s.label){case 0:return n=this.hostUrl+t,!0===this.isCenter&&void 0===this.apiToken&&Object(i.d)()?[4,Object(i.c)(n,e.method,e.body)]:[3,2];case 1:return[2,s.sent()];case 2:return[4,new Promise(function(t,i){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(n,e,t,i)];case 1:return r.sent(),[2]}})})})];case 3:return[2,s.sent()]}})})},t.prototype.callFetch=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o=this;return r.e(this,function(s){switch(s.label){case 0:return(i=this.buildOptions()).method=e,i.body=n,[4,new Promise(function(e,n){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(t,i,e,n)];case 1:return r.sent(),[2]}})})})];case 1:return[2,s.sent()]}})})},t.prototype.buildOptions=function(){var t=o.c.language,e=o.c.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=t;return e&&(r+="-"+e),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),{headers:n}},t}()},,function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n(0),i=n(1),o=n(13),s=n(14),a=n.n(s),u=n(21),c=n.n(u),l=n(61),h=100,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bottomTime=0,e.topTime=0,e.onScroll=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o,s,a,u;return r.e(this,function(r){return e=this.props,n=e.onScroll,i=e.onScrollTop,o=e.onScrollBottom,n&&this.props.onScroll(t),(s=t.target).scrollTop<30&&void 0!==i&&(a=(new Date).getTime())-this.topTime>h&&(this.topTime=a,i()),s.scrollTop+s.offsetHeight>s.scrollHeight-30&&void 0!==o&&(u=(new Date).getTime())-this.bottomTime>h&&(this.bottomTime=u,o()),[2]})})},e}return r.d(e,t),e.prototype.eachChild=function(t,e){var n=this,r=t.props;if(void 0!==r){var o=r.children;void 0!==o&&i.Children.forEach(o,function(t,r){var i=t._$scroll;i&&i(e),console.log(t.toString()),n.eachChild(t,e)})}},e.prototype.render=function(){return i.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)},e}(i.Component),d=function(t){function e(e){var n,r=t.call(this,e)||this,i=e.tabs;if(void 0===i||0===i.length)return r;r.tabs=i;for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s],l=c.a.clone(u);void 0===n&&!0===l.isSelected?n=l:l.isSelected=!1,l.isMounted=!1,o.push(l)}return r.state={cur:n,tabs:o},r}return r.d(e,t),e.prototype.componentDidMount=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return void 0===this.tabs?[2]:void 0===(t=this.state.tabs[0])?[2]:[4,this.onTabClick(t)];case 1:return e.sent(),[2]}})})},e.prototype.onTabClick=function(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:if(!0===t.isSelected)return[2];for(n=this.state.tabs,i=0,o=n;i<o.length;i++)(s=o[i])===t?(s.isSelected=!0,e=s):s.isSelected=!1;return!0===e.isMounted?[3,2]:void 0===(a=e.load)?[3,2]:[4,a()];case 1:r.sent(),r.label=2;case 2:return this.setState({cur:e,tabs:n}),[2]}})})},e.prototype.onTouchStart=function(t){},e.prototype.renderTabs=function(t){var e,n=this,r=this.props,o=r.header,s=r.back,u=r.right,c=r.keepHeader,h=this.state.cur,d=i.createElement("div",null,this.state.tabs.map(function(t,e){var r,o,s,u=t.icon,c=t.isSelected,l=t.title,h=t.redDot;if(void 0!==u&&(r=i.createElement("img",{src:u})),void 0!==h){var p=h.get();p<0?(s=a()("red-dot"),o=i.createElement("u",null)):p>0&&(s=a()("red-dot","num"),o=i.createElement("u",null,p))}return i.createElement("div",{key:e,className:a()("va-tab",{cur:c}),onClick:function(){return n.onTabClick(t)}},r,i.createElement("div",{className:s},l,o))}));return!1!==o&&(e=i.createElement(l.a,{back:s,center:!0===c?o:h&&(h.header||h.title),right:u})),i.createElement("article",{className:"page-container"},e,i.createElement("section",null,this.state.tabs.map(function(t,e){var n=t.isSelected,r=t.isMounted,o=t.content;if(!0===n||!0===r)return t.isMounted=!0,i.createElement(p,{key:e,className:a()({invisible:!1===n}),onScroll:t.onScroll,onScrollTop:t.onScrollTop,onScrollBottom:t.onScrollBottom},"function"===typeof o?o():o)})),d,t)},e.prototype.renderSingle=function(t){var e,n=this.props,r=n.back,o=n.header,s=n.right,a=n.onScroll,u=n.onScrollTop,c=n.onScrollBottom,h=n.children;return!1!==o&&(e=i.createElement(l.a,{back:r,center:o,right:s,logout:this.props.logout})),i.createElement("article",{className:"page-container",onTouchStart:this.onTouchStart},e,i.createElement("section",null,i.createElement(p,{onScroll:a,onScrollTop:u,onScrollBottom:c},h)),t)},e.prototype.render=function(){var t,e=this.props.footer;return void 0!==e&&(t=i.createElement("footer",null,e)),void 0!==this.tabs?this.renderTabs(t):this.renderSingle(t)},e=r.c([o.a],e)}(i.Component)},function(t,e,n){"use strict";var r=n(67);n.d(e,"CApp",function(){return r.a});n(103),n(72),n(76),n(47),n(71),n(62),n(73),n(74),n(75);var i=n(26);n.d(e,"PureJSONContent",function(){return i.b});n(50);var o=n(104);n.o(o,"tv")&&n.d(e,"tv",function(){return o.tv});n(69),n(12),n(36),n(68)},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(21),s=n.n(o),a=function(){function t(t,e,n){this.fieldMaps={},this.entities=t,this.name=e,this.typeId=n,this.sys=this.name.indexOf("$")>=0}return Object.defineProperty(t.prototype,"sName",{get:function(){return this.jName||this.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tvApi",{get:function(){return this.entities.usqApi},enumerable:!0,configurable:!0}),t.prototype.getApiFrom=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2,this.entities.usqApi]})})},t.prototype.fieldMap=function(t){void 0===t&&(t="$");var e=this.fieldMaps[t];if(void 0===e){var n=void 0;if("$"===t)n=this.fields;else if(void 0!==this.arrFields){void 0!==(r=this.arrFields.find(function(e){return e.name===t}))&&(n=r.fields)}else if(void 0!==this.returns){var r;void 0!==(r=this.returns.find(function(e){return e.name===t}))&&(n=r.fields)}if(void 0===n)return{};e={};for(var i=0,o=n;i<o.length;i++){var s=o[i];e[s.name]=s}this.fieldMaps[t]=e}return e},t.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.schema?[2]:[4,this.entities.usqApi.schema(this.name)];case 1:return t=e.sent(),this.setSchema(t),[2]}})})},t.prototype.setSchema=function(t){if(void 0!==t&&void 0===this.schema){this.schema=t;var e=t.name,n=t.fields,r=t.arrs,i=t.returns;e!==this.name&&(this.jName=e),this.entities.buildFieldTuid(this.fields=n),this.entities.buildArrFieldsTuid(this.arrFields=r,n),this.entities.buildArrFieldsTuid(this.returns=i,n)}},t.prototype.schemaStringify=function(){return JSON.stringify(this.schema,function(t,e){if("_tuid"!==t)return e},4)},t.prototype.tuidFromField=function(t){var e=t._tuid,n=t.tuid;if(void 0!==n)return void 0!==e?e:t._tuid=this.entities.getTuid(n,void 0)},t.prototype.tuidFromName=function(t,e){if(void 0!==this.schema){var n=this.schema,r=n.fields,i=n.arrs,o=this.entities,s=t.toLowerCase();if(void 0===e)return c(s,r);if(void 0!==i){var a=e.toLowerCase(),u=i.find(function(t){return t.name===a});if(void 0!==u)return c(s,u.fields)}}function c(t,e){if(void 0!==e){var n=e.find(function(e){return e.name===t});if(void 0!==n)return o.getTuid(n.tuid,void 0)}}},t.prototype.pack=function(t){var e=[],n=this.fields;void 0!==n&&this.packRow(e,n,t);var r=this.arrFields;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];this.packArr(e,s.fields,t[s.name])}return e.join("")},t.prototype.escape=function(t,e){var n=t[e.name];switch(typeof n){default:return n;case"object":var r=e._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var i=n.length,o="",s=0,a=0;a<i;a++){switch(n.charCodeAt(a)){case 9:o+=n.substring(s,a)+"\\t",s=a+1;break;case 10:o+=n.substring(s,a)+"\\n",s=a+1}}return o+n.substring(s);case"undefined":return""}},t.prototype.packRow=function(t,e,n){var r=e.length;if(0!==r){var i="";i+=this.escape(n,e[0]);for(var o=1;o<r;o++){var s=e[o];i+="\t"+this.escape(n,s)}t.push(i+"\n")}},t.prototype.packArr=function(t,e,n){if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r];this.packRow(t,e,o)}t.push("\n")},t.prototype.unpackSheet=function(t){var e={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(e,n,t,r));var i=this.arrFields;if(void 0!==i)for(var o=0,s=i;o<s.length;o++){var a=s[o];r=this.unpackArr(e,a,t,r)}return e},t.prototype.unpackReturns=function(t){var e={},n=0,r=this.returns;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];n=this.unpackArr(e,s,t,n)}return e},t.prototype.unpackRow=function(t,e,n,r){for(var i=0,o=0,s=r,a=0,u=n.length,c=e.length;r<u;r++)if(i=o,9===(o=n.charCodeAt(r))){var l=e[a];if(8!==i){if(r>s){var h=n.substring(s,r);t[l.name]=this.to(t,h,l)}}else t[l.name]=null;if(s=r+1,++a>=c)break}else if(10===o){l=e[a];if(8!==i){if(r>s){h=n.substring(s,r);t[l.name]=this.to(t,h,l)}}else t[l.name]=null;++r,++a;break}return r},t.prototype.to=function(t,e,n){switch(n.type){default:return e;case"datetime":case"date":case"time":return new Date(Number(e));case"tinyint":case"smallint":case"int":case"dec":return Number(e);case"bigint":var r=Number(e),i=n._tuid;return void 0===i?r:(console.log(this.name,"bigint",e,"tuid",i.name),i.useId(r,!0),i.boxId(r))}},t.prototype.unpackArr=function(t,e,n,r){for(var i=[],o=n.length,s=e.name,a=e.fields;r<o;){if(10===n.charCodeAt(r)){++r;break}var u={};i.push(u),r=this.unpackRow(u,a,n,r)}return t[s]=i,r},t}(),u=n(111),c=(function(){}(),function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.queue=[],o.waitingIds=[],o.cache=i.l.map({},{deep:!1}),o.buildIdBoxer(),o}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"tuid"},enumerable:!0,configurable:!0}),e.prototype.buildIdBoxer=function(){this.BoxId=function(){};var t=this.BoxId.prototype;Object.defineProperty(t,"_$tuid",{value:this,writable:!1,enumerable:!1}),Object.defineProperty(t,"obj",{enumerable:!1,get:function(){if(!(void 0===this.id||this.id<=0))return this._$tuid.valueFromId(this.id)}}),t.valueFromFieldName=function(t){return this._$tuid.valueFromFieldName(t,this.obj)},t.toJSON=function(){return this.id}},e.prototype.boxId=function(t){this.useId(t);var e=new this.BoxId;return e.id=t,e},e.prototype.getTuidContent=function(){return this.entities.cUsq.getTuidContent(this)},e.prototype.getIdFromObj=function(t){return t[this.idName]},e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.id,r=e.unique;this.idName=n,this.unique=r,this.schemaFrom=this.schema.from},e.prototype.moveToHead=function(t){var e=this.queue.findIndex(function(e){return e===t});this.queue.splice(e,1),this.queue.push(t)},e.prototype.valueFromId=function(t){var e;switch(typeof t){case"object":e=t.id;break;case"number":e=t;break;default:return}var n=this.cache.get(e);return void 0!==this.owner&&"object"===typeof n&&(n.$owner=this.owner.boxId(n.owner)),n},e.prototype.valueFromFieldName=function(t,e){if(void 0!==e){var n=this.fields.find(function(e){return e.name===t});if(void 0!==n){var r=e[t],i=n._tuid;return void 0===i?r:i.valueFromId(r)}}},e.prototype.resetCache=function(t){this.cache.delete(t);var e=this.queue.findIndex(function(e){return e===t});this.queue.splice(e,1),this.useId(t)},e.prototype.useId=function(t,e){if(void 0!==t&&0!==t&&!1!==Object(u.isNumber)(t))if(!0!==this.cache.has(t))if(this.entities.cacheTuids(!0===e?70:20),this.cache.set(t,t),this.waitingIds.findIndex(function(e){return e===t})>=0)this.moveToHead(t);else{if(console.log("// \u5982\u679c\u6ca1\u6709\u7f13\u51b2, \u6216\u8005\u6ca1\u6709waiting"),this.queue.length>=1e3){var n=this.queue.shift();if(n===t)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex(function(t){return t===n});this.waitingIds.splice(r,1)}}console.log("this.waitingIds.push(id)",t),this.waitingIds.push(t),this.queue.push(t)}else this.moveToHead(t)},e.prototype.proxied=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return this.entities.getTuid(t,void 0).useId(e),[4,this.tvApi.proxied(this.name,t,e)];case 1:return n=r.sent(),this.cacheValue(n),[2,n]}})})},e.prototype.cacheValue=function(t){if(void 0===t)return!1;var e=this.getIdFromObj(t);if(void 0===e)return!1;var n=this.waitingIds.findIndex(function(t){return t===e});return n>=0&&this.waitingIds.splice(n,1),this.cache.set(e,t),!0},e.prototype.afterCacheId=function(t){for(var e=0,n=this.fields;e<n.length;e++){var r=n[e],i=r._tuid;void 0!==i&&i.useId(t[r.name])}},e.prototype.cacheIds=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return 0===this.waitingIds.length?[2]:(void 0===this.owner?t=this.name:(t=this.owner.name,e=this.name),[4,this.getApiFrom()]);case 1:return[4,r.sent().tuidIds(t,e,this.waitingIds)];case 2:for(n=r.sent(),i=0,o=n;i<o.length;i++)s=o[i],!1!==this.cacheValue(s)&&(this.cacheTuidFieldValues(s),this.afterCacheId(s));return[4,this.cacheDivIds()];case 3:return r.sent(),[2]}})})},e.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2]})})},e.prototype.load=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return void 0===t||0===t?[2]:[4,this.getApiFrom()];case 1:return[4,n.sent().tuidGet(this.name,t)];case 2:return void 0===(e=n.sent())?[2]:(e._$tuid=this,this.cacheValue(e),this.cacheTuidFieldValues(e),[2,e])}})})},e.prototype.getDiv=function(t){},e.prototype.cacheTuidFieldValues=function(t){var e=this.schema,n=e.fields,r=e.arrs;if(this.cacheFieldsInValue(t,n),void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i],a=s.name,u=s.fields,c=t[a];if(void 0!==c)for(var l=this.getDiv(a),h=0,p=c;h<p.length;h++){var d=p[h];d._$tuid=l,d.$owner=this.boxId(d.owner),this.cacheFieldsInValue(d,u)}}},e.prototype.cacheFieldsInValue=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i.name,s=i._tuid;if(void 0!==s){var a=t[o];t[o]=s.boxId(a)}}},e.prototype.save=function(t,e){return r.b(this,void 0,void 0,function(){var n,i,o;return r.e(this,function(r){switch(r.label){case 0:return(n=s.a.clone(e)).$id=t,[4,this.tvApi.tuidSave(this.name,n)];case 1:return i=r.sent(),o=i.id,i.inId,void 0===o?(n.id=t,this.cacheValue(n)):o>0&&(n.id=o,this.cacheValue(n)),[2,i]}})})},e.prototype.search=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.searchArr(void 0,t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.searchArr=function(t,e,n,i){return r.b(this,void 0,Promise,function(){var o,s,a,u,c,l,h;return r.e(this,function(r){switch(r.label){case 0:return o=this.schema.fields,void 0!==this.owner?(s=this.owner.name,a=this.name):(s=this.name,a=void 0),[4,this.getApiFrom()];case 1:return[4,r.sent().tuidSearch(s,a,t,e,n,i)];case 2:for(u=r.sent(),c=0,l=u;c<l.length;c++)h=l[c],this.cacheFieldsInValue(h,o),void 0!==this.owner&&(h.$owner=this.owner.boxId(h.owner));return[2,u]}})})},e.prototype.loadArr=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return void 0===n||0===n?[2]:[4,this.getApiFrom()];case 1:return[4,r.sent().tuidArrGet(this.name,t,e,n)];case 2:return[2,r.sent()]}})})},e.prototype.saveArr=function(t,e,n,i){return r.b(this,void 0,void 0,function(){var o;return r.e(this,function(r){switch(r.label){case 0:return(o=s.a.clone(i)).$id=n,[4,this.tvApi.tuidArrSave(this.name,t,e,o)];case 1:return[2,r.sent()]}})})},e.prototype.posArr=function(t,e,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tvApi.tuidArrPos(this.name,t,e,n,i)];case 1:return[2,r.sent()]}})})},e.prototype.showInfo=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entities.cUsq.showTuid(this,t)];case 1:return e.sent(),[2]}})})},e}(a)),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"Main",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usqApi",{get:function(){return this.entities.usqApi},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.arrs;if(void 0!==n){this.divs={};for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o.name,a=new h(this.entities,s,this.typeId);a.owner=this,this.divs[s]=a,a.setSchema(o)}}},e.prototype.getDiv=function(t){return this.divs[t]},e.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.divs)return[2];for(e in t=[],this.divs)t.push(e);n=0,r.label=1;case 1:return n<t.length?(i=t[n],[4,this.divs[i].cacheIds()]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.cUsqFrom=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return void 0===this.schemaFrom?[2,this.entities.cUsq]:(t=this.schemaFrom,e=t.owner,n=t.usq,[4,this.entities.cUsq]);case 1:return i=r.sent(),void 0===(o=i.cApp)?[2,i]:[4,o.getImportUsq(e,n)];case 2:return void 0===(s=r.sent())?(console.error(e+"/"+n+" \u4e0d\u5b58\u5728"),[2,i]):[4,s.loadSchema()];case 3:return void 0!==(a=r.sent())?(console.error("cUsq.loadSchema: "+a),[2,i]):[2,s]}})})},e.prototype.getApiFrom=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.from()];case 1:return void 0!==(t=e.sent())?[2,t.entities.usqApi]:[2,this.entities.usqApi]}})})},e.prototype.from=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.cUsqFrom()];case 1:return[2,t.sent().tuid(this.name)]}})})},e.prototype.cFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.cUsqFrom()];case 1:return[2,t.sent().cTuidMainFromName(this.name)]}})})},e.prototype.cEditFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.cUsqFrom()];case 1:return[2,t.sent().cTuidEditFromName(this.name)]}})})},e.prototype.cInfoFrom=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.cUsqFrom()];case 1:return[2,t.sent().cTuidInfoFromName(this.name)]}})})},e.prototype.cSelectFrom=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.cUsqFrom()];case 1:return void 0===(t=e.sent())?[2]:[2,t.cTuidSelectFromName(this.name)]}})})},e.prototype.afterCacheId=function(e){if(t.prototype.afterCacheId.call(this,e),void 0!==this.proxies){var n=e.type,r=e.$proxy;this.proxies[n].useId(r)}},e}(c),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"Main",{get:function(){return this.owner},enumerable:!0,configurable:!0}),e.prototype.getApiFrom=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.owner.getApiFrom()];case 1:return[2,t.sent()]}})})},e}(c),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"action"},enumerable:!0,configurable:!0}),e.prototype.submit=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),e=this.pack(t),[4,this.tvApi.action(this.name,{data:e})];case 2:return[2,n.sent()]}})})},e}(a),d=n(5),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"sheet"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e),this.states=e.states},e.prototype.build=function(t){this.states=[];for(var e=0,n=t.ops;e<n.length;e++){var r=n[e];this.states.push({name:r,actions:void 0})}},e.prototype.createSheetState=function(t,e){var n={name:t,actions:[]},r=n.actions;for(var i in e){var o={name:i};r.push(o)}return n},e.prototype.save=function(t,e){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return n=this.entities.appId,i=this.pack(e),[4,this.tvApi.sheetSave(this.name,{app:n,discription:t,data:i})];case 1:return[2,r.sent()]}})})},e.prototype.action=function(t,e,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tvApi.sheetAction(this.name,{id:t,flow:e,state:n,action:i})];case 1:return[2,r.sent()]}})})},e.prototype.unpack=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o;return r.e(this,function(r){return e=t[0],n=e[0],i=this.unpackSheet(n.data),o=t[1],[2,{brief:n,data:i,flows:o}]})})},e.prototype.getSheet=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.tvApi.getSheet(this.name,t)];case 1:return 0!==(e=n.sent())[0].length?[3,3]:[4,this.getArchive(t)];case 2:return[2,n.sent()];case 3:return[4,this.unpack(e)];case 4:return[2,n.sent()]}})})},e.prototype.getArchive=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.tvApi.sheetArchive(this.name,t)];case 1:return e=n.sent(),[4,this.unpack(e)];case 2:return[2,n.sent()]}})})},e.prototype.getArchives=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.tvApi.sheetArchives(this.name,{pageStart:t,pageSize:e})];case 1:return[2,n.sent()]}})})},e.prototype.getStateSheets=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tvApi.stateSheets(this.name,{state:t,pageStart:e,pageSize:n})];case 1:return[2,r.sent()]}})})},e.prototype.createPageStateItems=function(){return new m(this)},e.prototype.stateSheetCount=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.tvApi.stateSheetCount(this.name)];case 1:return t=e.sent(),[2,this.states.map(function(e){var n=e.name,r=0,i=t.find(function(t){return t.state===n});return void 0!==i&&(r=i.count),{state:n,count:r}})]}})})},e}(a),m=function(t){function e(e){var n=t.call(this,!0)||this;return n.sheet=e,n.pageSize=10,n}return r.d(e,t),e.prototype.load=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.sheet.getStateSheets(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(d.PageItems),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"query"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.returns;this.returns=n,this.isPaged=void 0!==n.find(function(t){return"$page"===t.name})},e.prototype.resetPage=function(t,e){this.pageStart=void 0,this.pageSize=t,this.params=e,this.more=!1,this.list=void 0},Object.defineProperty(e.prototype,"hasMore",{get:function(){return this.more},enumerable:!0,configurable:!0}),e.prototype.loadPage=function(){return r.b(this,void 0,Promise,function(){var t,e,n,o,s,a;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.pageSize)throw"call resetPage(size:number, params:any) first";if(void 0!==this.pageStart)switch(this.startField.type){default:e=this.pageStart;break;case"date":case"time":case"datetime":e=this.pageStart.getTime()}return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.page(this.name,e,this.pageSize+1,this.params)];case 2:return n=r.sent(),[4,this.unpackReturns(n)];case 3:return o=r.sent(),this.list=i.l.array([],{deep:!1}),void 0!==(s=o.$page)&&(s.length>this.pageSize?(this.more=!0,s.pop(),a=this.returns.find(function(t){return"$page"===t.name}),this.startField=a.fields[0],this.pageStart=s[s.length-1][this.startField.name]):this.more=!1,(t=this.list).push.apply(t,s)),[2]}})})},e.prototype.page=function(t,e,n){return r.b(this,void 0,Promise,function(){var i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.page(this.name,e,n+1,t)];case 2:return i=r.sent(),[4,this.unpackReturns(i)];case 3:return[2,r.sent().$page]}})})},e.prototype.query=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.query(this.name,t)];case 2:return e=n.sent(),[4,this.unpackReturns(e)];case 3:return[2,n.sent()]}})})},e.prototype.table=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e.prototype.obj=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(t)];case 1:return(e=n.sent()).length>0?[2,e[0]]:[2]}})})},e.prototype.scalar=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},r.c([i.l],e.prototype,"list",void 0),e}(a),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="book",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"book"},enumerable:!0,configurable:!0}),e}(v),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="history",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"history"},enumerable:!0,configurable:!0}),e}(v),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions={},e.queries={},e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"map"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e),this.schemaFrom=this.schema.from;var n=e.actions,r=e.queries,i=e.keys;for(var o in this.entities.buildFieldTuid(this.keys=i),n){var s=n[o],a=s.name,u=this.entities.newAction(a,void 0);u.setSchema(s),this.actions[o]=u}for(var o in r){var c=r[o],l=(a=c.name,this.entities.newQuery(a,void 0));l.setSchema(c),this.queries[o]=l}},e.prototype.add=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.actions.add.submit(t)];case 2:return[2,e.sent()]}})})},e.prototype.del=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.actions.del.submit(t)];case 2:return[2,e.sent()]}})})},e.prototype.all=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.queries.all.query({})];case 2:return[2,t.sent()]}})})},e.prototype.page=function(t,e,n){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.queries.page.page(t,e,n)];case 2:return[2,r.sent()]}})})},e.prototype.query=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.queries.query.query(t)];case 2:return[2,e.sent()]}})})},e.prototype.table=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e.prototype.obj=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(t)];case 1:return(e=n.sent()).length>0?[2,e[0]]:[2]}})})},e.prototype.scalar=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e}(a),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="pending",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"pending"},enumerable:!0,configurable:!0}),e}(v);function E(t){switch(t){case"tinyint":case"smallint":case"int":case"bigint":case"dec":return 0;case"char":case"text":return"";case"datetime":case"date":return"2000-1-1";case"time":return"0:00"}}var C=function(){function t(t,e,n){var r=this;this.tuids={},this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.loadIds=function(){for(var t in r.clearCacheTimer(),r.tuids){r.tuids[t].cacheIds()}},this.cUsq=t,this.usqApi=e,this.appId=n}return t.prototype.tuid=function(t){return this.tuids[t.toLowerCase()]},t.prototype.action=function(t){return this.actions[t.toLowerCase()]},t.prototype.sheet=function(t){return this.sheets[t.toLowerCase()]},t.prototype.query=function(t){return this.queries[t.toLowerCase()]},t.prototype.book=function(t){return this.books[t.toLowerCase()]},t.prototype.map=function(t){return this.maps[t.toLowerCase()]},t.prototype.history=function(t){return this.histories[t.toLowerCase()]},t.prototype.pending=function(t){return this.pendings[t.toLowerCase()]},t.prototype.sheetFromTypeId=function(t){for(var e in this.sheets){var n=this.sheets[e];if(n.typeId===t)return n}},t.prototype.loadAccess=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.usqApi.loadAccess()];case 1:return t=e.sent(),this.buildEntities(t),[2]}})})},t.prototype.loadEntities=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.usqApi.loadEntities()];case 1:return t=e.sent(),this.buildEntities(t),[2]}})})},t.prototype.buildEntities=function(t){var e=t.access,n=t.tuids;this.buildTuids(n),this.buildAccess(e)},t.prototype.getTuid=function(t,e,n){var r=this.tuids[t];if(void 0!==r)return void 0===e?r:r.divs[e]},t.prototype.cacheTuids=function(t){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,t)},t.prototype.clearCacheTimer=function(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)},t.prototype.buildTuids=function(t){var e={};for(var n in t){(o=t[n]).name;var r=o.typeId,i=o.proxies;(s=this.newTuid(n,r)).sys=!0,void 0!==i&&(e[n]=i)}for(var n in t){var o;(o=t[n]).name;(s=this.getTuid(n)).setSchema(o)}for(var n in e){var s;i=e[n];(s=this.tuids[n]).proxies={};for(var a=0,u=i;a<u.length;a++){var c=u[a];s.proxies[c]=this.tuids[c]}}},t.prototype.buildAccess=function(t){for(var e in t){var n=t[e];switch(typeof n){case"string":this.fromType(e,n);break;case"object":this.fromObj(e,n)}}},t.prototype.newAction=function(t,e){var n=this.actions[t];return void 0!==n?n:(n=this.actions[t]=new p(this,t,e),this.actionArr.push(n),n)},t.prototype.newTuid=function(t,e){var n=this.tuids[t];return void 0!==n?n:(n=this.tuids[t]=new l(this,t,e),this.tuidArr.push(n),n)},t.prototype.newQuery=function(t,e){var n=this.queries[t];return void 0!==n?n:(n=this.queries[t]=new v(this,t,e),this.queryArr.push(n),n)},t.prototype.newBook=function(t,e){var n=this.books[t];return void 0!==n?n:(n=this.books[t]=new b(this,t,e),this.bookArr.push(n),n)},t.prototype.newMap=function(t,e){var n=this.maps[t];return void 0!==n?n:(n=this.maps[t]=new g(this,t,e),this.mapArr.push(n),n)},t.prototype.newHistory=function(t,e){var n=this.histories[t];if(void 0===n)return n=this.histories[t]=new y(this,t,e),this.historyArr.push(n),n},t.prototype.newPending=function(t,e){var n=this.pendings[t];if(void 0===n)return n=this.pendings[t]=new w(this,t,e),this.pendingArr.push(n),n},t.prototype.newSheet=function(t,e){var n=this.sheets[t];return void 0!==n?n:(n=this.sheets[t]=new f(this,t,e),this.sheetArr.push(n),n)},t.prototype.fromType=function(t,e){var n=e.split("|");e=n[0];var r=Number(n[1]);switch(e){case"usq":this.usqId=r;break;case"tuid":this.newTuid(t,r).sys=!1;break;case"action":this.newAction(t,r);break;case"query":this.newQuery(t,r);break;case"book":this.newBook(t,r);break;case"map":this.newMap(t,r);break;case"history":this.newHistory(t,r);break;case"sheet":this.newSheet(t,r);break;case"pending":this.newPending(t,r)}},t.prototype.fromObj=function(t,e){switch(e.$){case"sheet":this.buildSheet(t,e)}},t.prototype.buildSheet=function(t,e){var n=this.sheets[t];void 0===n&&(n=this.newSheet(t,e.id)),n.build(e)},t.prototype.buildFieldTuid=function(t,e){if(void 0!==t){for(var n=0,r=t;n<r.length;n++){var i=(h=r[n]).tuid,o=h.arr,s=h.url;void 0!==i&&(h._tuid=this.getTuid(i,o,s))}for(var a=function(n){var r=n.owner;if(void 0===r)return"continue";var i=t.find(function(t){return t.name===r});if(void 0===i&&(void 0!==e&&(i=e.find(function(t){return t.name===r})),void 0===i))throw"owner field "+r+" is undefined";n._ownerField=i;var o=n.arr,s=n.url;if(n._tuid=u.getTuid(i._tuid.name,o,s),void 0===n._tuid)throw"owner field ${owner} is not tuid"},u=this,c=0,l=t;c<l.length;c++){var h;a(h=l[c])}}},t.prototype.buildArrFieldsTuid=function(t,e){if(void 0!==t)for(var n=0,r=t;n<r.length;n++){var i=r[n].fields;void 0!==i&&this.buildFieldTuid(i,e)}},t}();n.d(e,"b",function(){return E}),n.d(e,"a",function(){return C})},,,,,function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var r=n(0);function i(t,e,n,i,o){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,t.fetch(e,n,i,o)];case 1:return r.sent(),[2]}})})}var o=function(){function t(t,e){this.path=t||"",this.showWaiting=e}return t.prototype.call=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,r.sent().callFetch(t,e,n)];case 2:return[2,r.sent()]}})})},t.prototype.get=function(t,e){return void 0===e&&(e=void 0),r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().get(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.post=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().post(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.put=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().put(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.delete=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().delete(this.path+t,e)];case 2:return[2,n.sent()]}})})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(1),o=n(22),s=function(t){function e(e){var n=t.call(this,e)||this;return n.logoutClick=function(){if(!1!==confirm("Really want to logout?")){var t=n.props.logout;"function"===typeof t&&t(),o.c.logout()}},n.navChange=n.navChange.bind(n),n.state={hasBack:!1},n}return r.d(e,t),e.prototype.navChange=function(){this.setState({hasBack:o.c.level>1})},e.prototype.componentWillMount=function(){this.navChange()},e.prototype.componentWillUnmount=function(){},e.prototype.back=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,o.c.back()];case 1:return t.sent(),[2]}})})},e.prototype.openWindow=function(){window.open(document.location.href)},e.prototype.render=function(){var t,e,n,r,s=this.state.hasBack||self!=top,a=this.props,u=a.right,c=a.center,l=a.logout;if(void 0!==l&&self===top&&("boolean"===typeof l&&!0===l||"function"===typeof l)){var h=o.c.user,p=h.nick,d=h.name;n=i.createElement("div",{className:"d-flex align-items-center"},i.createElement("small",{className:"text-light"},p||d),i.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},i.createElement("i",{className:"fa fa-sign-out"})))}if(s)switch(this.props.back){case"none":t=void 0;break;default:case"back":t=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":t=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),e=i.createElement("header",{onClick:this.openWindow})),(u||n)&&(r=i.createElement("aside",null,u," ",n)),i.createElement("header",{style:o.b},e,t,i.createElement("div",null,c),r)},e}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(1),s=n.n(o),a=n(13),u=n(8),c=n(5),l=n(27),h=function(t){return s.a.createElement("div",{className:"px-3 py-2"},Object(l.a)(t))},p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),!0!==this.entity.isPaged?[3,3]:[4,this.entity.resetPage(30,t)];case 1:return n.sent(),[4,this.entity.loadPage()];case 2:return n.sent(),this.replacePage(this.pageResult),[3,5];case 3:return[4,this.entity.query(t)];case 4:e=n.sent(),this.replacePage(this.queryResult,e),n.label=5;case 5:return[2]}})})},e.again=function(){e.vForm.reset(),e.replacePage(e.view)},e.renderRow=function(t,n){return o.createElement(e.row,r.a({},t))},e.view=function(){return o.createElement(c.Page,{header:e.label},e.vForm.render("mx-3 my-2"),e.renderExtra())},e.pageResult=function(){var t=e.entity,n=(t.name,t.list),r=o.createElement("button",{className:"btn btn-outline-success",onClick:e.again},o.createElement(u.b,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:e.label,right:r},o.createElement(u.e,{items:n,item:{render:e.renderRow}}))},e.queryResult=Object(a.a)(function(t){var n=o.createElement("button",{className:"btn btn-outline-success",onClick:e.again},o.createElement(u.b,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:e.label,right:n},o.createElement("pre",null,JSON.stringify(t,void 0,"\t")))}),e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){var e,n,i;return r.e(this,function(r){return this.vForm=this.createForm(this.onSubmit,t),e=this.ui,n=e.row,i=e.queryRow,this.row=i||n||h,this.openPage(this.view),[2]})})},e.prototype.renderExtra=function(){},e}(i.b),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.PageItems.first(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,n){return o.createElement(e.row,r.a({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.view=function(){var t=o.createElement(u.i,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label});return o.createElement(c.Page,{header:t},o.createElement(u.e,{items:e.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){var e,n,i;return r.e(this,function(r){switch(r.label){case 0:return e=this.ui,n=e.row,i=e.selectRow,this.row=i||n||h,this.PageItems=new f(this.entity),[4,this.onSearch(t)];case 1:return r.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){this.closePage(),this.returnCall(t)},e}(i.b),f=function(t){function e(e){var n=t.call(this)||this;return n.query=e,n}return r.d(e,t),e.prototype.load=function(){return r.b(this,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.query.loadSchema()];case 1:return n.sent(),!0!==this.query.isPaged?[3,3]:[4,this.query.page(this.param,this.pageStart,this.pageSize)];case 2:return t=n.sent(),[3,5];case 3:return[4,this.query.query(this.param)];case 4:e=n.sent(),t=e[this.query.returns[0].name],n.label=5;case 5:return[2,t]}})})},e.prototype.setPageStart=function(t){void 0===t&&(this.pageStart=0)},e}(c.PageItems),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(i.a),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VQueryMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VQueryMain",{get:function(){return this.ui&&this.ui.main||p},enumerable:!0,configurable:!0}),e}(m),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.showVPage(this.VQuerySelect,t)];case 1:return e.sent(),[2]}})})},Object.defineProperty(e.prototype,"VQuerySelect",{get:function(){return d},enumerable:!0,configurable:!0}),e}(m);n.d(e,"a",function(){return v}),n.d(e,"b",function(){return b})},,,,function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(1);function i(){return r.createElement("div",{style:{height:"100%"},className:"d-flex flex-fill align-items-center justify-content-center"},r.createElement("div",{className:"d-flex align-items-center justify-content-center slide text-info",style:{width:"5em",height:"2em"}},"\u52a0\u8f7d\u4e2d..."))}},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(0),i=n(1),o=n(5),s=n(8),a=n(72),u=n(70),c=function(t){function e(e,n){var a=t.call(this,Object(o.resLang)(n&&n.res))||this;a.cImportUsqs={},a.cUsqCollection={},a.renderRow=function(t,e){var n=t.id,r=t.nick,o=t.name;return i.createElement(s.d,{className:"px-3 py-2",right:"id: "+n},i.createElement("div",null,r||o))},a.onRowClick=function(t){return r.b(a,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return o.meInFrame.unit=t.id,[4,this.start()];case 1:return e.sent(),[2]}})})},a.selectUnitPage=function(){return i.createElement(o.Page,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},i.createElement(s.e,{items:a.appUnits,item:{render:a.renderRow,onClick:a.onRowClick}}))};var u=e.split("/");if(2!==u.length)throw"tonvaApp name must be / separated, owner/app";return a.appOwner=u[0],a.appName=u[1],a.ui=n||{usqs:{}},a.caption=a.res.caption||"Tonva",a}return r.d(e,t),e.prototype.startDebug=function(){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return t=this.appOwner+"/"+this.appName,n=new e(t,{usqs:{}}),!0,[4,n.start(!0)];case 1:return r.sent(),[2]}})})},e.prototype.loadUsqs=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,s,a,u,c,l,h,p,d,f,m,v,b,y,g,w,E,C;return r.e(this,function(r){switch(r.label){case 0:return t=[],o.meInFrame.unit,[4,Object(o.loadAppUsqs)(this.appOwner,this.appName)];case 1:for(e=r.sent(),n=e.id,i=e.usqs,this.id=n,s=[],a=[],u=0,c=i;u<c.length;u++)l=c[u],h=l.id,p=l.usqOwner,d=l.usqName,l.url,l.urlDebug,l.ws,f=l.access,l.token,m=p+"/"+d,v=this.ui&&this.ui.usqs&&this.ui.usqs[m],b=this.newCUsq(m,h,f,v||{}),this.cUsqCollection[m]=b,s.push(b.loadSchema()),a.push(b.entities.usqApi.checkAccess());return[4,Promise.all(s)];case 2:for(y=r.sent(),Promise.all(a).then(function(t){for(var e=0,n=t;e<n.length;e++){if(!1===n[e])return void o.nav.start()}}),g=0,w=y;g<w.length;g++)E=w[g],void 0===(C=E)||t.push(C);return 0===t.length?[2]:[2,t]}})})},e.prototype.getImportUsq=function(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return n=t+"/"+e,void 0!==(i=this.cImportUsqs[n])?[2,i]:(o=this.ui&&this.ui.usqs&&this.ui.usqs[n],-1,this.cImportUsqs[n]=i=this.newCUsq(n,-1,void 0,o||{}),[4,i.loadSchema()]);case 1:return void 0!==(s=r.sent())?(console.error(s),[2]):[2,i]}})})},e.prototype.newCUsq=function(t,e,n,r){var i=new(this.ui.CUsq||a.a)(this,t,this.id,e,n,r);return Object.setPrototypeOf(i.x,this.x),i},Object.defineProperty(e.prototype,"cUsqArr",{get:function(){var t=[];for(var e in this.cUsqCollection)t.push(this.cUsqCollection[e]);return t},enumerable:!0,configurable:!0}),e.prototype.getCUsq=function(t){return this.cUsqCollection[t]},Object.defineProperty(e.prototype,"VAppMain",{get:function(){return this.ui&&this.ui.main||l},enumerable:!0,configurable:!0}),e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){var t,e,n,s,a,u;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),(t=document.location.hash).startsWith("#tvdebug")?this.isProduction=!1:this.isProduction=t.startsWith("#tv"),e=o.meInFrame.unit,!1===this.isProduction&&(void 0===e||e<=0)?[4,Object(o.loadAppUsqs)(this.appOwner,this.appName)]:[3,3];case 1:return n=r.sent(),s=n.id,this.id=s,[4,this.loadAppUnits()];case 2:switch(r.sent(),this.appUnits.length){case 0:return this.showUnsupport(),[2,!1];case 1:if(void 0===(e=this.appUnits[0].id)||e<0)return this.showUnsupport(),[2,!1];o.meInFrame.unit=e;break;default:return o.nav.push(i.createElement(this.selectUnitPage,null)),[2,!1]}r.label=3;case 3:return[4,this.loadUsqs()];case 4:return void 0!==(a=r.sent())?(this.openPage(i.createElement(o.Page,{header:"ERROR"},i.createElement("div",{className:"m-3"},i.createElement("div",null,"Load Usqs \u53d1\u751f\u9519\u8bef\uff1a"),a.map(function(t,e){return i.createElement("div",{key:e},t)})))),[2,!1]):[2,!0];case 5:return u=r.sent(),o.nav.push(i.createElement(o.Page,{header:"App start error!"},i.createElement("pre",null,"string"===typeof u?u:u.message))),[2,!1];case 6:return[2]}})})},e.prototype.internalStart=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return!0!==t&&this.clearPrevPages(),[4,this.showMainPage()];case 1:return e.sent(),[2]}})})},e.prototype.load=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.beforeStart()];case 1:return t.sent(),[2]}})})},e.prototype.render=function(){return this.renderView(this.VAppMain)},e.prototype.clearPrevPages=function(){o.nav.clear()},e.prototype.showUnsupport=function(){this.clearPrevPages(),this.openPage(i.createElement(o.Page,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},i.createElement("div",{className:"m-3 text-danger container"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},i.createElement(s.b,{name:"exclamation-triangle"})),i.createElement("div",{className:"col"},"\u7528\u6237\u4e0d\u652f\u6301APP")),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"\u7528\u6237: "),i.createElement("div",{className:"col"},""+o.nav.user.name)),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"App:"),i.createElement("div",{className:"col"},this.appOwner+"/"+this.appName)))))},e.prototype.showMainPage=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return(t=document.location.hash.split("-")).length>2?"sheet"!==(e=t[2])&&"sheet_debug"!==e?[3,2]:(n=Number(t[3]),i=Number(t[4]),o=Number(t[5]),void 0===(s=this.getCUsqFromId(n))?(alert("unknown usqId: "+n),[2]):(this.clearPrevPages(),[4,s.navSheet(i,o)])):[3,2];case 1:return r.sent(),[2];case 2:return this.showVPage(this.VAppMain),[2]}})})},e.prototype.getCUsqFromId=function(t){for(var e in this.cUsqCollection){var n=this.cUsqCollection[e];if(n.id===t)return n}},e.prototype.loadAppUnits=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,u.a.userAppUnits(this.id)];case 1:return t=e.sent(),this.appUnits=t,1===t.length&&(o.meInFrame.unit=t[0].id),[2]}})})},e}(o.Controller),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.appContent=function(){var t,n=e.controller.cUsqArr;return t=0===n.length?i.createElement("div",{className:"text-danger"},i.createElement(s.b,{name:""})," \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684USQ"):n.map(function(t,e){return i.createElement("div",{key:e},t.render())}),i.createElement(i.Fragment,null,t)},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.appPage),[2]})})},e.prototype.render=function(t){return this.appContent()},e.prototype.appPage=function(){var t=this.controller.caption;return i.createElement(o.Page,{header:t,logout:function(){o.meInFrame.unit=void 0}},this.appContent())},e}(o.VPage)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(1),i=n.n(r),o=n(8);function s(t,e){return i.a.createElement(o.b,{className:t,name:e,fixWidth:!0})}var a={tuid:s("text-info","list-alt"),action:s("text-info","hand-o-right"),map:s("text-muted","list-ul"),book:s("text-muted","book"),query:s("text-warning","search"),history:s("text-info","hand-o-right"),pending:s("text-info","forward"),sheet:s("text-primary","wpforms")}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),i=function(t){function e(e,n){var r=t.call(this,n)||this;return r.cUsq=e,r}return r.d(e,t),e}(n(5).Controller)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.userAppUnits=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tie/user-app-units",{app:t})];case 1:return[2,e.sent()]}})})},e}(n(5).CenterApi))("tv/",void 0)},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(5),s=n(12),a=n(1),u=n.n(a),c=n(13),l=n(32),h=n(8),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.newClick=function(){return e.event("new")},e.schemaClick=function(){return e.event("schema")},e.archivesClick=function(){return e.event("archives")},e.sheetStateClick=function(t){return e.event("state",t)},e.renderState=function(t,n){var r=t.state,i=t.count;if(0===i)return null;var o=a.createElement(l.a,{className:"ml-5 align-self-end",color:"success"},i);return a.createElement(h.d,{className:"px-3 py-2",left:e.controller.getStateLabel(r),right:o})},e.view=Object(c.a)(function(){var t,n=e.controller.statesCount.filter(function(t){return t.count}),r=a.createElement("button",{className:"btn btn-outline-primary",onClick:e.archivesClick},"\u5df2\u5f52\u6863");return!0===e.isDev&&(t=a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.schemaClick},"\u6a21\u677f")),a.createElement(o.Page,{header:e.label},a.createElement(h.d,{className:"mx-3 my-2",right:r},a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.newClick},"\u65b0\u5efa"),t),a.createElement(h.e,{className:"my-2",header:a.createElement(h.g,{className:"mx-3 my-1"},"\u5f85\u5904\u7406",e.label),none:"[ \u65e0 ]",items:n,item:{render:e.renderState,onClick:e.sheetStateClick}}))}),e}return r.d(e,t),e.prototype.showEntry=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(s.b),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),e=this.vForm.values,[4,this.controller.onSave(t,e)];case 1:return n.sent(),[2]}})})},e.view=function(){return a.createElement(o.Page,{header:e.label},e.vForm.render())},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),this.openPage(this.view),[2]})})},e}(s.b),f=n(50),m={width:"8rem"},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.flowRow=function(t,e){var n,r=t.date,i=(t.user,t.preState,t.state),o=t.action;switch(void 0===o&&(o=a.createElement(a.Fragment,null,a.createElement(h.b,{className:"text-primary",name:"pencil-square-o"})," \u5236\u5355")),i){case"$":break;case"#":n=a.createElement(a.Fragment,null,a.createElement(h.b,{className:"text-success",name:"file-archive-o"}));break;default:n=a.createElement(a.Fragment,null,a.createElement(h.b,{className:"text-muted",name:"arrow-right"})," \xa0 ",i)}return a.createElement(h.d,{left:a.createElement("div",{className:"pl-3 py-2",style:m},o),right:a.createElement("div",{className:"p-2"},a.createElement(h.g,null,a.createElement(h.a,{date:r})))},a.createElement("div",{className:"p-2"},n))},e.sheetView=function(){var t,n=e.sheetData,r=n.brief,i=n.flows;return"-"===r.state&&(t=a.createElement("div",{className:"mx-3 my-2",style:{color:"red"}},"\u672c\u5355\u636e\u4f5c\u5e9f")),a.createElement("div",null,t,e.vForm.render(),a.createElement(h.e,{header:a.createElement(h.g,{className:"mx-3 my-1"},"\u6d41\u7a0b"),items:i,item:{render:e.flowRow}}))},e}return r.d(e,t),e}(s.b),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this.vForm.getValues(),[4,this.controller.saveSheet(t,this.vForm.values)];case 1:return e.sent(),this.closePage(),this.returnCall(this.vForm.values),[2]}})})},e.view=function(){return a.createElement(o.Page,{header:e.label},e.vForm.render())},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(this.onSubmit,t.data,f.a.edit),this.openPage(this.view),[2]})})},e}(v),y=n(14),g=n.n(y),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actionClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return e=this.sheetData.brief,n=e.id,i=e.flow,o=e.state,[4,this.controller.action(n,i,o,t.name)];case 1:return r.sent(),this.ceasePage(),this.openPage(this.acted),[2]}})})},e.deleteClick=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return alert("\u5355\u636e\u4f5c\u5e9f\uff1a\u7a0b\u5e8f\u6b63\u5728\u8bbe\u8ba1\u4e2d"),[2]})})},e.editClick=function(){return r.b(e,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.editSheet(this.sheetData)];case 1:return t=e.sent(),this.vForm.setValues(t),[2]}})})},e.page=function(){var t,n,r=e.sheetData.brief,i=r.state,s=r.no,a=e.controller.getStateLabel(i),c=e.entity.states.find(function(t){return t.name===i});if(void 0===c){var h=void 0,p=void 0;switch(i){default:h="\u4e0d\u8ba4\u8bc6\u7684\u5355\u636e\u72b6\u6001'"+i+"'",p="text-info";break;case"-":h="\u5df2\u4f5c\u5e9f",p="text-danger";break;case"#":h="\u5df2\u5f52\u6863",p="text-success"}t=u.a.createElement("div",{className:g()(p)},"[",h,"]")}else t=u.a.createElement("div",{className:"flex-grow-1"},c.actions.map(function(t,n){return u.a.createElement(l.b,{key:n,className:"mr-2",color:"primary",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel(i,t.name))})),"$"===i&&(n=u.a.createElement("div",null,u.a.createElement(l.b,{outline:!0,className:"ml-2",color:"info",onClick:e.editClick},"\u4fee\u6539"),u.a.createElement(l.b,{outline:!0,className:"ml-2",color:"danger",onClick:e.deleteClick},"\u4f5c\u5e9f")));return u.a.createElement(o.Page,{header:e.label+":"+a+"-"+s},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},t,n),u.a.createElement(e.sheetView,null)))},e.acted=function(){var t=e.sheetData.brief.discription;return u.a.createElement(o.Page,{header:"\u5df2\u5904\u7406",back:"close"},u.a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},u.a.createElement("div",{className:"p-3"},t),u.a.createElement("div",{className:"text-success"},u.a.createElement(h.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),u.a.createElement("div",{className:"p-3"},u.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de"))))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,t.data),this.openPage(this.page),[2]})})},e}(v),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return a.createElement(o.Page,{header:e.label+"\u6a21\u677f"},a.createElement("pre",{className:"mx-3 my-2"},e.entity.schemaStringify()))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(s.b),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.archiveClick=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return 1===t.processing?[2]:(this.event("archived",t),[2])})})},e.archiveRow=function(t,e){t.id,t.no,t.discription;var n=t.date,r=a.createElement(a.Fragment,null,1===t.processing?"... ":"",t.no," \xa0 ",t.discription),i=a.createElement(h.g,null,a.createElement(h.a,{date:n}));return a.createElement(h.d,{className:"px-3 py-2",left:r,right:i})},e.view=function(){return a.createElement(o.Page,{header:"\u5df2\u5f52\u6863"+e.label},a.createElement(h.e,{items:e.list,item:{render:e.archiveRow,onClick:e.archiveClick}}))},e}return r.d(e,t),e.prototype.showEntry=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this,[4,this.entity.getArchives(void 0,10)];case 1:return t.list=e.sent(),this.openPage(this.view),[2]}})})},e}(s.b),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rowClick=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return 1===t.processing?(this.event("processing",t.id),[2]):(this.event("action",t.id),[2])})})},e.onScrollBottom=function(){console.log("onScrollBottom"),e.controller.pageStateItems.more()},e.rowContent=function(t){t.id;var e=t.no,n=t.discription,r=t.date,i=t.processing,o=a.createElement(a.Fragment,null,e," \xa0 ",a.createElement(h.g,null,n)," ",1===i?"...":""),s=a.createElement(h.g,null,a.createElement(h.a,{date:r}));return a.createElement(h.d,{className:"px-3 py-2",left:o,right:s})},e.renderRow=function(t,n){return a.createElement(e.row,r.a({},t))},e.view=function(){var t=e.controller.pageStateItems;return a.createElement(o.Page,{header:e.label+" - "+e.stateLabel,onScrollBottom:e.onScrollBottom},a.createElement(h.e,{items:t,item:{render:e.renderRow,onClick:e.rowClick}}))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.row=this.ui.listRow||this.rowContent,this.stateName=t.state,this.stateLabel=this.controller.getStateLabel(this.stateName),[4,this.controller.pageStateItems.first(this.stateName)];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e}(s.b),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){var t=e.sheetData.brief;return a.createElement(o.Page,{header:e.label+":-"+t.no},a.createElement(e.sheetView,null))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,this.sheetData.data),this.openPage(this.view),[2]})})},e}(v),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.restart=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.ceasePage(),[4,this.event("new")];case 1:return t.sent(),[2]}})})},e.actionClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return this.ceasePage(),e=this.brief,n=e.id,i=e.flow,o=e.state,[4,this.controller.action(n,i,o,t.name)];case 1:return r.sent(),this.openPage(this.acted),[2]}})})},e.buttons=a.createElement(a.Fragment,null,a.createElement("button",{className:"btn btn-outline-primary mr-3",onClick:e.restart},"\u7ee7\u7eed\u5f00\u5355"),a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de")),e.view=function(){var t=e.entity.states,n=t.find(function(t){return"$"===t.name}),r=a.createElement(a.Fragment,null,n.actions.map(function(t,n){return a.createElement("button",{key:n,className:"btn btn-primary mr-3",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel("$",t.name))}));return a.createElement(o.Page,{header:"\u5df2\u4fdd\u5b58",back:"close"},a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(h.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u4fdd\u5b58\uff01\u7cfb\u7edf\u5c1a\u672a\u5904\u7406"),a.createElement("div",{className:"p-3"},r,e.buttons)))},e.acted=function(){return a.createElement(o.Page,null,a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(h.b,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),a.createElement("div",{className:"p-3"},e.buttons)))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.brief=t,this.openPage(this.view),[2]})})},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(s.b)),N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=function(){var t=e.sheetData.brief,n=t.state,r=t.no,i=e.controller.getStateLabel(n);return u.a.createElement(o.Page,{header:e.label+":"+i+"-"+r},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},"\u6b63\u5728\u5904\u7406\u4e2d..."),u.a.createElement(e.sheetView,null)))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,t.data),this.openPage(this.page),[2]})})},e}(v),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statesCount=i.l.array([],{deep:!0}),e.onSave=function(t,n){return r.b(e,void 0,Promise,function(){var e;return r.e(this,function(r){switch(r.label){case 0:return[4,this.saveSheet(t,n)];case 1:return e=r.sent(),this.ceasePage(),[4,this.showSaved(e)];case 2:return r.sent(),[2]}})})},e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadStateSheetCount()];case 1:return t.sent(),this.pageStateItems=this.entity.createPageStateItems(),[4,this.showVPage(this.VSheetMain)];case 2:return t.sent(),[2]}})})},e.prototype.onMessage=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o;return r.e(this,function(r){return e=t.type,n=t.body,i=t.from,o=t.to,t.push,"sheet"===e&&this.onSheet(i,o,n),[2]})})},e.prototype.onSheet=function(t,e,n){var r=this.user.id,i=n.id,o=n.preState,s=n.state;console.log({$:"onMessage sheet",from:t,to:e.join(","),id:i,preState:o,state:s,me:r,sheetData:n}),t===r&&this.sheetActPreState(i,o),void 0!==e.find(function(t){return t===r})&&this.sheetActState(i,s,n)},e.prototype.sheetActPreState=function(t,e){if(this.changeStateCount(e,-1),void 0!==this.curState&&this.curState===e){var n=this.pageStateItems.items.findIndex(function(e){return e.id===t});n>=0&&this.pageStateItems.items.splice(n,1)}},e.prototype.sheetActState=function(t,e,n){this.changeStateCount(e,1),void 0!==this.curState&&this.curState===e&&this.pageStateItems.items.findIndex(function(e){return e.id===t})<0&&this.pageStateItems.items.push(n)},e.prototype.changeStateCount=function(t,e){if(void 0!==t){var n=this.statesCount.findIndex(function(e){return e.state===t});if(console.log({$:"changeState",state:t,delta:e,index:n}),!(n<0)){var r=this.statesCount[n];r.count+=e,r.count<0&&(r.count=0)}}},Object.defineProperty(e.prototype,"VSheetMain",{get:function(){return this.ui&&this.ui.main||p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetNew",{get:function(){return this.ui.sheetNew||d},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetSaved",{get:function(){return this.ui.sheetSaved||O},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetEdit",{get:function(){return this.ui.sheetEdit||b},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetSchema",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VArchives",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VArchived",{get:function(){return P},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetList",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetAction",{get:function(){return this.ui.sheetAction||w},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetProcessing",{get:function(){return N},enumerable:!0,configurable:!0}),e.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:switch(t){case"new":return[3,2];case"schema":return[3,3];case"archives":return[3,4];case"state":return[3,5];case"archived":return[3,6];case"action":return[3,8];case"processing":return[3,10]}return[3,1];case 1:return[2];case 2:return n=this.VSheetNew,[3,12];case 3:return n=this.VSheetSchema,[3,12];case 4:return n=this.VArchives,[3,12];case 5:return this.curState=e.state,n=this.VSheetList,[3,12];case 6:return[4,this.showArchived(e)];case 7:return r.sent(),[2];case 8:return[4,this.showAction(e)];case 9:return r.sent(),[2];case 10:return[4,this.showProcessing(e)];case 11:return r.sent(),[2];case 12:return[4,this.showVPage(n,e)];case 13:return r.sent(),[2]}})})},e.prototype.startSheet=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.beforeStart()];case 1:return!1===e.sent()?[2]:[4,this.onEvent("action",t)];case 2:return e.sent(),[2]}})})},e.prototype.showAction=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(t)];case 1:return e=n.sent(),Object(o.postWsToTop)({body:{$type:"msg",action:"$sheet",msg:{id:t,usq:this.cUsq.id,state:e.brief.state}}}),[4,this.showVPage(this.VSheetAction,e)];case 2:return n.sent(),[2]}})})},e.prototype.showProcessing=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(t)];case 1:return e=n.sent(),[4,this.showVPage(this.VSheetProcessing,e)];case 2:return n.sent(),[2]}})})},e.prototype.editSheet=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.vCall(this.VSheetEdit,t)];case 1:return[2,e.sent()]}})})},e.prototype.showArchived=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getArchived(t.id)];case 1:return e=n.sent(),[4,this.showVPage(this.VArchived,e)];case 2:return n.sent(),[2]}})})},e.prototype.showSaved=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.showVPage(this.VSheetSaved,t)];case 1:return e.sent(),[2]}})})},e.prototype.getStateUI=function(t){var e=this.res.states;if(void 0!==e)return e[t]},e.prototype.getStateLabel=function(t){var e=this.getStateUI(t),n=e&&e.label||t;switch(n){default:return n;case"$":return"\u65b0\u5355"}},e.prototype.getActionLabel=function(t,e){var n=this.getStateUI(t);if(void 0===n)return e;var r=n.actions;if(void 0===r)return e;var i=r[e];return i&&i.label||e},e.prototype.loadStateSheetCount=function(){return r.b(this,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return this.statesCount.clear(),[4,this.entity.stateSheetCount()];case 1:return e=n.sent(),(t=this.statesCount).splice.apply(t,[0,0].concat(e)),[2]}})})},e.prototype.getSheetData=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.getSheet(t)];case 1:return[2,e.sent()]}})})},e.prototype.getArchived=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.getArchive(t)];case 1:return[2,e.sent()]}})})},e.prototype.saveSheet=function(t,e){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return n=this.ui.sheetTitle,i=void 0===n?this.label:n(e,this.x),[4,this.entity.save(i,t)];case 1:return[2,r.sent()]}})})},e.prototype.action=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.entity.action(t,e,n,i)];case 1:return[2,r.sent()]}})})},e}(s.a);n.d(e,"a",function(){return S})},function(t,e,n){"use strict";var r=n(0),i=n(5),o=n(55),s=n(36),a=n(12),u=n(1),c=n.n(u),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return u.createElement(i.Page,{header:e.label},"Book")},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(a.b),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VBookMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VBookMain",{get:function(){return l},enumerable:!0,configurable:!0}),e}(a.a),p=n(71),d=n(76),f=n(62),m=n(47),v=n(73),b=n(26),y=n(8),g=function(t){function e(e){var n=t.call(this,e)||this;n.isSysVisible=!1,n.view=function(){var t,e=n.controller,r=e.res,i=e.usq,o=e.error,s={render:function(t,e){return t.render()},onClick:void 0},a=[{header:r.tuid||"TUID",items:n.tuidLinks},{cn:"my-2",header:r.map||"MAP",items:n.mapLinks},{cn:"my-2",header:r.sheet||"SHEET",items:n.sheetLinks},{cn:"my-2",header:r.action||"ACTION",items:n.actionLinks},{cn:"my-2",header:r.query||"QUERY",items:n.queryLinks},{cn:"mt-2 mb-4",header:r.book||"BOOK",items:n.bookLinks},{cn:"mt-2 mb-4",header:r.history||"HISTORY",items:n.historyLinks},{cn:"mt-2 mb-4",header:r.pending||"PENDING",items:n.pendingLinks}];return t=void 0!==o?c.a.createElement("div",{className:"p-3 text-danger"},"\u8fde\u63a5\u9519\u8bef: ",o):a.map(function(t,e){var n=t.cn,r=t.header,i=t.items;return i.length>0&&c.a.createElement(y.e,{key:e,className:n,header:c.a.createElement("div",{className:"px-3 py-1 bg-light"},c.a.createElement(y.g,null,r)),items:i,item:s})}),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"px-3 py-1 small"},r.usq||i),t)};var r=e.entities,i=r.tuidArr,o=r.mapArr,a=r.sheetArr,u=r.actionArr,l=r.queryArr,h=r.bookArr,p=r.historyArr,d=r.pendingArr;return n.tuidLinks=i.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cTuidMain(t))}),n.mapLinks=o.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cMap(t))}),n.sheetLinks=a.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cSheet(t))}),n.actionLinks=u.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cAction(t))}),n.queryLinks=l.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cQuery(t))}),n.bookLinks=h.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cBook(t))}),n.historyLinks=p.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cHistory(t))}),n.pendingLinks=d.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cPending(t))}),n}return r.d(e,t),e.prototype.isVisible=function(t){return!0!==t.sys||this.isSysVisible},e.prototype.render=function(t){return void 0===this.view?c.a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):c.a.createElement(this.view)},e}(i.View),w=n(74),E=n(75);function C(t){if(void 0!==t)for(var e in t)t[e.toLowerCase()]=t[e]}var k=function(t){function e(e,n,r,s,a,u){var c=t.call(this,Object(i.resLang)(u.res))||this;c.schemaLoaded=!1,c.isSysVisible=!1,c.cApp=e,c.usq=n,c.id=s,C(u.tuid),C(u.sheet),C(u.map),C(u.query),C(u.action),C(u.book),C(u.history),C(u.pending),c.ui=u,c.CTuidMain=u.CTuidMain||m.d,c.CTuidEdit=u.CTuidEdit||m.a,c.CTuidList=u.CTuidList||m.c,c.CTuidSelect=u.CTuidSelect||m.e,c.CTuidInfo=u.CTuidInfo||m.b,c.CQuery=u.CQuery||f.a,c.CQuerySelect=u.CQuerySelect||f.b,c.CMap=u.CMap||v.a,c.CAction=u.CAction||d.a,c.CSheet=u.CSheet||p.a,c.CBook=u.CBook||h,c.CHistory=u.CHistory||w.a,c.CPending=u.CPending||E.a;var l,b,y=n.split("/");switch(y.length){case 1:l="$$$",b=y[0];break;case 2:l=y[0],b=y[1];break;default:return void console.log("usq must be usqOwner/usqName format")}var g,k,P=document.location.hash,O=void 0===P||""===P?"debug/":"tv/";return g=null===a||void 0===a||"*"===a?[]:a.split(";").map(function(t){return t.trim()}).filter(function(t){return t.length>0}),k="$$$/$unitx"===n?new i.UnitxApi(i.meInFrame.unit):new i.UsqApi(O,l,b,g,!0),c.entities=new o.a(c,k,r),c}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2]})})},e.prototype.loadEntites=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entities.loadAccess()];case 1:return t.sent(),[2]}})})},e.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),!0===this.schemaLoaded?[2]:[4,this.loadEntites()];case 1:for(t in r.sent(),void 0===this.id&&(this.id=this.entities.usqId),this.ui)if(void 0!==(e=this.ui[t])&&(e.caption,void 0!==(n=e.collection)))for(i in n)void 0===this.entities[t](i)&&console.warn(t+":'"+i+"' is not usql entity");return this.schemaLoaded=!0,[2];case 2:return o=r.sent(),console.error(o),[2,this.error=o];case 3:return[2]}})})},e.prototype.getQuerySearch=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return void 0!==(e=this.entities.query(t))?[3,1]:(alert("QUERY "+t+" \u6ca1\u6709\u5b9a\u4e49!"),[3,3]);case 1:return[4,e.loadSchema()];case 2:n.sent(),e.returns.length>1&&alert("QUERY "+t+" \u8fd4\u56de\u591a\u5f20\u8868, \u65e0\u6cd5\u505aQuerySearch"),n.label=3;case 3:return[2,e]}})})},e.prototype.getTuidPlaceHolder=function(t){var e=this.res,n=e.tuidPlaceHolder,r=e.entity,i=t.name;if(void 0!==r){var o=r[i];void 0!==o&&o.label}return n||"Select"},e.prototype.getNone=function(){return this.res.none||"none"},e.prototype.isVisible=function(t){return!0!==t.sys||this.isSysVisible},e.prototype.navSheet=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return void 0===(n=this.entities.sheetFromTypeId(t))?(alert("sheetTypeId "+t+" is not exists!"),[2]):[4,this.cSheet(n).startSheet(e)];case 1:return r.sent(),[2]}})})},e.prototype.sheet=function(t){return this.entities.sheet(t)},e.prototype.action=function(t){return this.entities.action(t)},e.prototype.query=function(t){return this.entities.query(t)},e.prototype.book=function(t){return this.entities.book(t)},e.prototype.map=function(t){return this.entities.map(t)},e.prototype.history=function(t){return this.entities.history(t)},e.prototype.pending=function(t){return this.entities.pending(t)},e.prototype.tuid=function(t){return this.entities.tuid(t)},e.prototype.tuidDiv=function(t,e){var n=this.entities.tuid(t);if(void 0!==n){var r=n.divs;if(void 0!==r)return r[e]}},e.prototype.cSheetFromName=function(t){var e=this.entities.sheet(t);if(void 0!==e)return this.cSheet(e)},e.prototype.cActionFromName=function(t){var e=this.entities.action(t);if(void 0!==e)return this.cAction(e)},e.prototype.cQueryFromName=function(t){var e=this.entities.query(t);if(void 0!==e)return this.cQuery(e)},e.prototype.cBookFromName=function(t){var e=this.entities.book(t);if(void 0!==e)return this.cBook(e)},e.prototype.cMapFromName=function(t){var e=this.entities.map(t);if(void 0!==e)return this.cMap(e)},e.prototype.cHistoryFromName=function(t){var e=this.entities.history(t);if(void 0!==e)return this.cHistory(e)},e.prototype.cPendingFromName=function(t){var e=this.entities.pending(t);if(void 0!==e)return this.cPending(e)},e.prototype.cTuidMainFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidMain(e)},e.prototype.cTuidEditFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidEdit(e)},e.prototype.cTuidInfoFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidInfo(e)},e.prototype.cTuidSelectFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidSelect(e)},e.prototype.cFromName=function(t,e){switch(t){case"sheet":var n=this.entities.sheet(e);if(void 0===n)return;return this.cSheet(n);case"action":var r=this.entities.action(e);if(void 0===r)return;return this.cAction(r);case"tuid":var i=this.entities.tuid(e);if(void 0===i)return;return this.cTuidMain(i);case"query":var o=this.entities.query(e);if(void 0===o)return;return this.cQuery(o);case"book":var s=this.entities.book(e);if(void 0===s)return;return this.cBook(s);case"map":var a=this.entities.map(e);if(void 0===a)return;return this.cMap(a);case"history":var u=this.entities.history(e);if(void 0===u)return;return this.cHistory(u);case"pending":var c=this.entities.pending(e);if(void 0===c)return;return this.cPending(c)}},e.prototype.linkFromName=function(t,e){return this.link(this.cFromName(t,e))},e.prototype.getUI=function(t){var e,n,r=t.name,i=t.typeName;if(void 0!==this.ui){var o=this.ui[i];void 0!==o&&(e=o[r])}var s=this.res.entity;return void 0!==s&&(n=s[r]),{ui:e||{},res:n||{}}},e.prototype.link=function(t){return new s.a(t)},Object.defineProperty(e.prototype,"tuidLinks",{get:function(){var t=this;return this.entities.tuidArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cTuidMain(e))})},enumerable:!0,configurable:!0}),e.prototype.cTuidMain=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidMain||this.CTuidMain)(this,t,n,r)},e.prototype.cTuidEdit=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidEdit||this.CTuidEdit)(this,t,n,r)},e.prototype.cTuidList=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidList||this.CTuidList)(this,t,n,r)},e.prototype.cTuidSelect=function(t){var e=this.getUI(t.owner||t),n=e.ui,r=e.res;return new(n&&n.CTuidSelect||this.CTuidSelect)(this,t,n,r)},e.prototype.cTuidInfo=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidInfo||this.CTuidInfo)(this,t,n,r)},e.prototype.cSheet=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CSheet||this.CSheet)(this,t,n,r)},Object.defineProperty(e.prototype,"sheetLinks",{get:function(){var t=this;return this.entities.sheetArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cSheet(e))})},enumerable:!0,configurable:!0}),e.prototype.cAction=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CAction||this.CAction)(this,t,n,r)},Object.defineProperty(e.prototype,"actionLinks",{get:function(){var t=this;return this.entities.actionArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cAction(e))})},enumerable:!0,configurable:!0}),e.prototype.cQuery=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CQuery||this.CQuery)(this,t,n,r)},e.prototype.cQuerySelect=function(t){var e=this.entities.query(t);if(void 0!==e){var n=this.getUI(e),r=n.ui,i=n.res;return new(r&&r.CQuerySelect||this.CQuerySelect)(this,e,r,i)}},Object.defineProperty(e.prototype,"queryLinks",{get:function(){var t=this;return this.entities.queryArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cQuery(e))})},enumerable:!0,configurable:!0}),e.prototype.cBook=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CBook||this.CBook)(this,t,n,r)},Object.defineProperty(e.prototype,"bookLinks",{get:function(){var t=this;return this.entities.bookArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cBook(e))})},enumerable:!0,configurable:!0}),e.prototype.cHistory=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CHistory||this.CHistory)(this,t,n,r)},Object.defineProperty(e.prototype,"historyLinks",{get:function(){var t=this;return this.entities.historyArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cHistory(e))})},enumerable:!0,configurable:!0}),e.prototype.cPending=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CPending||this.CPending)(this,t,n,r)},Object.defineProperty(e.prototype,"pendingLinks",{get:function(){var t=this;return this.entities.pendingArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cPending(e))})},enumerable:!0,configurable:!0}),e.prototype.cMap=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CMap||this.CMap)(this,t,n,r)},Object.defineProperty(e.prototype,"mapLinks",{get:function(){var t=this;return this.entities.mapArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cMap(e))})},enumerable:!0,configurable:!0}),e.prototype.getTuidContent=function(t){var e,n=t.owner;return void 0===n?(e=this.getUI(t).ui)&&e.content||b.b:(e=this.getUI(n).ui)&&e.divs&&e.divs[t.name].content||b.b},e.prototype.showTuid=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return n=t.owner,[4,this.cTuidInfo(n||t).start(e)];case 1:return r.sent(),[2]}})})},Object.defineProperty(e.prototype,"VUsq",{get:function(){return g},enumerable:!0,configurable:!0}),e.prototype.render=function(){return new this.VUsq(this).render()},e}(i.Controller);n.d(e,"a",function(){return k})},function(t,e,n){"use strict";var r=n(0),i=n(21),o=n.n(i),s=n(12),a=n(55),u=n(1),c=n(13),l=n(14),h=n.n(l),p=n(8),d=n(5),f=n(27),m=n(26),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemRender=function(t,n){return u.createElement(e.ItemRow,{item:t})},e.ItemRow=Object(c.a)(function(t){var n,r,i,o,s,a,c=t.item,l=(c.tuid,c.box),d=c.children,v=c.isLeaf,b=c.keyIndex,y=c.values,g=e.controller.keyUIs[b],w=g.content,E=g.valuesContent,C=g.none;if(!1===e.isFrom&&(n=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.addClick(c)}},u.createElement(p.b,{name:"plus"})),r=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.removeClick(c)}},u.createElement(p.b,{className:"text-info",name:"trash"}))),!1===v?i=0===b?n:u.createElement(u.Fragment,null,r," \xa0 ",n):b>0&&(i=r),!0===v)o=void 0,y&&(a=(E||m.b)(y,e.x));else{s="border-bottom";var k=C&&C(e.x);o=u.createElement(p.e,{className:"ml-4",items:d,item:{onClick:void 0,render:e.itemRender},none:k})}return u.createElement("div",{className:"d-flex flex-column"},u.createElement(p.d,{className:h()("px-3","py-2",s),right:i},u.createElement("div",{className:"py-1"},Object(f.b)(l,w,e.x)),u.createElement("div",{className:"py-1 font-weight-bold"},a)),o)}),e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.isFrom=this.controller.isFrom,this.openPage(this.view),[2]})})},Object.defineProperty(e.prototype,"view",{get:function(){var t=this;return function(){return u.createElement(d.Page,{header:t.label},u.createElement(p.e,{items:t.controller.items,item:{className:"my-2",onClick:void 0,render:t.itemRender}}))}},enumerable:!0,configurable:!0}),e}(s.b),b=n(9),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onValuesSubmit=function(){return r.b(e,void 0,void 0,function(){var t;return r.e(this,function(e){return this.ceasePage(),t=this.vForm.getValues(),this.returnCall(t),[2]})})},e.view=function(){return u.createElement(d.Page,null,e.vForm.render())},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.vForm=this.createForm(this.onValuesSubmit),this.openPageElement(u.createElement(this.view,null)),[2]})})},e}(s.b),g=function(){return function(t,e,n,r){this.children=b.l.array([],{deep:!0}),this.parent=t,this.tuid=e,this.box=n,this.keyIndex=r,this.isLeaf=!1}}(),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.addClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o,s,u,c,l,h,p,d,f,m,v,b,g,w,E,C,k,P,O,N,S,x,j,V;return r.e(this,function(r){switch(r.label){case 0:if(e=t.keyIndex,n=t.children,i=this.keyFields.length,o=i-1,(s=e+1)>=i)return[2];for(u=this.keyFields[s],c=u.name,l=u._tuid,h={},p={},d=t;void 0!==d;d=d.parent)f=d.keyIndex,m=d.box,v=this.keyFields[f].name,h[v]=p[v]=m.id;return[4,this.searchOnKey(u,h)];case 1:return void 0===(b=r.sent())||b<=0?[2]:(l.useId(b),g=l.boxId(b),w={},E={},e+1!==o?[3,4]:(l.useId(b),E[c]=w[c]=g,this.entity.fields.length>0?[4,this.vCall(y,p)]:[3,3]));case 2:for(k in C=r.sent())E[k]=w[k]=C[k];r.label=3;case 3:return[3,5];case 4:for(E[c]=p[c]=g,k=s+1;k<o;k++)p[this.keyFields[k].name]=0;for(w[this.keyFields[o].name]=0,j=this.entity.fields,P=0,O=j;P<O.length;P++)N=O[P],N.name,S=N.type,!0!==N.null&&(w[N.name]=Object(a.b)(S));r.label=5;case 5:return p.arr1=[w],[4,this.entity.actions.add.submit(p)];case 6:return r.sent(),(x=n.findIndex(function(t){return t.box.id===b}))<0?n.push(this.createItem(t,l,g,s,E)):void 0!==(j=this.entity.fields)&&j.length>0&&(V=n[x],n.splice(x,1),V.values=E,n.splice(x,0,V)),this.removeCeased(),[2]}})})},e.removeClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,s,a,u,c,l,h,p,d,f,m,v,b,y;return r.e(this,function(r){switch(r.label){case 0:if(e=this.keyFields[t.keyIndex],n=e._tuid,i=this.cUsq.cTuidMain(n.Main),s=i.getLable(n),a=this.res.confirmDelete||o.a.template("do you really want to remove ${label}?"),!1===confirm(a({label:s})))return[2];for(u=this.entity,l=(c={}).arr1=[],h={},l.push(h),p=t;void 0!==p;p=p.parent)d=p.keyIndex,h[this.keyFields[d].name]=p.box.id;for(f=this.keyFields.length,m=t.keyIndex+1;m<f;m++)v=this.keyFields[m],h[v.name]=-1;return[4,u.actions.del.submit(c)];case 1:return r.sent(),b=t.parent.children,(y=b.findIndex(function(e){return e===t}))>=0&&b.splice(y,1),[2]}})})},e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,s,a,u,c,l,h,p,d,f,v;return r.e(this,function(r){switch(r.label){case 0:return t=this.entity,e=t.keys,n=t.schemaFrom,this.isFrom=void 0!==n,[4,(i=this.entity.queries.all).query({})];case 1:for(s=r.sent(),a=s.ret,u=e.length,this.keyUIs=o.a.clone(this.ui.keys||[]),this.keyFields=[],c=i.returns[0].fields,l=0;l<u;l++)this.keyFields.push(c[l]),l>=this.keyUIs.length&&this.keyUIs.push({content:m.b});for(this.items=Object(b.l)([]),h=void 0,p=0,d=a;p<d.length;p++)f=d[p],void 0!==(v=this.addItem(h,f))&&(this.items.push(v),h=v);return[4,this.showVPage(this.VMapMain)];case 2:return r.sent(),[2]}})})},e.prototype.createItem=function(t,e,n,r,i){var o=new g(t,e,n,r);return r===this.keyFields.length-1&&(o.isLeaf=!0,o.values=i),o},e.prototype.addItem=function(t,e){for(var n=void 0,r=this.keyFields.length,i=t,o=0;o<r;o++){var s=this.keyFields[o],a=s.name,u=s._tuid,c=e[a];if(void 0===c)break;var l=c.id;if(0!==o){var h=i.children,p=(i.box,h.length);if(p>0){var d=h[p-1];if(d.box.id===l){i=d;continue}}l>0&&h.push(i=this.createItem(i,u,c,o,e))}else{if(0===l)continue;void 0!==i&&i.box.id===l||(n=i=this.createItem(void 0,u,c,o,e))}}return n},e.prototype.searchOnKey=function(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=t._tuid,i=t._ownerField,o=this.cUsq.cTuidSelect(n),s=e,void 0!==i&&"object"===typeof(s=e[i.name])&&(s=s.id),[4,o.call(s)];case 1:return a=r.sent(),[2,n.getIdFromObj(a)]}})})},Object.defineProperty(e.prototype,"VMapMain",{get:function(){return v},enumerable:!0,configurable:!0}),e}(s.a);n.d(e,"a",function(){return w})},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(1),s=n(5),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return o.createElement(s.Page,{header:e.label},"History")},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(i.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VHistoryMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VHistoryMain",{get:function(){return a},enumerable:!0,configurable:!0}),e}(i.a);n.d(e,"a",function(){return u})},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(1),s=n(5),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return o.createElement(s.Page,{header:e.label},"pending")},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(i.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VPendingMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VPendingMain",{get:function(){return a},enumerable:!0,configurable:!0}),e}(i.a);n.d(e,"a",function(){return u})},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(1),s=n(5),a=n(27),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),e=this,[4,this.controller.submit(t)];case 1:return e.returns=n.sent(),this.closePage(),this.openPage(this.resultPage),[2]}})})},e.mainPage=function(){var t=e.controller.label;return o.createElement(s.Page,{header:t},e.vForm.render("mx-3 my-2"))},e.resultPage=function(){var t=e.controller.label;return o.createElement(s.Page,{header:t,back:"close"},"\u5b8c\u6210\uff01",o.createElement("pre",null,Object(a.a)(e.returns)))},e}return r.d(e,t),e.prototype.showEntry=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),this.openPage(this.mainPage),[2]})})},e}(i.b),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.showVPage(this.VActionMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VActionMain",{get:function(){return u},enumerable:!0,configurable:!0}),e.prototype.submit=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return[2,this.entity.submit(t)]})})},e}(i.a);n.d(e,"a",function(){return c})},function(t,e,n){"use strict";var r=n(1),i=n(13),o=n(0),s=n(14),a=n.n(s),u=n(21),c=n.n(u),l=function(){return function(){}}(),h=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return o.d(e,t),e.prototype.check=function(t,e){var n=this.func(e);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void t.push(n);default:return void t.push.apply(t,n)}},e}(l),p=function(t){function e(e){var n=t.call(this)||this;return n.res=e,n}return o.d(e,t),e}(l),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.check=function(t,e){switch(typeof e){default:case"boolean":return;case"object":if(null!==e)return;break;case"string":if(e.trim().length>0)return;break;case"number":if(NaN!==e)return;break;case"undefined":}t.push(this.res.required)},e}(p),f=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.minMsg=c.a.template(e.min),i.maxMsg=c.a.template(e.max),i.min=n,i.max=r,i}return o.d(e,t),e.prototype.check=function(t,e){if(void 0!==e&&null!==e){var n=Number(e);NaN===n?t.push(this.res.number):this.checkMore(t,n)}},e.prototype.checkMore=function(t,e){void 0!==this.min&&Number(e)<this.min&&t.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(e)>this.max&&t.push(this.maxMsg({max:this.max}))},e}(p),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.checkMore=function(e,n){t.prototype.checkMore.call(this,e,n),!1===Number.isInteger(n)&&e.push(this.res.integer)},e}(f),v=n(9),b=function(){function t(t,e,n,r){var i=this;this.errors=[],this.contextErrors=[],this.onInputChange=function(t){i.changeValue(t.target.value,!0)},this.context=t;var o=e.name;if(this.name=o,this.itemSchema=e,this.fieldProps=n,this.children=r,this.ui=t.getUiItem(o),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var s=this.ui,a=s.readOnly,u=s.disabled,c=s.visible;this.readOnly=!0===a,this.disabled=!0===u,this.visible=!(!1===c)}this.value=this.defaultValue=t.getValue(o),this.init()}return Object.defineProperty(t.prototype,"hasError",{get:function(){return this.errors.length+this.contextErrors.length>0},enumerable:!0,configurable:!0}),t.prototype.init=function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new d(this.context.form.res)),this.buildRules(),void 0!==this.ui){var t=this.ui.rules;if(void 0!==t)if(!1!==Array.isArray(t))for(var e=0,n=t;e<n.length;e++){var r=n[e];this.rules.push(new h(r))}else this.rules.push(new h(t))}},t.prototype.buildRules=function(){},t.prototype.checkRules=function(){for(var t,e=[],n=0,r=this.rules;n<r.length;n++){r[n].check(e,this.value)}0===e.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,e))},Object.defineProperty(t.prototype,"isOk",{get:function(){return 0===this.errors.length},enumerable:!0,configurable:!0}),t.prototype.setError=function(t){var e;void 0!==t&&("string"===typeof t?this.errors.push(t):(e=this.errors).push.apply(e,t))},t.prototype.setContextError=function(t){var e;void 0!==t&&("string"===typeof t?this.contextErrors.push(t):(e=this.contextErrors).push.apply(e,t))},t.prototype.clearError=function(){this.errors.splice(0)},t.prototype.clearContextError=function(){this.contextErrors.splice(0)},t.prototype.parse=function(t){return t},t.prototype.setElementValue=function(t){},t.prototype.setDataValue=function(t){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(t))},t.prototype.setValue=function(t){!0!==this.isChanging&&this.changeValue(t,!1)},t.prototype.getValue=function(){return this.context.getValue(this.name)},t.prototype.getReadOnly=function(){return this.readOnly},t.prototype.getDisabled=function(){return this.disabled},t.prototype.getVisible=function(){return this.visible},t.prototype.setReadOnly=function(t){this.readOnly=t},t.prototype.setDisabled=function(t){this.disabled=t},t.prototype.setVisible=function(t){this.visible=t},t.prototype.changeValue=function(t,e){var n,r,i=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var o=!0;void 0!==n&&(this.isChanging=!0,o=n(this.context,this.value,i),this.isChanging=!1),!0===o&&(this.setDataValue(t),!0!==e&&this.setElementValue(t),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,i),this.isChanging=!1))},Object.defineProperty(t.prototype,"className",{get:function(){var t;return!1===this.context.inNode&&(t="form-control"),a()(t,this.context.form.FieldClass,this.ui&&this.ui.className)},enumerable:!0,configurable:!0}),t.prototype.renderContainer=function(){if(!1===this.visible)return null;var t,e=this.context,n=e.form;if(!0===e.inNode)return this.render();if(void 0===this.ui)t=this.name;else{var i=this.ui.label;null===i&&(t=null),t=i||this.name}return!0===this.itemSchema.required&&!1!==n.props.requiredFlag&&null!==t&&(t=r.createElement(r.Fragment,null,t,"\xa0",r.createElement("span",{className:"text-danger"},"*"))),n.FieldContainer(t,this.render())},t.prototype.renderTemplet=function(){if(void 0!==this.children)return r.createElement(r.Fragment,null,this.children);if(void 0!==this.ui){var t=this.ui.Templet;return"function"===typeof t?t(this.value):t}},t.prototype.renderErrors=function(){var t=this.errors.concat(this.contextErrors);if(0===t.length)return null;var e=!0===this.context.inNode?"span":"div";return t.map(function(t){return r.createElement(e,{key:t,className:"text-danger d-inline-block my-2 ml-3"},r.createElement(r.Fragment,null,r.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t))})},o.c([v.l],t.prototype,"errors",void 0),o.c([v.l],t.prototype,"contextErrors",void 0),o.c([v.e],t.prototype,"hasError",null),o.c([v.l],t.prototype,"visible",void 0),o.c([v.e],t.prototype,"isOk",null),t}(),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="text",e}return o.d(e,t),e.prototype.setElementValue=function(t){null!==this.input&&(this.input.value=t)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this.ui&&this.ui.placeholder||this.name},enumerable:!0,configurable:!0}),e.prototype.onBlur=function(){this.checkRules(),this.context.checkContextRules()},e.prototype.onFocus=function(){this.clearError(),this.context.removeErrorWidget(this),this.context.removeErrors()},e.prototype.setReadOnly=function(t){null!==this.input&&(this.input.readOnly=this.readOnly=t)},e.prototype.setDisabled=function(t){null!==this.input&&(this.input.disabled=this.disabled=t)},e.prototype.render=function(){var t=this,e=this.renderTemplet();if(void 0!==e)return e;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,r.createElement(r.Fragment,null,r.createElement("input",{ref:function(e){return t.input=e},className:a()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:this.onInputChange,placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:function(){return t.onFocus()},onBlur:function(){return t.onBlur()},maxLength:this.itemSchema.maxLength}),this.renderErrors())},e}(b),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setValue(t.currentTarget.value)},e}return o.d(e,t),e.prototype.setElementValue=function(t){this.input.value=t},e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this;return r.createElement("textarea",{ref:function(e){return t.input=e},rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange})},e}(b),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="password",e}return o.d(e,t),e}(y),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="url",e}return o.d(e,t),e}(y),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="email",e}return o.d(e,t),e}(y),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e}return o.d(e,t),e.prototype.buildRules=function(){t.prototype.buildRules.call(this);var e=this.context.form.res,n=this.itemSchema,r=n.min,i=n.max;this.rules.push("integer"===this.itemSchema.type?new f(e,r,i):new m(e,r,i))},e.prototype.parse=function(t){if(void 0!==t&&null!==t)return Number(t)},e}(y),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e.onKeyDown=function(t){var n=t.keyCode;event.returnValue=e.isValidKey(n)},e}return o.d(e,t),e.prototype.isValidKey=function(t){return 46===t||8===t||37===t||39===t||t>=48&&t<=57||t>=96&&t<=105||109===t||189===t},e}(k),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="date",e}return o.d(e,t),e}(y),N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="datetime",e}return o.d(e,t),e}(y),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="time",e}return o.d(e,t),e}(y),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="month",e}return o.d(e,t),e}(y),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setDataValue(!0===t.target.checked?e.trueValue:e.falseValue)},e.onClick=function(){e.context.removeErrors()},e}return o.d(e,t),e.prototype.init=function(){if(t.prototype.init.call(this),void 0!==this.ui){var e=this.ui,n=e.trueValue,r=e.falseValue;this.trueValue=void 0===n||n,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1},e.prototype.setElementValue=function(t){this.input.checked=t===this.trueValue},e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this,e=a()(this.className,"form-check-inline"),n=r.createElement("input",{ref:function(e){return t.input=e},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return this.context.inNode?r.createElement("label",{className:e},n," ",this.ui&&this.ui.label||this.name):r.createElement("div",{className:e},n)},e}(b),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setDataValue(t.target.value)},e}return o.d(e,t),e.prototype.setElementValue=function(t){this.select.value=t},e.prototype.setReadOnly=function(t){this.select.disabled=this.readOnly=!t},e.prototype.setDisabled=function(t){this.select.disabled=this.disabled=t},e.prototype.render=function(){var t=this;if(!0===this.readOnly){var e=this.ui.list.find(function(e){return e.value===t.value}),n=void 0===e?"(???)":e.title;return r.createElement("span",{className:"form-control w-min-6c"},n)}return r.createElement("select",{ref:function(e){return t.select=e},className:a()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map(function(t,e){var n=t.title,i=t.value;return r.createElement("option",{className:void 0,key:e,value:i},n||i)}))},o.c([v.l],e.prototype,"readOnly",void 0),e}(b),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputs={},e}return o.d(e,t),e.prototype.setElementValue=function(t){for(var e in this.inputs){var n=this.inputs[e];n.checked=t===n.value}},e.prototype.setReadOnly=function(t){for(var e in this.readOnly=t,this.inputs)this.inputs[e].readOnly=t},e.prototype.setDisabled=function(t){for(var e in this.disabled=t,this.inputs)this.inputs[e].disabled=t},e.prototype.render=function(){var t,e=this,n=this.ui,i=n.defaultValue,o=n.list,s=this.context,u=s.isRow;s.inNode;!0===u&&(t=this.context.rowKey);var c=a()(this.className,"form-radio-inline");return r.createElement("span",{className:c},o.map(function(n,o){var s=n.value,a=n.title,u=e.name;return void 0!==t&&(u+="-"+t),r.createElement("label",{key:o,className:"form-radio-inline"},r.createElement("input",{ref:function(t){return e.inputs[o]=t},type:"radio",name:u,value:s,defaultChecked:(e.defaultValue||i)===s}),a||s)}))},e}(b),A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="range",e}return o.d(e,t),e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this,e=this.ui,n=e.min,i=e.max,o=e.step;return r.createElement(r.Fragment,null,r.createElement("input",{ref:function(e){return t.input=e},className:a()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:i,min:n,step:o}))},e}(b),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return o.b(e,void 0,void 0,function(){var t,e;return o.e(this,function(n){switch(n.label){case 0:return void 0===(t=this.ui&&this.ui.pickId)?(alert("no pickId defined!"),[2]):[4,t(this.context,this.name,this.value)];case 1:return e=n.sent(),this.setDataValue(e),this.clearError(),this.clearContextError(),this.checkRules(),[2]}})})},e}return o.d(e,t),e.prototype.setReadOnly=function(t){this.readOnly=t},e.prototype.setDisabled=function(t){this.disabled=t},e.prototype.render=function(){var t,e;void 0!==this.ui&&(t=this.ui.placeholder,e=this.ui.Templet);var n,i={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(n=t||"placeholder",i["text-muted"]=!0):n=void 0===e?r.createElement(r.Fragment,null,this.value):"function"===typeof e?e(this.value):e,r.createElement(r.Fragment,null,r.createElement("div",{className:a()(i),onClick:this.onClick},n),this.renderErrors())},o.c([v.l],e.prototype,"value",void 0),e}(b),I=function(t,e,n){return r.createElement("span",{className:"text-danger"},"!!data type ",t," only support ",(n||[]).join(", "),", can't use ui ",e,"!!")},q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return o.b(e,void 0,void 0,function(){var t,e,n,r;return o.e(this,function(i){switch(i.label){case 0:return this.clearError(),this.clearContextError(),t=this.itemSchema,e=t.name,"submit"===t.type&&(this.context.checkRules(),!0===this.context.hasError)?[2]:void 0===(n=this.context.form.props.onButtonClick)?(alert("button "+e+" clicked. you should define form onButtonClick"),[2]):[4,n(e,this.context)];case 1:return void 0===(r=i.sent())?[2]:(this.context.setError(e,r),[2])}})})},e.observerRender=Object(i.a)(function(){var t,n,i,o=e.itemSchema,s=o.name,a=o.type;if(void 0!==e.ui){var u=e.ui.widget;if("button"!==u)return I(a,u,["button"]);t=e.ui.Templet,n=e.ui.className,i=e.ui.label}var c,l=e.context,h=l.form,p=l.hasError,d=e.context,f="submit"===a&&p;c=void 0!==e.children?e.children:"function"===typeof t?t():void 0!==t?t:i;var m=r.createElement("button",{className:n,type:"button",disabled:f,onClick:e.onClick},c||s);return!0===d.inNode?r.createElement(r.Fragment,null,m,e.renderErrors()):r.createElement("div",{className:h.ButtonClass},r.createElement("div",null,e.renderErrors()),m)}),e}return o.d(e,t),e.prototype.render=function(){return r.createElement(this.observerRender,null)},e.prototype.renderContainer=function(){if(!1===this.visible)return null;var t=this.context,e=t.form;return!0===t.inNode?this.render():e.FieldContainer(null,this.render())},e}(b),R=n(25),D=Object(i.a)(function(t){var e,n,o,s,u=t.parentContext,c=t.arrSchema,l=t.children,h=c.name,p=c.arr,d=u.initData[h],f=u.form,m=u.getArrRowContexts(h),v=u.getUiItem(h),b=h,y=f.ArrContainer,g=f.RowContainer,w=f.RowSeperator,E=f.uiSchema;if(void 0!==E){var C=E.selectable,k=E.deletable,P=E.restorable;!0!==n&&(n=C),!0!==o&&(o=k),!0!==s&&(s=P)}if(void 0!==v){var O=v.widget,N=v.label,S=v.selectable,x=v.deletable,j=v.restorable,V=v.ArrContainer,F=v.RowContainer,A=v.RowSeperator;if(void 0!==S&&(n=S),void 0!==x&&(o=x),void 0!==j&&(s=j),void 0!==V&&(y=V),void 0!==F&&(g=F),void 0!==A&&(w=A),e=v.Templet,"arr"!==O)return I(c.type,O,["arr"]);b=N||b}var T=!0;return y(b,r.createElement(r.Fragment,null,d.map(function(t,h){var f,v,b=void 0;if(!1===T?b=w:T=!1,void 0!==l)f=new R.c(u,c,t,!0),v=r.createElement(r.Fragment,null,l);else{var y=typeof e;"function"===y?(f=new R.c(u,c,t,!0),v=r.createElement(Object(i.a)(e),t)):"object"===y?(f=new R.c(u,c,t,!0),v=e):(f=new R.c(u,c,t,!1),v=r.createElement(r.Fragment,null,p.map(function(t,e){return r.createElement(r.Fragment,{key:t.name},L(f,t,void 0))})))}var E,C,k=f.rowKey;if(m[k]=f,!0===n){E=r.createElement("div",{className:"form-row-checkbox"},r.createElement("input",{type:"checkbox",onClick:function(e){t.$isSelected=e.target.checked,f.removeErrors()}}))}var P=!(void 0===t.$isDeleted||!1===t.$isDeleted);if(!0===o){var O=P?"fa-undo":"fa-trash";C=r.createElement("div",{className:"form-row-edit align-self-start text-info cursor-pointer",onClick:function(){if(!0===s)t.$isDeleted=!P;else{var e=d.indexOf(t);e>=0&&d.splice(e,1)}f.removeErrors()}},r.createElement("i",{className:a()("fa",O,"fa-fw")}))}var N=!0===n||!0===o?function(e){return r.createElement("fieldset",{disabled:P},r.createElement("div",{className:a()("d-flex",{deleted:P,"row-selected":t.$isSelected})},E,r.createElement("div",{className:"flex-grow-1"},e),C))}:function(t){return t};return r.createElement(R.a.Provider,{key:k,value:f},b,g(N(r.createElement(r.Fragment,null,r.createElement(f.renderErrors,null),v))))})))}),U={id:{dataTypes:["id"],widget:T},text:{dataTypes:["integer","number","string"],widget:y},textarea:{dataTypes:["string"],widget:g},password:{dataTypes:["string"],widget:w},date:{dataTypes:["date"],widget:O},datetime:{dataTypes:["date"],widget:N},time:{dataTypes:["date"],widget:S},month:{dataTypes:["date"],widget:x},select:{dataTypes:["integer","number","string","date","boolean"],widget:V},url:{dataTypes:["string"],widget:E},email:{dataTypes:["string"],widget:C},number:{dataTypes:["integer","number"],widget:k},updown:{dataTypes:["integer","number"],widget:P},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:j},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:F},range:{dataTypes:["integer"],widget:A},button:{dataTypes:["button","submit"],widget:q}};function L(t,e,n,o){if(void 0===t)return null;if(void 0!==e){var s,a=e.name,u=e.type;switch(u){case"arr":var c=t.getItemSchema(a);return r.createElement(D,{parentContext:t,arrSchema:c,children:n})}var l=t.getUiItem(a);if(void 0===l)s=v(u);else{var h=l.widget;switch(h){default:if(void 0!==h)s=U[h].widget;void 0===s&&(s=v(u));break;case"custom":s=l.WidgetClass;break;case"group":return r.createElement("span",null,"impletment group")}}var p=t.isRow,d=t.widgets,f=new s(t,e,o,n);if(d[a]=f,!1===p){var m=Object(i.a)(function(){return f.renderContainer()});return r.createElement(m,null)}return f.renderContainer()}function v(t){switch(t){default:return y;case"id":return T;case"integer":return P;case"number":return k;case"string":return y;case"date":return O;case"boolean":return j;case"button":case"submit":return q}}}n.d(e,"a",function(){return L})},,,,,function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(35),i=n(37),o={set:function(t,e){Object(r.h)(t,e),i.a.setCenterToken(e)},clear:function(){Object(r.h)(0,void 0),i.a.setCenterToken(void 0)}}},,,,,,,function(t,e,n){"use strict"},,function(t,e,n){"use strict";n(1)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(14);(function(t){function e(e){var n=t.call(this,e)||this;return n.state={isPressed:!1},n}r.d(e,t),e.prototype.mouseDown=function(){this.setState({isPressed:!0})},e.prototype.mouseUp=function(){this.setState({isPressed:!1}),this.props.action&&this.props.action()},e.prototype.render=function(){var t=this,e=o("row","label-row",this.props.className,{pressed:this.state.isPressed});return i.createElement("div",{className:e,onMouseDown:function(){return t.mouseDown()},onMouseUp:function(){return t.mouseUp()}},i.createElement("div",{className:"col-xs-3"},this.props.label),i.createElement("div",{className:"col-xs-9"},this.props.children))}})(i.Component),function(t){function e(e){var n=t.call(this,e)||this;return n.state={isPressed:!1},n}r.d(e,t),e.prototype.mouseDown=function(){this.setState({isPressed:!0})},e.prototype.mouseUp=function(){this.setState({isPressed:!1}),this.props.action&&this.props.action()},e.prototype.render=function(){var t=this,e=o("action-row",this.props.className,{pressed:this.state.isPressed});return i.createElement("div",{className:e,onMouseDown:function(){return t.mouseDown()},onMouseUp:function(){return t.mouseUp()}},this.props.children)}}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return l});var r=n(0),i=n(1),o=n(22),s=n(53),a=n(28),u=function(){function t(t){var e=this;this.isDev=a.g,this.onMessageReceive=function(t){return r.b(e,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.onMessage(t)];case 1:return e.sent(),[2]}})})},this.res=t||{},this.x=this.res.x||{}}return Object.defineProperty(t.prototype,"user",{get:function(){return o.c.user},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLogined",{get:function(){var t=o.c.user;return void 0!==t&&t.id>0},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){o.c.unregisterReceiveHandler(this.receiveHandlerId),this.onDispose()},t.prototype.onDispose=function(){},t.prototype.showVPage=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new t(this).showEntry(e)];case 1:return n.sent(),[2]}})})},t.prototype.renderView=function(t,e){return new t(this).render(e)},t.prototype.event=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.onEvent(t,e)];case 1:return n.sent(),[2]}})})},t.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2]})})},t.prototype.msg=function(t){alert(t)},t.prototype.errorPage=function(t,e){this.openPage(i.createElement(s.a,{header:"App error!"},i.createElement("pre",null,"string"===typeof e?e:e.message)))},t.prototype.onMessage=function(t){},t.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2,!0]})})},t.prototype.registerReceiveHandler=function(){this.receiveHandlerId=o.c.registerReceiveHandler(this.onMessageReceive)},t.prototype.start=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.disposer=this.dispose.bind(this),this.registerReceiveHandler(),[4,this.beforeStart()];case 1:return!1===e.sent()?[2]:[4,this.internalStart(t)];case 2:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"isCalling",{get:function(){return void 0!==this._resolve_$},enumerable:!0,configurable:!0}),t.prototype.call=function(t){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(n){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(n,i){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this._resolve_$.push(n),[4,this.start(t)];case 1:return e.sent(),[2]}})})})]})})},t.prototype.vCall=function(t,e){return r.b(this,void 0,Promise,function(){var n=this;return r.e(this,function(i){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(i,o){return r.b(n,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return this._resolve_$.push(i),[4,new t(this).showEntry(e)];case 1:return n.sent(),[2]}})})})]})})},t.prototype.returnCall=function(t){if(void 0!==this._resolve_$){var e=this._resolve_$.pop();void 0!==e?e(t):alert("the Coordinator call already returned, or not called")}},t.prototype.openPage=function(t){o.c.push(t,this.disposer),this.disposer=void 0},t.prototype.replacePage=function(t){o.c.replace(t,this.disposer),this.disposer=void 0},t.prototype.backPage=function(){o.c.back()},t.prototype.closePage=function(t){o.c.pop(t)},t.prototype.ceasePage=function(t){o.c.ceaseTop(t)},t.prototype.removeCeased=function(){o.c.removeCeased()},t.prototype.regConfirmClose=function(t){o.c.regConfirmClose(t)},t}(),c=function(){function t(t){this.controller=t,this.res=t.res,this.x=t.x}return Object.defineProperty(t.prototype,"isDev",{get:function(){return a.g},enumerable:!0,configurable:!0}),t.prototype.renderVm=function(t,e){return new t(this.controller).render(e)},t.prototype.showVPage=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new t(this.controller).showEntry(e)];case 1:return n.sent(),[2]}})})},t.prototype.event=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.controller.event(t,e)];case 1:return n.sent(),[2]}})})},t.prototype.returnCall=function(t){this.controller.returnCall(t)},t.prototype.openPage=function(t,e){this.controller.openPage(i.createElement(t,e))},t.prototype.replacePage=function(t,e){this.controller.replacePage(i.createElement(t,e))},t.prototype.openPageElement=function(t){this.controller.openPage(t)},t.prototype.replacePageElement=function(t){this.controller.replacePage(t)},t.prototype.backPage=function(){this.controller.backPage()},t.prototype.closePage=function(t){this.controller.closePage(t)},t.prototype.ceasePage=function(t){this.controller.ceasePage(t)},t.prototype.removeCeased=function(){this.controller.removeCeased()},t.prototype.regConfirmClose=function(t){this.controller.regConfirmClose(t)},t}(),l=function(t){function e(e){return t.call(this,e)||this}return r.d(e,t),e.prototype.render=function(t){return null},e}(c)},function(t,e,n){"use strict";var r=n(107);n.d(e,"Form",function(){return r.a});var i=n(95);n.d(e,"Field",function(){return i.a});var o=n(96);n.o(o,"Loading")&&n.d(e,"Loading",function(){return o.Loading}),n.o(o,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return o.TabCaptionComponent}),n.o(o,"Tabs")&&n.d(e,"Tabs",function(){return o.Tabs}),n.o(o,"resLang")&&n.d(e,"resLang",function(){return o.resLang});var s=n(97);n.o(s,"Loading")&&n.d(e,"Loading",function(){return s.Loading}),n.o(s,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return s.TabCaptionComponent}),n.o(s,"Tabs")&&n.d(e,"Tabs",function(){return s.Tabs}),n.o(s,"resLang")&&n.d(e,"resLang",function(){return s.resLang});n(25)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(1),o=n(77),s=n(25),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.name,n=t.children,r=this.context;if(void 0===r)return i.createElement("span",{className:"text-danger"},"!only in Form!");var s=r.getItemSchema(e),a=Object(o.a)(r,s,n,this.props);return void 0===a?i.createElement("span",{className:"text-danger"},"!!",e," is not defined!!"):a},e.contextType=s.a,e}(i.Component)},function(t,e){},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(9),o=n(44),s=function(){function t(t){void 0===t&&(t=!1),this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=i.l.array([],{deep:t})}return Object.defineProperty(t.prototype,"items",{get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0},enumerable:!0,configurable:!0}),t.prototype.scrollToTop=function(){this.topDiv="$$"+Object(o.a)()},t.prototype.scrollToBottom=function(){this.bottomDiv="$$"+Object(o.a)()},t.prototype.reset=function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)},t.prototype.append=function(t){"tail"===this.appendPosition?this._items.unshift(t):this._items.push(t)},t.prototype.first=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.reset(),this.beforeLoad=!1,this.param=t,[4,this.more()];case 1:return e.sent(),[2]}})})},t.prototype.more=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return!0===this.allLoaded?[2]:!0===this.loading?[2]:(this.loading=!0,n=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(n=this.firstSize+1),[4,this.load(this.param,this.pageStart,n)]);case 1:return i=r.sent(),this.loading=!1,this.loaded=!0,o=i.length,!0===this.isFirst&&o>this.firstSize||!1===this.isFirst&&o>this.pageSize?(this.allLoaded=!1,--o,i.splice(o,1)):this.allLoaded=!0,0===o?(this._items.clear(),[2]):(this.setPageStart(i[o-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,i):(e=this._items).unshift.apply(e,i.reverse()),this.isFirst=!1,[2])}})})},r.c([i.l],t.prototype,"loading",void 0),r.c([i.l],t.prototype,"beforeLoad",void 0),r.c([i.l],t.prototype,"loaded",void 0),r.c([i.l],t.prototype,"allLoaded",void 0),r.c([i.e],t.prototype,"items",null),r.c([i.l],t.prototype,"topDiv",void 0),r.c([i.l],t.prototype,"bottomDiv",void 0),t}()},function(t,e,n){"use strict";var r=n(0),i=n(9);!function(){function t(t){void 0===t&&(t=100),this.arr=[],this.dict=new Map,this.maxCount=t}t.prototype.loadIds=function(t){for(var e=[],n=0,r=t;n<r.length;n++){var i=r[n];if(null!==i){var o=this.dict.get(i);void 0===o&&(e.push(i),o={id:i},this.dict.set(i,o))}}this.loadId(e)},t.prototype.get=function(t){if(void 0===t||null===t)return null;var e=this.dict.get(t);return void 0===e&&(this.dict.set(t,{id:t}),this.loadId([t]),e=this.dict.get(t)),e},t.prototype.setItem=function(t,e){void 0===e?(this.dict.set(t,null),this.arr.push({id:t})):(this.dict.set(t,e),this.arr.push(e)),this.arr.length>this.maxCount&&(e=this.arr.shift(),this.dict.delete(e.id))},t.prototype.loadId=function(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:return[4,this._loadIds(t)];case 1:if(void 0!==(e=r.sent()))return[3,6];n=0,i=t,r.label=2;case 2:return n<i.length?null===(l=i[n])?[3,4]:[4,this._loadId(l)]:[3,5];case 3:o=r.sent(),this.setItem(l,o),r.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:for(s=function(t){var n=e.find(function(e){return e.id===t});a.setItem(t,n)},a=this,u=0,c=t;u<c.length;u++)l=c[u],s(l);r.label=7;case 7:return[2]}})})},r.c([i.l],t.prototype,"dict",void 0)}()},,,,function(t,e,n){"use strict";n(0),n(1),n(67)},function(t,e){},,function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(9),s=n(13),a=n(14),u=n.n(a),c=function(){function t(){}return Object.defineProperty(t.prototype,"content",{get:function(){return!0!==this.selected?this._content:void 0!==this._content?this._content:this._content=this.contentBuilder()},enumerable:!0,configurable:!0}),r.c([o.l],t.prototype,"selected",void 0),t}(),l=function(t,e,n){return i.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},i.createElement("div",null,i.createElement("i",{className:"fa fa-lg fa-"+e})),i.createElement("small",null,t))},h=function(t){function e(e){var n,r=t.call(this,e)||this;r.tabs=[],r.tabClick=function(t){r.selectedTab.selected=!1,t.selected=!0,r.selectedTab=t};var i=r.props,o=i.size,s=i.tabs,a=i.tabBack,u=i.contentBack,l=i.sep,h=i.selected;switch(o){default:case"md":r.size="3.2rem";break;case"sm":r.size="4rem";break;case"lg":r.size="2.5rem"}return(n=r.tabs).push.apply(n,s.map(function(t){var e=new c;return e.name=t.name,e.selected=!1,e.caption=t.caption,e.contentBuilder=t.content,e.notify=t.notify,e})),r.tabBack=a||"bg-light",r.contentBack=u,r.sep=l||"border-top border-gray",void 0!==h&&(r.selectedTab=r.tabs.find(function(t){return t.name===h})),void 0===r.selectedTab&&(r.selectedTab=r.tabs[0]),r.selectedTab.selected=!0,r}return r.d(e,t),e.prototype.render=function(){var t=this;return i.createElement("div",{className:"tab"},i.createElement("div",{className:this.contentBack,style:{height:"calc(100% - "+this.size+")"}},this.tabs.map(function(t,e){var n={display:!0===t.selected?void 0:"none"};return i.createElement("div",{key:e,style:n},t.content)})),i.createElement("div",{className:u()(this.tabBack,this.sep),style:{height:this.size}},this.tabs.map(function(e,n){var r,o=e.selected,s=e.caption,a=e.notify;if(void 0!==a){var u=a.get();void 0!==u&&(u>0?r=i.createElement("u",null,u>99?"99+":u):u<0&&(r=i.createElement("u",{className:"dot"})))}return i.createElement("div",{key:n,className:"",onClick:function(){return t.tabClick(e)}},i.createElement("div",{className:"align-self-center"},r,s(o)))})))},r.c([o.l],e.prototype,"selectedTab",void 0),r.c([o.l],e.prototype,"tabs",void 0),e=r.c([s.a],e)}(i.Component);n.d(e,"a",function(){return l}),n.d(e,"b",function(){return h})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(9),s=n(14),a=n.n(s),u=n(77),c=(n(90),n(25)),l={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},h=n(49);n.d(e,"a",function(){return p});var p=function(t){function e(e){var n=t.call(this,e)||this;n.DefaultContainer=function(t){return i.createElement("form",{className:a()(n.props.className)},t)},n.DefaultFieldContainer=function(t,e){var r=n.props.fieldLabelSize;if(r>0){var o=void 0;null===t?r=0:o=i.createElement("label",{className:a()("col-sm-"+r,"col-form-label")},t);var s="col-sm-"+(12-r);return i.createElement("div",{className:"form-group row"},o,i.createElement("div",{className:s},e))}return i.createElement("div",{className:"form-group"},null===t?null:i.createElement("label",{className:"col-form-label"},t),e)},n.DefaultFieldClass=void 0,n.DefaultButtonClass="text-center py-2",n.DefaultRes=Object(h.a)(l),n.ArrContainer=function(t,e){return i.createElement("div",null,i.createElement("div",{className:a()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},t),e)},n.RowContainer=function(t){var e=a()({"py-3":!0});return i.createElement("div",{className:e},t)},n.RowSeperator=i.createElement("div",{className:"border border-gray border-top"});var r=e.schema,o=e.uiSchema,s=e.formData,p=e.Container,d=e.FieldContainer,f=e.FieldClass,m=e.ButtonClass,v=e.res;n.Container=p||n.DefaultContainer,n.FieldContainer=d||n.DefaultFieldContainer,n.FieldClass=void 0!==f&&""!==f&&null!==f?f:n.DefaultFieldClass,n.res=v||n.DefaultRes,n.ButtonClass=m||n.DefaultButtonClass,n.schema=r,n.itemSchemas={};for(var b=0,y=n.schema;b<y.length;b++){var g=y[b];n.itemSchemas[g.name]=g}n.uiSchema=o,n.data={},n.initData(s);void 0!==n.props.children||n.uiSchema&&n.uiSchema.Templet;var w=n.props.children;if(void 0!==w)n.content=i.createElement(i.Fragment,null,w),n.formContext=new c.b(n,!0);else{var E=void 0;void 0!==n.uiSchema&&(E=n.uiSchema.Templet),void 0!==E?(n.content="function"===typeof E?E(n.data):E,n.formContext=new c.b(n,!0)):(n.formContext=new c.b(n,!1),n.content=i.createElement(i.Fragment,null,n.schema.map(function(t,e){return i.createElement(i.Fragment,{key:e},Object(u.a)(n.formContext,t,w))})))}return n}return r.d(e,t),e.prototype.initData=function(t){void 0===t&&(t={});for(var e=0,n=this.schema;e<n.length;e++){var r=n[e];this.initDataItem(r,this.data,t)}},e.prototype.initDataItem=function(t,e,n){var r=t.name,i=t.type;if("button"!==i)if("arr"!==i)e[r]=n[r];else{var s=t,a=s.arr;if(void 0===a)return;for(var u=s.itemSchemas={},c=0,l=a;c<l.length;c++){u[(g=l[c]).name]=g}var h=n[r];void 0===h?h=[]:!1===Array.isArray(h)&&(h=[h]);for(var p=[],d=0,f=h;d<f.length;d++){for(var m=f[d],v={},b=0,y=a;b<y.length;b++){var g=y[b];this.initDataItem(g,v,m)}p.push(v)}e[r]=Object(o.l)(p)}},e.prototype.componentDidMount=function(){var t=this.props.beforeShow;void 0!==t&&t(this.formContext)},e.prototype.render=function(){return i.createElement(c.a.Provider,{value:this.formContext},i.createElement(this.formContext.renderErrors,null),this.Container(this.content))},r.c([o.l],e.prototype,"data",void 0),e}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(28),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reApi=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,s,a;return r.e(this,function(r){switch(r.label){case 0:return this.props.clearError(),t=this.props,e=t.channel,n=t.url,i=t.options,s=t.resolve,a=t.reject,[4,Object(o.l)(e,n,i,s,a)];case 1:return r.sent(),[2]}})})},e.close=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.props.clearError(),[2]})})},e}return r.d(e,t),e.prototype.render=function(){var t,e=this.props,n=e.error,r=e.url;if("object"===typeof n){var o=[];for(var s in n)o.push(i.createElement("li",{key:s},i.createElement("label",null,s),i.createElement("div",null,n[s])));t=i.createElement("ul",null,o)}else t=i.createElement("div",null,n);return i.createElement("li",null,i.createElement("article",{className:"page-container"},i.createElement("section",null,i.createElement("div",{className:"va-error"},i.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),i.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),i.createElement("div",null,"url: ",r),t,i.createElement("div",{className:"p-3"},i.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),i.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))},e}(i.Component);e.a=s},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(){function t(t){this.name=t}return t.prototype.get=function(){if(void 0!==this.value)return this.value;var t=localStorage.getItem(this.name);return this.value=null===t?void 0:JSON.parse(t)},t.prototype.set=function(t){t?(this.value=t,localStorage.setItem(this.name,JSON.stringify(t))):this.clear()},t.prototype.clear=function(){this.value=void 0,localStorage.removeItem(this.name)},t}(),i=function(){function t(){this.user=new r("user"),this.guest=new r("guest"),this.unit=new r("unit"),this.homeTabCur=new r("homeTabCur")}return t.prototype.logoutClear=function(){[this.user,this.homeTabCur].map(function(t){return t.clear()})},t}()},,,,,function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAABz1SURBVHja1Ht5eBzVle+5tXb1JnWrtcuSbNmSjY2RWcxmiIGEDIEJMEmALB8fecMkhJdMlknCy3skE4YhkH0jTDIZAsO8gQyEhLwQJiFgMEsMBizvkixrX1otqffu6q6qW/e+c6sleZNsky//pP2VW6rl1j3b7/zOuVeEcw47128B3zndAIzB4ocA0LEpUDtWAcfzUsAPUlUYiCJD4Ze/AZbJgtLSAtwqg7Z2DZCaGsCh8DmC5yywX3sDuOMASybBTaVAX9cFbjaH1yXgpgmsWARjy0Xg33opgE8DbtvgJmZg2Y8Yt2wBy+UBJAlO64MTIqoKPJf7YOnNXV8/f7SnVYG/lA8KyUslcEdHPSFO9xmQlag7l/x4OZdfIU795QgsrGUYINfVAqeuZ/FT3S+8hqWz77EHhy5Jq1LxL0tgDCsSMEBqqAeeyZ2WWzuzs808lf4KI0Sa0aT4X5bAntAIEsK6rgsVwICTx3wqfRufTa4pIEZkm2NDpyuwUKUsnAQPesoXLULe4jMM+DEPkfkxRSAG8Mh548474indWsPHqsPLuDRZ/EIAfAedit8u4+tTuhovVocfO1bgEwYgAp2vc4aGbkKtBtWu1dvkjrbvmS/+kQmE9lyK4EOEcHEvQZdjmQwiMxWxcy0CzAc5pTJQ+v+Iz/cIyLKY8GX43//AwYPgMsrL9nbURZBI0ll4fS+O+T28VjqZ1bz3Vt59oj7Q8t5ZSa6iI2N3SaVSlOF7Mwp5yyHkmSMCs0qASz4fAgKtqIgQPzdLH3X6Dr0XdI3JK5pfZvkiE0iJL2zBmNqC6WUN3t+P9/4RNHUSheaEOuBMTl2GqegGFATkttYDxrouwiYnrqej418DRekiqgJSKPhjIpPtck30QRyzGzSN4/tDpxJYpEiR9o6JYQ/By+CMjgsEl8C2vkDHJy+RMQVmZXCnNfIq3jWzKLCwijMwjHm1CaTq6oV8vJoVCp1cyK7pE1K46hnn0CC4E5NXcc7uwTfXsHyuzMxypzMy+qRslj4mogaNbrj5wpmACpRbmvKha646ZI+O3mYPj30DJxuUNC2jdnY8TCcm70RlWSyZ6ncz2QOsVHwSBTJPGcMuXR6whBc59HI6NHordylqW4EZXUrkA8arflqJGk9gIkvA8gUov/EWaKs7PA0Sv389KxQbOQ4ihwIjbnz6MOEsjNb4Ki+a3UpT4yVqe1un1bPnZzQx24iTkLmLSEqkNaxorhSTkiIRlc4l7yi98PJKls0GcczDJBT8RzkafZROTnnehMr6KnqQD8MmiYounDKvLiesiC7OY2x45EvpXLbej8Ji+ELcJ+9QDKOHmkU4JoaJonjoh25XcRlVbcL4q0IXoeiGL7izcyU5HGzAeIySfMECx7nCGR59N1ptVNa0e/E7KUKa5bKbkGHVEU0DdCsfutmZgGFAdB2kcOgFbV3no55rIgvzAFCSBr14XDiWFXbp69680Sg4Z12amftcNp28LCMTqMZ7kwq3Erry32CVC4xxOAGlOXNBaW4CuTYWLu/bfw4UCgKXTElVd+I58b46KRBQEAF9bjJ9l9zSPKKsaPkoJvYXZNsCFakmWuo8jGVjgRl5VtdVzm0HpeRbpGBgE/7co52xDuNN86zsIe/JPkhnl1QGKsw60CuIiCwr6u1sNvnpMaCkWtJBQQHHwlqf0dD4NHrmIv4v+IcAi050iprKFd4mSdK53mQVZVquqtotydJ7rYO9j9L4dJVkGHnOERFVZRKBKYJT+RzG5nl4r4bx3YWuSTwcUJW0HI38GM/vJmgF5MFr7AN9Zwjr43nk58Z8PiVLI7K4JksntbwIRZaY2SL1HfrspJn1F3QV6ogKyOD5uCH/X0VREqgNDGfliMC8XP4OL5nPIHX7FE3MyOWdb651c/l6MQ+5oX4nc90Wa9+B+91kqg7d55MkGv0UWmecDg1f6AwcflwKh7+MYNdEZ2dX4QRavXjSdQuF+pYcqb6dBIMD81RPwXR0Jf7sBwEiboVEiAxxjFuLOMX7nYFBvOYIxVYEl44cooiZd/MWJV+4J1vIrxivq4a22noIOAyGg3oKve8ZfCtwvE8cR1A6X7jVC6dYzUfQEjKz6TsxRsNSdbgkRaMPOYcPb2KZ3ArJb7yCk9uJSpmSDeOvmeO8T0wWh0qCrh4mtnIBuvMqhtZVamufxee/gQKKd824cykQaQoR/CqWTJ+Fb91RsW7WEw4V61VSnnHRxe3+Q+CmMyA11gHD6krE6mLRgEpyEWcQE2qgULwXXfnioaYohDd1w+p9wzBuFWFyRdcvo21tg+Q4KlNBacMYw4m3InHoQO3d6bk1gYR+5oZ/xbjejmVhqyDszLK24IsRdCCHsN+F8TjMSnILouNK4rob3aJ5JsYkw3tMydCfQytTtDDQqalX0CI3codV82LR7ybnLpZCodeOZmDOyNhRQCRXhETXt/oGgMUTINfXgxKLzisth/dPSGpby53aTPIjQ0EdrCsugfMQmtyhEak3ZuSaNN8PjLJjnQAHXvqKRv7eTadvwuQdFAaXI5EiKuA/0RUR4Uqu1r3xv52h0a+w6cR5KFCV5PerxKX3I2Jvk+rr36GuaDZ4Pv88y+WSnPExSZXLiMLPQrnsuSiO96Kk619kth0WbIiXrH4mCAJDIFgudgWqitAQltW1ebeWK+6MliaG73bSf/i2ObsE/Stir3QzeTbyxq5r9ykUzDXrfnDJdG5/rrYBGJFOFBhT0K8x9fwBf9KIJGMODtiYZkwPeMRBaQKteTcPBqqgYMrIkhhaKuO9PBR8g0SqCbIyjq72LI7x7OKkPSAVwCMn8NzDR+VT4k3+eH8Tz2G6EqxJpDi+THpi5fLHlLJ1j8OZr6cpOhGtq7un7cXXr0nH49LeiLZ9JVceN5n7lZFE/ElOyIETBRaT4lywHHOhFDuhSKgIn61onx17uC73zi+HpicWHHxJ2ojWZ6k0onegAkrHP4cKRmZ3GyRmvsHLpdBbATmNqfDOc225zZlO3NwXC0LNed0/X3No4sp4If/F4ZLyMj61hMCnKLMWBVmYgHC1gN+LJ49AHN0a+pOKexwikwa3iARlOYKBXoFx/TE+NvlNKWcGX5cda1RRP3tD1j7gm8v8YoI5oezaNb9ZX9+yJrjr0C2zdvEQ0+p2k+NSnnLKtoplV+whhAyFvOLb19gIgXvu9HpQ+Qce9DoR6OJvX3AhmKiy8sVKnSuel5Wl7pNYqfR30vT0tyGTC+wyCJQ2n//vN+bpM/LhoQeyqVTbxPoOvqKzKxp+7pXLCslUtNAS2a5mCwWJwGkKLGgiap0Oj4o8Dfo5m0CqqwNraKRyHfMoMi2I3v9NcHbtgRKCizVwGGMQgdGnn56wSGxcUWrySqW5zH0EXf1j0lzyXqSogR6Nw8yF5/7npZGmf9CnDt5ZKpXeP2KgqwcCpH7XgYshmYKMJkM5UvViiQp6dyqBF9wWBRCJ38t98nw8zVtQTE6S5+leNgfq2k7wXXIRqKvaIfuVr3mxuKTnCrIhxvNATbCkvFepSeIcX1LYBnzms2rZvh2zRrAnJLPJLRc+dF5rxydqduy+qTg0/KmcxMHG51cOjAKzMQOgC2fCftu/etUewPGP97pjBUaNg654nJp4lE5dahJBzMl/Vy4UxsGxf7GooFQK5OveAz4kBPQ7P4JFEJtnRpi3AZkPMFSQiHuey1cQnCxNK7kstdCZ2W/7LHoDRQW+pFiFQaL8042z5reDAzsuKM7O/NCViF/Ms4tJYOL4ObRsddmB2YC+vUTpHrWq6gR8XERpwXUJ8lsPHV26RDzLmBHImTJ17x4YHnhn8be/+TQg+T8WSbkX58ql58Ga4UkAUXXNJT1mpDU2ACAJccxSJfWIppwoHpbADebQd0jl8j2+dP7iPCq/pzaQHAwE77o+7f6wZt+hbpPaP3E5q+JITGqQtiddC/okCpuYDDldhilmPa4VclksKE5AemURdYVbLdSax90kkj8dGT2TlK1/s1xncz+3nvbNJJ5QlgAYPjMDWl0UYCxeIeylSgNDpBpRogmrkuVKQUKQYrEbMV7vVG1nXUKTYBsvvVFq67jvA2PZX9X6jE0Flv8ZA2kD4RIY6JBZy4T9jdXQrBpQPTYDfRF9gNfWvo5exDGEYUmm5fV5teWBBq1f6yaT98nJ9Oa0Lpet6vAjxaEhDB++VIYBL4IRSC7B2sRZsOGpEbwOefj/1E3789ym/j6w3RcM6YnGtq67biprfcyyu4vMehDZWrfQlQ8ZVN4sQE/XCrv54i3krOdeV8edEoz6g09gldbr0qU7mxUuvVwnn1Qk4KZ5NTNL79GwiM9pEGe6voMI6y7TwWyiHC4G9YiwJ0drDHD2LrlU+oxetv4q4zqwS4fp14PKjwOMfP0aJWL5y+ZFKdP8PpflTcjtwMBhU9SCV6u14brW1kc3HJq4vjQydMYBjfUnqPU4mYov212tcOnamuWbZrbd4MzO3kpENwTHcKqrh1QOJYIF//HyCP2IPHCRScA11FP3jQGaERM+rJbLn6Zlq+kQofBHH30+79fvXaX6n/8rW4NgvviJVDr1JUbICh3foKKjTPIyvB7zv95+/gX/a8PBkXOc/b0rRkO6le5c+Uhd0L9fPomelfl6ePkcaDtXMeqcjxQeiThAzrZ2uXOzWfn4OBftRhSiy5WBh6KnWvNR0MWvV8zC7SSb2xonLvT7pMN7DennBvH/4CotPLtJ8VcVndLtyeHhO3CSVX58hGKt8QYvwa4a/1Od1ZFPXODI77KnZu6ec0rGVPemwsXXXTsUzQm85icXWPDXZQXmfAsRhTviiVea+TRuIRIqx4UkRYk7ygzWlbBgDy0rqGjOb0Xyf7Ni2ddlsHrq9UOuV5V+XZDY/ZcbtTvbiQaNstY1k0n+Ey/Z70f1ScJikxStqtJ+uaPtXy/VAt9duX/ootJI8uvUKhvja9qhtq096Pvtc9fEZxJPS7KydDPw/3xm3sKi47D0J4KTW7NQmIu40P1+2QjoRGHHarEkE2hPYVFO6DwTJcfGOCFRRN+vSqXSDQgn9Qg+QIN+iJ259leXxxN/79f0XHPJkQlnH8mkk59nheIGWeRvPN7Swdxv6E8EytI9N9SvGqjKFz80R+2vU6Y0DvrQCI110LF3AHoG+1qGFR7A4nFJgd+9YGHRuFu6LoU6e2CwRqSShRYJE+QED36UwBZe25CnEEGmQ0Xlh+ypODEJxdaWCjqTSuBQagd8rlsfFp6CQBnG+6KHRq/SOdyitNQcKKTjH8aa+ibM0YbgBV4Kw3e1xhpfW0PI5/1VWlodHf9qMp3+Ilc1Y1ZikEVbbBiYwpRfhpnm2EEzEsoqLju5S5PjimSPR4u4dtmZeKlZwAuft1htKuf48zI/kpIQoJAc1GAeJLJaaQHiNQmLjhr8vSQzTB9FkQnMg3WhL5fNTKLFcq7vsHin4TKJZtJ1RVX9rjQ6WsICIXB0mSneybBmjiVS3WoweBPV3YsL8ekbiddVkEDlDFowljS3DHFDTmdDwW1E08qcnSKGldUrj5VXVaDcsxfcdJrysiWIsyeIjJqLGYHmoKFrqHmPjgmXM7CCCiOlc4PasR6CrE1PJEGNT0N5ZSs4ujJVIPC/34wGHkyazm3rSuyWWLEcI5RJDi0EZMHRQQb3KNARuEEdO+qkkj9c4CaK4C3oOXn0JluVoKZE4SDhO+bAfUGlTqVbcjKBj89ZmPhB71odtqYSq51cTvE6jMLFcEKK5Vzg6mqUuY4pXJshm9JOtuznWUmCkMuhtexCOhiCfU5xMKcpX9gdNv64Lqt9c0Uy12GLrRRozaBY4xI9LVk+pv72JovfPlSJjUL1gJUprO2Kn58srkuUp5xCNPp4F5OTrOicvMW9uCZzDLNCrc7Mvo9NxT+FMeivNAFQcahRLV9oDfi0dWpz04SEdbCLrk/6D6PA0pFSm2DVQUgYKalYghHccsaVpfyGIgUaxVo6gTGH0Dso818Nb+zKGhOzP4kMDK/OR8KQwTEj8USlxXMU/RTMSgDlJFiwQ6ejoY41/7xVNrrp9PC6vSH96Quq6n5xtquCK518zdUT2J2aPtEquXwLS8y0eG3YhfJNcG7G9VCu+DeBTQ1/kBrqgM7NQbF3AF3bQ2bkp+QyVjL/GvP3Cnt4tJOUSjl8eIgXCgctn2+7wtjLmyWDFRHVTUw1JUPfljh7/W2+ZOaBmGV1FrZ0l4p9A8zYdzAgChFvOvjuBN47rBNz0Cc/2wrBL29Vq1q0g/13vloTGGtf0fLrhvHZK7YZUk+C2eMyLF1bf2aReJgnLtoRTX0TLT+NQjQc4+6ibi8Wb6Rm8Q2Z0p+5rruQhrq4bd0hhIUii1UUOeX1mokinecm5lzQtVlSy35dJPw76AKHznUk6KUMbF17vhCr/pyvf+iXoUOD44Vg4D9cw/dBlbEzuKjSkHBMNNe+1Ufsf77Qlrd1lXiTsr/vm7slu029eMvkRfHsJw8k9kZ31Rq35AlfVuBFC9uDQ0tdG8OKYw4UpWGJRemI1XvobnkmOcRsS7Rgz2Tp7AOYhLcc0/dSlKMW112ZF80Gpzzxccnv76Kx2O2Kovau6R+BaZ8BTFN/xxrqHyO9Ax+QOlpHzJWtDwVHJr8mcaYyHHONasTriP+pFrO4idDSwyPM2pAzNNiwp7/JnJxujjfF3iRVxpiRTFaaEydNS+HwUmijIc1SuegaSPIJNaubmGly51J3yc0Nj6E0N2HNuwUlPLbsO/pn0dKVKlUTKxa3Et13HwsaNyNCZzuH4yDpfpfXq0/SdOZmlkx/gG5Y+4/gsL8hExMXMny/byZ1dqAm+h3Xdq50bHt9EM+tLqHTjE+SOLVpXA/8PNDYMEpiNUuvVR0tsO/ss5ZC1wlr1+5xJ5nqIr4lNCasx+FSNzG7BVOE5P1OTr7pgy+s8Qoik05tBah+rxUJ/wf3+6BKcAWV7Ceh4G55du4S3aZcbaj7FovHH8EHA+htTXQ68Vkxjo6aS2O1NKMSvIAFfyQ0adfVbldopcVzqg0rYk13qWNWCod2S4av0vpZTgpKJb7IppbWKDIpTF1Y6fD53nulWxkmVvnGZGOsur+uCijmfsSBCU7pNvyOQCZzFd64gwRDvQthoiCA+HAug0g09q9fyZuitVDAcnKstvoprmm7KTI3iteXO46sHuYLJx7ZfLUcDNYTw++1Y06rb328sDjPEtYuPVhLbuPF/nGg2QU9IdqL/v1mlOVccR+dioMzPumwgplS0IJmIX+25dKULCs7xDN6ZTsQ7CQW7WmofrC7uf33DTkT+sLaYbe58WFd1aiGKU3z+ZY9Fl3a2t+31HxX4XGht2CtyG+7ty7KRxMn2NNQNT3M7Ts3Fegr/bq8Osj170cyxQ4mXJvS2szQ4KqspkJXtozPoG1DIVVKpcA2fDU0i/SkVO51ZIkNuZa0X2KH9PWdX3tnrKm/fvvOB3qsvJm68KxvocJ3czit7VQLoBVaeoEkhxXBPMs61YYsNt/aIYu7CdCNAga0Nrf+rvvw2KMxpA1zqlGtFIpJVyIdfnw1WhDSIyNaCr9ZXXtlpd9xmSAdLoFOWZHq9WjELqaTfL9KfuGXlc9cWSTMyE8+vK+Y2VS69spd77z2ut+AQ0/bEBUuXRtbylWHMceOuqXS2uWFRYKC/4TbYnmDh4Q0knhcmKKSgo4Lkf7Ry9xy6SFTlsOBDD3ftaywAK4514Zev5xjazfOVRs6FgA6KLbDnf4Bx+trE2JBtMblAZqRUsnS5uZVO1pjdZaz7aVv9bn2lfEVMdjokHUjjz1+Naatn56OsBd+6PqlufT8uQwJBA9CKvPu5RbKZERFS1ehf2XTGM1mJltSua5qkMM6FqoiBzP0jrJltWGp1ybSkSQW3ZG27pWcxH6NvgLR8C/PuuD8Z8INjaC+1gOSWdaUSHXMyU9ArlAciMXoHFdkP75ZrTLLHy+PT95IVXkz6AZszDmQf34721ulFthp7ib+8CLTWqbhRfz6fxGJXI3u2bkcMAknhHDwX/pp4d8P2dIWw3LWb/IHb+go0XV0YZfNkQYKojSzkQn9qKzr90k+n+P6dPAXTdAbGxFMyq18eORSEUKzZbNYH58qc9UfRfdWyMh4p8CFPHqUISkQKlrwVkTfI7ev+J1yqp21x7u02t623PUe2We8Zu3b3ykKf2814ugVVPwdQYU3JnOmXdcU32OVnpjB46z2FS8oQ/HfOsVCgBwV/wJYKCG02YXhzUXXmVZNqN7TC/WmA7bY/M1ZO1a13UVNYWW/vtsIhh2SzlPZccCPITNNS3AwoILYLTeGJVq6pfZRIxhMEw5vT2BpHrKXiOOVru7byI/QhuM2xnGxGqGFOGzt9lU91B5tzT85lwJJ07fTWORJks/dfPS+SBHz6E3SmGsFLCxBfZN5MKYzWEdXgYuVEmQLm9WypSZUMpktm8+H6uqAmPZ6LEnlXrBh7Nz1+bW1TQH/71+UehrDr8o1Nf8ldhq9DXkrAtOJ8eUWbpNseCwuUbebLZWaxGo8ajs4l1mr+QKt9T7jwHvWnwNBrHIKqn6/Npu8VC0W2110a6+BACJVMTLu17TDiOCbLAJRRwNXxLZhXENSmU+WUTe9iruvo67lYIvia5k2zUtfIuV8Sle+u4XKMy3DUz98JaCWaGfH3cFgaO7tLtF6PkrE4tkSBw42Z4eC38ciPy0tsyJY+VuEcic1zfcVDZ1s2Hg2+NFjLJ/2Rjbs/57YGyAhyRC7HMRK4UzYbzactbH/by0DLnA1zESKWDW5ns3MPSBZVuOkT6bqxvXPdbevyTqJmXekC9lVgSu23re1YeW/NL114F2v7H3LGWmquSMYrvqDLLZFKsppH0eIh7w8zJl+48VSNPhv1cnc5zXOCTseIMTiF+OyOzZ+g15T81ui6W/VtLTC9N49YNbFfjpXEzmv5uDhD8mUEYcziBh+uanIzg46YNmcrXEJvRoc53IZqWYRlbxPhT+0UfKzdoeQ2cT0VrlYMjYqgWsDJfvqHgMunOve/ONotPoBmRBGKnz+bX08gX8fCyy/0602aPna637UdWjs8ob+4XOIono18Qn7IEvOep7N3ovM7G9hbm68um8IYrruWFZ5D4bD+zC3Ir/TIDydDMNc5t4SVqWoKbH3cD7GCfRV+1LVPv2nl42l0tmuyI2O67w/hIFAn31h8ytu0Zo6o+O7Gy+//JuBQNBllMKf8vEEXl1Vs+wNLlolHAyP1vkiT7nDE+f4LAccrdKdJEfzaSwynInJd5GXX73DGRq+Q6qurnEpvV3KF29FM/i4XOm9sErBIZ7RFni4QIdR0W3v3ji5OVMupnsHb4UDvf+gZXPVSXzsgF+a3O/K98Zk+Ufezj3Glk2lpyXwZStWn5Q6IhLDRNB8YnRdx9aGXQeu8LkK2DLx6CQ/an1ZTKS0d99H5aqqemRoTZw6FwnrextL+PLFhiueVwhsGE+ujCYzPzGtcrtllWBEB3evyp/NhrRvaGX+IvyJQp4gcJmeqtNHgPqN/qm2plvihw9/aZUDH63D/C+MIpZYvP7xAhurqvJjXnw/Eb0wBCvRfRT5lx2X2MgiDycecnZRCWjfQDCBjHRaV+CwLu2ZDfseMV3nMYPzOP0zCPu2/qrF+5sG4BNZVfpC3pBfjxatmxq5fEmIsqCOMCt7m8MrUlC815rfeKZzF1SEanV+TwifDwbJ22HBwMbrFgJfllAaD6szk5zuTKrsKRbwvaSp6rAijEHgz/Z5W3/GIxiNwrlZlskjvT7y9GFNuSJI4TKfWV4b8ilnIMWLIFsCS/MVMy7dqUdipprOxKoYOUuzbZ+3BCJVdk45KKypKVDU1WSSll/KMvosM4xByxGlHmR9Qil/Jqse/fn/AgwAOY4uqSLnKwwAAAAASUVORK5CYII="},function(t,e,n){},function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(t,e,n){t.exports=n(183)},,,,,function(t,e,n){},,,,,,function(t,e,n){},,function(t,e,n){},,,,,,,,,,,,,,,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){},,function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(52),o=n(0),s=(n(122),n(5)),a=n(24),u=n(9),c=n(113),l=n.n(c),h=function(){var t=l()({loader:function(){return n.e(2).then(n.bind(null,185))},loading:s.Loading});return r.createElement(t,null)},p={homeCount:u.l.box(-1)},d=function(t){return!0===t?"text-primary":"text-muted"},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.render=function(t){var n=e.controller,i=n.cHome,o=n.cMember,a=n.cCart,u=[{name:"home",label:"\u9996\u9875",icon:"home",content:i.tab,notify:p.homeCount},{name:"member",label:"\u4f1a\u5458",icon:"vcard",content:o.tab},{name:"cart",label:"\u8d2d\u7269\u8f66",icon:"shopping-cart",content:a.tab,notify:a.cart.count},{name:"me",label:"\u6211\u7684",icon:"user",content:h}].map(function(t){var e=t.name,n=t.label,r=t.icon;return{name:e,caption:function(t){return Object(s.TabCaptionComponent)(n,r,d(t))},content:t.content,notify:t.notify}});return r.createElement(s.Page,{header:!1},r.createElement(s.Tabs,{tabs:u}))},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.render),[2]})})},e}(s.VPage),m=n(13),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showCart=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.start()];case 1:return t.sent(),[2]}})})},e.content=Object(m.a)(function(){return r.createElement("div",null,r.createElement("button",{className:"btn btn-info btn-sm",onClick:e.showCart},"Cart: ",r.createElement("span",{className:"badge badge-light"},e.controller.cart.count.get())))}),e}return o.d(e,t),e.prototype.render=function(t){return r.createElement(this.content,null)},e}(s.View),b=n(8),y=n(14),g=n.n(y),w=n(10),E=n(42),C=n(16),k=n(20),P=n(17),O=n(15),N=n(18),S=n(29),x=n.n(S),j=n(39),V=n(45),F=n(87),A=n.n(F),T=function t(){Object(C.a)(this,t)},I=function(t){function e(t){var n;return Object(C.a)(this,e),(n=Object(P.a)(this,Object(O.a)(e).call(this))).func=t,n}return Object(N.a)(e,t),Object(k.a)(e,[{key:"check",value:function(t,e){var n=this.func(e);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void t.push(n);default:return void t.push.apply(t,Object(j.a)(n))}}}]),e}(T),q=function(t){function e(t){var n;return Object(C.a)(this,e),(n=Object(P.a)(this,Object(O.a)(e).call(this))).res=t,n}return Object(N.a)(e,t),e}(T),R=function(t){function e(){return Object(C.a)(this,e),Object(P.a)(this,Object(O.a)(e).apply(this,arguments))}return Object(N.a)(e,t),Object(k.a)(e,[{key:"check",value:function(t,e){switch(typeof e){default:case"boolean":return;case"object":if(null!==e)return;break;case"string":if(e.trim().length>0)return;break;case"number":if(NaN!==e)return;break;case"undefined":}t.push(this.res.required)}}]),e}(q),D=function(t){function e(t,n,r){var i;return Object(C.a)(this,e),(i=Object(P.a)(this,Object(O.a)(e).call(this,t))).minMsg=A.a.template(t.min),i.maxMsg=A.a.template(t.max),i.min=n,i.max=r,i}return Object(N.a)(e,t),Object(k.a)(e,[{key:"check",value:function(t,e){if(void 0!==e&&null!==e){var n=Number(e);NaN===n?t.push(this.res.number):this.checkMore(t,n)}}},{key:"checkMore",value:function(t,e){void 0!==this.min&&Number(e)<this.min&&t.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(e)>this.max&&t.push(this.maxMsg({max:this.max}))}}]),e}(q),U=function(t){function e(){return Object(C.a)(this,e),Object(P.a)(this,Object(O.a)(e).apply(this,arguments))}return Object(N.a)(e,t),Object(k.a)(e,[{key:"checkMore",value:function(t,n){Object(V.a)(Object(O.a)(e.prototype),"checkMore",this).call(this,t,n),!1===Number.isInteger(n)&&t.push(this.res.integer)}}]),e}(D),L=n(23),M=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},B=function(){function t(e,n,r,i){var o=this;Object(C.a)(this,t),this.errors=[],this.contextErrors=[],this.onInputChange=function(t){o.changeValue(t.target.value,!0)},this.context=e;var s=n.name;if(this.name=s,this.itemSchema=n,this.fieldProps=r,this.children=i,this.ui=e.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var a=this.ui,u=a.readOnly,c=a.disabled,l=a.visible;this.readOnly=!0===u,this.disabled=!0===c,this.visible=!(!1===l)}this.value=this.defaultValue=e.getValue(s),this.init()}return Object(k.a)(t,[{key:"init",value:function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new R(this.context.form.res)),this.buildRules(),void 0!==this.ui){var t=this.ui.rules;if(void 0!==t)if(!1!==Array.isArray(t)){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value;this.rules.push(new I(s))}}catch(a){n=!0,r=a}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}else this.rules.push(new I(t))}}},{key:"buildRules",value:function(){}},{key:"checkRules",value:function(){var t,e=[],n=!0,r=!1,i=void 0;try{for(var o,s=this.rules[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){o.value.check(e,this.value)}}catch(a){r=!0,i=a}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}0===e.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,e))}},{key:"setError",value:function(t){var e;void 0!==t&&("string"===typeof t?this.errors.push(t):(e=this.errors).push.apply(e,Object(j.a)(t)))}},{key:"setContextError",value:function(t){var e;void 0!==t&&("string"===typeof t?this.contextErrors.push(t):(e=this.contextErrors).push.apply(e,Object(j.a)(t)))}},{key:"clearError",value:function(){this.errors.splice(0)}},{key:"clearContextError",value:function(){this.contextErrors.splice(0)}},{key:"parse",value:function(t){return t}},{key:"setElementValue",value:function(t){}},{key:"setDataValue",value:function(t){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(t))}},{key:"setValue",value:function(t){!0!==this.isChanging&&this.changeValue(t,!1)}},{key:"getValue",value:function(){return this.context.getValue(this.name)}},{key:"getReadOnly",value:function(){return this.readOnly}},{key:"getDisabled",value:function(){return this.disabled}},{key:"getVisible",value:function(){return this.visible}},{key:"setReadOnly",value:function(t){this.readOnly=t}},{key:"setDisabled",value:function(t){this.disabled=t}},{key:"setVisible",value:function(t){this.visible=t}},{key:"changeValue",value:function(t,e){var n,r,i=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var o=!0;void 0!==n&&(this.isChanging=!0,o=n(this.context,this.value,i),this.isChanging=!1),!0===o&&(this.setDataValue(t),!0!==e&&this.setElementValue(t),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,i),this.isChanging=!1))}},{key:"renderContainer",value:function(){if(!1===this.visible)return null;var t,e=this.context,n=e.form;if(!0===e.inNode)return this.render();if(void 0===this.ui)t=this.name;else{var r=this.ui.label;null===r&&(t=null),t=r||this.name}return!0===this.itemSchema.required&&!1!==n.props.requiredFlag&&null!==t&&(t=w.createElement(w.Fragment,null,t,"\xa0",w.createElement("span",{className:"text-danger"},"*"))),n.FieldContainer(t,this.render())}},{key:"renderTemplet",value:function(){if(void 0!==this.children)return w.createElement(w.Fragment,null,this.children);if(void 0!==this.ui){var t=this.ui.Templet;return"function"===typeof t?t(this.value):t}}},{key:"renderErrors",value:function(){var t=[].concat(Object(j.a)(this.errors),Object(j.a)(this.contextErrors));if(0===t.length)return null;var e=!0===this.context.inNode?"span":"div";return t.map(function(t){return w.createElement(e,{key:t,className:"text-danger d-inline-block my-2 ml-3"},w.createElement(w.Fragment,null,w.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t))})}},{key:"hasError",get:function(){return this.errors.length+this.contextErrors.length>0}},{key:"isOk",get:function(){return 0===this.errors.length}},{key:"className",get:function(){var t;return!1===this.context.inNode&&(t="form-control"),x()(t,this.context.form.FieldClass,this.ui&&this.ui.className)}}]),t}();M([L.k],B.prototype,"errors",void 0),M([L.k],B.prototype,"contextErrors",void 0),M([L.d],B.prototype,"hasError",null),M([L.k],B.prototype,"visible",void 0),M([L.d],B.prototype,"isOk",null);var H=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="text",t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setElementValue",value:function(t){null!==this.input&&(this.input.value=t)}},{key:"onBlur",value:function(){this.checkRules(),this.context.checkContextRules()}},{key:"onFocus",value:function(){this.clearError(),this.context.removeErrorWidget(this),this.context.removeErrors()}},{key:"setReadOnly",value:function(t){null!==this.input&&(this.input.readOnly=this.readOnly=t)}},{key:"setDisabled",value:function(t){null!==this.input&&(this.input.disabled=this.disabled=t)}},{key:"render",value:function(){var t=this,e=this.renderTemplet();if(void 0!==e)return e;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,w.createElement(w.Fragment,null,w.createElement("input",{ref:function(e){return t.input=e},className:x()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:this.onInputChange,placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:function(){return t.onFocus()},onBlur:function(){return t.onBlur()},maxLength:this.itemSchema.maxLength}),this.renderErrors())}},{key:"placeholder",get:function(){return this.ui&&this.ui.placeholder||this.name}}]),e}(B),W=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).onInputChange=function(e){t.setValue(e.currentTarget.value)},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setElementValue",value:function(t){this.input.value=t}},{key:"setReadOnly",value:function(t){this.input.readOnly=this.readOnly=t}},{key:"setDisabled",value:function(t){this.input.disabled=this.disabled=t}},{key:"render",value:function(){var t=this;return w.createElement("textarea",{ref:function(e){return t.input=e},rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange})}}]),e}(B),K=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="password",t}return Object(N.a)(e,t),e}(H),Q=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="url",t}return Object(N.a)(e,t),e}(H),J=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="email",t}return Object(N.a)(e,t),e}(H),z=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="number",t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"buildRules",value:function(){Object(V.a)(Object(O.a)(e.prototype),"buildRules",this).call(this);var t=this.context.form.res,n=this.itemSchema,r=n.min,i=n.max;this.rules.push("integer"===this.itemSchema.type?new D(t,r,i):new U(t,r,i))}},{key:"parse",value:function(t){if(void 0!==t&&null!==t)return Number(t)}}]),e}(H),X=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="number",t.onKeyDown=function(e){var n=e.keyCode;event.returnValue=t.isValidKey(n)},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"isValidKey",value:function(t){return 46===t||8===t||37===t||39===t||t>=48&&t<=57||t>=96&&t<=105||109===t||189===t}}]),e}(z),_=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="date",t}return Object(N.a)(e,t),e}(H),Z=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="datetime",t}return Object(N.a)(e,t),e}(H),G=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="time",t}return Object(N.a)(e,t),e}(H),Y=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="month",t}return Object(N.a)(e,t),e}(H),$=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).onInputChange=function(e){t.setDataValue(!0===e.target.checked?t.trueValue:t.falseValue)},t.onClick=function(){t.context.removeErrors()},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"init",value:function(){if(Object(V.a)(Object(O.a)(e.prototype),"init",this).call(this),void 0!==this.ui){var t=this.ui,n=t.trueValue,r=t.falseValue;this.trueValue=void 0===n||n,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1}},{key:"setElementValue",value:function(t){this.input.checked=t===this.trueValue}},{key:"setReadOnly",value:function(t){this.input.readOnly=this.readOnly=t}},{key:"setDisabled",value:function(t){this.input.disabled=this.disabled=t}},{key:"render",value:function(){var t=this,e=x()(this.className,"form-check-inline"),n=w.createElement("input",{ref:function(e){return t.input=e},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return this.context.inNode?w.createElement("label",{className:e},n," ",this.ui&&this.ui.label||this.name):w.createElement("div",{className:e},n)}}]),e}(B),tt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},et=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).onInputChange=function(e){t.setDataValue(e.target.value)},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setElementValue",value:function(t){this.select.value=t}},{key:"setReadOnly",value:function(t){this.select.disabled=this.readOnly=!t}},{key:"setDisabled",value:function(t){this.select.disabled=this.disabled=t}},{key:"render",value:function(){var t=this;if(!0===this.readOnly){var e=this.ui.list.find(function(e){return e.value===t.value}),n=void 0===e?"(???)":e.title;return w.createElement("span",{className:"form-control w-min-6c"},n)}return w.createElement("select",{ref:function(e){return t.select=e},className:x()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map(function(t,e){var n=t.title,r=t.value;return w.createElement("option",{className:void 0,key:e,value:r},n||r)}))}}]),e}(B);tt([L.k],et.prototype,"readOnly",void 0);var nt=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputs={},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setElementValue",value:function(t){for(var e in this.inputs){var n=this.inputs[e];n.checked=t===n.value}}},{key:"setReadOnly",value:function(t){for(var e in this.readOnly=t,this.inputs)this.inputs[e].readOnly=t}},{key:"setDisabled",value:function(t){for(var e in this.disabled=t,this.inputs)this.inputs[e].disabled=t}},{key:"render",value:function(){var t,e=this,n=this.ui,r=n.defaultValue,i=n.list,o=this.context,s=o.isRow;o.inNode;!0===s&&(t=this.context.rowKey);var a=x()(this.className,"form-radio-inline");return w.createElement("span",{className:a},i.map(function(n,i){var o=n.value,s=n.title,a=e.name;return void 0!==t&&(a+="-"+t),w.createElement("label",{key:i,className:"form-radio-inline"},w.createElement("input",{ref:function(t){return e.inputs[i]=t},type:"radio",name:a,value:o,defaultChecked:(e.defaultValue||r)===o}),s||o)}))}}]),e}(B),rt=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).inputType="range",t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setReadOnly",value:function(t){this.input.readOnly=this.readOnly=t}},{key:"setDisabled",value:function(t){this.input.disabled=this.disabled=t}},{key:"render",value:function(){var t=this,e=this.ui,n=e.min,r=e.max,i=e.step;return w.createElement(w.Fragment,null,w.createElement("input",{ref:function(e){return t.input=e},className:x()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:i}))}}]),e}(B),it=n(56),ot=n.n(it),st=n(46),at=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ut=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},ct=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).onClick=function(){return ut(Object(st.a)(Object(st.a)(t)),void 0,void 0,ot.a.mark(function t(){var e,n;return ot.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(e=this.ui&&this.ui.pickId)){t.next=4;break}return alert("no pickId defined!"),t.abrupt("return");case 4:return t.next=6,e(this.context,this.name,this.value);case 6:n=t.sent,this.setDataValue(n),this.clearError(),this.clearContextError(),this.checkRules();case 11:case"end":return t.stop()}},t,this)}))},t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"setReadOnly",value:function(t){this.readOnly=t}},{key:"setDisabled",value:function(t){this.disabled=t}},{key:"render",value:function(){var t,e;void 0!==this.ui&&(t=this.ui.placeholder,e=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(n=t||"placeholder",r["text-muted"]=!0):n=void 0===e?w.createElement(w.Fragment,null,this.value):"function"===typeof e?e(this.value):e,w.createElement(w.Fragment,null,w.createElement("div",{className:x()(r),onClick:this.onClick},n),this.renderErrors())}}]),e}(B);at([L.k],ct.prototype,"value",void 0);var lt=function(t,e,n){return w.createElement("span",{className:"text-danger"},"!!data type ",t," only support ",(n||[]).join(", "),", can't use ui ",e,"!!")},ht=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},pt=function(t){function e(){var t;return Object(C.a)(this,e),(t=Object(P.a)(this,Object(O.a)(e).apply(this,arguments))).onClick=function(){return ht(Object(st.a)(Object(st.a)(t)),void 0,void 0,ot.a.mark(function t(){var e,n,r,i;return ot.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.clearError(),this.clearContextError(),e=this.itemSchema,n=e.name,"submit"!==e.type){t.next=7;break}if(this.context.checkRules(),!0!==this.context.hasError){t.next=7;break}return t.abrupt("return");case 7:if(void 0!==(r=this.context.form.props.onButtonClick)){t.next=11;break}return alert("button ".concat(n," clicked. you should define form onButtonClick")),t.abrupt("return");case 11:return t.next=13,r(n,this.context);case 13:if(void 0!==(i=t.sent)){t.next=16;break}return t.abrupt("return");case 16:this.context.setError(n,i);case 17:case"end":return t.stop()}},t,this)}))},t.observerRender=Object(E.a)(function(){var e,n,r,i=t.itemSchema,o=i.name,s=i.type;if(void 0!==t.ui){var a=t.ui.widget;if("button"!==a)return lt(s,a,["button"]);e=t.ui.Templet,n=t.ui.className,r=t.ui.label}var u,c=t.context,l=c.form,h=c.hasError,p=t.context,d="submit"===s&&h;u=void 0!==t.children?t.children:"function"===typeof e?e():void 0!==e?e:r;var f=w.createElement("button",{className:n,type:"button",disabled:d,onClick:t.onClick},u||o);return!0===p.inNode?w.createElement(w.Fragment,null,f,t.renderErrors()):w.createElement("div",{className:l.ButtonClass},w.createElement("div",null,t.renderErrors()),f)}),t}return Object(N.a)(e,t),Object(k.a)(e,[{key:"render",value:function(){return w.createElement(this.observerRender,null)}},{key:"renderContainer",value:function(){if(!1===this.visible)return null;var t=this.context,e=t.form;return!0===t.inNode?this.render():e.FieldContainer(null,this.render())}}]),e}(B),dt=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ft=function(){function t(e,n,r,i,o){var s=this;if(Object(C.a)(this,t),this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(E.a)(function(){var t=s.errors;return 0===t.length?null:w.createElement(w.Fragment,null,t.map(function(t){return w.createElement("span",{key:t,className:"text-danger inline-block my-1 ml-3"},w.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t)}))}),this.form=e,this.uiSchema=n,this.initData=r,this.inNode=i,this.isRow=o,void 0!==n){var a,u=n.rules;if(void 0!==u)this.rules=[],!1===Array.isArray(u)?this.rules.push(u):(a=this.rules).push.apply(a,Object(j.a)(u))}}return Object(k.a)(t,[{key:"getArrRowContexts",value:function(t){void 0===this.subContexts&&(this.subContexts={});var e=this.subContexts[name];return void 0===e&&(this.subContexts[name]=e={}),e}},{key:"getValue",value:function(t){return this.initData[t]}},{key:"setValue",value:function(t,e){this.initData[t]=e;var n=this.widgets[t];void 0!==n&&n.setValue(e)}},{key:"getDisabled",value:function(t){var e=this.widgets[t];if(void 0!==e)return e.getDisabled()}},{key:"setDisabled",value:function(t,e){var n=this.widgets[t];void 0!==n&&n.setDisabled(e)}},{key:"getReadOnly",value:function(t){var e=this.widgets[t];void 0!==e&&e.getReadOnly()}},{key:"setReadOnly",value:function(t,e){var n=this.widgets[t];void 0!==n&&n.setReadOnly(e)}},{key:"getVisible",value:function(t){var e=this.widgets[t];void 0!==e&&e.getVisible()}},{key:"setVisible",value:function(t,e){var n=this.widgets[t];void 0!==n&&n.setVisible(e)}},{key:"checkFieldRules",value:function(){for(var t in this.widgets)this.widgets[t].checkRules();if(void 0!==this.subContexts)for(var e in this.subContexts){var n=this.subContexts[e];for(var r in n)n[r].checkFieldRules()}}},{key:"checkContextRules",value:function(){if(void 0!==this.rules){this.clearContextErrors();var t=!0,e=!1,n=void 0;try{for(var r,i=this.rules[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o,s=(0,r.value)(this);if(void 0!==s)if(!0===Array.isArray(s))(o=this.errors).push.apply(o,Object(j.a)(s));else if("string"===typeof s)this.errors.push(s);else for(var a in s)this.setError(a,s[a])}}catch(p){e=!0,n=p}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}if(void 0!==this.subContexts)for(var u in this.subContexts){var c=this.subContexts[u];for(var l in c){var h=c[l];h.removeErrors(),h.checkContextRules()}}}}},{key:"setError",value:function(t,e){var n=this.widgets[t];void 0!==n&&(n.setContextError(e),this.addErrorWidget(n))}},{key:"clearContextErrors",value:function(){for(var t in this.widgets)this.widgets[t].clearContextError()}},{key:"checkRules",value:function(){this.checkFieldRules(),this.checkContextRules()}},{key:"addErrorWidget",value:function(t){this.errorWidgets.findIndex(function(e){return e===t})<0&&this.errorWidgets.push(t)}},{key:"removeErrorWidget",value:function(t){var e=this.errorWidgets.findIndex(function(e){return e===t});e>=0&&this.errorWidgets.splice(e,1)}},{key:"checkHasError",value:function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var t in this.subContexts){var e=this.subContexts[t];for(var n in e)if(!0===e[n].hasError)return!0}return!1}},{key:"removeErrors",value:function(){for(var t in this.errors.splice(0),this.errorWidgets.splice(0),this.widgets){var e=this.widgets[t];void 0!==e&&e.clearContextError()}}},{key:"arrName",get:function(){}},{key:"hasError",get:function(){return this.checkHasError()}}]),t}();dt([L.k],ft.prototype,"errors",void 0),dt([L.k],ft.prototype,"errorWidgets",void 0),dt([L.d],ft.prototype,"hasError",null);var mt=1,vt=function(t){function e(t,n,r,i){var o,s;Object(C.a)(this,e);var a=t.uiSchema;if(void 0!==a){var u=a.items;void 0!==u&&(s=u[n.name])}return(o=Object(P.a)(this,Object(O.a)(e).call(this,t.form,s,r,i,!0))).parentContext=t,o.arrSchema=n,o.rowKey=mt++,o.data=r,o}return Object(N.a)(e,t),Object(k.a)(e,[{key:"getItemSchema",value:function(t){return this.arrSchema.itemSchemas[t]}},{key:"getUiItem",value:function(t){if(void 0!==this.uiSchema){var e=this.uiSchema.items;if(void 0!==e)return e[t]}}},{key:"removeErrors",value:function(){Object(V.a)(Object(O.a)(e.prototype),"removeErrors",this).call(this),this.parentContext.removeErrors()}},{key:"arrName",get:function(){return this.arrSchema.name}}]),e}(ft),bt=w.createContext({}),yt=Object(E.a)(function(t){var e,n,r,i,o=t.parentContext,s=t.arrSchema,a=t.children,u=s.name,c=s.arr,l=o.initData[u],h=o.form,p=o.getArrRowContexts(u),d=o.getUiItem(u),f=u,m=h.ArrContainer,v=h.RowContainer,b=h.RowSeperator,y=h.uiSchema;if(void 0!==y){var g=y.selectable,C=y.deletable,k=y.restorable;!0!==n&&(n=g),!0!==r&&(r=C),!0!==i&&(i=k)}if(void 0!==d){var P=d.widget,O=d.label,N=d.selectable,S=d.deletable,j=d.restorable,V=d.ArrContainer,F=d.RowContainer,A=d.RowSeperator;if(void 0!==N&&(n=N),void 0!==S&&(r=S),void 0!==j&&(i=j),void 0!==V&&(m=V),void 0!==F&&(v=F),void 0!==A&&(b=A),e=d.Templet,"arr"!==P)return lt(s.type,P,["arr"]);f=O||f}var T=!0;return m(f,w.createElement(w.Fragment,null,l.map(function(t,u){var h,d,f=void 0;if(!1===T?f=b:T=!1,void 0!==a)h=new vt(o,s,t,!0),d=w.createElement(w.Fragment,null,a);else{var m=typeof e;"function"===m?(h=new vt(o,s,t,!0),d=w.createElement(Object(E.a)(e),t)):"object"===m?(h=new vt(o,s,t,!0),d=e):(h=new vt(o,s,t,!1),d=w.createElement(w.Fragment,null,c.map(function(t,e){return w.createElement(w.Fragment,{key:t.name},function(t,e,n,r){if(void 0===t)return null;if(void 0===e)return;var i,o=e.name,s=e.type;switch(s){case"arr":var a=t.getItemSchema(o);return w.createElement(yt,{parentContext:t,arrSchema:a,children:n})}var u=t.getUiItem(o);function c(t){switch(t){default:return H;case"id":return ct;case"integer":return X;case"number":return z;case"string":return H;case"date":return _;case"boolean":return $;case"button":case"submit":return pt}}if(void 0===u)i=c(s);else{var l=u.widget;switch(l){default:if(void 0!==l){var h=gt[l];i=h.widget}void 0===i&&(i=c(s));break;case"custom":i=u.WidgetClass;break;case"group":return w.createElement("span",null,"impletment group")}}var p=t.isRow,d=t.widgets,f=new i(t,e,r,n);if(d[o]=f,!1===p){var m=Object(E.a)(function(){return f.renderContainer()});return w.createElement(m,null)}var v=f.renderContainer();return v}(h,t,void 0))})))}var y,g,C=h.rowKey;if(p[C]=h,!0===n){y=w.createElement("div",{className:"form-row-checkbox"},w.createElement("input",{type:"checkbox",onClick:function(e){t.$isSelected=e.target.checked,h.removeErrors()}}))}var k=!(void 0===t.$isDeleted||!1===t.$isDeleted);if(!0===r){var P=k?"fa-undo":"fa-trash";g=w.createElement("div",{className:"form-row-edit align-self-start text-info cursor-pointer",onClick:function(){if(!0===i)t.$isDeleted=!k;else{var e=l.indexOf(t);e>=0&&l.splice(e,1)}h.removeErrors()}},w.createElement("i",{className:x()("fa",P,"fa-fw")}))}var O=!0===n||!0===r?function(e){return w.createElement("fieldset",{disabled:k},w.createElement("div",{className:x()("d-flex",{deleted:k,"row-selected":t.$isSelected})},y,w.createElement("div",{className:"flex-grow-1"},e),g))}:function(t){return t};return w.createElement(bt.Provider,{key:C,value:h},f,v(O(w.createElement(w.Fragment,null,w.createElement(h.renderErrors,null),d))))})))}),gt={id:{dataTypes:["id"],widget:ct},text:{dataTypes:["integer","number","string"],widget:H},textarea:{dataTypes:["string"],widget:W},password:{dataTypes:["string"],widget:K},date:{dataTypes:["date"],widget:_},datetime:{dataTypes:["date"],widget:Z},time:{dataTypes:["date"],widget:G},month:{dataTypes:["date"],widget:Y},select:{dataTypes:["integer","number","string","date","boolean"],widget:et},url:{dataTypes:["string"],widget:Q},email:{dataTypes:["string"],widget:J},number:{dataTypes:["integer","number"],widget:z},updown:{dataTypes:["integer","number"],widget:X},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:$},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:nt},range:{dataTypes:["integer"],widget:rt},button:{dataTypes:["button","submit"],widget:pt}};var wt=[107,109,110,187,189],Et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minusClick=function(){var t=e.getValue();t||(t=0),e.setValue(t-1)},e.plusClick=function(){var t=e.getValue();t||(t=0),e.setValue(t+1)},e.ref=function(t){var n;if(e.input=t,null!==e.input)for(n=e.input;n;n=n.parentElement)if("FIELDSET"===n.tagName){!0===n.disabled&&(e.disabled=!0);break}},e.renderContent=Object(m.a)(function(){var t=e.renderTemplet();if(void 0!==t)return t;var n={};!0===e.hasError?n["is-invalid"]=!0:n["required-item"]=!0===e.itemSchema.required;var i,o,s,a,u=e.hasFocus,c=!0!==e.readOnly&&!0!==e.disabled,l=NaN!==e.value&&void 0!==e.value&&e.value>0;!0===e.disabled?(i="cursor-pointer",o="text-light"):(s=e.minusClick,a=e.plusClick,o="text-danger");var h=r.createElement("i",{className:g()("fa","fa-minus-circle","fa-lg",o,i,{invisible:!(!0===u||!0===c&&!0===l)}),onClick:s}),p=r.createElement("input",{ref:e.ref,className:g()(e.className,n,"mx-1 w-4c form-control",{invisible:!(!0===u||!0===l)}),type:"text",defaultValue:e.value,onChange:e.onInputChange,placeholder:e.placeholder,readOnly:e.readOnly,disabled:e.disabled,onKeyDown:e.onKeyDown,onFocus:function(){return e.onFocus()},onBlur:function(){return e.onBlur()},maxLength:10}),d=r.createElement("i",{className:g()("fa fa-plus-circle fa-lg",o,i,{invisible:!(!0===c)}),onClick:a});return r.createElement("div",{className:"d-flex align-items-center"},h,p,d,e.renderErrors())}),e}return o.d(e,t),e.prototype.isValidKey=function(e){return void 0===wt.find(function(t){return t===e})&&t.prototype.isValidKey.call(this,e)},e.prototype.onBlur=function(){t.prototype.onBlur.call(this),this.hasFocus=!1},e.prototype.onFocus=function(){t.prototype.onFocus.call(this),this.hasFocus=!0},e.prototype.render=function(){return r.createElement(this.renderContent,null)},o.c([u.l],e.prototype,"value",void 0),o.c([u.l],e.prototype,"disabled",void 0),o.c([u.l],e.prototype,"hasFocus",void 0),e}(X),Ct=[{name:"list",type:"arr",arr:[{name:"product",type:"object"},{name:"packs",type:"arr",arr:[{name:"pack",type:"object"},{name:"price",type:"number"},{name:"quantity",type:"number"}]}]}],kt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputRefs={},e.checkBoxs={},e.mapInputRef=function(t,n){if(null!==t)return t.value=n.quantity,e.inputRefs[n.pack.id]=t},e.mapCheckBox=function(t,n){if(null!==t)return t.checked=n.checked||!1,e.checkBoxs[n.pack.id]=t},e.updateChecked=function(t){return o.b(e,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return e=this.checkBoxs[t.pack.id],[4,this.controller.cart.updateChecked(t,e.checked)];case 1:return n.sent(),[2]}})})},e.updateQuantity=function(t){return o.b(e,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return e=this.inputRefs[t.pack.id],[4,this.controller.cart.updateQuantity(t,Number(e.value))];case 1:return n.sent(),[2]}})})},e.minusQuantity=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return t.quantity>1?[4,this.controller.cart.updateQuantity(t,t.quantity-1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.plusQuantity=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.cart.updateQuantity(t,t.quantity+1)];case 1:return e.sent(),[2]}})})},e.renderProduct=function(t){return r.createElement("strong",null,t.description)},e.renderPack=function(t){return r.createElement(r.Fragment,null,t.name)},e.renderItem=function(t){return r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement("img",{src:"favicon.ico",alt:t.product.obj.description})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},Object(a.tv)(t.product,e.renderProduct))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},Object(a.tv)(t.pack,e.renderPack)),r.createElement("div",{className:"col-3"},r.createElement("strong",{className:"text-danger"},t.price)),r.createElement("div",{className:"col-6 text-right d-flex"},r.createElement("div",{onClick:function(){return e.minusQuantity(t)}},r.createElement(b.b,{name:"minus-circle text-success"})),r.createElement("span",{className:"px-4 bg-light"},t.quantity),r.createElement("div",{onClick:function(){return e.plusQuantity(t)}},r.createElement(b.b,{name:"plus-circle text-success"})))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},"\u8d27\u671f"))))},e.onCartItemRender=function(t){var n,i,o,s=t.isDeleted,u=r.createElement(r.Fragment,null,Object(a.tv)(t,e.renderItem));r.createElement("input",{className:"text-center",style:{width:"60px"},ref:function(n){return e.mapInputRef(n,t)},type:"number",onChange:function(){return e.updateQuantity(t)},disabled:s});!0===s?(o=r.createElement("del",null,u),n=function(){return t.isDeleted=!1},i=r.createElement(b.b,{name:"rotate-left"})):(o=r.createElement("div",null,u),n=function(){return t.isDeleted=!0},i=r.createElement(b.b,{name:"trash-o"}));var c=r.createElement("button",{className:"btn btn-light",type:"button",onClick:n},i);return r.createElement(b.d,{className:"px-2 py-2",left:r.createElement("input",{className:"mr-3",type:"checkbox",ref:function(n){return e.mapCheckBox(n,t)},onChange:function(){return e.updateChecked(t)},disabled:s}),right:r.createElement(r.Fragment,null,c)},o)},e.CheckOutButton=Object(m.a)(function(){var t=e.controller,n=t.checkOut,i=t.cart.amount.get(),o=i>0?r.createElement(r.Fragment,null,"\u53bb\u7ed3\u7b97"," (",i," \u5143)"):r.createElement(r.Fragment,null,"\u53bb\u7ed3\u7b97");return r.createElement("button",{className:"btn btn-success w-100",type:"button",onClick:n,disabled:i<=0},o)}),e.onQuantityChanged=function(t,n,r){return o.b(e,void 0,void 0,function(){var e,r,i,s,a;return o.e(this,function(o){switch(o.label){case 0:return e=t.data,r=e.product,i=e.pack,s=i.retail,a=i.currency,[4,this.controller.cApp.cCart.cart.AddToCart(r,i,n,s,a)];case 1:return o.sent(),[2]}})})},e.productRow=function(t){var e=t.product;return r.createElement("div",{className:"row"},r.createElement("div",{className:"col-sm-6"},Object(a.tv)(e)),r.createElement("div",{className:"col-sm-6"},r.createElement(s.Field,{name:"packs"})))},e.packsRow=function(t){var e=t.pack,n=(t.quantity,t.price);return r.createElement("div",{className:"d-flex align-items-center"},r.createElement("div",{className:"d-flex flex-grow-1"},r.createElement("div",{className:"flex-grow-1"},Object(a.tv)(e)),r.createElement("div",{className:"w-6c mr-4 text-right"},r.createElement("span",{className:"text-danger h5"},n),"\u5143")),r.createElement(s.Field,{name:"quantity"}))},e.uiSchema={selectable:!0,deletable:!0,restorable:!0,items:{list:{widget:"arr",Templet:e.productRow,ArrContainer:function(t,e){return e},RowContainer:function(t){return r.createElement("div",{className:"p-3"},t)},items:{packs:{widget:"arr",Templet:e.packsRow,selectable:!1,deletable:!1,ArrContainer:function(t,e){return e},RowContainer:function(t){return t},RowSeperator:r.createElement("div",{className:"border border-gray border-top my-3"}),items:{quantity:{widget:"custom",className:"text-center",WidgetClass:Et,onChanged:e.onQuantityChanged}}}}}}},e.cartData={list:[{product:{discription:"aaa"},packs:[{pack:{name:"1g"},quantity:10,price:12.1},{pack:{name:"10g"},quantity:12,price:22.1}]},{product:{discription:"bbb"},packs:[{pack:{name:"1g"},quantity:13,price:12.1},{pack:{name:"10g"},quantity:14,price:22.1}]}]},e.page=function(){var t=e.controller.cart,n={list:t.items.map(function(t){return{product:t.product,packs:[{pack:t.pack,quantity:t.quantity,price:t.price}]}})};return r.createElement(r.Fragment,null,r.createElement("header",{className:"p-3 text-center"},"\u8d2d\u7269\u8f66"),r.createElement(s.Form,{className:"bg-white",schema:Ct,uiSchema:e.uiSchema,formData:n}),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},r.createElement(b.e,{items:t.items,item:{render:e.onCartItemRender}}))),r.createElement("footer",null,r.createElement(e.CheckOutButton,null)))},e}return o.d(e,t),e.prototype.showEntry=function(){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page),[2]})})},e.prototype.render=function(t){return this.page()},e}(s.VPage),Pt=n(21),Ot=n.n(Pt),Nt=function(){function t(t){var e=this;this.calcSum=function(){var t=e.items.reduce(function(t,e){var n=e.isDeleted,r=e.quantity,i=e.price,o=e.checked,s=t.count,a=t.amount;return!0===n?t:i===Number.NaN||r===Number.NaN?t:{count:s+r,amount:a+(!0!==o?0:r*i)}},{count:0,amount:0}),n=t.count,r=t.amount;e.count.set(n),e.amount.set(r)},this.items=[],this.count=u.l.box(0),this.amount=u.l.box(0),this.addToCartAction=t.action("addtocart"),this.getCartQuery=t.query("getcart"),this.setCartAction=t.action("setcart"),this.removeFromCartAction=t.action("removefromcart"),this.disposer=Object(u.d)(this.calcSum)}return t.prototype.dispose=function(){this.disposer()},t.prototype.load=function(){return o.b(this,void 0,void 0,function(){var t,e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.getCartQuery.page(void 0,0,100)];case 1:return e=n.sent(),(t=this.items).push.apply(t,e),[2]}})})},t.prototype.AddToCart=function(t,e,n,r,i){return o.b(this,void 0,void 0,function(){var s;return o.e(this,function(o){switch(o.label){case 0:return(s=this.items.find(function(t){return t.pack.id===e.id}))?(s.quantity+=n,s.price=r):(s=this.createCartItem(t,e,n,r,i),this.items.push(s)),[4,this.addToCartAction.submit({product:s.product.id,pack:s.pack.id,price:s.price,currency:i&&i.id,quantity:n})];case 1:return o.sent(),[2]}})})},t.prototype.createCartItem=function(t,e,n,r,i){return{checked:!0,pack:e,product:t,price:r,currency:i,quantity:n,isDeleted:!1,createdate:Date.now()}},t.prototype.updateChecked=function(t,e){return o.b(this,void 0,void 0,function(){var n;return o.e(this,function(r){return(n=this.items.find(function(e){return e.pack.id===t.pack.id}))&&(n.checked=e),[2]})})},t.prototype.updateQuantity=function(t,e){return o.b(this,void 0,void 0,function(){var n;return o.e(this,function(r){switch(r.label){case 0:return[4,this.setCartAction.submit({product:t.product.id,pack:t.pack.id,price:t.price,quantity:e})];case 1:return r.sent(),(n=this.items.find(function(e){return e.pack.id===t.pack.id}))&&(n.quantity=e),[2]}})})},t.prototype.removeDeletedItem=function(){return o.b(this,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return(t=this.items.filter(function(t){return!0===t.isDeleted}))?[4,this.removeFromCart(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.removeFromCart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.removeFromCartAction.submit({rows:t})];case 1:return e.sent(),Ot.a.pullAllBy(this.items,t,"pack.id"),[2]}})})},t.prototype.getSelectItem=function(){var t=this.items.filter(function(t){return t.checked&&!(!0===t.isDeleted)});if(t&&0!==t.length)return t},t.prototype.getItem=function(t){return this.items.find(function(e){return e.pack.id===t})},o.c([u.l],t.prototype,"items",void 0),t}(),St=function(t){function e(e,n){var i=t.call(this,n)||this;i.renderCart=function(){return i.renderView(kt)},i.checkOut=function(){return o.b(i,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return this.isLogined?[3,1]:[3,3];case 1:return void 0===(t=this.cart.getSelectItem())?[2]:[4,this.cApp.cOrder.start(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},i.tab=function(){return r.createElement(i.renderCart,null)},i.cApp=e;var s=i.cApp.cUsqOrder;return i.cart=new Nt(s),i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.showVPage(kt),[2]})})},e.prototype.onDispose=function(){this.cart.removeDeletedItem()},e.prototype.renderCartLabel=function(){return this.renderView(v)},e}(s.Controller),xt=[{name:"list",type:"arr",arr:[{name:"pack",type:"object"},{name:"retail",type:"number"},{name:"vipPrice",type:"number"},{name:"currency",type:"string"},{name:"quantity",type:"number"}]}],jt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onQuantityChanged=function(t,n,r){return o.b(e,void 0,void 0,function(){var e,r,i,s,a;return o.e(this,function(o){switch(o.label){case 0:return e=t.data,r=e.product,i=e.pack,s=i.retail,a=i.currency,[4,this.controller.cApp.cCart.cart.AddToCart(r,i,n,s,a)];case 1:return o.sent(),[2]}})})},e.arrTemplet=function(t){var e=t.pack,n=e.retail,i=e.vipPrice,o=r.createElement("div",{className:"d-flex"},r.createElement(s.Field,{name:"quantity"}));return r.createElement(b.d,{className:"mx-3",right:o},r.createElement("div",null,Object(a.tv)(e)),r.createElement("div",null,"retail:",n," vipPrice:",i))},e.renderPack=function(t){var e=t.radiox,n=t.radioy,i=t.unit;return r.createElement(r.Fragment,null,e," x ",n," ",i)},e.page=Object(m.a)(function(t){var n=e.controller,i=n.product,o=n.cApp,u=o.cHome.renderSearchHeader(),c=o.cCart.renderCartLabel();r.createElement(b.d,{className:"pt-3",right:"quantity  cart  favorite"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-2"},"SKU"),r.createElement("div",{className:"col-2"},"price"),r.createElement("div",{className:"col-2"},"vip price"))),r.createElement("div",{className:"border border-danger border-top"});return r.createElement(s.Page,{header:u,right:c},r.createElement("div",{className:"px-2 py-2 bg-white"},Object(a.tv)(i,It)),r.createElement(s.Form,{schema:xt,uiSchema:e.uiSchema,formData:e.data}))}),e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.uiSchema={items:{list:{widget:"arr",Templet:this.arrTemplet,items:{quantity:{widget:"custom",className:"text-center",WidgetClass:Et,onChanged:this.onQuantityChanged}}}}},this.packRows=this.controller.buildPackRows(),this.data={list:this.packRows},this.openPage(this.page,t),[2]})})},e}(s.VPage),Vt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onProductClick=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){return this.controller.showProductDetail(t.id),[2]})})},e.onScrollBottom=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.pageProducts.more()];case 1:return t.sent(),[2]}})})},e.page=Object(m.a)(function(){var t=e.controller,n=t.pageProducts,i=t.cApp,o=i.cHome.renderSearchHeader(),a=i.cCart.renderCartLabel();return r.createElement(s.Page,{header:o,right:a,onScrollBottom:e.onScrollBottom},r.createElement(b.e,{before:"",items:n,item:{render:It,onClick:e.onProductClick},className:"bg-white px-2"}))}),e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){return e=t,this.controller.pageProducts.first({key:e}),this.openPage(this.page),[2]})})},e}(s.VPage),Ft=function(t){function e(e){var n=t.call(this)||this;return n.firstSize=n.pageSize=3,n.searchProductQuery=e,n}return o.d(e,t),e.prototype.load=function(t,e,n){return o.b(this,void 0,Promise,function(){var r;return o.e(this,function(i){switch(i.label){case 0:return r=t.key,void 0===e&&(e=0),[4,this.searchProductQuery.page({key:r},e,n)];case 1:return[2,i.sent()]}})})},e.prototype.setPageStart=function(t){return void 0===t?0:t.id},e}(s.PageItems),At=function(t){function e(e,n){var r=t.call(this,n)||this;r.showProductDetail=function(t){return o.b(r,void 0,void 0,function(){var e,n,r,i,s,a,u,c;return o.e(this,function(o){switch(o.label){case 0:return e=this,[4,this.productTuid.load(t)];case 1:return e.product=o.sent(),n=this,[4,this.productChemicalMap.obj({product:t})];case 2:return n.productChemical=o.sent(),this.productChemical&&(this.product.chemical=this.productChemical.chemical,this.product.purity=this.productChemical.purity),r=this.cApp,i=r.salesRegion,s=r.currentUser,[4,this.priceMap.table({product:t,salesRegion:i.id})];case 3:return a=o.sent(),u=0,s.hasCustomer?[4,this.getCustomerDiscount.table({brand:this.product.brand.id,customer:s.currentCustomer.id})]:[3,5];case 4:c=o.sent(),u=c&&c[0]&&c[0].discount,o.label=5;case 5:return a.forEach(function(t){t.vipprice=t.price*(1-u),t.currency=i.currency.obj}),this.product.packx.forEach(function(t){var e=a.find(function(e){return e.pack.id===t.id});t.retail=e&&e.retail,t.vipPrice=e&&e.vipPrice,t.currency=i.currency.obj}),this.showVPage(jt,this.product),[2]}})})},r.getDeliveryTimeDescription=function(t,e,n){return o.b(r,void 0,void 0,function(){var r,i;return o.e(this,function(o){switch(o.label){case 0:return[4,this.getInventoryAllocationQuery.table({product:t,pack:e,salesRegion:n})];case 1:return(r=o.sent()).length>0?[2,r[0].deliveryTimeDescription]:[3,2];case 2:return[4,this.getFutureDeliveryTime.table({product:t,salesRegion:n})];case 3:if((i=o.sent()).length>0)return[2,i[0].deliveyTimeDescription];o.label=4;case 4:return[2]}})})},r.cApp=e;var i=e.cUsqProduct,s=e.cUsqCustomerDiscount,a=e.cUsqWarehouse,u=i.query("searchProduct");return r.pageProducts=new Ft(u),r.productTuid=i.tuid("productx"),r.packTuid=r.productTuid.divs.packx,r.productChemicalMap=i.map("productChemical"),r.priceMap=i.map("price2"),r.getCustomerDiscount=s.query("getdiscount"),r.getInventoryAllocationQuery=a.query("getInventoryAllocation"),r.getFutureDeliveryTime=i.query("getFutureDeliveryTime"),r}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.showVPage(Vt,t),[2]})})},e.prototype.buildPackRows=function(){for(var t=[],e=0,n=this.product.packx;e<n.length;e++){var r=n[e],i={pack:r},o=this.cApp.cCart.cart.getItem(r.id);o&&(i.quantity=o.quantity),t.push(i)}return t},e}(s.Controller);function Tt(t){return r.createElement(r.Fragment,null,r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u54c1\u724c:"),r.createElement("div",{className:"col-8 col-md-4"},t.name))}function It(t,e){return r.createElement("div",{className:"row d-flex"},r.createElement("div",{className:"col-12"},r.createElement("div",{className:"row py-2"},r.createElement("div",{className:"col-12"},r.createElement("strong",null,t.description))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement("img",{src:"favicon.ico",alt:"structure"})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-4 col-md-2 text-muted"},"CAS:"),r.createElement("div",{className:"col-8 col-md-4"},t.CAS),r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u7eaf\u5ea6:"),r.createElement("div",{className:"col-8 col-md-4"},t.purity),r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u5f0f:"),r.createElement("div",{className:"col-8 col-md-4"},t.molecularFomula),r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u5206\u5b50\u91cf:"),r.createElement("div",{className:"col-8 col-md-4"},t.molecularWeight),r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u4ea7\u54c1\u7f16\u53f7:"),r.createElement("div",{className:"col-8 col-md-4"},t.origin),Object(a.tv)(t.brand,Tt))))))}var qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.RenderDeliveryContact=function(t){return r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},t.name,t.mobile,r.createElement("br",null),t.address))},e.nullContact=function(){return r.createElement(r.Fragment,null,"\u8bf7\u70b9\u51fb\u8f93\u5165\u5730\u5740")},e.renderProduct=function(t){return r.createElement("strong",null,t.description)},e.renderPack=function(t){return r.createElement(r.Fragment,null,t.name)},e.renderItem=function(t){return r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement("img",{src:"favicon.ico",alt:t.product.obj.description})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},Object(a.tv)(t.product,e.renderProduct))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},t.pack.obj.name),r.createElement("div",{className:"col-3"},r.createElement("strong",{className:"text-danger"},t.price)),r.createElement("div",{className:"col-6 text-right"},"\u6570\u91cf: ",r.createElement("span",{className:"px-4 bg-light"},t.quantity))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-12"},"\u8d27\u671f"))))},e.renderOrderItem=function(t){return r.createElement(r.Fragment,null,Object(a.tv)(t,e.renderItem),r.createElement("br",null))},e.page=Object(m.a)(function(){var t=e.controller,n=t.orderData,i=t.submitOrder,o=t.openContactList,a=n.orderItems,u=n.deliveryContact,c=r.createElement("button",{type:"button",className:"btn btn-danger w-100",onClick:i},"\u63d0\u4ea4\u8ba2\u5355",n.amount),l=r.createElement(b.b,{name:"chevron-right"});return r.createElement(s.Page,{header:"\u8ba2\u5355\u9884\u89c8",footer:c},r.createElement(b.d,{right:l,onClick:o,className:"px-2 py-2"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-4"},u.name),r.createElement("div",{className:"col-8"},u.mobile),r.createElement("div",{className:"col-12"},u.addressString))),r.createElement(b.e,{items:a,item:{render:e.renderOrderItem,className:"px-2"}}))}),e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page),[2]})})},e}(s.VPage),Rt=function(){function t(){this.deliveryContact={},this.orderItems=[]}return Object.defineProperty(t.prototype,"amount",{get:function(){return this.orderItems.reduce(function(t,e){return t+e.subAmount},0)},enumerable:!0,configurable:!0}),t.prototype.getPostData=function(){return{webUser:this.webUser,organization:this.organization&&this.organization.id,customer:this.customer&&this.customer.id,orderitems:this.orderItems.map(function(t){return{product:t.product.id,pack:t.pack.id,price:t.price,quantity:t.quantity,subAmount:t.subAmount}}),deliveryOrderContact:this.deliveryContact.id,amount:this.amount,currency:this.currency&&this.currency.id}},o.c([u.l],t.prototype,"deliveryContact",void 0),o.c([u.l],t.prototype,"orderItems",void 0),o.c([u.e],t.prototype,"amount",null),t}(),Dt=function(){function t(){}return Object.defineProperty(t.prototype,"subAmount",{get:function(){return this.price*this.quantity},enumerable:!0,configurable:!0}),o.c([u.l],t.prototype,"price",void 0),o.c([u.l],t.prototype,"quantity",void 0),o.c([u.e],t.prototype,"subAmount",null),t}(),Ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=function(t){return r.createElement(s.Page,null,r.createElement("div",null,t.no))},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e}(s.VPage),Lt=function(t){function e(e,n){var r=t.call(this,n)||this;r.orderData=new Rt,r.createOrderFromCart=function(t){return o.b(r,void 0,void 0,function(){var e,n;return o.e(this,function(r){switch(r.label){case 0:return this.orderData.webUser=this.cApp.currentUser.id,void 0!==this.orderData.deliveryContact?[3,2]:[4,this.cApp.currentUser.getConsigneeContacts()];case 1:(e=r.sent())&&e.length>0&&((n=e.find(function(t){if(!0===t.isDefault)return t}))||(n=e[0]),this.setContact(n.contact.obj)),r.label=2;case 2:return void 0!==t&&t.length>0&&(this.orderData.currency=t[0].currency,this.orderData.orderItems=t.map(function(t,e){var n=new Dt;return n.product=t.product,n.pack=t.pack,n.price=t.price,n.quantity=t.quantity,n})),[2]}})})},r.setContact=function(t){r.orderData.deliveryContact=o.a({},t)},r.submitOrder=function(){return o.b(r,void 0,void 0,function(){var t,e;return o.e(this,function(n){switch(n.label){case 0:return this.orderData.deliveryContact?(t=this.orderData.getPostData(),[4,this.orderSheet.loadSchema()]):(this.openContactList(),[2]);case 1:return n.sent(),[4,this.orderSheet.save("",t)];case 2:return e=n.sent(),[4,this.orderSheet.action(e.id,e.flow,e.state,"submit")];case 3:return n.sent(),this.cApp.cCart.cart.removeFromCart(this.orderData.orderItems),this.closePage(1),this.showVPage(Ut,e),[2]}})})},r.openContactList=function(){r.cApp.cUser.start()},r.cApp=e;var i=e.cUsqWebUser,s=e.cUsqCustomer,a=e.cUsqOrder;return r.webUserCustomerMap=i.map("webUserCustomer"),r.webUserConsigneeContactMap=i.map("webUserConsigneeContact"),r.customerConsigneeContactMap=s.map("customerConsigneeContact"),r.orderSheet=a.sheet("order"),r}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return e=t,[4,this.createOrderFromCart(e)];case 1:return n.sent(),this.showVPage(qt),[2]}})})},o.c([u.l],e.prototype,"orderData",void 0),e}(s.Controller),Mt=n(114),Bt=n.n(Mt),Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.render=function(){var t=r.createElement(b.b,{name:"globe"}),e=(r.createElement("div",null,"\u767b\u5f55"),r.createElement("img",{className:"m-1",src:Bt.a,alt:"logo"})),n=r.createElement("div",{className:"d-flex flex-row mr-1 align-items-center"},t," \xa0",r.createElement("button",{onClick:function(){return s.nav.start()}},"Try"));return r.createElement(b.d,{className:"align-items-end pb-1",left:e,right:n},r.createElement("div",{className:"h4 px-3 mb-0"},"\u767e\u7075\u5a01\u79d1\u6280"))},e}(s.View),Wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){return this.controller.cApp.cProduct.start(t),[2]})})},e}return o.d(e,t),e.prototype.render=function(t){return r.createElement(b.i,{className:"px-1 my-2 w-100",onSearch:this.onSearch,placeholder:"Search product name, CAS, MDL etc."})},e}(s.View),Kt=5,Qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderSection=function(t,e){return r.createElement("section",null,r.createElement("h4",null,t.title,r.createElement("small",{className:"text-muted"},t.subtitle)),r.createElement("p",null,t.content))},e.page=Object(m.a)(function(){var t=e.controller.openMetaView,n=r.createElement(r.Fragment,null);return e.controller.isLogined&&e.controller.user.id===Kt&&(n=r.createElement("button",{type:"button",className:"btn w-100",onClick:t},"view")),r.createElement(s.Page,{header:!1,footer:n},e.content())}),e.content=function(){var t=e.controller.renderSiteHeader();return r.createElement(r.Fragment,null,t,e.controller.renderSearchHeader(),e.controller.renderCategoryRootList())},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page),[2]})})},e.prototype.render=function(t){return r.createElement(this.content,null)},e}(s.View),Jt=(function(t){function e(e){var n=t.call(this)||this;return n.firstSize=n.pageSize=13,n.sectionTuid=e,n}o.d(e,t),e.prototype.load=function(t,e,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){switch(t.label){case 0:return void 0===e&&(e=0),[4,this.sectionTuid.search("",e,n)];case 1:return[2,t.sent()]}})})},e.prototype.setPageStart=function(t){return void 0===t?0:t.id}}(s.PageItems),function(t){function e(e,n){var i=t.call(this,n)||this;return i.renderSiteHeader=function(){return i.renderView(Ht)},i.renderSearchHeader=function(){return i.renderView(Wt)},i.renderCategoryRootList=function(){return i.cApp.cProductCategory.renderRootList()},i.renderHome=function(){return i.renderView(Qt)},i.openMetaView=function(){i.cApp.startDebug()},i.tab=function(){return r.createElement(i.renderHome,null)},i.cApp=e,i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.cApp.cProductCategory.start()];case 1:return t.sent(),this.showVPage(Qt),[2]}})})},e}(s.Controller)),zt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.catClick=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.openMainPage(t)];case 1:return e.sent(),[2]}})})},e.onRootCategoryRender=function(t,n){var i=t.category,o=t.children,s=r.createElement("div",{className:"h4"},i.obj.name);return r.createElement("div",{className:"row bg-light py-2"},r.createElement("div",{className:"col-12"},r.createElement(b.d,{left:s,right:"\u66f4\u591a...",className:"px-3 cursor-pointer",onClick:function(){return e.catClick(t)}})),r.createElement("div",{className:"col-12"},r.createElement("div",{className:"row mx-3 cussor-pointer"},o&&o.map(function(t){return r.createElement("div",{className:"col-12 col-md-4 py-2",onClick:function(){return e.catClick(t)}},t.category.obj.name,r.createElement("hr",{className:"my-1"}))}))))},e}return o.d(e,t),e.prototype.render=function(t){var e=this.controller.rootCategories;return r.createElement(b.e,{items:e,item:{render:this.onRootCategoryRender},className:"mx-1"})},e}(s.View),Xt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childUI=function(t){return r.createElement("div",{className:"py-2"},r.createElement(b.b,{name:"hand-o-right mr-2"}),t.name)},e.renderChild=function(t){return Object(a.tv)(t.category,e.childUI)},e.catClick=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.openMainPage(t)];case 1:return e.sent(),[2]}})})},e.page=function(t){var n=e.controller.cApp.cHome.renderSearchHeader(),i=e.controller.cApp.cCart.renderCartLabel();return r.createElement(s.Page,{header:n,right:i},r.createElement("h3",null,Object(a.tv)(t.category,function(t){return t.name})),r.createElement("hr",null),r.createElement(b.e,{items:t.children,item:{render:e.renderChild,onClick:e.catClick},className:"bg-white px-2"}))},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e}(s.VPage),_t=function(t){function e(e,n){var r=t.call(this,n)||this;r.rootCategories=[],r.renderRootList=function(){return r.renderView(zt)},r.cApp=e;var i=r.cApp.cUsqProduct;return r.categoryTuid=i.tuid("productCategory"),r.categoryTreeMap=i.map("productCategoryTree"),r}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){var t,e=this;return o.e(this,function(n){switch(n.label){case 0:return t=this,[4,this.categoryTreeMap.table({parent:0})];case 1:return t.rootCategories=n.sent(),this.rootCategories.forEach(function(t){return o.b(e,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return t.isleaf?[3,2]:(e=t,[4,this.getCategoryChildren(t.category.id)]);case 1:e.children=n.sent(),n.label=2;case 2:return[2]}})})}),[2]}})})},e.prototype.getCategoryChildren=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.categoryTreeMap.table({parent:t})];case 1:return[2,e.sent()]}})})},e.prototype.openMainPage=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return t.isleaf?[3,3]:[3,1];case 1:return e=t,[4,this.getCategoryChildren(t.category.id)];case 2:e.children=n.sent(),this.showVPage(Xt,t),n.label=3;case 3:return[2]}})})},o.c([u.l],e.prototype,"rootCategories",void 0),e}(s.Controller),Zt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onContactRender=function(t){var n=e.controller,i=n.onContactEdit,o=n.onContactSelected;return r.createElement("div",{className:"row"},r.createElement("div",{className:"col-10",onClick:function(){return o(t)}},Object(a.tv)(t)),r.createElement("div",{className:"col-2"},r.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return i(t)}},"edit")))},e.page=function(){var t=e.controller,n=t.currentUser,i=t.onContactEdit,o=n.consigneeContacts;return r.createElement(s.Page,{footer:r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:function(){return i()}},"\u6dfb\u52a0\u65b0\u5730\u5740")},r.createElement(b.e,{items:o,item:{render:e.onContactRender},none:"\u4f60\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u6536\u8d27\u5730\u5740\uff0c\u8bf7\u6dfb\u52a0\u65b0\u5730\u5740"}))},e}return o.d(e,t),e.prototype.showEntry=function(){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page),[2]})})},e}(s.VPage),Gt=[{name:"webUser",type:"id",required:!1},{name:"name",type:"string",required:!0},{name:"organizationName",type:"string",required:!0},{name:"mobile",type:"string",required:!0},{name:"telephone",type:"string",required:!1},{name:"email",type:"string",required:!1},{name:"address",type:"id",required:!1},{name:"addressString",type:"string",required:!0},{name:"isDefault",type:"integer",required:!0},{name:"submit",type:"submit"}],Yt={items:{webUser:{visible:!1},name:{widget:"text",label:"\u59d3\u540d"},organizationName:{widget:"text",label:"\u5355\u4f4d\u540d\u79f0"},mobile:{widget:"text",label:"\u624b\u673a\u53f7"},telephone:{widget:"text",label:"\u7535\u8bdd"},addressString:{widget:"text",label:"\u8be6\u7ec6\u5730\u5740"},isDefault:{widget:"checkbox",label:"\u4f5c\u4e3a\u9ed8\u8ba4\u5730\u5740"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},$t=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.saveContact=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){return[2]})})},e.onFormButtonClick=function(t,n){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return n.form.data.isDefault?n.form.data.isDefault=1:n.form.data.isDefault=0,[4,this.controller.saveContact(n.form.data)];case 1:return t.sent(),[2]}})})},e.page=function(){var t=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:e.saveContact},"\u4fdd\u5b58\u5e76\u4f7f\u7528");return r.createElement(s.Page,{header:"\u6dfb\u52a0\u6536\u8d27\u4eba",footer:t},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{schema:Gt,uiSchema:Yt,formData:{webUser:e.controller.user.id},onButtonClick:e.onFormButtonClick,fieldLabelSize:3,className:"my-3"})))},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page),[2]})})},e}(s.VPage),te=function(t){function e(e,n){var r=t.call(this,n)||this;r.consigneeContacts=[],r.onContactEdit=function(t){return o.b(r,void 0,void 0,function(){return o.e(this,function(t){return this.showVPage($t),[2]})})},r.saveContact=function(t){return o.b(r,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.contactTuid.save(void 0,t)];case 1:return e=n.sent(),[4,this.webUserConsigneeContactMap.add({webUser:this.user.id,arr1:[{contact:e.id}]})];case 2:return n.sent(),this.onContactSelected(t),[2]}})})},r.onContactSelected=function(t){r.cApp.cOrder.setContact(t),r.backPage()},r.cApp=e;var i=e.cUsqWebUser,s=e.cUsqCustomer;e.cUsqOrder;return r.webUserCustomerMap=i.map("webUserCustomer"),r.webUserConsigneeContactMap=i.map("webUserConsigneeContact"),r.customerTuid=s.tuid("customer"),r.customerConsigneeContactMap=s.map("customerConsigneeContact"),r.contactTuid=s.tuid("contact"),r}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){var t,e=this;return o.e(this,function(n){switch(n.label){case 0:return this.currentUser=this.cApp.currentUser,this.currentUser.consigneeContacts=[],[4,this.cApp.currentUser.getConsigneeContacts()];case 1:return(t=n.sent())&&t.length>0&&t.forEach(function(t){e.currentUser.consigneeContacts.push(t.contact.obj)}),this.showVPage(Zt),[2]}})})},e}(s.Controller),ee=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=function(){var t=e.controller,n=t.member,i=t.user,o=r.createElement("img",{src:i.icon,alt:"\u5934\u50cf"}),s=r.createElement("p",{className:"h4"},"\u6211\u7684\u79ef\u5206"),a=r.createElement("p",{className:"small align-self-end"},"\u67e5\u770b\u8be6\u60c5 ",r.createElement(b.b,{name:"angle-right"})),u=r.createElement(r.Fragment,null,r.createElement("p",{className:"h5 mb-0"},"0"),r.createElement(b.g,null,"\u672c\u5468")),c=r.createElement(r.Fragment,null,r.createElement("p",{className:"h5 mb-0"},n.point),r.createElement(b.g,null,"\u7d2f\u8ba1")),l=r.createElement("p",{className:"h4"},"\u6211\u7684\u7c89\u4e1d"),h=r.createElement("p",{className:"small align-self-end"},"\u67e5\u770b\u8be6\u60c5 ",r.createElement(b.b,{name:"angle-right"}));return r.createElement("div",null,r.createElement(b.d,{className:"shadow bg-white rounded p-3 mb-1",left:o},r.createElement("div",null,r.createElement("div",null,i.name),r.createElement("div",null,"\u9080\u8bf7\u7801:",n.recommendationCode))),r.createElement("div",{className:"shadow bg-white rounded p-3 mb-1"},r.createElement(b.d,{left:s,right:a}),r.createElement(b.d,{className:"pb-2"},r.createElement("p",{className:"h4 mb-0"},"0"),r.createElement(b.g,null,"\u4eca\u65e5")),r.createElement(b.d,{left:u,right:c})),r.createElement("div",{className:"shadow bg-white rounded p-3 mb-1"},r.createElement(b.d,{left:l,right:h}),r.createElement(b.d,{className:"pb-2"},r.createElement("p",{className:"h4 mb-0"},"0"),r.createElement(b.g,null,"\u4eca\u65e5")),r.createElement(b.d,{left:u,right:c})))},e}return o.d(e,t),e.prototype.showEntry=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return[2]})})},e.prototype.render=function(t){return r.createElement(this.content,null)},e}(s.VPage),ne=function(t){function e(e,n){var i=t.call(this,n)||this;return i.renderMember=function(){return i.renderView(ee)},i.render=Object(m.a)(function(){return void 0===i.member?r.createElement(s.Loading,null):i.renderMember()}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=e,i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){var t,e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.cApp.cUsqMember.tuid("member").load(this.user.id)];case 1:return t=n.sent(),[4,this.cApp.cUsqMember.query("getPoint").obj({member:t.id})];case 2:return e=n.sent(),t.point=void 0===e?0:e.point,this.member=t,[2]}})})},o.c([u.l],e.prototype,"member",void 0),e}(s.Controller),re=function(){function t(t){this.webUserCustomerMap=t.map("webUserCustomer"),this.webUserConsigneeContactMap=t.map("webUserConsigneeContact")}return Object.defineProperty(t.prototype,"user",{set:function(t){var e=this;void 0!==t&&(this._user=t,this.id=t.id,this.name=t.name,this.nick=t.nick,this.icon=t.icon,this.guest=t.guest,this.token=t.token,void 0!==this._user&&this.webUserCustomerMap.obj({webUser:this.id}).then(function(t){void 0!=t&&(e.currentCustomer=new ie(t.Customer))}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLogined",{get:function(){return void 0!==this._user},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasCustomer",{get:function(){return void 0!==this.currentCustomer},enumerable:!0,configurable:!0}),t.prototype.getConsigneeContacts=function(){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){switch(t.label){case 0:return void 0===this.currentCustomer?[3,2]:[4,this.currentCustomer.getConsigneeContacts()];case 1:t.sent(),t.label=2;case 2:return[2,this.webUserConsigneeContactMap.table({webUser:this.id})]}})})},t}(),ie=function(){function t(t){}return t.prototype.getConsigneeContacts=function(){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.consigneeContactMap.table({customer:this.id})];case 1:return[2,t.sent()]}})})},t}(),oe=n(43),se={content:function(t){var e=t;r.createElement("div",null,"image");return r.createElement("div",{className:"row d-flex"},r.createElement("div",{className:"col-12"},r.createElement("div",{className:"row py-2"},r.createElement("div",{className:"col-12"},r.createElement("strong",null,e.description))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement("img",{src:"favicon.ico",alt:"structure"})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-4 col-md-2 text-muted"},"\u4ea7\u54c1\u7f16\u53f7:"),r.createElement("div",{className:"col-8 col-md-4"},e.origin))))))},divs:{packx:{content:function(t){var e=t.radiox,n=t.radioy,i=t.unit;return r.createElement(r.Fragment,null,e," ",n," ",i)}}}},ae={CApp:function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.internalStart=function(){return o.b(this,void 0,void 0,function(){var t,e;return o.e(this,function(n){switch(n.label){case 0:return console.log("CCartApp.internalStart"),this.cUsqOrder=this.getCUsq(oe.a.usqOrder),this.cUsqProduct=this.getCUsq(oe.a.usqProduct),this.cUsqCommon=this.getCUsq(oe.a.usqCommon),this.cUsqWebUser=this.getCUsq(oe.a.usqWebUser),this.cUsqCustomer=this.getCUsq(oe.a.usqCustomer),this.cUsqCustomerDiscount=this.getCUsq(oe.a.usqCustomerDiscount),this.cUsqWarehouse=this.getCUsq(oe.a.usqWarehouse),this.cUsqMember=this.getCUsq(oe.a.usqMember),this.cProductCategory=new _t(this,void 0),this.cCart=new St(this,void 0),this.cHome=new Jt(this,void 0),this.cProduct=new At(this,void 0),this.cOrder=new Lt(this,void 0),this.cUser=new te(this,void 0),this.cMember=new ne(this,void 0),t=this.cUsqCommon.tuid("salesregion"),e=this,[4,t.load(1)];case 1:return e.salesRegion=n.sent(),this.currentUser=new re(this.cUsqWebUser),this.isLogined&&(this.currentUser.user=this.user),[4,this.cCart.cart.load()];case 2:return n.sent(),this.showVPage(this.VAppMain),[2]}})})},e}(a.CApp),main:f,usqs:{"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/order":{tuid:{product:se,productx:se,address:{content:function(t){var e=t.description;return r.createElement("div",null,e)}},contact:{content:function(t){return r.createElement("div",null,"gee")}}}},"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/product":{tuid:{product:se,productx:se}}}},ue=function(){function t(t){this.a=t}return Object.defineProperty(t.prototype,"A",{get:function(){return this},enumerable:!0,configurable:!0}),t.prototype.test=function(){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return[2,"A"]})})},t.prototype.t=function(){return"ta"},t}(),ce="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/cart",le=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onLogined=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,Object(a.startApp)(ce,ae)];case 1:return t.sent(),[2]}})})},e}return o.d(e,t),e.prototype.render=function(){return r.createElement(s.NavView,{onLogined:this.onLogined,notLogined:this.onLogined})},e}(r.Component),he=(function(t){function e(e){return t.call(this,e)||this}o.d(e,t),e.prototype.test=function(){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return[2,"B"]})})},e.prototype.superTest=function(){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return console.log("superTest: "+t.prototype.t.call(this)),[2,t.prototype.test.call(this)]})})},e.prototype.t=function(){return"tb"},e.prototype.d=function(){return o.b(this,void 0,void 0,function(){var e,n,r,i,s,a;return o.e(this,function(o){switch(o.label){case 0:return console.log(t.prototype.test),console.log(this.test),console.log(t.prototype.t),console.log(this.t),n=(e=console).log,r="A.test ",[4,this.superTest()];case 1:return n.apply(e,[r+o.sent()]),s=(i=console).log,a="B.test ",[4,this.test()];case 2:return s.apply(i,[a+o.sent()]),console.log("A.t "+t.prototype.t.call(this)),console.log("B.t "+this.t()),[2]}})})}}(ue),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function pe(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e&&(e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(t){console.error("Error during service worker registration:",t)})}n(179),n(181);i.render(r.createElement(le,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="./service-worker.js";he?(function(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):pe(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):pe(t)})}}()}],[[117,4,3]]]);
//# sourceMappingURL=main.9c1d3a23.chunk.js.map